00001C0E Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 03/01/2019 19:43:03

00000000                             1  ; =============================================================================
00000000                             2  ; TITLE    : YET ANOTHER FLAPPY BIRD (YAF)
00000000                             3  ; AUTHORS  : DOÑAQUE, EUGENIO && LLABRÉS, NADAL.
00000000                             4  ; CREATION : DEC 2018
00000000                             5  ; =============================================================================
00000000                             6  
00001000                             7              ORG     $1000
00001000                             8  
00001000                             9  ; --- CODE INCLUDES -----------------------------------------------------------
00001000                            10  
00001000                            11              INCLUDE "SYSCONST.X68"               ; SYSTEM CONSTANTS
00001000                            12  ; =============================================================================
00001000                            13  ; SYSTEM CONSTANTS
00001000                            14  ; =============================================================================
00001000                            15  
00001000                            16  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
00001000                            17  
00001000  =00000000                 18  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
00001000  =00000001                 19  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
00001000                            20  
00001000                            21  ; --- KEY CODES (EASy68K)
00001000                            22  
00001000  =00000020                 23  KBDCHRSP    EQU     $20                     ; SPACE KEY
00001000  =0000004D                 24  KBDCHRMK    EQU     'M'                     ; M KEY
00001000  =00000010                 25  KBDCHRSH    EQU     $10                     ; SHIFT KEY
00001000  =00000050                 26  KBDCHRPK    EQU     'P'                     ; P KEY
00001000  =00000025                 27  KBDCHRLF    EQU     $25                     ; LEFT KEY
00001000  =00000026                 28  KBDCHRUP    EQU     $26                     ; UP KEY
00001000  =00000027                 29  KBDCHRRT    EQU     $27                     ; RIGHT KEY
00001000  =00000028                 30  KBDCHRDN    EQU     $28                     ; DOWN KEY
00001000                            31  
00001000                            32  ; --- KEYBOARD MAPPING --------------------------------------------------------
00001000                            33  
00001000  =00000025                 34  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
00001000  =00000026                 35  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
00001000  =00000027                 36  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
00001000  =00000028                 37  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
00001000  =00000020                 38  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
00001000  =0000004D                 39  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
00001000  =00000010                 40  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
00001000  =00000050                 41  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
00001000                            42  
00001000                            43  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
00001000                            44  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
00001000                            45  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
00001000                            46  ; +---+---+---+---+---+---+---+---+
00001000                            47  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
00001000                            48  ; +---+---+---+---+---+---+---+---+
00001000                            49  ;   |   |   |   |   |   |   |   |
00001000                            50  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
00001000                            51  ;   |   |   |   |   |   |   +-------------- UP BUTTON
00001000                            52  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
00001000                            53  ;   |   |   |   |   +---------------------- DOWN BUTTON
00001000                            54  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
00001000                            55  ;   |   |   +------------------------------ FIRE 2 BUTTON
00001000                            56  ;   |   +---------------------------------- FIRE 3 BUTTON
00001000                            57  ;   +-------------------------------------- PAUSE BUTTON
00001000                            58  
00001000  =00000001                 59  KBDMSKLF    EQU     %00000001
00001000  =00000002                 60  KBDMSKUP    EQU     %00000010
00001000  =00000004                 61  KBDMSKRT    EQU     %00000100
00001000  =00000008                 62  KBDMSKDN    EQU     %00001000
00001000  =00000010                 63  KBDMSKF1    EQU     %00010000
00001000  =00000020                 64  KBDMSKF2    EQU     %00100000
00001000  =00000040                 65  KBDMSKF3    EQU     %01000000
00001000  =00000080                 66  KBDMSKPS    EQU     %10000000
00001000                            67  
00001000                            68  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
00001000                            69  
00001000  =00000000                 70  KBDBITLF    EQU     0
00001000  =00000001                 71  KBDBITUP    EQU     1
00001000  =00000002                 72  KBDBITRT    EQU     2
00001000  =00000003                 73  KBDBITDN    EQU     3
00001000  =00000004                 74  KBDBITF1    EQU     4
00001000  =00000005                 75  KBDBITF2    EQU     5
00001000  =00000006                 76  KBDBITF3    EQU     6
00001000  =00000007                 77  KBDBITPS    EQU     7
00001000                            78  
00001000                            79  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
00001000                            80  
00001000  =00000280                 81  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
00001000  =000001E0                 82  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
00001000  =00000001                 83  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
00001000  =00000014                 84  SCRTIM      EQU     20                      ; SCREEN TIMER (MS)
00001000                            85  
00001000                            86  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
00001000                            87  
00001000  =00000040                 88  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001000  =00000032                 89  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001000  =00000000                 90  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001000                            91  
00001000                            92  
00001000                            93  
00001000                            94  
00001000                            95  -------------------- end include --------------------
00001000                            96              INCLUDE "SYSTEM.X68"                 ; SYSTEM CODE
00001000                            97  ; =============================================================================
00001000                            98  ; SYSTEM MANAGEMENT (SYSTEM CODE)
00001000                            99  ; =============================================================================
00001000                           100  
00001000                           101  ; -----------------------------------------------------------------------------
00001000                           102  SYSINIT
00001000                           103  ; INITIALIZES THE SYSTEM
00001000                           104  ; INPUT    - NONE
00001000                           105  ; OUTPUT   - NONE
00001000                           106  ; MODIFIES - NONE
00001000                           107  ; -----------------------------------------------------------------------------
00001000  205F                     108              MOVE.L  (A7)+,A0                ; GET RETURN ADDRESS
00001002  4EB9 00001090            109              JSR     KBDINIT                 ; INIT KEYBOARD
00001008  4EB9 0000101C            110              JSR     SCRINIT                 ; INIT SCREEN
0000100E  4EB9 000010FE            111              JSR     DMMINIT                 ; INIT DYNAMIC MEMORY
00001014  027C DFFF                112              ANDI.W  #$DFFF,SR               ; SWITCH TO USER
00001018  2F08                     113              MOVE.L  A0,-(A7)                ; PUT RETURN ADDRESS
0000101A  4E75                     114              RTS
0000101C                           115  
0000101C                           116  ; =============================================================================
0000101C                           117  ; SCREEN MANAGEMENT (SYSTEM CODE)
0000101C                           118  ; =============================================================================
0000101C                           119  
0000101C                           120  ; -----------------------------------------------------------------------------
0000101C                           121  SCRINIT
0000101C                           122  ; INITIALIZES THE SCREEN, SCREEN-RELATED INTERRUPT AND VARS.
0000101C                           123  ; INPUT    - NONE
0000101C                           124  ; OUTPUT   - NONE
0000101C                           125  ; MODIFIES - D0,D1,D2,D3
0000101C                           126  ; -----------------------------------------------------------------------------
0000101C                           127              ; TO DO:
0000101C                           128              ; - DISABLE INTS (SET INT BITS IN SR TO 111)
0000101C                           129              
0000101C  007C 0700                130              ORI.W #(7<<8)&$700,SR
00001020                           131              
00001020                           132              ; - INSTALL SCRUPD INTO TRAP SCRTRAP
00001020                           133              
00001020  21FC 00001082 0084       134              MOVE.L  #SCRUPD,($80+4*SCRTRAP)
00001028                           135              
00001028                           136              ; - SET RESOLUTION TO SCRWIDTH X SCRHEIGHT
00001028                           137              
00001028  7021                     138              MOVE.L  #33,D0
0000102A  223C 028001E0            139              MOVE.L  #SCRWIDTH*$10000+SCRHEIGH,D1
00001030  4E4F                     140              TRAP    #15
00001032                           141              
00001032                           142              ; - SET WINDOWED MODE
00001032                           143              
00001032  7201                     144              MOVEQ   #1, D1 
00001034  4E4F                     145              TRAP    #15
00001036                           146              
00001036                           147              ; - CLEAR VISIBLE BUFFER
00001036                           148              
00001036  700B                     149              MOVEQ   #11, D0
00001038  323C FF00                150              MOVE.W  #$FF00,D1
0000103C  4E4F                     151              TRAP    #15
0000103E                           152              
0000103E                           153              ; - ENABLE DOUBLE BUFFER
0000103E                           154              
0000103E  705C                     155              MOVEQ   #92, D0
00001040  7211                     156              MOVEQ   #17, D1     
00001042  4E4F                     157              TRAP    #15
00001044                           158              
00001044                           159              ; - CLEAR HIDDEN BUFFER
00001044                           160              
00001044  700B                     161              MOVEQ   #11, D0
00001046  323C FF00                162              MOVE.W  #$FF00,D1
0000104A  4E4F                     163              TRAP    #15
0000104C                           164              
0000104C                           165              ; - INSTALL SCRISR FOR IRQ SCRIRQ (IRQ INTERRUPT VECTOR BEGINS
0000104C                           166              ;   AT $60. INSTALLATION IS SIMILAR TO TRAP INSTALLATION)
0000104C                           167              
0000104C  21FC 00001074 0064       168              MOVE.L  #SCRISR,($60+4*SCRIRQ)
00001054                           169              
00001054                           170              ; - ENABLE AUTO-IRQ EVERY SCRTIM MS FOR IRQ SCRIRQ (SEE TRAP #15
00001054                           171              ;   TASK 32)
00001054                           172              
00001054  7020                     173              MOVEQ   #32,D0
00001056  7206                     174              MOVEQ   #6,D1
00001058  243C 00000081            175              MOVE.L  #$80+SCRIRQ,D2
0000105E  7614                     176              MOVE.L  #SCRTIM, D3
00001060  4E4F                     177              TRAP    #15
00001062                           178              
00001062                           179              ; - CLEAR SCRINTCT AND SCRCYCCT
00001062                           180              
00001062  4239 00001C5A            181              CLR.B   (SCRINTCT)
00001068  4239 00001C5B            182              CLR.B   (SCRCYCCT)
0000106E                           183              
0000106E                           184              ; - ENABLE INTS (SET INT BITS IN SR TO 000)
0000106E                           185              
0000106E  027C F8FF                186              ANDI.W #$F8FF,SR
00001072                           187              
00001072  4E75                     188              RTS
00001074                           189  
00001074                           190  ; -----------------------------------------------------------------------------
00001074                           191  SCRISR
00001074                           192  ; SCREEN TIMER ISR. INCREASES THE INTERRUPT COUNTER AND UPDATES DOUBLE BUFFER.
00001074                           193  ; INPUT    - NONE
00001074                           194  ; OUTPUT   - NONE
00001074                           195  ; MODIFIES - NONE
00001074                           196  ; -----------------------------------------------------------------------------
00001074  5239 00001C5A            197              ADDQ.B  #1,(SCRINTCT)           ; UPDATE INT FLAG/COUNTER
0000107A  5239 00001C5B            198              ADDQ.B  #1,(SCRCYCCT)           ; UPDATE CYCLE COUNTER
00001080  4E73                     199              RTE
00001082                           200  
00001082                           201  ; -----------------------------------------------------------------------------
00001082                           202  SCRUPD
00001082                           203  ; TRAP SERVICE ROUTINE IN CHARGE OF VISUALIZING CURRENT FRAME AND CLEARING
00001082                           204  ; BUFFER FOR THE NEXT ONE.
00001082                           205  ; INPUT    - NONE
00001082                           206  ; OUTPUT   - NONE
00001082                           207  ; MODIFIES - NONE
00001082                           208  ; -----------------------------------------------------------------------------
00001082                           209              ; TO DO: UPDATE DOUBLE BUFFER AND CLEAR HIDDEN BUFFER
00001082                           210              ; - UPDATE DOUBLE BUFFER
00001082                           211              
00001082  705E                     212              MOVEQ   #94,D0
00001084  4E4F                     213              TRAP    #15
00001086                           214              
00001086                           215              ; - CLEAR HIDDEN BUFFER
00001086                           216                                 
00001086  700B                     217              MOVEQ   #11, D0
00001088  323C FF00                218              MOVE.W  #$FF00,D1
0000108C  4E4F                     219              TRAP    #15
0000108E                           220              
0000108E  4E73                     221              RTE
00001090                           222  
00001090                           223  ; =============================================================================
00001090                           224  ; KEYBOARD MANAGEMENT (SYSTEM CODE)
00001090                           225  ; =============================================================================
00001090                           226  
00001090                           227  ; -----------------------------------------------------------------------------
00001090                           228  KBDINIT
00001090                           229  ; INITIALIZES THE SYSTEM VARIABLES KBDSYS AND KBDVAL
00001090                           230  ; INPUT    - NONE
00001090                           231  ; OUTPUT   - NONE
00001090                           232  ; MODIFIES - NONE
00001090                           233  ; -----------------------------------------------------------------------------
00001090  4239 00001C58            234              CLR.B   (KBDVAL)                ; INIT VARS
00001096  4239 00001C59            235              CLR.B   (KBDEDGE)
0000109C  21FC 000010A6 0080       236              MOVE.L  #KBDREAD,($80+KBDTRAP*4) ; INSTALL
000010A4  4E75                     237              RTS
000010A6                           238  
000010A6                           239  ; -----------------------------------------------------------------------------
000010A6                           240  KBDREAD
000010A6                           241  ; TRAP SERVICE ROUTINE.
000010A6                           242  ; UPDATES THE SYSTEM VARIABLES KBDEDGE AND KBDVAL ACCORDING TO THE BITFIELD
000010A6                           243  ; DESCRIBED IN SYSCONST. KBDVAL HOLDS THE CURRENT VALUES AND KBDEFGE HOLDS
000010A6                           244  ; RISING EDGES FROM PREVIOUS CALL TO THE CURRENT ONE.
000010A6                           245  ; INPUT    - NONE
000010A6                           246  ; OUTPUT   - (KBDVAL) AND (KBDEDGE)
000010A6                           247  ; MODIFIES - NONE
000010A6                           248  ; -----------------------------------------------------------------------------
000010A6                           249              ; TO DO: UPDATE KBDVAL AND KBDEDGE
000010A6                           250              ;Guardar registros en pila
000010A6  48E7 F800                251              MOVEM.L D0-D4,-(A7)
000010AA                           252  
000010AA                           253              ;Obtener estado de teclas
000010AA  7013                     254              MOVEQ   #19,D0
000010AC                           255              
000010AC                           256              ;Obtener estado de teclas PAUSE - FIRE3 - FIRE2 - FIRE1
000010AC  223C 50104D20            257              MOVE.L  #KBDCHRPK<<24+KBDCHRSH<<16+KBDCHRMK<<8+KBDCHRSP,D1
000010B2                           258              
000010B2  4E4F                     259              TRAP    #15
000010B4                           260              
000010B4                           261              ;GUARDAR ESTADO DE TECLAS
000010B4  2401                     262              MOVE.L  D1,D2                   
000010B6                           263              
000010B6                           264              ;Obtener estado de teclas DOWN - RIGHT - UP - LEFT
000010B6  223C 28272625            265              MOVE.L  #KBDCHRDN<<24+KBDCHRRT<<16+KBDCHRUP<<8+KBDCHRLF,D1
000010BC                           266  
000010BC  4E4F                     267              TRAP    #15
000010BE                           268            
000010BE                           269              ;Actualizar valores de KBDVAL
000010BE  4243                     270              CLR     D3        ;Registro que contendrá KBDVAL.
000010C0  4244                     271              CLR     D4        ;Registro con índice de bit a modificar de D3.
000010C2                           272              
000010C2                           273              
000010C2                           274              ;Bucle que recorre D1 para obtener estado de teclas.
000010C2  7003                     275  .NEXTKEYS   MOVEQ   #3, D0    ;Número de iteraciones del bucle (.LOOP).
000010C4                           276  
000010C4                           277  .LOOP                   
000010C4  0801 0000                278              BTST    #0, D1
000010C8  6700 0004                279              BEQ     .NOTPRESSED
000010CC                           280              ;If pressed, set corresponding bit
000010CC  09C3                     281              BSET    D4, D3                  
000010CE                           282                        
000010CE                           283  .NOTPRESSED              
000010CE                           284              *En cualquier caso, obtener siguiente byte de D1*
000010CE                           285              
000010CE                           286              ;Se desplaza el registro D1 8 bits a la derecha. 
000010CE  E089                     287              LSR.L   #8, D1
000010D0                           288              
000010D0                           289              ;Se incrementa el índice de D3.
000010D0  5244                     290              ADDQ    #1, D4
000010D2  51C8 FFF0                291              DBRA    D0, .LOOP
000010D6                           292              
000010D6                           293              ;Comprobar si hay que analizar el segundo conjunto de teclas. 
000010D6  B83C 0004                294              CMP.B   #4, D4
000010DA  6600 0006                295              BNE     .KEYSREADY            
000010DE                           296             
000010DE                           297              ;Se mueve el segundo conjunto de teclas al registro D1 y se
000010DE                           298              ;repite el bucle .LOOP.
000010DE  2202                     299              MOVE.L  D2, D1
000010E0  60E0                     300              BRA     .NEXTKEYS
000010E2                           301  
000010E2                           302  .KEYSREADY  
000010E2                           303              ;Recuperamos el anterior KBDVAL en D4.
000010E2  1839 00001C58            304              MOVE.B  (KBDVAL), D4
000010E8                           305              ;Se mueve el byte obtenido a KBDVAL.         
000010E8  13C3 00001C58            306              MOVE.B  D3, KBDVAL 
000010EE                           307  
000010EE  4604                     308              NOT.B   D4
000010F0  C604                     309              AND.B   D4, D3
000010F2  13C3 00001C59            310              MOVE.B  D3, (KBDEDGE)             
000010F8                           311              
000010F8                           312              ;Restaurar registros a su estado original. 
000010F8  4CDF 001F                313              MOVEM.L (A7)+,D0-D4
000010FC                           314  
000010FC  4E73                     315              RTE
000010FE                           316  
000010FE                           317  ; =============================================================================
000010FE                           318  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
000010FE                           319  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
000010FE                           320  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
000010FE                           321  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
000010FE                           322  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
000010FE                           323  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
000010FE                           324  ; =============================================================================
000010FE                           325  
000010FE                           326  ; -----------------------------------------------------------------------------
000010FE                           327  DMMINIT
000010FE                           328  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
000010FE                           329  ; INPUT    - NONE
000010FE                           330  ; OUTPUT   - NONE
000010FE                           331  ; MODIFIES - NONE
000010FE                           332  ; -----------------------------------------------------------------------------
000010FE  48E7 8080                333              MOVEM.L D0/A0,-(A7)
00001102  41F9 00001C80            334              LEA     DMMDATA,A0
00001108  303C 0031                335              MOVE.W  #DMMBNUM-1,D0
0000110C  30BC 0000                336  .LOOP       MOVE.W  #DMMSYSID,(A0)
00001110  D1FC 00000040            337              ADD.L   #DMMBSIZE,A0
00001116  51C8 FFF4                338              DBRA.W  D0,.LOOP
0000111A  4CDF 0101                339              MOVEM.L (A7)+,D0/A0
0000111E  4E75                     340              RTS
00001120                           341  
00001120                           342  ; -----------------------------------------------------------------------------
00001120                           343  DMMFIRST
00001120                           344  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001120                           345  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001120                           346  ; INPUT    - NONE
00001120                           347  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001120                           348  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001120                           349  ; -----------------------------------------------------------------------------
00001120  41F9 00001C80            350              LEA     DMMDATA,A0
00001126  4A58                     351  DMMFRLOP    TST.W   (A0)+
00001128  6600 0016                352              BNE     DMMFRFND
0000112C  D1FC 0000003E            353              ADD.L   #DMMBSIZE-2,A0
00001132  B1FC 000028FF            354  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001138  6DEC                     355              BLT     DMMFRLOP
0000113A  207C 00000000            356              MOVE.L  #0,A0
00001140  4E75                     357  DMMFRFND    RTS
00001142                           358  
00001142                           359  ; -----------------------------------------------------------------------------
00001142                           360  DMMNEXT
00001142                           361  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001142                           362  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001142                           363  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
00001142                           364  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001142                           365  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001142                           366  ; -----------------------------------------------------------------------------
00001142  2F00                     367              MOVE.L  D0,-(A7)
00001144  2008                     368              MOVE.L  A0,D0
00001146  C0BC FFFFFFC0            369              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
0000114C  0680 00000040            370              ADD.L   #DMMBSIZE,D0
00001152  2040                     371              MOVE.L  D0,A0
00001154  201F                     372              MOVE.L  (A7)+,D0
00001156  60DA                     373              BRA     DMMFRCOM
00001158                           374  
00001158                           375  ; -----------------------------------------------------------------------------
00001158                           376  DMMFRSTO
00001158                           377  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
00001158                           378  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001158                           379  ; INPUT    - D0.W : ID TO SEARCH
00001158                           380  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001158                           381  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001158                           382  ; -----------------------------------------------------------------------------
00001158  41F9 00001C80            383              LEA     DMMDATA,A0
0000115E  B058                     384  DMMFLOOP    CMP.W   (A0)+,D0
00001160  6700 0016                385              BEQ     DMMFFND
00001164  D1FC 0000003E            386              ADD.L   #DMMBSIZE-2,A0
0000116A  B1FC 000028FF            387  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001170  6DEC                     388              BLT     DMMFLOOP
00001172  207C 00000000            389              MOVE.L  #0,A0
00001178  4E75                     390  DMMFFND     RTS
0000117A                           391  
0000117A                           392  ; -----------------------------------------------------------------------------
0000117A                           393  DMMNEXTO
0000117A                           394  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000117A                           395  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000117A                           396  ; INPUT    - D0.W : ID TO SEARCH
0000117A                           397  ;            A0   : POINTER WITHIN THE CURRENT SLOT
0000117A                           398  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000117A                           399  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000117A                           400  ; -----------------------------------------------------------------------------
0000117A  2F00                     401              MOVE.L  D0,-(A7)
0000117C  2008                     402              MOVE.L  A0,D0
0000117E  C0BC FFFFFFC0            403              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001184  0680 00000040            404              ADD.L   #DMMBSIZE,D0
0000118A  2040                     405              MOVE.L  D0,A0
0000118C  201F                     406              MOVE.L  (A7)+,D0
0000118E  60DA                     407              BRA     DMMFCOM
00001190                           408  
00001190                           409  ; -----------------------------------------------------------------------------
00001190                           410  DMMALLOC
00001190                           411  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
00001190                           412  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
00001190                           413  ; INPUT    - D0.W : ID TO ASSIGN
00001190                           414  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
00001190                           415  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001190                           416  ; -----------------------------------------------------------------------------
00001190  3F00                     417              MOVE.W  D0,-(A7)
00001192  4240                     418              CLR.W   D0
00001194  4EB8 1158                419              JSR     DMMFRSTO
00001198  301F                     420              MOVE.W  (A7)+,D0
0000119A  B1FC 00000000            421              CMP.L   #0,A0
000011A0  6700 0006                422              BEQ     .END
000011A4  3140 FFFE                423              MOVE.W  D0,-2(A0)
000011A8  4E75                     424  .END        RTS
000011AA                           425  
000011AA                           426  ; -----------------------------------------------------------------------------
000011AA                           427  DMMFREE
000011AA                           428  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000011AA                           429  ; SYSTEM (0)
000011AA                           430  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000011AA                           431  ; OUTPUT   - NONE
000011AA                           432  ; MODIFIES - NONE
000011AA                           433  ; -----------------------------------------------------------------------------
000011AA  48E7 8080                434              MOVEM.L D0/A0,-(A7)
000011AE  2008                     435              MOVE.L  A0,D0
000011B0  C0BC FFFFFFC0            436              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000011B6  2040                     437              MOVE.L  D0,A0
000011B8  4250                     438              CLR.W   (A0)
000011BA  4CDF 0101                439              MOVEM.L (A7)+,D0/A0
000011BE  4E75                     440              RTS
000011C0                           441  
000011C0                           442  
000011C0                           443  
000011C0                           444  
000011C0                           445  -------------------- end include --------------------
000011C0                           446              INCLUDE "SYSCONST.X68"               ; SYSTEM CONSTANTS
000011C0                           447  ; =============================================================================
000011C0                           448  ; SYSTEM CONSTANTS
000011C0                           449  ; =============================================================================
000011C0                           450  
000011C0                           451  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
000011C0                           452  
000011C0  =00000000                453  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
000011C0  =00000001                454  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
000011C0                           455  
000011C0                           456  ; --- KEY CODES (EASy68K)
000011C0                           457  
000011C0  =00000020                458  KBDCHRSP    EQU     $20                     ; SPACE KEY
000011C0  =0000004D                459  KBDCHRMK    EQU     'M'                     ; M KEY
000011C0  =00000010                460  KBDCHRSH    EQU     $10                     ; SHIFT KEY
000011C0  =00000050                461  KBDCHRPK    EQU     'P'                     ; P KEY
000011C0  =00000025                462  KBDCHRLF    EQU     $25                     ; LEFT KEY
000011C0  =00000026                463  KBDCHRUP    EQU     $26                     ; UP KEY
000011C0  =00000027                464  KBDCHRRT    EQU     $27                     ; RIGHT KEY
000011C0  =00000028                465  KBDCHRDN    EQU     $28                     ; DOWN KEY
000011C0                           466  
000011C0                           467  ; --- KEYBOARD MAPPING --------------------------------------------------------
000011C0                           468  
000011C0  =00000025                469  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
000011C0  =00000026                470  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
000011C0  =00000027                471  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
000011C0  =00000028                472  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
000011C0  =00000020                473  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
000011C0  =0000004D                474  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
000011C0  =00000010                475  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
000011C0  =00000050                476  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
000011C0                           477  
000011C0                           478  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
000011C0                           479  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
000011C0                           480  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
000011C0                           481  ; +---+---+---+---+---+---+---+---+
000011C0                           482  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
000011C0                           483  ; +---+---+---+---+---+---+---+---+
000011C0                           484  ;   |   |   |   |   |   |   |   |
000011C0                           485  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
000011C0                           486  ;   |   |   |   |   |   |   +-------------- UP BUTTON
000011C0                           487  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
000011C0                           488  ;   |   |   |   |   +---------------------- DOWN BUTTON
000011C0                           489  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
000011C0                           490  ;   |   |   +------------------------------ FIRE 2 BUTTON
000011C0                           491  ;   |   +---------------------------------- FIRE 3 BUTTON
000011C0                           492  ;   +-------------------------------------- PAUSE BUTTON
000011C0                           493  
000011C0  =00000001                494  KBDMSKLF    EQU     %00000001
000011C0  =00000002                495  KBDMSKUP    EQU     %00000010
000011C0  =00000004                496  KBDMSKRT    EQU     %00000100
000011C0  =00000008                497  KBDMSKDN    EQU     %00001000
000011C0  =00000010                498  KBDMSKF1    EQU     %00010000
000011C0  =00000020                499  KBDMSKF2    EQU     %00100000
000011C0  =00000040                500  KBDMSKF3    EQU     %01000000
000011C0  =00000080                501  KBDMSKPS    EQU     %10000000
000011C0                           502  
000011C0                           503  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
000011C0                           504  
000011C0  =00000000                505  KBDBITLF    EQU     0
000011C0  =00000001                506  KBDBITUP    EQU     1
000011C0  =00000002                507  KBDBITRT    EQU     2
000011C0  =00000003                508  KBDBITDN    EQU     3
000011C0  =00000004                509  KBDBITF1    EQU     4
000011C0  =00000005                510  KBDBITF2    EQU     5
000011C0  =00000006                511  KBDBITF3    EQU     6
000011C0  =00000007                512  KBDBITPS    EQU     7
000011C0                           513  
000011C0                           514  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
000011C0                           515  
000011C0  =00000280                516  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
000011C0  =000001E0                517  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
000011C0  =00000001                518  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
000011C0  =00000014                519  SCRTIM      EQU     20                      ; SCREEN TIMER (MS)
000011C0                           520  
000011C0                           521  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
000011C0                           522  
000011C0  =00000040                523  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
000011C0  =00000032                524  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
000011C0  =00000000                525  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
000011C0                           526  
000011C0                           527  
000011C0                           528  
000011C0                           529  
000011C0                           530  -------------------- end include --------------------
000011C0                           531              INCLUDE "CONST.X68"                  ; USER CONSTANTS
000011C0                           532  ; =============================================================================
000011C0                           533  ; SYSTEM CONSTANTS
000011C0                           534  ; =============================================================================
000011C0                           535  
000011C0                           536  ; --- GAME STATES -------------------------------------------------------------
000011C0                           537  
000011C0  =FFFFFFFF                538  STANONE     EQU     -1                      ; PLACEHOLDER TO FORCE CHANGE
000011C0  =00000000                539  STAINTR     EQU     0                       ; INTRO/PRESS FIRE STATE
000011C0  =00000001                540  STAPLAY     EQU     1                       ; NORMAL GAME STATE
000011C0  =00000002                541  STAPAU      EQU     2                       ; PAUSE GAME STATE
000011C0  =00000003                542  STAGOVR     EQU     3                       ; GAME OVER STATE
000011C0                           543  
000011C0                           544  ; --- AGENT & PROP TYPES -------------------------------------------------------------
000011C0                           545  
000011C0  =00000001                546  CLDTYPE     EQU     1                       ; NUMBER FOR CLOUD TYPES
000011C0  =00000002                547  GSSDTYPE    EQU     2                       ; NUMBER FOR GRASS DETAIL TYPES
000011C0  =00000003                548  PIPTYPE     EQU     3                       ; NUMBER FOR PIPE TYPES
000011C0                           549  
000011C0                           550  
000011C0                           551  ; --- INTRO STATE RELATED CONSTANTS -------------------------------------------
000011C0                           552  
000011C0  =00000001                553  INTTITX     EQU     1                       ; TITLE X COORDINATE
000011C0  =00000001                554  INTTITY     EQU     1                       ; TITLE Y COORDINATE
000011C0  =0000FFFF                555  INTTITC     EQU     $0000FFFF               ; TITLE COLOR
000011C0  =033D0001                556  INTTITF     EQU     $033D0001               ; TITLE FONT
000011C0  =00000005                557  INTPRSX     EQU     5                       ; PRESS FIRE X COORDINATE
000011C0  =00000008                558  INTPRSY     EQU     8                       ; PRESS FIRE Y COORDINATE
000011C0  =00000080                559  INTPRSC     EQU     $00000080               ; PRESS FIRE COLOR
000011C0  =031A0001                560  INTPRSF     EQU     $031A0001               ; PRESS FIRE FONT
000011C0                           561  
000011C0                           562  ; --- BACKGROUND RELATED CONSTANTS --------------------------------------------
000011C0                           563  
000011C0  =00000000                564  BGSKYPC     EQU     $00000000               ; BACKGROUND SKY PEN COLOUR
000011C0  =00EFCE87                565  BGSKYFC     EQU     $00EFCE87               ; BACKGROUND SKY FILL COLOUR
000011C0  =00000000                566  BGGSSPC     EQU     $00000000               ; BACKGROUND GRASS PEN COLOUR
000011C0  =0000990A                567  BGGSSFC     EQU     $0000990A               ; BACKGROUND GRASS FILL COLOUR
000011C0  =00000168                568  BGGSSTP     EQU     SCRHEIGH*3/4            ; GRASS TOP EDGE (Y) COORDINATE
000011C0  =00000190                569  BGGSSBT     EQU     BGGSSTP+40              ; GRASS BOTTOM EDGE (Y) COORDINATE
000011C0  =0000000A                570  GSSDWDTH    EQU     10                      ; GRASS DETAIL WIDTH
000011C0  =0039DB44                571  GSSDFC      EQU     $0039DB44               ; BACKGROUND GRASS DETAIL F.COLOUR
000011C0  =00000000                572  BGGNDPC     EQU     $00000000               ; BACKGROUND GROUND PEN COLOUR
000011C0  =00155DD8                573  BGGNDFC     EQU     $00155DD8               ; BACKGROUND GROUND FILL COLOUR
000011C0  =00000190                574  BGGNDTP     EQU     BGGSSBT                 ; GROUND TOP EDGE (Y) COORDINATE
000011C0                           575  
000011C0                           576  ; --- PLAYER RELATED CONSTANTS ------------------------------------------------
000011C0                           577  
000011C0                           578        ;Player colours
000011C0                           579  
000011C0  =00008000                580  GREEN EQU $00008000                         ;GREEN COLOR
000011C0  =000000FF                581  RED   EQU $000000FF                         ;RED COLOR
000011C0  =00FFFFFF                582  WHITE EQU $00FFFFFF                         ;WHITE COLOR
000011C0  =00000000                583  BLACK EQU $00000000                         ;BLACK COLOR
000011C0                           584  
000011C0                           585        ;Constants
000011C0                           586        
000011C0  =00008000                587  PLRCOLOR        EQU GREEN                   ;PLAYER COLOR
000011C0  =00FFFFFF                588  PLREYECOLOR     EQU WHITE                   ;PLAYER EYE COLOR
000011C0  =00000000                589  PLRIRISCOLOR    EQU BLACK                   ;PLAYER IRIS COLOR
000011C0  =000000FF                590  PLRMOUTHCOLOR   EQU RED                     ;PLAYER MOUTH COLOR
000011C0  =00000019                591  PLRWIDTH        EQU 25                      ;PLAYER WIDTH
000011C0  =00000019                592  PLRHEIGHT       EQU 25                      ;PLAYER HEIGHT
000011C0  =00000096                593  PLRINITPOSX     EQU 150                     ;INITIAL POSITION OF THE PLAYER (X)
000011C0  =000000B4                594  PLRINITPOSY     EQU 180                     ;INITIAL POSITION OF THE PLAYER (Y)
000011C0  =0000003C                595  JUMPSIZE        EQU 60                      ;JUMP SIZE
000011C0  =00000003                596  JUMPSPEED       EQU 3                       ;JUMP SPEED (BIG VALUE = SLOW SPEED).
000011C0                           597  
000011C0                           598  ; --- PIPE RELATED CONSTANTS --------------------------------------------------
000011C0                           599  
000011C0  =00000000                600  PIPPC       EQU     $00000000               ; PIPE PEN COLOUR
000011C0  =00196600                601  PIPFC       EQU     $00196600               ; PIPE FILL COLOUR
000011C0  =00000032                602  PIPBWDT     EQU     50                      ; PIPE BASE WIDTH
000011C0  =0000003C                603  PIPTWDT     EQU     60                      ; PIPE MOUTH WIDTH
000011C0  =0000000A                604  PIPTHGT     EQU     10                      ; PIPE MOUTH HEIGHT
000011C0  =00000005                605  PIPTBSPC    EQU     ((PIPTWDT-PIPBWDT)/2)   ; DIF.BETW. OUTER RAD. & IN. RAD
000011C0  =00000064                606  PIPOPEN     EQU     100                      ; SPACE BETW. TOP AND BOTTOM PIPES
000011C0  =00000002                607  PIPYSPD     EQU     2                       ; SPEED @ WHICH PIPES GO UP&DOWN
000011C0                           608  
000011C0                           609  ; --- CLOUD RELATED CONSTANTS -------------------------------------------------
000011C0                           610  
000011C0  =0000003C                611  CLDSIZE     EQU     60                      ; CLOUD DIAMETER
000011C0  =00FFFFFF                612  CLDPCLR     EQU     $00FFFFFF               ; CLOUD PEN COLOR
000011C0  =00FFFFFF                613  CLDFCLR     EQU     $00FFFFFF               ; CLOUD FIL COLOR
000011C0                           614  
000011C0                           615  ; --- PAUSE STATE RELATED CONSTANTS ---------------------------------------
000011C0                           616  
000011C0  =00000000                617  CONTNUM     EQU     0                       ; CONTINUE GAME NUMBER
000011C0  =00000001                618  NEWGNUM     EQU     1                       ; NEW GAME NUMBER
000011C0  =00000002                619  EXTNUM      EQU     2                       ; EXIT GAME NUMBER
000011C0  =0000FFFF                620  PAUTITC     EQU     $0000FFFF               ; TITLE COLOUR
000011C0  =03300001                621  PAUTITF     EQU     $03300001               ; TITLE FONT
000011C0  =01130001                622  PAUOPTFU    EQU     $01130001               ; OPTION FONT (unselected)
000011C0  =01130005                623  PAUOPTFS    EQU     $01130005               ; OPTION FONT (selected)
000011C0  =00FFFFFF                624  PAUOPTC     EQU     $00FFFFFF               ; OPTION COLOUR
000011C0  =00000002                625  PAUTITX     EQU     2                       ; TITLE COORD. X
000011C0  =00000001                626  PAUTITY     EQU     1                       ; TITLE COORD. Y
000011C0  =0000000F                627  PAUOPTX     EQU     15                      ; OPTIONS COORD. X
000011C0  =00000008                628  PAUCNTY     EQU     8                       ; CONTINUE OPTION COORD. Y
000011C0  =0000000A                629  PAUNEWY     EQU     10                      ; NEW GAME OPTION COORD. Y
000011C0  =0000000C                630  PAUEXTY     EQU     12                      ; EXIT OPTION COORD. Y
000011C0  =000000FF                631  PAUSELC     EQU     $000000FF               ; SELECTED OPTION COLOUR
000011C0                           632  
000011C0                           633  ; --- GAME OVER STATE RELATED CONSTANTS ---------------------------------------
000011C0                           634  
000011C0  =00000023                635  GOVSTRX     EQU     35                      ; TITLE X COORDINATE
000011C0  =0000000F                636  GOVSTRY     EQU     15                      ; TITLE Y COORDINATE
000011C0  =00FFFFFF                637  GOVSTRC     EQU     $00FFFFFF               ; TITLE COLOR
000011C0                           638  
000011C0                           639  
000011C0                           640  
000011C0                           641  
000011C0                           642  
000011C0                           643  
000011C0                           644  
000011C0                           645  
000011C0                           646  
000011C0                           647  
000011C0                           648  
000011C0                           649  
000011C0                           650  
000011C0                           651  
000011C0                           652  
000011C0                           653  
000011C0                           654  
000011C0                           655  
000011C0                           656  
000011C0                           657  
000011C0                           658  
000011C0                           659  
000011C0                           660  
000011C0                           661  
000011C0                           662  
000011C0                           663  
000011C0                           664  
000011C0                           665  
000011C0                           666  
000011C0                           667  
000011C0                           668  
000011C0                           669  
000011C0                           670  
000011C0                           671  -------------------- end include --------------------
000011C0                           672              INCLUDE "PLAYER.X68"
000011C0                           673  ; =============================================================================
000011C0                           674  ; PLAYER MANAGEMENT
000011C0                           675  ; =============================================================================
000011C0                           676  
000011C0                           677  ; -----------------------------------------------------------------------------
000011C0                           678  PLRINIT
000011C0                           679  ; INITIALIZES THE PLAYER
000011C0                           680  ; INPUT    - NONE
000011C0                           681  ; OUTPUT   - NONE
000011C0                           682  ; MODIFIES - NONE
000011C0                           683  ; -----------------------------------------------------------------------------
000011C0                           684  
000011C0  33FC 0096 00001C3A       685          MOVE.W #PLRINITPOSX,(PLRPOSX)
000011C8  33FC 00B4 00001C3C       686          MOVE.W #PLRINITPOSY,(PLRPOSY)
000011D0  33FC 00B4 00001C3E       687          MOVE.W #PLRINITPOSY,(MAXPOS)
000011D8  33FC 0000 00001C40       688          MOVE.W #0, (UPPRESSED)
000011E0  33FC 0001 00001C42       689          MOVE.W #1, (PLRDOWNSPEED)
000011E8  4279 00001C46            690          CLR    (PLRSCORE)
000011EE  4279 00001C44            691          CLR    (PLRDEAD)               ;Poner a 0 PLRDEAD (Jugador vivo).
000011F4                           692  
000011F4  4E75                     693          RTS
000011F6                           694  ; -----------------------------------------------------------------------------
000011F6                           695  PLRUPD
000011F6                           696  ; UPDATES THE PLAYER MOTION
000011F6                           697  ; INPUT    - NONE (ACCESSES KBDEDGE)
000011F6                           698  ; OUTPUT   - NONE (MODIFIES PLAYER DATA)
000011F6                           699  ; MODIFIES - NONE
000011F6                           700  ; -----------------------------------------------------------------------------
000011F6  48E7 F000                701            MOVEM.L D0/D1/D2/D3,-(A7)
000011FA  0839 0001 00001C59       702            BTST.B #KBDBITUP, (KBDEDGE)    
00001202  6600 0044                703            BNE.L  .PRESSED
00001206                           704          
00001206                           705           ;Comprobar colisión con tubería. 
00001206  0C79 0001 00001C44       706            CMP #1, (PLRDEAD)
0000120E  6700 009C                707            BEQ .GAMEOVER 
00001212                           708          
00001212                           709            ;TECLA NO PRESIONADA
00001212  0C79 0001 00001C40       710            CMP #1, (UPPRESSED)
0000121A  6700 0050                711            BEQ .MAKEJUMP
0000121E                           712            ;No se ha apretado la tecla UP. Hay que bajar el pájaro. 
0000121E  3039 00001C3C            713            MOVE.W (PLRPOSY), D0
00001224  D079 00001C42            714            ADD.W (PLRDOWNSPEED), D0
0000122A                           715            ;Se incrementa la velocidad de bajada. 
0000122A  5279 00001C42            716            ADDQ #1, (PLRDOWNSPEED)
00001230  33C0 00001C3C            717            MOVE.W D0, (PLRPOSY)
00001236                           718           
00001236                           719            ;Comprobar si ha salido por la parte inferior
00001236  323C 0168                720            MOVE.W #BGGSSTP, D1
0000123A  0640 0019                721            ADD.W #PLRHEIGHT, D0
0000123E  B240                     722            CMP D0, D1
00001240  6B00 006A                723            BMI .GAMEOVER         
00001244                           724         
00001244  6000 0072                725            BRA .END         
00001248                           726  .PRESSED
00001248                           727            ;TECLA UP PRESIONADA
00001248                           728            ;Se reinicia la velocidad de bajada. 
00001248  33FC 0001 00001C42       729            MOVE.W #1, (PLRDOWNSPEED)
00001250                           730  
00001250                           731            ;Se establece el límite hasta donde subirá
00001250  3039 00001C3C            732            MOVE.W (PLRPOSY), D0
00001256  0440 003C                733            SUB.W #JUMPSIZE, D0
0000125A  33C0 00001C3E            734            MOVE.W D0, (MAXPOS)
00001260                           735            ;Se indica que se ha presionado la tecla de salto
00001260  33FC 0001 00001C40       736            MOVE.W #1, (UPPRESSED)
00001268                           737            
00001268  6000 004E                738            BRA .END   
0000126C                           739        
0000126C                           740  .MAKEJUMP
0000126C                           741            ;Se ha apretado la tecla UP anteriormente (eso indica que el salto no
0000126C                           742            ; ha finalizado). 
0000126C                           743            
0000126C  3039 00001C3C            744            MOVE.W (PLRPOSY), D0
00001272  3239 00001C3E            745            MOVE.W (MAXPOS), D1
00001278  9041                     746            SUB.W  D1, D0             ;FÓRMULA: (PLRPOSY-MAXPOS)/JUMPSPEED = VALOR QUE SE TIENE QUE RESTAR A LA POSICIÓN ACTUAL PARA OBTENER LA NUEVA POSICIÓN
0000127A  80FC 0003                747            DIVU.W #JUMPSPEED, D0
0000127E  9179 00001C3C            748            SUB.W D0, (PLRPOSY)       ;NEWPOS
00001284                           749  
00001284                           750            ;Ver si ha salido por la parte superior. 
00001284  0C79 0000 00001C3C       751            CMP #0, (PLRPOSY)
0000128C  6B00 001E                752            BMI .GAMEOVER
00001290  B07C 0001                753            CMP #1, D0
00001294  6B00 000A                754            BMI .LASTJUMP
00001298  6700 0006                755            BEQ .LASTJUMP
0000129C                           756            ;El salto no ha finalizado (No ha llegado a MAXPOS)
0000129C                           757                                
0000129C  6000 001A                758            BRA .END
000012A0                           759            
000012A0                           760  .LASTJUMP
000012A0                           761            ;El salto ha llegado a MAXPOS
000012A0                           762            ;Se desactiva la tecla UP indicando que lo siguiente será realizar la bajada. 
000012A0  33FC 0000 00001C40       763            MOVE.W #0, (UPPRESSED)         
000012A8  6000 000E                764            BRA .END    
000012AC                           765            
000012AC                           766  .GAMEOVER
000012AC                           767  
000012AC  33FC 0003 00001C38       768            MOVE.W #STAGOVR, (STANEXT)        
000012B4  6000 0002                769            BRA .END         
000012B8                           770                   
000012B8                           771  .END
000012B8  4CDF 000F                772            MOVEM.L (A7)+,D0/D1/D2/D3
000012BC  4E75                     773            RTS
000012BE                           774            
000012BE                           775  ; -----------------------------------------------------------------------------
000012BE                           776  PLRPLOT
000012BE                           777  ; PLOTS THE PLAYER
000012BE                           778  ; INPUT    - NONE
000012BE                           779  ; OUTPUT   - NONE
000012BE                           780  ; MODIFIES - NONE
000012BE                           781  ; -----------------------------------------------------------------------------
000012BE                           782  
000012BE  48E7 FC00                783              MOVEM.L D0-D5,-(A7)
000012C2                           784              
000012C2                           785              ;-------SCORE----------------
000012C2                           786              
000012C2  303C 0011                787              MOVE #17, D0
000012C6  43F9 00001C48            788              LEA PLRSCORETEXT, A1
000012CC  2239 00001C46            789              MOVE.L (PLRSCORE), D1
000012D2  4E4F                     790              TRAP #15
000012D4                           791                      
000012D4                           792              ;-------PLAYER (BODY)--------
000012D4                           793  
000012D4                           794              ;SET PLAYER COLOR 
000012D4  223C 00008000            795              MOVE.L  #PLRCOLOR,D1
000012DA  103C 0050                796              MOVE.B  #80,D0
000012DE  4E4F                     797              TRAP    #15
000012E0  5200                     798              ADDQ.B  #1,D0
000012E2  4E4F                     799              TRAP    #15
000012E4                           800              
000012E4                           801              ;SET PLAYER POSITION
000012E4  3239 00001C3A            802              MOVE.W  (PLRPOSX),D1            
000012EA  3439 00001C3C            803              MOVE.W  (PLRPOSY),D2
000012F0  3601                     804              MOVE.W  D1,D3
000012F2  3802                     805              MOVE.W  D2,D4
000012F4                           806              
000012F4                           807              ;SET PLAYER WIDTH AND HEIGHT
000012F4  0643 0019                808              ADD.W   #PLRWIDTH,D3
000012F8  0644 0019                809              ADD.W   #PLRHEIGHT,D4
000012FC  103C 0058                810              MOVE.B  #88,D0
00001300  4E4F                     811              TRAP    #15
00001302                           812              
00001302                           813              
00001302  0443 000C                814              SUB.W   #PLRWIDTH/2,D3
00001306  103C 0057                815              MOVE.B  #87,D0
0000130A  4E4F                     816              TRAP    #15
0000130C                           817              
0000130C                           818              ;---------EYE (IRIS)---------
0000130C                           819                               
0000130C                           820              ;SET EYE COLOR
0000130C  7051                     821              MOVE.L  #81, D0
0000130E  7200                     822              MOVE.L  #PLRIRISCOLOR, D1
00001310  4E4F                     823              TRAP    #15
00001312                           824              
00001312  3239 00001C3A            825              MOVE.W  PLRPOSX,D1   
00001318                           826              
00001318                           827              ;X0        
00001318  5041                     828              ADD.W   #PLRWIDTH/3,D1
0000131A  3639 00001C3A            829              MOVE.W  (PLRPOSX),D3
00001320                           830              
00001320                           831              ;X2
00001320  0643 000C                832              ADD.W   #PLRWIDTH/2,D3
00001324  3439 00001C3C            833              MOVE.W (PLRPOSY),D2
0000132A                           834              
0000132A                           835              ;X1
0000132A  5C42                     836              ADD.W   #PLRHEIGHT/4,D2
0000132C  3839 00001C3C            837              MOVE.W  (PLRPOSY),D4
00001332                           838              
00001332                           839              
00001332                           840              ;X3
00001332  5244                     841              ADD.W   #PLRHEIGHT/20,D4
00001334  103C 0058                842              MOVE.B  #88,D0
00001338  4E4F                     843              TRAP    #15
0000133A                           844              
0000133A                           845             ;---------MOUTH------
0000133A                           846                                 
0000133A                           847              ;SET MOUTH COLOR
0000133A  7051                     848              MOVE.L  #81, D0
0000133C  223C 000000FF            849              MOVE.L  #RED, D1
00001342  4E4F                     850              TRAP    #15           
00001344                           851                 
00001344  3239 00001C3A            852              MOVE.W  (PLRPOSX),D1   
0000134A                           853              
0000134A                           854              ;X0        
0000134A  0641 0014                855              ADD.W   #PLRWIDTH-5,D1
0000134E  3639 00001C3A            856              MOVE.W  (PLRPOSX),D3
00001354                           857             
00001354                           858              
00001354                           859              ;X2
00001354  0643 000C                860              ADD.W   #PLRWIDTH/2,D3
00001358  3439 00001C3C            861              MOVE.W  (PLRPOSY),D2
0000135E                           862              
0000135E                           863    
0000135E                           864              ;X1
0000135E  0642 000C                865              ADD.W   #PLRHEIGHT/2,D2
00001362  3839 00001C3C            866              MOVE.W  (PLRPOSY),D4   
00001368                           867              
00001368                           868              ;X3 
00001368  0644 0019                869              ADD.W   #PLRHEIGHT,D4
0000136C                           870             
0000136C  103C 0058                871              MOVE.B  #88,D0
00001370  4E4F                     872              TRAP    #15
00001372                           873              
00001372  4CDF 003F                874              MOVEM.L (A7)+,D0-D5
00001376                           875              
00001376  4E75                     876              RTS
00001378                           877  
00001378                           878  -------------------- end include --------------------
00001378                           879              INCLUDE "UTIL.X68"                   ; UTILITY MACRO AND SUBROUTINES
00001378                           880  ; =============================================================================
00001378                           881  ; UTILITY MACROS
00001378                           882  ; =============================================================================
00001378                           883  
00001378                           884  ; -----------------------------------------------------------------------------
00001378                           885  UTLSPEN     MACRO
00001378                           886  ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001378                           887  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
00001378                           888  ; OUTPUT   - NONE
00001378                           889  ; MODIFIES - D0,D1
00001378                           890  ; -----------------------------------------------------------------------------
00001378                           891              MOVE.B  #80,D0
00001378                           892              MOVE.L  \1,D1
00001378                           893              TRAP    #15
00001378                           894              ENDM
00001378                           895  
00001378                           896  ; -----------------------------------------------------------------------------
00001378                           897  UTLSFIL     MACRO
00001378                           898  ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001378                           899  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
00001378                           900  ; OUTPUT   - NONE
00001378                           901  ; MODIFIES - D0,D1
00001378                           902  ; -----------------------------------------------------------------------------
00001378                           903              MOVE.B  #81,D0
00001378                           904              MOVE.L  \1,D1
00001378                           905              TRAP    #15
00001378                           906              ENDM
00001378                           907  
00001378                           908  ; -----------------------------------------------------------------------------
00001378                           909  UTLLOCT     MACRO
00001378                           910  ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001378                           911  ; INPUT    - \1 X, \2 Y
00001378                           912  ; OUTPUT   - NONE
00001378                           913  ; MODIFIES - D0,D1
00001378                           914  ; -----------------------------------------------------------------------------
00001378                           915              MOVE.W  #\1<<8|\2, D1
00001378                           916              MOVE.B  #11,D0
00001378                           917              TRAP    #15
00001378                           918              ENDM
00001378                           919  
00001378                           920  ; -----------------------------------------------------------------------------
00001378                           921  UTLFONT     MACRO
00001378                           922  ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001378                           923  ; INPUT    - \1 COLOR, \2 FONT
00001378                           924  ; OUTPUT   - NONE
00001378                           925  ; MODIFIES - D0,D1,D2
00001378                           926  ; -----------------------------------------------------------------------------
00001378                           927              MOVE.L  #\1,D1
00001378                           928              MOVE.L  #\2,D2
00001378                           929              MOVEQ   #21,D0
00001378                           930              TRAP    #15
00001378                           931              ENDM
00001378                           932  
00001378                           933  ; =============================================================================
00001378                           934  ; UTILITY SUBROUTINES
00001378                           935  ; =============================================================================
00001378                           936  
00001378                           937  ; -----------------------------------------------------------------------------
00001378                           938  UTLINIT
00001378                           939  ; INITIALIZES UTILITY CODE
00001378                           940  ; INPUT    - NONE
00001378                           941  ; OUTPUT   - NONE
00001378                           942  ; MODIFIES - NONE
00001378                           943  ; -----------------------------------------------------------------------------
00001378  4239 00001C57            944              CLR.B   (UTLRNDIX)
0000137E  4E75                     945              RTS
00001380                           946  ; -----------------------------------------------------------------------------
00001380                           947  UTLCHCOL
00001380                           948  ; CHECKS COLLISION
00001380                           949  ; INPUT    - D0.W X0 COORDINATE
00001380                           950  ;            D1.W Y0 COORDINATE
00001380                           951  ;            D2.W X1 COORDINATE
00001380                           952  ;            D3.W Y1 COORDINATE
00001380                           953  ;            D4.W WIDTH 0
00001380                           954  ;            D5.W WIDTH 1
00001380                           955  ;            D6.W HEIGHT 0
00001380                           956  ;            D7.W HEIGHT 1
00001380                           957  ; OUTPUT   - D0.B=FF - COLLISION, =0 - NO COLLISION
00001380                           958  ; MODIFIES - NONE
00001380                           959  ; -----------------------------------------------------------------------------
00001380  48A7 2B00                960               MOVEM.W D2/D4/D6/D7,-(A7)
00001384                           961  
00001384                           962              ;Verificar si la tubería esta delante o detrás del pájaro. 
00001384                           963              
00001384  D840                     964              ADD.W D0, D4 ;Pared derecha de la tubería.
00001386  B842                     965              CMP D2, D4
00001388  6500 0022                966              BCS .NOCOL
0000138C                           967              
0000138C                           968              ;Comprobar si el pájaro ha alcanzado la tubería.
0000138C                           969              
0000138C  D445                     970              ADD.W D5, D2 ;Parte delantera del pájaro.
0000138E  B440                     971              CMP D0, D2
00001390  6500 001A                972              BCS .NOCOL
00001394                           973              
00001394                           974              ;Comprobar parte inferior del pájaro con la parte superior de la 
00001394                           975              ;tubería inferior.
00001394                           976                          
00001394  B641                     977              CMP D1, D3
00001396  6F00 000C                978              BLE .COL 
0000139A                           979              
0000139A  DC41                     980              ADD.W D1, D6 ;Parte superior de la tubería inferior.
0000139C  DE43                     981              ADD.W D3, D7 ;Parte inferior del pájaro. 
0000139E  BE46                     982              CMP D6, D7
000013A0  6500 000A                983              BCS .NOCOL
000013A4                           984       
000013A4                           985             ;Si no se realiza ninguno de los saltos anteriores, hay colisión. 
000013A4                           986  .COL
000013A4  303C 00FF                987              MOVE.W  #$FF, D0
000013A8  6000 0006                988              BRA .END                                
000013AC                           989  
000013AC                           990  .NOCOL                    
000013AC  303C 0000                991              MOVE.W #0, D0
000013B0                           992  
000013B0                           993  .END          
000013B0  4C9F 00D4                994              MOVEM.W (A7)+,D2/D4/D6/D7
000013B4  4E75                     995              RTS
000013B6                           996  ; -----------------------------------------------------------------------------
000013B6                           997  UTLRAND
000013B6                           998  ; PROVIDES A PSEUDO-RANDOM BYTE
000013B6                           999  ; INPUT    - NONE
000013B6                          1000  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
000013B6                          1001  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000013B6                          1002  ; -----------------------------------------------------------------------------
000013B6  2F08                    1003              MOVE.L  A0,-(A7)
000013B8  41F9 000013D4           1004              LEA     .RANDVEC,A0
000013BE  4280                    1005              CLR.L   D0
000013C0  1039 00001C57           1006              MOVE.B  (UTLRNDIX),D0
000013C6  1030 0800               1007              MOVE.B  (A0,D0.L),D0
000013CA  5239 00001C57           1008              ADDQ.B  #1,(UTLRNDIX)
000013D0  205F                    1009              MOVE.L  (A7)+,A0
000013D2  4E75                    1010              RTS
000013D4                          1011  
000013D4                          1012  
000013D4= A2 EE 9A 0C F5 24 ...   1013  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000013DC= 2A A3 51 26 E0 AC ...   1014              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
000013E4= 75 51 CA FD 33 EB ...   1015              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
000013EC= 60 CC E7 B8 9A EB ...   1016              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000013F4= 1D 76 B5 95 B0 89 ...   1017              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000013FC= 39 15 48 C9 6E CA ...   1018              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001404= 43 E7 E2 7C 37 25 ...   1019              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
0000140C= E9 94 CE E9 E4 52 ...   1020              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001414= 37 6D 9A 84 A2 28 ...   1021              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
0000141C= 19 E2 C6 77 80 D4 ...   1022              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001424= 0A 5A 32 67 33 C2 ...   1023              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
0000142C= 59 80 DC 0E 57 FC ...   1024              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001434= 8A AB BC F7 07 4D ...   1025              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
0000143C= EF D5 77 6E 1E BB ...   1026              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001444= D6 E0 2A 8F BD 28 ...   1027              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
0000144C= 13 4F 66 EC 0A 64 ...   1028              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001454= 56 52 9A 16 9B 90 ...   1029              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
0000145C= 06 8A A4 F7 01 DA ...   1030              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001464= F2 E7 77 28 B1 76 ...   1031              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
0000146C= A4 42 E3 81 B1 67 ...   1032              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001474= BF CE FA 16 BF 38 ...   1033              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
0000147C= D1 8B 50 0C 5F 49 ...   1034              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001484= DE 4C 14 A2 40 DC ...   1035              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
0000148C= B6 9B 0A 38 5D AB ...   1036              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001494= E2 1B DD 75 15 82 ...   1037              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
0000149C= 8A 26 51 30 9F 47 ...   1038              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
000014A4= 1E 8A BB 71 C6 6E ...   1039              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
000014AC= 9F 47 E5 34 94 27 ...   1040              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
000014B4= 7D 06 D6 BA 30 0F ...   1041              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
000014BC= EC 7F 7E 03 CF 2D ...   1042              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
000014C4= 94 5B 23 F2 8B CD ...   1043              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000014CC= 74 33 EC B9 0F D5 ...   1044              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
000014D4                          1045  
000014D4                          1046  
000014D4                          1047  
000014D4                          1048  
000014D4                          1049  
000014D4                          1050  
000014D4                          1051  
000014D4                          1052  
000014D4                          1053  
000014D4                          1054  
000014D4                          1055  -------------------- end include --------------------
000014D4                          1056              INCLUDE "AGENTLST.X68"               ; AGENT LIST MANAGEMENT
000014D4                          1057  ; =============================================================================
000014D4                          1058  ; AGENT MANAGEMENT
000014D4                          1059  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000014D4                          1060  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000014D4                          1061  ; +4 - LONG : PLOT SUBROUTINE POINTER
000014D4                          1062  ; +8:END    : DATA (AGENT SPECIFIC)
000014D4                          1063  ; =============================================================================
000014D4                          1064  
000014D4                          1065  ; -----------------------------------------------------------------------------
000014D4                          1066  AGLADD
000014D4                          1067  ; CREATES A NEW AGENT
000014D4                          1068  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000014D4                          1069  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000014D4                          1070  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000014D4                          1071  ;            D0 - AGENT TYPE (USED AS OWNED BY DMM)
000014D4                          1072  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000014D4                          1073  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000014D4                          1074  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000014D4                          1075  ; OUTPUT   - NONE
000014D4                          1076  ; MODIFIES - NONE
000014D4                          1077  ; -----------------------------------------------------------------------------
000014D4  2F08                    1078              MOVE.L  A0,-(A7)
000014D6                          1079              
000014D6  4EB8 1190               1080              JSR     DMMALLOC
000014DA  B1FC 00000000           1081              CMP.L   #0,A0
000014E0  6700 0008               1082              BEQ     .END
000014E4  20CA                    1083              MOVE.L  A2,(A0)+
000014E6  20CB                    1084              MOVE.L  A3,(A0)+
000014E8  4E91                    1085              JSR     (A1)
000014EA                          1086  
000014EA  205F                    1087  .END        MOVE.L  (A7)+,A0
000014EC  4E75                    1088              RTS
000014EE                          1089  
000014EE                          1090  ; -----------------------------------------------------------------------------
000014EE                          1091  AGLUPD
000014EE                          1092  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000014EE                          1093  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000014EE                          1094  ; INPUT    - NONE
000014EE                          1095  ; OUTPUT   - NONE
000014EE                          1096  ; MODIFIES - NONE
000014EE                          1097  ; -----------------------------------------------------------------------------
000014EE  48E7 00C0               1098              MOVEM.L A0-A1,-(A7)
000014F2                          1099              
000014F2  4EB8 1120               1100              JSR     DMMFIRST
000014F6  B1FC 00000000           1101  .LOOP       CMP.L   #0,A0
000014FC  6700 001E               1102              BEQ     .END
00001500  0C68 0002 FFFE          1103              CMP.W   #GSSDTYPE,-2(A0)    ;IF MEMORY DOESN'T BELONG TO AGENT
00001506  670E                    1104              BEQ.S   .NEXT               ;SKIP
00001508  0C68 0001 FFFE          1105              CMP.W   #CLDTYPE,-2(A0)
0000150E  6706                    1106              BEQ.S   .NEXT
00001510                          1107              
00001510  2250                    1108              MOVE.L  (A0),A1
00001512  5088                    1109              ADD.L   #8,A0
00001514  4E91                    1110              JSR     (A1)
00001516  4EB8 1142               1111  .NEXT       JSR     DMMNEXT
0000151A  60DA                    1112              BRA     .LOOP
0000151C                          1113              
0000151C  4CDF 0300               1114  .END        MOVEM.L (A7)+,A0-A1            
00001520  4E75                    1115              RTS
00001522                          1116  
00001522                          1117  ; -----------------------------------------------------------------------------
00001522                          1118  AGLPLOT
00001522                          1119  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001522                          1120  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001522                          1121  ; INPUT    - NONE
00001522                          1122  ; OUTPUT   - NONE
00001522                          1123  ; MODIFIES - NONE
00001522                          1124  ; -----------------------------------------------------------------------------
00001522  48E7 00C0               1125              MOVEM.L A0-A1,-(A7)
00001526                          1126  
00001526  4EB8 1120               1127              JSR     DMMFIRST
0000152A  B1FC 00000000           1128  .LOOP       CMP.L   #0,A0
00001530  6700 0020               1129              BEQ     .END
00001534  0C68 0002 FFFE          1130              CMP.W   #GSSDTYPE,-2(A0)    ;IF MEMORY DOESN'T BELONG TO AGENT
0000153A  6710                    1131              BEQ.S   .NEXT               ;SKIP
0000153C  0C68 0001 FFFE          1132              CMP.W   #CLDTYPE,-2(A0)
00001542  6708                    1133              BEQ.S   .NEXT
00001544                          1134              
00001544  2268 0004               1135              MOVE.L  4(A0),A1
00001548  5088                    1136              ADD.L   #8,A0
0000154A  4E91                    1137              JSR     (A1)
0000154C  4EB8 1142               1138  .NEXT       JSR     DMMNEXT
00001550  60D8                    1139              BRA     .LOOP
00001552  4CDF 0300               1140  .END        MOVEM.L (A7)+,A0-A1
00001556                          1141  
00001556  4E75                    1142              RTS
00001558                          1143  
00001558                          1144  ; -----------------------------------------------------------------------------
00001558  =000011AA               1145  AGLKILL     EQU     DMMFREE
00001558                          1146  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001558                          1147  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001558                          1148  ; OUTPUT   - NONE
00001558                          1149  ; MODIFIES - NONE
00001558                          1150  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001558                          1151  ; -----------------------------------------------------------------------------
00001558                          1152  
00001558                          1153  
00001558                          1154  
00001558                          1155  
00001558                          1156  
00001558                          1157  
00001558                          1158  
00001558                          1159  
00001558                          1160  
00001558                          1161  
00001558                          1162  
00001558                          1163  -------------------- end include --------------------
00001558                          1164              INCLUDE "PROPLST.X68"                ; PROPS LIST MANAGEMENT
00001558                          1165  ; =============================================================================
00001558                          1166  ; PROP MANAGEMENT
00001558                          1167  ; EACH PROP HAS A DATA BLOCK FROM DMM AS FOLLOWS:
00001558                          1168  ; +0 - LONG : UPDATE SUBROUTINE POINTER
00001558                          1169  ; +4 - LONG : PLOT SUBROUTINE POINTER
00001558                          1170  ; +8:END    : DATA (PROP SPECIFIC)
00001558                          1171  ; =============================================================================
00001558                          1172  
00001558                          1173  ; -----------------------------------------------------------------------------
00001558                          1174  PRPADD
00001558                          1175  ; CREATES A NEW PROP
00001558                          1176  ; INPUT    - A1 - POINTER TO PROP INIT FUNCTION
00001558                          1177  ;            A2 - POINTER TO PROP UPDATE FUNCTION
00001558                          1178  ;            A3 - POINTER TO PROP PLOT FUNCTION
00001558                          1179  ;            D0 - PROP TYPE (USED AS OWNED BY DMM)
00001558                          1180  ;            D1 - PROP INITIALIZATION PARAMETER 1
00001558                          1181  ;            D2 - PROP INITIALIZATION PARAMETER 2
00001558                          1182  ;            D3 - PROP INITIALIZATION PARAMETER 3
00001558                          1183  ; OUTPUT   - NONE
00001558                          1184  ; MODIFIES - NONE
00001558                          1185  ; -----------------------------------------------------------------------------
00001558  2F08                    1186              MOVE.L  A0,-(A7)
0000155A                          1187              
0000155A  4EB8 1190               1188              JSR     DMMALLOC
0000155E  B1FC 00000000           1189              CMP.L   #0,A0
00001564  6700 0008               1190              BEQ     .END
00001568  20CA                    1191              MOVE.L  A2,(A0)+
0000156A  20CB                    1192              MOVE.L  A3,(A0)+
0000156C  4E91                    1193              JSR     (A1)
0000156E                          1194  
0000156E  205F                    1195  .END        MOVE.L  (A7)+,A0
00001570  4E75                    1196              RTS
00001572                          1197  
00001572                          1198  ; -----------------------------------------------------------------------------
00001572                          1199  PRPUPD
00001572                          1200  ; UPDATES THE PROP LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001572                          1201  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001572                          1202  ; INPUT    - NONE
00001572                          1203  ; OUTPUT   - NONE
00001572                          1204  ; MODIFIES - NONE
00001572                          1205  ; -----------------------------------------------------------------------------
00001572  48E7 00C0               1206              MOVEM.L A0-A1,-(A7)
00001576                          1207              
00001576  4EB8 1120               1208              JSR     DMMFIRST
0000157A  B1FC 00000000           1209  .LOOP       CMP.L   #0,A0
00001580  6700 0018               1210              BEQ     .END
00001584  0C68 0003 FFFE          1211              CMP.W   #PIPTYPE,-2(A0) ;IF MEMORY DOESN'T BELONG TO PROPS
0000158A  6700 0008               1212              BEQ     .NEXT           ;SKIP
0000158E                          1213              
0000158E  2250                    1214              MOVE.L  (A0),A1
00001590  5088                    1215              ADD.L   #8,A0
00001592  4E91                    1216              JSR     (A1)
00001594                          1217              
00001594  4EB8 1142               1218  .NEXT       JSR     DMMNEXT
00001598  60E0                    1219              BRA     .LOOP
0000159A                          1220              
0000159A  4CDF 0300               1221  .END        MOVEM.L (A7)+,A0-A1            
0000159E  4E75                    1222              RTS
000015A0                          1223              
000015A0                          1224  ; -----------------------------------------------------------------------------
000015A0                          1225  PRPPLOT
000015A0                          1226  ; PLOTS THE PROP LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000015A0                          1227  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000015A0                          1228  ; INPUT    - NONE
000015A0                          1229  ; OUTPUT   - NONE
000015A0                          1230  ; MODIFIES - NONE
000015A0                          1231  ; -----------------------------------------------------------------------------
000015A0  48E7 00C0               1232              MOVEM.L A0-A1,-(A7)
000015A4                          1233  
000015A4  4EB8 1120               1234              JSR     DMMFIRST
000015A8  B1FC 00000000           1235  .LOOP       CMP.L   #0,A0
000015AE  6700 0018               1236              BEQ     .END
000015B2  0C68 0003 FFFE          1237              CMP.W   #PIPTYPE,-2(A0)     ;IF MEMORY DOESN'T BELONG TO PROP
000015B8  6708                    1238              BEQ.S   .NEXT               ;SKIP
000015BA                          1239              
000015BA  2268 0004               1240              MOVE.L  4(A0),A1
000015BE  5088                    1241              ADD.L   #8,A0
000015C0  4E91                    1242              JSR     (A1)
000015C2  4EB8 1142               1243  .NEXT       JSR     DMMNEXT
000015C6  60E0                    1244              BRA     .LOOP
000015C8  4CDF 0300               1245  .END        MOVEM.L (A7)+,A0-A1
000015CC                          1246  
000015CC  4E75                    1247              RTS
000015CE                          1248  
000015CE                          1249  ; -----------------------------------------------------------------------------
000015CE  =000011AA               1250  PRPKILL     EQU     DMMFREE
000015CE                          1251  ; KILLS THE PRP BY RELEASING ITS MEMORY
000015CE                          1252  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
000015CE                          1253  ; OUTPUT   - NONE
000015CE                          1254  ; MODIFIES - NONE
000015CE                          1255  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
000015CE                          1256  ; -----------------------------------------------------------------------------
000015CE                          1257  
000015CE                          1258  
000015CE                          1259  
000015CE                          1260  
000015CE                          1261  
000015CE                          1262  
000015CE                          1263  
000015CE                          1264  
000015CE                          1265  
000015CE                          1266  
000015CE                          1267  
000015CE                          1268  
000015CE                          1269  
000015CE                          1270  
000015CE                          1271  -------------------- end include --------------------
000015CE                          1272              INCLUDE "SPAWNER.X68"                ; SPAWNER
000015CE                          1273  ; =============================================================================
000015CE                          1274  ; SPAWNER MANAGEMENT.
000015CE                          1275  ; =============================================================================
000015CE                          1276  
000015CE                          1277  ; -----------------------------------------------------------------------------
000015CE                          1278  SPWUPD
000015CE                          1279  ; UPDATES THE SPAWNER
000015CE                          1280  ; INPUT    - NONE
000015CE                          1281  ; OUTPUT   - NONE
000015CE                          1282  ; MODIFIES - NONE
000015CE                          1283  ; -----------------------------------------------------------------------------
000015CE  48E7 8070               1284              MOVEM.L  D0/A1-A3,-(A7)
000015D2                          1285  
000015D2  1039 00001C5B           1286              MOVE.B  (SCRCYCCT),D0
000015D8  C07C 003F               1287              AND     #$3F,D0                 ; EVERY 64 CYCLES
000015DC  6600 0028               1288              BNE     .END                    ; CREATE A NEW PIPE
000015E0  43F9 00001B06           1289              LEA     PIPINIT,A1
000015E6  45F9 00001B2C           1290              LEA     PIPUPD,A2
000015EC  47F9 00001B7E           1291              LEA     PIPPLOT,A3
000015F2  303C 0003               1292              MOVE.W  #PIPTYPE,D0
000015F6  1239 00001C50           1293              MOVE.B  (PIPCOUNT),D1
000015FC  5239 00001C50           1294              ADDQ.B  #1,(PIPCOUNT)
00001602                          1295              
00001602  4EB8 14D4               1296              JSR     AGLADD
00001606                          1297              
00001606  4CDF 0E01               1298  .END        MOVEM.L (A7)+,D0/A1-A3
0000160A  4E75                    1299              RTS
0000160C                          1300  
0000160C                          1301  
0000160C                          1302  
0000160C                          1303  
0000160C                          1304  
0000160C                          1305  
0000160C                          1306  
0000160C                          1307  
0000160C                          1308  
0000160C                          1309  
0000160C                          1310  
0000160C                          1311  
0000160C                          1312  
0000160C                          1313  
0000160C                          1314  
0000160C                          1315  
0000160C                          1316  
0000160C                          1317  
0000160C                          1318  
0000160C                          1319  
0000160C                          1320  
0000160C                          1321  -------------------- end include --------------------
0000160C                          1322              INCLUDE "STATES2.X68"                ; GAME STATES MANAGEMENT
0000160C                          1323  ; =============================================================================
0000160C                          1324  ; GAME STATE MANAGEMENT
0000160C                          1325  ; =============================================================================
0000160C                          1326  
0000160C                          1327  ; -----------------------------------------------------------------------------
0000160C                          1328  STAINIT
0000160C                          1329  ; INITALIZES THE STATE MANAGER
0000160C                          1330  ; INPUT    - NONE
0000160C                          1331  ; OUTPUT   - NONE
0000160C                          1332  ; MODIFIES - NONE
0000160C                          1333  ; -----------------------------------------------------------------------------
0000160C  33FC FFFF 00001C36      1334              MOVE.W  #STANONE,(STACUR)
00001614  33FC 0000 00001C38      1335              MOVE.W  #STAINTR,(STANEXT)
0000161C  4E75                    1336              RTS
0000161E                          1337  
0000161E                          1338  ; -----------------------------------------------------------------------------
0000161E                          1339  STAUPD
0000161E                          1340  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
0000161E                          1341  ; INPUT    - NONE
0000161E                          1342  ; OUTPUT   - NONE
0000161E                          1343  ; MODIFIES - NONE
0000161E                          1344  ; -----------------------------------------------------------------------------
0000161E  48E7 8080               1345              MOVEM.L D0/A0,-(A7)
00001622  4280                    1346              CLR.L   D0
00001624  3039 00001C38           1347              MOVE.W  (STANEXT),D0
0000162A  B079 00001C36           1348              CMP.W   (STACUR),D0
00001630  6700 0012               1349              BEQ     .DOUPD
00001634  33C0 00001C36           1350              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
0000163A  E588                    1351              LSL.L   #2,D0
0000163C  2040                    1352              MOVE.L  D0,A0
0000163E  2068 165C               1353              MOVE.L  .INITBL(A0),A0
00001642  4E90                    1354              JSR     (A0)
00001644  4280                    1355  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00001646  3039 00001C36           1356              MOVE.W  (STACUR),D0
0000164C  E588                    1357              LSL.L   #2,D0
0000164E  2040                    1358              MOVE.L  D0,A0
00001650  2068 166C               1359              MOVE.L  .UPDTBL(A0),A0
00001654  4E90                    1360              JSR     (A0)
00001656  4CDF 0101               1361              MOVEM.L (A7)+,D0/A0
0000165A  4E75                    1362              RTS
0000165C= 000010FE 000011C0 ...   1363  .INITBL     DC.L    STAINTRI,STAPLAYI,STAEMPTY,STAEMPTY
0000166C= 000016E6 000016AA ...   1364  .UPDTBL     DC.L    STAINTRU,STAPLAYU,STAPAUU,STAGOVRU
0000167C                          1365  
0000167C                          1366  ; -----------------------------------------------------------------------------
0000167C                          1367  STAPLOT
0000167C                          1368  ; PERFORMS STATE PLOT
0000167C                          1369  ; INPUT    - NONE
0000167C                          1370  ; OUTPUT   - NONE
0000167C                          1371  ; MODIFIES - NONE
0000167C                          1372  ; -----------------------------------------------------------------------------
0000167C  48E7 8080               1373              MOVEM.L D0/A0,-(A7)
00001680  4280                    1374              CLR.L   D0
00001682  3039 00001C36           1375              MOVE.W  (STACUR),D0
00001688  E588                    1376              LSL.L   #2,D0
0000168A  2040                    1377              MOVE.L  D0,A0
0000168C  2068 1698               1378              MOVE.L  .PLTTBL(A0),A0
00001690  4E90                    1379              JSR     (A0)
00001692  4CDF 0101               1380              MOVEM.L (A7)+,D0/A0
00001696  4E75                    1381              RTS
00001698= 000016FC 000016D4 ...   1382  .PLTTBL     DC.L    STAINTRP,STAPLAYP,STAPAUP,STAGOVRP
000016A8                          1383  
000016A8                          1384  ; -----------------------------------------------------------------------------
000016A8                          1385  STAEMPTY
000016A8                          1386  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
000016A8                          1387  ; INPUT    - NONE
000016A8                          1388  ; OUTPUT   - NONE
000016A8                          1389  ; MODIFIES - NONE
000016A8                          1390  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
000016A8                          1391  ; -----------------------------------------------------------------------------
000016A8  4E75                    1392              RTS
000016AA                          1393  
000016AA                          1394  ; -----------------------------------------------------------------------------
000016AA  =000011C0               1395  STAPLAYI    EQU     PLRINIT
000016AA                          1396  ; PLAY STATE INITIALIZATION.
000016AA                          1397  ; INPUT    - NONE
000016AA                          1398  ; OUTPUT   - NONE
000016AA                          1399  ; MODIFIES - NONE
000016AA                          1400  ; NOTE     - JUST A WRAPPER FOR PLRINIT
000016AA                          1401  ; -----------------------------------------------------------------------------
000016AA                          1402  
000016AA                          1403  ; -----------------------------------------------------------------------------
000016AA                          1404  STAPLAYU
000016AA                          1405  ; PLAY STATE UPDATE
000016AA                          1406  ; INPUT    - NONE
000016AA                          1407  ; OUTPUT   - NONE
000016AA                          1408  ; MODIFIES - NONE
000016AA                          1409  ; -----------------------------------------------------------------------------
000016AA  0839 0007 00001C59      1410              BTST.B   #KBDBITPS,(KBDEDGE)         ;Si 'P' es presionado, pausa.
000016B2  6616                    1411              BNE.S   .PAUSE
000016B4                          1412              
000016B4  4EB8 11F6               1413              JSR     PLRUPD
000016B8  4EB9 00001A50           1414              JSR     BGUPD
000016BE  4EB8 1572               1415              JSR     PRPUPD
000016C2  4EB8 15CE               1416              JSR     SPWUPD
000016C6  6000 FE26               1417              BRA     AGLUPD
000016CA                          1418  .PAUSE      
000016CA  33FC 0002 00001C38      1419              MOVE.W  #STAPAU,(STANEXT)
000016D2  4E75                    1420              RTS
000016D4                          1421  ; -----------------------------------------------------------------------------
000016D4                          1422  STAPLAYP
000016D4                          1423  ; PLAY STATE PLOT
000016D4                          1424  ; INPUT    - NONE
000016D4                          1425  ; OUTPUT   - NONE
000016D4                          1426  ; MODIFIES - NONE
000016D4                          1427  ; -----------------------------------------------------------------------------
000016D4  4EB9 00001A9C           1428              JSR     BGPLOT
000016DA  4EB8 15A0               1429              JSR     PRPPLOT
000016DE  4EB8 1522               1430              JSR     AGLPLOT
000016E2                          1431              ;BRA     AGLPLOT
000016E2  6000 FBDA               1432              BRA     PLRPLOT
000016E6                          1433  
000016E6                          1434  ; -----------------------------------------------------------------------------
000016E6  =000010FE               1435  STAINTRI    EQU     DMMINIT
000016E6                          1436  ; INTRO STATE INIT
000016E6                          1437  ; INPUT    - NONE
000016E6                          1438  ; OUTPUT   - NONE
000016E6                          1439  ; MODIFIES - NONE
000016E6                          1440  ; NOTE     - JUST A WRAPPER FOR DMMINIT TO RELEASE ALL MEMORY
000016E6                          1441  ; -----------------------------------------------------------------------------
000016E6                          1442  
000016E6                          1443  ; -----------------------------------------------------------------------------
000016E6                          1444  STAINTRU
000016E6                          1445  ; INTRO STATE UPDATE
000016E6                          1446  ; INPUT    - NONE
000016E6                          1447  ; OUTPUT   - NONE
000016E6                          1448  ; MODIFIES - NONE
000016E6                          1449  ; -----------------------------------------------------------------------------
000016E6  0839 0004 00001C59      1450              BTST.B  #KBDBITF1,(KBDEDGE)
000016EE  6700 000A               1451              BEQ     .END
000016F2  33FC 0001 00001C38      1452              MOVE.W  #STAPLAY,(STANEXT)
000016FA  4E75                    1453  .END        RTS
000016FC                          1454  
000016FC                          1455  ; -----------------------------------------------------------------------------
000016FC                          1456  STAINTRP
000016FC                          1457  ; INTRO STATE PLOT
000016FC                          1458  ; INPUT    - NONE
000016FC                          1459  ; OUTPUT   - NONE
000016FC                          1460  ; MODIFIES - NONE
000016FC                          1461  ; -----------------------------------------------------------------------------
000016FC                          1462              ;Guardar registros en pila
000016FC  48E7 C040               1463              MOVEM.L A1/D0-D1,-(A7)
00001700                          1464              
00001700                          1465              ;Seleccionar fuente de texto
00001700                          1466m             UTLFONT INTTITC,INTTITF
00001700                          1467m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001700                          1468m ; INPUT    - INTTITC COLOR, INTTITF FONT
00001700                          1469m ; OUTPUT   - NONE
00001700                          1470m ; MODIFIES - D0,D1,D2
00001700                          1471m ; -----------------------------------------------------------------------------
00001710                          1472              ;Seleccionar posicion de texto      
00001710                          1473m             UTLLOCT INTTITX,INTTITY               
00001710                          1474m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001710                          1475m ; INPUT    - INTTITX X, INTTITY Y
00001710                          1476m ; OUTPUT   - NONE
00001710                          1477m ; MODIFIES - D0,D1
00001710                          1478m ; -----------------------------------------------------------------------------
0000171A                          1479  
0000171A  43F9 00001752           1480              LEA     .TITLE,A1
00001720  103C 000E               1481              MOVE.B  #14,D0
00001724  4E4F                    1482              TRAP    #15
00001726                          1483              
00001726                          1484              ;Seleccionar fuente de texto
00001726                          1485m             UTLFONT INTPRSC,INTPRSF     
00001726                          1486m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001726                          1487m ; INPUT    - INTPRSC COLOR, INTPRSF FONT
00001726                          1488m ; OUTPUT   - NONE
00001726                          1489m ; MODIFIES - D0,D1,D2
00001726                          1490m ; -----------------------------------------------------------------------------
00001736                          1491              ;Seleccionar posicion de texto
00001736                          1492m             UTLLOCT INTPRSX,INTPRSY     
00001736                          1493m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001736                          1494m ; INPUT    - INTPRSX X, INTPRSY Y
00001736                          1495m ; OUTPUT   - NONE
00001736                          1496m ; MODIFIES - D0,D1
00001736                          1497m ; -----------------------------------------------------------------------------
00001740                          1498  
00001740  43F9 0000175E           1499              LEA     .START_TEXT,A1
00001746  103C 000E               1500              MOVE.B  #14,D0
0000174A  4E4F                    1501              TRAP    #15
0000174C                          1502              
0000174C                          1503              ;Restaurar registros
0000174C  4CDF 0203               1504              MOVEM.L (A7)+,A1/D0-D1
00001750  4E75                    1505              RTS
00001752                          1506  
00001752= 46 4C 41 50 50 59 ...   1507  .TITLE      DC.B    'FLAPPY BIRD',0 
0000175E= 50 52 45 53 53 20 ...   1508  .START_TEXT DC.B    'PRESS SPACE TO START',0
00001774                          1509              DS.W    0
00001774                          1510  
00001774                          1511  
00001774                          1512  
00001774                          1513  ; -----------------------------------------------------------------------------
00001774                          1514  STAPAUI    
00001774                          1515  ; PAUSE STATE INIT
00001774                          1516  ; INPUT    - NONE
00001774                          1517  ; OUTPUT   - NONE
00001774                          1518  ; MODIFIES - NONE
00001774                          1519  ; -----------------------------------------------------------------------------
00001774                          1520              ;Guardar registros de juego
00001774  48E7 FFFE               1521              MOVEM.L D0-D7/A0-A6,-(A7)
00001778  40E7                    1522              MOVE.W  SR,-(A7)
0000177A                          1523              
0000177A  4EEF FFC0               1524              JMP     -64(A7)
0000177E                          1525  ; -----------------------------------------------------------------------------
0000177E                          1526  STAPAUU
0000177E                          1527  ; INTRO STATE UPDATE
0000177E                          1528  ; INPUT    - NONE
0000177E                          1529  ; OUTPUT   - NONE
0000177E                          1530  ; MODIFIES - NONE
0000177E                          1531  ; -----------------------------------------------------------------------------
0000177E  0839 0001 00001C59      1532              BTST.B  #KBDBITUP,(KBDEDGE)     ;Check cambio en estado de UP
00001786  6628                    1533              BNE.S   .UP
00001788  0839 0003 00001C59      1534              BTST.B  #KBDBITDN,(KBDEDGE)     ;Check cambio en estado de DOWN
00001790  6630                    1535              BNE.S   .DN
00001792  0839 0004 00001C59      1536              BTST.B  #KBDBITF1,(KBDEDGE)     ;Check cambio en estado de FIRE1
0000179A  6638                    1537              BNE.S   .OK
0000179C  0839 0007 00001C59      1538              BTST.B  #KBDBITPS,(KBDEDGE)     ;Check cambio en estado de 'P'
000017A4  6708                    1539              BEQ.S   .END
000017A6                          1540              
000017A6  33FC 0001 00001C38      1541              MOVE.W  #STAPLAY,(STANEXT)      ;Si hay cambio en estado de 'P'
000017AE                          1542                                              ;Actualizar siguiente estado
000017AE  4E75                    1543  .END        RTS
000017B0                          1544  
000017B0  0C39 0000 00001C56      1545  .UP         CMP.B   #CONTNUM,(PMOPTN)       ;Check si es posible cambiar a una
000017B8  6FF4                    1546              BLE.S   .END                    ;opción superior
000017BA  5379 00001C56           1547              SUBQ    #1,(PMOPTN)
000017C0  60EC                    1548              BRA.S   .END
000017C2                          1549              
000017C2  0C39 0002 00001C56      1550  .DN         CMP.B   #EXTNUM,(PMOPTN)        ;Check si es posible cambiar a una
000017CA  6CE2                    1551              BGE.S   .END                    ;opción inferior
000017CC  5279 00001C56           1552              ADDQ    #1,(PMOPTN)
000017D2  60DA                    1553              BRA.S   .END
000017D4                          1554              
000017D4                          1555  .OK         
000017D4  4280                    1556              CLR.L   D0                      ;Preparar registro D0
000017D6  1039 00001C56           1557              MOVE.B  (PMOPTN),D0
000017DC  C0FC 0006               1558              MULU    #6,D0                   
000017E0                          1559              
000017E0  2040                    1560              MOVEA.L D0,A0                   ;Usar D0 como indice para .JMPLST
000017E2                          1561              
000017E2  4EE8 17E6               1562              JMP     .JMPLST(A0)
000017E6                          1563              
000017E6  4EF9 000017F8           1564  .JMPLST     JMP     .contgame               
000017EC  4EF9 00001802           1565              JMP     .newgame
000017F2  4EF9 0000180C           1566              JMP     .exitgame
000017F8                          1567  .contgame
000017F8                          1568              ;Si última PMOPT == continuar juego, actualizar estado
000017F8  33FC 0001 00001C38      1569              MOVE.W  #STAPLAY,(STANEXT)
00001800  60AC                    1570              BRA     .END
00001802                          1571  .newgame    
00001802                          1572              ;Si última PMOPT == nuevo juego, actualizar estado
00001802  33FC 0000 00001C38      1573              MOVE.W  #STAINTR,(STANEXT)
0000180A  60A2                    1574              BRA     .END
0000180C                          1575              
0000180C                          1576  .exitgame   
0000180C                          1577              ;Si última PMOPT == salir de juego, actualizar estado
0000180C  33FC 0003 00001C38      1578              MOVE.W  #STAGOVR,(STANEXT)
00001814  6098                    1579              BRA     .END
00001816                          1580  
00001816                          1581  ; -----------------------------------------------------------------------------
00001816                          1582  STAPAUP
00001816                          1583  ; INTRO STATE PLOT
00001816                          1584  ; INPUT    - NONE
00001816                          1585  ; OUTPUT   - NONE
00001816                          1586  ; MODIFIES - NONE
00001816                          1587  ; -----------------------------------------------------------------------------
00001816                          1588              ;Guardar registros
00001816  48E7 8040               1589              MOVEM.L D0/A1,-(A7)
0000181A                          1590  
0000181A                          1591m             UTLSFIL #$00000000
0000181A                          1592m ; WRAPPER FOR SET FIL TRAP 15 TASK.
0000181A                          1593m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
0000181A                          1594m ; OUTPUT   - NONE
0000181A                          1595m ; MODIFIES - D0,D1
0000181A                          1596m ; -----------------------------------------------------------------------------
00001822                          1597  
00001822                          1598              **********DIBUJAR TÍTULO**********
00001822                          1599              ;Seleccionar fuente de texto
00001822                          1600m             UTLFONT PAUTITC,PAUTITF
00001822                          1601m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001822                          1602m ; INPUT    - PAUTITC COLOR, PAUTITF FONT
00001822                          1603m ; OUTPUT   - NONE
00001822                          1604m ; MODIFIES - D0,D1,D2
00001822                          1605m ; -----------------------------------------------------------------------------
00001832                          1606              ;Seleccionar posicion de texto      
00001832                          1607m             UTLLOCT PAUTITX,PAUTITY               
00001832                          1608m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001832                          1609m ; INPUT    - PAUTITX X, PAUTITY Y
00001832                          1610m ; OUTPUT   - NONE
00001832                          1611m ; MODIFIES - D0,D1
00001832                          1612m ; -----------------------------------------------------------------------------
0000183C                          1613  
0000183C  43F9 00001912           1614              LEA     .TITLE,A1
00001842  700E                    1615              MOVEQ   #14,D0
00001844  4E4F                    1616              TRAP    #15
00001846                          1617              
00001846  1E39 00001C56           1618              MOVE.B  (PMOPTN),D7
0000184C                          1619              
0000184C                          1620              
0000184C                          1621              **********DIBUJAR OPCION CONTINUAR**********
0000184C                          1622              ;Seleccionar fuente de texto
0000184C  0C39 0000 00001C56      1623              CMP.B   #CONTNUM,(PMOPTN)
00001854  6712                    1624              BEQ.S   .CNTSEL
00001856                          1625m             UTLFONT PAUOPTC,PAUOPTFU
00001856                          1626m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001856                          1627m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
00001856                          1628m ; OUTPUT   - NONE
00001856                          1629m ; MODIFIES - D0,D1,D2
00001856                          1630m ; -----------------------------------------------------------------------------
00001866  6010                    1631              BRA.S   .SKPCNT
00001868                          1632  
00001868                          1633m .CNTSEL     UTLFONT PAUOPTC,PAUOPTFS
00001868                          1634m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001868                          1635m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
00001868                          1636m ; OUTPUT   - NONE
00001868                          1637m ; MODIFIES - D0,D1,D2
00001868                          1638m ; -----------------------------------------------------------------------------
00001878                          1639  .SKPCNT
00001878                          1640              ;Seleccionar posición de texto
00001878                          1641m             UTLLOCT PAUOPTX,PAUCNTY
00001878                          1642m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001878                          1643m ; INPUT    - PAUOPTX X, PAUCNTY Y
00001878                          1644m ; OUTPUT   - NONE
00001878                          1645m ; MODIFIES - D0,D1
00001878                          1646m ; -----------------------------------------------------------------------------
00001882                          1647              
00001882  43F9 00001920           1648              LEA     .CONT,A1
00001888  700E                    1649              MOVEQ   #14,D0
0000188A  4E4F                    1650              TRAP    #15
0000188C                          1651              
0000188C                          1652              **********DIBUJAR OPCION JUEGO NUEVO**********
0000188C                          1653              ;Seleccionar fuente de texto
0000188C  0C39 0001 00001C56      1654              CMP.B   #NEWGNUM,(PMOPTN)
00001894  6712                    1655              BEQ.S   .NEWSEL
00001896                          1656m             UTLFONT PAUOPTC,PAUOPTFU
00001896                          1657m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001896                          1658m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
00001896                          1659m ; OUTPUT   - NONE
00001896                          1660m ; MODIFIES - D0,D1,D2
00001896                          1661m ; -----------------------------------------------------------------------------
000018A6  6010                    1662              BRA.S   .SKPNEW
000018A8                          1663  
000018A8                          1664m .NEWSEL     UTLFONT PAUOPTC,PAUOPTFS
000018A8                          1665m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018A8                          1666m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
000018A8                          1667m ; OUTPUT   - NONE
000018A8                          1668m ; MODIFIES - D0,D1,D2
000018A8                          1669m ; -----------------------------------------------------------------------------
000018B8                          1670  .SKPNEW
000018B8                          1671              ;Seleccionar posición de texto
000018B8                          1672m             UTLLOCT PAUOPTX,PAUNEWY
000018B8                          1673m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000018B8                          1674m ; INPUT    - PAUOPTX X, PAUNEWY Y
000018B8                          1675m ; OUTPUT   - NONE
000018B8                          1676m ; MODIFIES - D0,D1
000018B8                          1677m ; -----------------------------------------------------------------------------
000018C2                          1678              
000018C2  43F9 0000192A           1679              LEA     .NEWG,A1
000018C8  700E                    1680              MOVEQ   #14,D0
000018CA  4E4F                    1681              TRAP    #15
000018CC                          1682              
000018CC                          1683              **********DIBUJAR OPCION SALIR**********
000018CC                          1684              ;Seleccionar fuente de texto
000018CC  0C39 0002 00001C56      1685              CMP.B   #EXTNUM,(PMOPTN)
000018D4  6712                    1686              BEQ.S   .EXTSEL
000018D6                          1687m             UTLFONT PAUOPTC,PAUOPTFU
000018D6                          1688m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018D6                          1689m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
000018D6                          1690m ; OUTPUT   - NONE
000018D6                          1691m ; MODIFIES - D0,D1,D2
000018D6                          1692m ; -----------------------------------------------------------------------------
000018E6  6010                    1693              BRA.S   .SKPEXT
000018E8                          1694  
000018E8                          1695m .EXTSEL     UTLFONT PAUOPTC,PAUOPTFS
000018E8                          1696m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018E8                          1697m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
000018E8                          1698m ; OUTPUT   - NONE
000018E8                          1699m ; MODIFIES - D0,D1,D2
000018E8                          1700m ; -----------------------------------------------------------------------------
000018F8                          1701  .SKPEXT
000018F8                          1702              ;Seleccionar posición de texto
000018F8                          1703m             UTLLOCT PAUOPTX,PAUEXTY
000018F8                          1704m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000018F8                          1705m ; INPUT    - PAUOPTX X, PAUEXTY Y
000018F8                          1706m ; OUTPUT   - NONE
000018F8                          1707m ; MODIFIES - D0,D1
000018F8                          1708m ; -----------------------------------------------------------------------------
00001902                          1709              
00001902  43F9 00001936           1710              LEA     .EXIT,A1
00001908  700E                    1711              MOVEQ   #14,D0
0000190A  4E4F                    1712              TRAP    #15
0000190C                          1713              
0000190C                          1714              ;Restaurar registros
0000190C  4CDF 0201               1715              MOVEM.L (A7)+,D0/A1
00001910  4E75                    1716              RTS
00001912                          1717              
00001912                          1718  ; --- LOCAL DATA -----------------
00001912= 4D 45 4E 55 20 44 ...   1719  .TITLE      DC.B    'MENU DE PAUSA',0
00001920= 43 4F 4E 54 49 4E ...   1720  .CONT       DC.B    'CONTINUAR',0
0000192A= 4A 55 45 47 4F 20 ...   1721  .NEWG       DC.B    'JUEGO NUEVO',0
00001936= 53 41 4C 49 52 00       1722  .EXIT       DC.B    'SALIR',0
0000193C                          1723              DS.W    0
0000193C                          1724              
0000193C                          1725  ; -----------------------------------------------------------------------------
0000193C                          1726  STAGOVRU
0000193C                          1727  ; GAME OVER STATE UPDATE
0000193C                          1728  ; INPUT    - NONE
0000193C                          1729  ; OUTPUT   - NONE
0000193C                          1730  ; MODIFIES - NONE
0000193C                          1731  ; -----------------------------------------------------------------------------
0000193C  0839 0004 00001C59      1732              BTST.B  #KBDBITF1,(KBDEDGE)
00001944  6700 000A               1733              BEQ     .END
00001948  33FC 0000 00001C38      1734              MOVE.W  #STAINTR,(STANEXT)
00001950  4E75                    1735  .END        RTS
00001952                          1736  
00001952                          1737  ; -----------------------------------------------------------------------------
00001952                          1738  STAGOVRP
00001952                          1739  ; GAME OVER STATE PLOT
00001952                          1740  ; INPUT    - NONE
00001952                          1741  ; OUTPUT   - NONE
00001952                          1742  ; MODIFIES - NONE
00001952                          1743  ; -----------------------------------------------------------------------------
00001952  48E7 C040               1744              MOVEM.L A1/D0-D1,-(A7)
00001956                          1745m             UTLLOCT GOVSTRX,GOVSTRY
00001956                          1746m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001956                          1747m ; INPUT    - GOVSTRX X, GOVSTRY Y
00001956                          1748m ; OUTPUT   - NONE
00001956                          1749m ; MODIFIES - D0,D1
00001956                          1750m ; -----------------------------------------------------------------------------
00001960                          1751m             UTLSPEN #GOVSTRC
00001960                          1752m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001960                          1753m ; INPUT    - #GOVSTRC COLOR IN FORMAT $00BBGGRR
00001960                          1754m ; OUTPUT   - NONE
00001960                          1755m ; MODIFIES - D0,D1
00001960                          1756m ; -----------------------------------------------------------------------------
0000196C                          1757m             UTLSFIL #$00000000
0000196C                          1758m ; WRAPPER FOR SET FIL TRAP 15 TASK.
0000196C                          1759m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
0000196C                          1760m ; OUTPUT   - NONE
0000196C                          1761m ; MODIFIES - D0,D1
0000196C                          1762m ; -----------------------------------------------------------------------------
00001974  43F9 00001986           1763              LEA     .GOVSTR,A1
0000197A  103C 000E               1764              MOVE.B  #14,D0
0000197E  4E4F                    1765              TRAP    #15
00001980  4CDF 0203               1766              MOVEM.L (A7)+,A1/D0-D1
00001984  4E75                    1767              RTS
00001986                          1768  
00001986= 47 41 4D 45 20 20 ...   1769  .GOVSTR     DC.B    'GAME  OVER',0
00001992                          1770              DS.W    0
00001992                          1771  
00001992                          1772  
00001992                          1773  
00001992                          1774  
00001992                          1775  
00001992                          1776  
00001992                          1777  
00001992                          1778  
00001992                          1779  
00001992                          1780  
00001992                          1781  
00001992                          1782  
00001992                          1783  
00001992                          1784  
00001992                          1785  
00001992                          1786  
00001992                          1787  
00001992                          1788  
00001992                          1789  
00001992                          1790  
00001992                          1791  
00001992                          1792  
00001992                          1793  
00001992                          1794  -------------------- end include --------------------
00001992                          1795              INCLUDE "BACKGROUND/BACKGROUND.X68"  ; BACKGROUND MANAGEMENT
00001992                          1796  ;------------------------------------------------------------------------------
00001992                          1797  ; BACKGROUND
00001992                          1798  ;------------------------------------------------------------------------------
00001992                          1799              INCLUDE "BACKGROUND/CLOUD.X68"     ; BACKGROUND CLOUDS MANAGEMENT 
00001992                          1800  ; =============================================================================
00001992                          1801  ; CLOUD MANAGEMENT. IT IS A PROP.
00001992                          1802  ; LOCAL MEMORY IS:
00001992                          1803  ; +0 WORD X COORDINATE
00001992                          1804  ; +2 WORD Y COORDINATE
00001992                          1805  ; =============================================================================
00001992                          1806  
00001992                          1807  ; -----------------------------------------------------------------------------
00001992                          1808  CLDINIT
00001992                          1809  ; INITALIZES CLOUD
00001992                          1810  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
00001992                          1811  ; OUTPUT   - NONE
00001992                          1812  ; MODIFIES - NONE
00001992                          1813  ; NOTE     - ASSUMES SCRHEIGH IS GREATER THAN 255
00001992                          1814  ; -----------------------------------------------------------------------------
00001992                          1815          ;Guardar registros
00001992  2F00                    1816          MOVE.L      D0,-(A7)
00001994                          1817              
00001994  30BC 0280               1818          MOVE.W      #SCRWIDTH,(A0)
00001998                          1819          
00001998  4EB8 13B6               1820          JSR         UTLRAND
0000199C  3140 0002               1821          MOVE.W      D0,2(A0)
000019A0                          1822          
000019A0                          1823          ;Restaurar registros
000019A0  201F                    1824          MOVE.L      (A7)+,D0
000019A2                          1825          
000019A2  4E75                    1826          RTS
000019A4                          1827  
000019A4                          1828  ; -----------------------------------------------------------------------------
000019A4                          1829  CLDUPD
000019A4                          1830  ; UPDATES THE STATE OF CLOUDS
000019A4                          1831  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
000019A4                          1832  ; OUTPUT   - NONE
000019A4                          1833  ; MODIFIES - NONE
000019A4                          1834  ; -----------------------------------------------------------------------------
000019A4                          1835          ;Actualizar posición
000019A4  2F00                    1836          MOVE.L      D0,-(A7)
000019A6                          1837          
000019A6  3039 00001C54           1838          MOVE.W      (XSPEED),D0
000019AC  80FC 0002               1839          DIVU.W      #2,D0
000019B0  9150                    1840          SUB.W       D0,(A0)
000019B2  0C50 FF88               1841          CMP.W       #-CLDSIZE*2,(A0)
000019B6  6F04                    1842          BLE.S       .KILL
000019B8                          1843  
000019B8                          1844  .END    
000019B8  201F                    1845          MOVE.L      (A7)+,D0
000019BA  4E75                    1846          RTS
000019BC                          1847          
000019BC  4EB8 11AA               1848  .KILL   JSR PRPKILL
000019C0  60F6                    1849          BRA         .END     
000019C2                          1850  
000019C2                          1851  ; -----------------------------------------------------------------------------
000019C2                          1852  CLDPLOT
000019C2                          1853  ; PLOTS THE CLOUD IN ITS RIGHTFUL POSITION
000019C2                          1854  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
000019C2                          1855  ; OUTPUT   - NONE
000019C2                          1856  ; MODIFIES - NONE
000019C2                          1857  ; -----------------------------------------------------------------------------       
000019C2                          1858          ;Guardar registros
000019C2  48E7 F800               1859          MOVEM.L     D0-D4,-(A7)
000019C6                          1860          
000019C6                          1861m         UTLSPEN     #CLDPCLR
000019C6                          1862m ; WRAPPER FOR SET PEN TRAP 15 TASK.
000019C6                          1863m ; INPUT    - #CLDPCLR COLOR IN FORMAT $00BBGGRR
000019C6                          1864m ; OUTPUT   - NONE
000019C6                          1865m ; MODIFIES - D0,D1
000019C6                          1866m ; -----------------------------------------------------------------------------
000019D2                          1867m         UTLSFIL     #CLDFCLR
000019D2                          1868m ; WRAPPER FOR SET FIL TRAP 15 TASK.
000019D2                          1869m ; INPUT    - #CLDFCLR COLOR IN FORMAT $00BBGGRR
000019D2                          1870m ; OUTPUT   - NONE
000019D2                          1871m ; MODIFIES - D0,D1
000019D2                          1872m ; -----------------------------------------------------------------------------
000019DE                          1873          
000019DE                          1874          ;Preparar parametros
000019DE  3210                    1875          MOVE.W      (A0),D1     ;X0 COORD
000019E0  3428 0002               1876          MOVE.W      2(A0),D2    ;Y0 COORD
000019E4  3601                    1877          MOVE.W      D1,D3       
000019E6  3802                    1878          MOVE.W      D2,D4       
000019E8  0643 0078               1879          ADD.W       #CLDSIZE*2,D3 ;X1 COORD
000019EC  0644 003C               1880          ADD.W       #CLDSIZE,D4 ;Y2 COORD
000019F0                          1881          
000019F0  7058                    1882          MOVEQ       #88,D0      ;TASK NUM
000019F2                          1883          
000019F2  4E4F                    1884          TRAP        #15
000019F4                          1885          
000019F4                          1886          ;Restaurar registros
000019F4  4CDF 001F               1887          MOVEM.L     (A7)+,D0-D4
000019F8  4E75                    1888          RTS
000019FA                          1889  
000019FA                          1890  
000019FA                          1891  
000019FA                          1892  
000019FA                          1893  
000019FA                          1894  
000019FA                          1895  
000019FA                          1896  
000019FA                          1897  
000019FA                          1898  
000019FA                          1899  
000019FA                          1900  
000019FA                          1901  
000019FA                          1902  
000019FA                          1903  
000019FA                          1904  
000019FA                          1905  
000019FA                          1906  
000019FA                          1907  
000019FA                          1908  
000019FA                          1909  
000019FA                          1910  
000019FA                          1911  
000019FA                          1912  
000019FA                          1913  
000019FA                          1914  -------------------- end include --------------------
000019FA                          1915              INCLUDE "BACKGROUND/GSSDETAIL.X68" ; GRASS DETAILS MANAGEMENT
000019FA                          1916  ; =============================================================================
000019FA                          1917  ; GRASS DETAILS MANAGEMENT. IT IS A PROP.
000019FA                          1918  ; LOCAL MEMORY IS:
000019FA                          1919  ; +0 WORD X COORDINATE
000019FA                          1920  ; =============================================================================
000019FA                          1921  
000019FA                          1922  ; -----------------------------------------------------------------------------
000019FA                          1923  GSSDINIT
000019FA                          1924  ; INITIALIZES THE LITTLE DETAILS ON THE GRASS
000019FA                          1925  ; -----------------------------------------------------------------------------
000019FA  2F00                    1926          MOVE.L      D0,-(A7)
000019FC                          1927          
000019FC  30BC 0280               1928          MOVE.W      #SCRWIDTH,(A0)
00001A00                          1929          
00001A00  201F                    1930          MOVE.L      (A7)+,D0
00001A02  4E75                    1931          RTS
00001A04                          1932          
00001A04                          1933          
00001A04                          1934  ; -----------------------------------------------------------------------------
00001A04                          1935  GSSDUPD
00001A04                          1936  ; MODIFIES THE LITTLE DETAILS ON THE GRASS' X COORDINATE
00001A04                          1937  ; -----------------------------------------------------------------------------
00001A04                          1938          ;Guardar registros
00001A04  2F00                    1939          MOVE.L      D0,-(A7)
00001A06                          1940  
00001A06  3039 00001C54           1941          MOVE.W      (XSPEED),D0
00001A0C  9150                    1942          SUB.W       D0,(A0)         ;UPDATE X COORDINATE
00001A0E  0C50 FFF6               1943          CMP.W       #-GSSDWDTH,(A0)
00001A12  6F04                    1944          BLE.S       .KILL
00001A14                          1945          
00001A14                          1946  .END    ;Restaurar registros
00001A14  201F                    1947          MOVE.L      (A7)+,D0
00001A16  4E75                    1948          RTS
00001A18                          1949  
00001A18  4EB8 11AA               1950  .KILL   JSR         PRPKILL
00001A1C  60F6                    1951          BRA         .END
00001A1E                          1952          
00001A1E                          1953  ; -----------------------------------------------------------------------------
00001A1E                          1954  GSSDPLOT
00001A1E                          1955  ; PLOTS THE LITTLE DETAILS ON THE GRASS' X COORDINATE
00001A1E                          1956  ; -----------------------------------------------------------------------------
00001A1E  48E7 F800               1957          MOVEM.L     D0-D4,-(A7)
00001A22                          1958          
00001A22                          1959m         UTLSPEN     #$00000000
00001A22                          1960m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001A22                          1961m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001A22                          1962m ; OUTPUT   - NONE
00001A22                          1963m ; MODIFIES - D0,D1
00001A22                          1964m ; -----------------------------------------------------------------------------
00001A2A                          1965m         UTLSFIL     #GSSDFC
00001A2A                          1966m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001A2A                          1967m ; INPUT    - #GSSDFC COLOR IN FORMAT $00BBGGRR
00001A2A                          1968m ; OUTPUT   - NONE
00001A2A                          1969m ; MODIFIES - D0,D1
00001A2A                          1970m ; -----------------------------------------------------------------------------
00001A36                          1971          
00001A36  3210                    1972          MOVE.W      (A0),D1
00001A38  343C 0168               1973          MOVE.W      #BGGSSTP,D2
00001A3C  3601                    1974          MOVE.W      D1,D3
00001A3E  0643 000A               1975          ADD.W       #GSSDWDTH,D3
00001A42  383C 0190               1976          MOVE.W      #BGGSSBT,D4
00001A46                          1977          
00001A46  7057                    1978          MOVEQ       #87,D0
00001A48  4E4F                    1979          TRAP        #15
00001A4A                          1980          
00001A4A  4CDF 001F               1981          MOVEM.L     (A7)+,D0-D4
00001A4E  4E75                    1982          RTS
00001A50                          1983          
00001A50                          1984  
00001A50                          1985  
00001A50                          1986  
00001A50                          1987  
00001A50                          1988  
00001A50                          1989  
00001A50                          1990  
00001A50                          1991  -------------------- end include --------------------
00001A50                          1992  ; -----------------------------------------------------------------------------
00001A50                          1993  BGUPD
00001A50                          1994  ; UPDATES DETAILS OF BACKGROUND
00001A50                          1995  ; INPUT    - NONE
00001A50                          1996  ; OUTPUT   - NONE
00001A50                          1997  ; MODIFIES - MEMORY WHEN NEEDED
00001A50                          1998  ; -----------------------------------------------------------------------------
00001A50  48E7 8070               1999              MOVEM.L  D0/A1-A3,-(A7)
00001A54                          2000  
00001A54  1039 00001C5B           2001              MOVE.B  (SCRCYCCT),D0
00001A5A  C07C 0007               2002              AND     #$07,D0                 ;EVERY 8 CYCLES
00001A5E  6614                    2003              BNE.S   .CLOUD                  ;CREATE A NEW MARK ON GRASS
00001A60  43F8 19FA               2004              LEA     GSSDINIT,A1
00001A64  45F8 1A04               2005              LEA     GSSDUPD,A2
00001A68  47F8 1A1E               2006              LEA     GSSDPLOT,A3
00001A6C  303C 0002               2007              MOVE.W  #GSSDTYPE,D0
00001A70                          2008              
00001A70  4EB8 1558               2009              JSR     PRPADD
00001A74                          2010  
00001A74  1039 00001C5B           2011  .CLOUD      MOVE.B  (SCRCYCCT),D0
00001A7A  C07C 00FF               2012              AND     #$FF,D0                 ; EVERY 256 CYCLES
00001A7E  6600 0016               2013              BNE     .END                    ; CREATE A NEW CLOUD
00001A82  43F8 1992               2014              LEA     CLDINIT,A1
00001A86  45F8 19A4               2015              LEA     CLDUPD,A2
00001A8A  47F8 19C2               2016              LEA     CLDPLOT,A3
00001A8E  303C 0001               2017              MOVE.W  #CLDTYPE,D0
00001A92                          2018              
00001A92  4EB8 1558               2019              JSR     PRPADD
00001A96                          2020              
00001A96  4CDF 0E01               2021  .END        MOVEM.L (A7)+,D0/A1-A3
00001A9A  4E75                    2022              RTS
00001A9C                          2023  
00001A9C                          2024  
00001A9C                          2025  ; -----------------------------------------------------------------------------
00001A9C                          2026  BGPLOT
00001A9C                          2027  ; PLOTS BACKGROUND
00001A9C                          2028  ; INPUT    - NONE
00001A9C                          2029  ; OUTPUT   - NONE
00001A9C                          2030  ; MODIFIES - NONE
00001A9C                          2031  ; -----------------------------------------------------------------------------
00001A9C                          2032              
00001A9C  48A7 7800               2033              MOVEM.W D1-D4,-(A7)
00001AA0                          2034              
00001AA0                          2035m             UTLSPEN #BGSKYPC
00001AA0                          2036m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001AA0                          2037m ; INPUT    - #BGSKYPC COLOR IN FORMAT $00BBGGRR
00001AA0                          2038m ; OUTPUT   - NONE
00001AA0                          2039m ; MODIFIES - D0,D1
00001AA0                          2040m ; -----------------------------------------------------------------------------
00001AA8                          2041m             UTLSFIL #BGSKYFC
00001AA8                          2042m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001AA8                          2043m ; INPUT    - #BGSKYFC COLOR IN FORMAT $00BBGGRR
00001AA8                          2044m ; OUTPUT   - NONE
00001AA8                          2045m ; MODIFIES - D0,D1
00001AA8                          2046m ; -----------------------------------------------------------------------------
00001AB4                          2047              
00001AB4  4241                    2048              CLR.W   D1
00001AB6  4242                    2049              CLR.W   D2
00001AB8  363C 0280               2050              MOVE.W  #SCRWIDTH,D3
00001ABC  383C 01E0               2051              MOVE.W  #SCRHEIGH,D4
00001AC0                          2052              
00001AC0  7057                    2053              MOVEQ   #87,D0
00001AC2  4E4F                    2054              TRAP    #15
00001AC4                          2055              
00001AC4                          2056m             UTLSFIL #BGGNDFC
00001AC4                          2057m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001AC4                          2058m ; INPUT    - #BGGNDFC COLOR IN FORMAT $00BBGGRR
00001AC4                          2059m ; OUTPUT   - NONE
00001AC4                          2060m ; MODIFIES - D0,D1
00001AC4                          2061m ; -----------------------------------------------------------------------------
00001AD0                          2062              
00001AD0  4241                    2063              CLR     D1
00001AD2  343C 0190               2064              MOVE.W  #BGGSSBT,D2
00001AD6  363C 0280               2065              MOVE.W  #SCRWIDTH,D3
00001ADA  383C 01E0               2066              MOVE.W  #SCRHEIGH,D4
00001ADE                          2067              
00001ADE  7057                    2068              MOVEQ   #87,D0
00001AE0  4E4F                    2069              TRAP    #15
00001AE2                          2070              
00001AE2                          2071m             UTLSFIL #BGGSSFC
00001AE2                          2072m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001AE2                          2073m ; INPUT    - #BGGSSFC COLOR IN FORMAT $00BBGGRR
00001AE2                          2074m ; OUTPUT   - NONE
00001AE2                          2075m ; MODIFIES - D0,D1
00001AE2                          2076m ; -----------------------------------------------------------------------------
00001AEE                          2077  
00001AEE                          2078  
00001AEE  4241                    2079              CLR     D1
00001AF0  343C 0168               2080              MOVE.W  #BGGSSTP,D2
00001AF4  363C 0280               2081              MOVE.W  #SCRWIDTH,D3
00001AF8  383C 0190               2082              MOVE.W  #BGGSSBT,D4
00001AFC                          2083              
00001AFC  7057                    2084              MOVEQ   #87,D0
00001AFE  4E4F                    2085              TRAP    #15
00001B00                          2086              
00001B00  4C9F 001E               2087              MOVEM.W (A7)+,D1-D4
00001B04  4E75                    2088              RTS
00001B06                          2089  
00001B06                          2090  
00001B06                          2091  
00001B06                          2092  
00001B06                          2093  
00001B06                          2094  
00001B06                          2095  
00001B06                          2096  
00001B06                          2097  
00001B06                          2098  
00001B06                          2099  
00001B06                          2100  
00001B06                          2101  
00001B06                          2102  
00001B06                          2103  
00001B06                          2104  
00001B06                          2105  
00001B06                          2106  
00001B06                          2107  -------------------- end include --------------------
00001B06                          2108              INCLUDE "PIPES.X68"                  ; PIPES MANAGEMENT          
00001B06                          2109  ; =============================================================================
00001B06                          2110  ; PIPES MANAGEMENT. IT IS AN AGENT.
00001B06                          2111  ; LOCAL MEMORY IS:
00001B06                          2112  ; +0 WORD X COORDINATE OF THE LEFTMOST EDGE OF THE VERTICALLY ALIGNED PIPES
00001B06                          2113  ; +2 WORD Y COORDINATE OF THE DOWNMOST EDGE OF THE TOP PIPE (FACING DOWN)
00001B06                          2114  ; +4 WORD BOOLEAN THAT TELLS WHETHER THE PIPE SHOULD MOVE OR NOT
00001B06                          2115  ;    (0 == TRUE. ELSE FALSE)
00001B06                          2116  ; =============================================================================
00001B06                          2117  
00001B06                          2118  ; -----------------------------------------------------------------------------
00001B06                          2119  PIPINIT
00001B06                          2120  ; PIPE INITIALIZATION
00001B06                          2121  ; -----------------------------------------------------------------------------
00001B06                          2122              ;Guardar registros
00001B06  48E7 C000               2123              MOVEM.L D0-D1,-(A7)
00001B0A                          2124              
00001B0A  30BC 0280               2125              MOVE.W  #SCRWIDTH,(A0)      ;X COORDINATE OF STARTING POSITION
00001B0E  4EB8 13B6               2126              JSR     UTLRAND             ;RANDOM Y COORDINATE OF STARTING
00001B12  3140 0002               2127              MOVE.W  D0,2(A0)            *POSITION
00001B16  B23C 0004               2128              CMP.B   #4,D1
00001B1A  6606                    2129              BNE.S   .skip
00001B1C                          2130              
00001B1C  4239 00001C50           2131              CLR.B   (PIPCOUNT)
00001B22                          2132  .skip            
00001B22  1141 0004               2133              MOVE.B  D1,4(A0)            ;BOOLEAN: MOVING OR NOT
00001B26                          2134          
00001B26                          2135              ;Restaurar registros
00001B26  4CDF 0003               2136              MOVEM.L (A7)+,D0-D1
00001B2A  4E75                    2137              RTS
00001B2C                          2138              
00001B2C                          2139  ; -----------------------------------------------------------------------------
00001B2C                          2140  PIPUPD
00001B2C                          2141  ; PIPE UPDATE
00001B2C                          2142  ; -----------------------------------------------------------------------------
00001B2C                          2143               ;Guardar registros
00001B2C  48E7 FF00               2144              MOVEM.L  D0-D7,-(A7)
00001B30                          2145              
00001B30  3039 00001C54           2146              MOVE.W  (XSPEED),D0     
00001B36  9150                    2147              SUB.W   D0,(A0)         ;UPDATE X COORDINATE
00001B38                          2148              
00001B38  0C50 FFC4               2149              CMP.W   #-PIPTWDT,(A0)
00001B3C  6F3A                    2150              BLE.S   .KILL
00001B3E                          2151              
00001B3E                          2152  
00001B3E                          2153              ;Preparar los registros para llamar a la subrutina que comprueba 
00001B3E                          2154              ;las colisiones con las tuberías. 
00001B3E  3010                    2155              MOVE.W (A0), D0
00001B40  3228 0002               2156              MOVE.W 2(A0), D1
00001B44  3439 00001C3A           2157              MOVE.W (PLRPOSX), D2
00001B4A  3639 00001C3C           2158              MOVE.W (PLRPOSY), D3
00001B50  383C 0032               2159              MOVE.W #PIPBWDT, D4
00001B54  3A3C 0019               2160              MOVE.W #PLRWIDTH, D5
00001B58  3C3C 0064               2161              MOVE.W #PIPOPEN, D6
00001B5C  3E3C 0019               2162              MOVE.W #PLRHEIGHT, D7
00001B60  4EB8 1380               2163              JSR UTLCHCOL           
00001B64                          2164              
00001B64  4A00                    2165              TST.B D0
00001B66  6700 000A               2166              BEQ .END
00001B6A  33FC 0001 00001C44      2167              MOVE.W #1, (PLRDEAD)
00001B72                          2168              
00001B72                          2169  .END        ;Restaurar registros
00001B72  4CDF 00FF               2170              MOVEM.L  (A7)+,D0-D7
00001B76  4E75                    2171              RTS
00001B78                          2172              
00001B78  4EB8 11AA               2173  .KILL       JSR     AGLKILL
00001B7C  60F4                    2174              BRA.S  .END
00001B7E                          2175  
00001B7E                          2176  ; -----------------------------------------------------------------------------
00001B7E                          2177  PIPPLOT
00001B7E                          2178  ; PIPE PLOT
00001B7E                          2179  ; -----------------------------------------------------------------------------
00001B7E                          2180              ;Guardar registros
00001B7E  48E7 F800               2181              MOVEM.L D0-D4,-(A7)
00001B82                          2182              
00001B82                          2183m             UTLSPEN #PIPPC
00001B82                          2184m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001B82                          2185m ; INPUT    - #PIPPC COLOR IN FORMAT $00BBGGRR
00001B82                          2186m ; OUTPUT   - NONE
00001B82                          2187m ; MODIFIES - D0,D1
00001B82                          2188m ; -----------------------------------------------------------------------------
00001B8A                          2189              
00001B8A  0C28 0000 0004          2190              CMP.B   #0,4(A0)
00001B90  6710                    2191              BEQ.S   .skip
00001B92                          2192              
00001B92                          2193m             UTLSFIL #PIPFC
00001B92                          2194m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001B92                          2195m ; INPUT    - #PIPFC COLOR IN FORMAT $00BBGGRR
00001B92                          2196m ; OUTPUT   - NONE
00001B92                          2197m ; MODIFIES - D0,D1
00001B92                          2198m ; -----------------------------------------------------------------------------
00001B9E  6000 000A               2199              BRA     .skp2
00001BA2                          2200  .skip       
00001BA2                          2201m             UTLSFIL #$00000000      ;prueba para pipes que se han de mover
00001BA2                          2202m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001BA2                          2203m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001BA2                          2204m ; OUTPUT   - NONE
00001BA2                          2205m ; MODIFIES - D0,D1
00001BA2                          2206m ; -----------------------------------------------------------------------------
00001BAA                          2207  .skp2
00001BAA                          2208              
00001BAA  3210                    2209              MOVE.W  (A0),D1         ;PAINT THE BASE OF THE TOP PIPE
00001BAC  5A41                    2210              ADDQ    #PIPTBSPC,D1
00001BAE  4242                    2211              CLR     D2
00001BB0  3601                    2212              MOVE.W  D1,D3
00001BB2  0643 0032               2213              ADD.W   #PIPBWDT,D3
00001BB6  3828 0002               2214              MOVE.W  2(A0),D4
00001BBA                          2215              
00001BBA  7057                    2216              MOVEQ   #87,D0
00001BBC  4E4F                    2217              TRAP    #15
00001BBE                          2218              
00001BBE  3210                    2219              MOVE.W  (A0),D1         ;PAINT THE MOUTH OF THE TOP PIPE
00001BC0  3828 0002               2220              MOVE.W  2(A0),D4
00001BC4  3404                    2221              MOVE.W  D4,D2
00001BC6  0442 000A               2222              SUB.W   #PIPTHGT,D2
00001BCA  3601                    2223              MOVE.W  D1,D3
00001BCC  0643 003C               2224              ADD.W   #PIPTWDT,D3
00001BD0                          2225              
00001BD0  7057                    2226              MOVEQ   #87,D0
00001BD2  4E4F                    2227              TRAP    #15
00001BD4                          2228              
00001BD4  3210                    2229              MOVE.W  (A0),D1         ;PAINT THE BASE OF THE BOTTOM PIPE
00001BD6  5A41                    2230              ADD.W   #PIPTBSPC,D1
00001BD8  3428 0002               2231              MOVE.W  2(A0),D2
00001BDC  0642 0064               2232              ADD.W   #PIPOPEN,D2
00001BE0  3601                    2233              MOVE.W  D1,D3
00001BE2  0643 0032               2234              ADD.W   #PIPBWDT,D3
00001BE6  383C 0168               2235              MOVE.W  #BGGSSTP,D4
00001BEA                          2236              
00001BEA  7057                    2237              MOVEQ   #87,D0
00001BEC  4E4F                    2238              TRAP    #15
00001BEE                          2239              
00001BEE  3210                    2240              MOVE.W  (A0),D1         ;PAINT THE MOUTH OF THE BOTTOM PIPE
00001BF0  3428 0002               2241              MOVE.W  2(A0),D2
00001BF4  0642 0064               2242              ADD.W   #PIPOPEN,D2
00001BF8  3601                    2243              MOVE.W  D1,D3
00001BFA  0643 003C               2244              ADD.W   #PIPTWDT,D3
00001BFE  3802                    2245              MOVE.W  D2,D4
00001C00  0644 000A               2246              ADD.W   #PIPTHGT,D4
00001C04                          2247              
00001C04  7057                    2248              MOVEQ   #87,D0
00001C06  4E4F                    2249              TRAP    #15
00001C08                          2250  
00001C08                          2251              ;Restaurar registros
00001C08  4CDF 001F               2252              MOVEM.L (A7)+,D0-D4
00001C0C  4E75                    2253              RTS
00001C0E                          2254  
00001C0E                          2255  
00001C0E                          2256  
00001C0E                          2257  
00001C0E                          2258  
00001C0E                          2259  
00001C0E                          2260  
00001C0E                          2261  
00001C0E                          2262  
00001C0E                          2263  
00001C0E                          2264  
00001C0E                          2265  
00001C0E                          2266  
00001C0E                          2267  
00001C0E                          2268  
00001C0E                          2269  
00001C0E                          2270  -------------------- end include --------------------
00001C0E                          2271  
00001C0E                          2272  
00001C0E                          2273  ; --- INITIALIZE --------------------------------------------------------------
00001C0E                          2274  
00001C0E  4EB8 1000               2275  START       JSR     SYSINIT
00001C12  4EB8 160C               2276              JSR     STAINIT
00001C16                          2277  
00001C16                          2278  ; --- UPDATE ------------------------------------------------------------------
00001C16                          2279   
00001C16  4E40                    2280  .LOOP       TRAP    #KBDTRAP                ; READ KEYBOARD
00001C18  4EB8 161E               2281              JSR     STAUPD
00001C1C                          2282  
00001C1C                          2283  ; --- WAIT SYNCH --------------------------------------------------------------
00001C1C                          2284  
00001C1C  4A39 00001C5A           2285  .WINT       TST.B   (SCRINTCT)              ; WAIT FOR INTERRUPT
00001C22  67F8                    2286              BEQ     .WINT
00001C24  4239 00001C5A           2287              CLR.B   (SCRINTCT)
00001C2A                          2288  
00001C2A                          2289  ; --- PLOT --------------------------------------------------------------------
00001C2A                          2290  
00001C2A  4EB8 167C               2291              JSR     STAPLOT
00001C2E  4E41                    2292              TRAP    #SCRTRAP                ; SHOW GRAPHICS
00001C30  60E4                    2293              BRA     .LOOP
00001C32  FFFF FFFF               2294              SIMHALT
00001C36                          2295  
00001C36                          2296  ; --- VARIABLES ---------------------------------------------------------------
00001C36                          2297  
00001C36                          2298              INCLUDE "VAR.X68"
00001C36                          2299  ; =============================================================================
00001C36                          2300  ; GAME VARS
00001C36                          2301  ; =============================================================================
00001C36                          2302  
00001C36                          2303  ; --- GAME STATE RELATED VARIABLES --------------------------------------------
00001C36                          2304  
00001C36                          2305  STACUR      DS.W    1                       ; CURRENT GAME STATE
00001C38                          2306  STANEXT     DS.W    1                       ; NEXT GAME STATE
00001C3A                          2307  
00001C3A                          2308  ; --- PLAYER RELATED VARIABLES ------------------------------------------------
00001C3A                          2309  
00001C3A                          2310  PLRPOSX      DS.W    1                       ; PLAYER X POSITION (PIXELS)
00001C3C                          2311  PLRPOSY      DS.W    1                       ; PLAYER Y POSITION (PIXELS)
00001C3E                          2312  MAXPOS       DS.W    1                       ; JUMP MAX POSITION
00001C40                          2313  UPPRESSED    DS.W    1                       ; 1 IF UP PRESSED, 0 IF NO PRESSED
00001C42                          2314  PLRDOWNSPEED DS.W    1                       ; PLAYER DOWN SPEED
00001C44                          2315  PLRDEAD      DS.W    1                       ; PLAYER DEAD
00001C46                          2316  PLRSCORE     DS.W    1                       ; PLAYER SCORE
00001C48= 53 43 4F 52 45 3A ...   2317  PLRSCORETEXT DC.B    'SCORE: ',0             ; SCORE TEXT
00001C50                          2318               DS.W    0
00001C50                          2319              
00001C50                          2320  ; --- PIPE RELATED VARIABLES --------------------------------------------------
00001C50                          2321  
00001C50= 01                      2322  PIPCOUNT    DC.B    1
00001C52= 0001                    2323  PIPEPOSX    DC.W    1
00001C54                          2324              DS.W    0
00001C54                          2325  
00001C54                          2326  ; --- GAME RELATED VARIABLES --------------------------------------------------
00001C54                          2327  
00001C54= 0005                    2328  XSPEED      DC.W    5                       ;HORIZONTAL SPEED OF OBJECTS
00001C56                          2329  
00001C56                          2330  ; --- PAUSE MENU RELATED VARIABLES -------------------------------------------
00001C56                          2331  
00001C56= 00                      2332  PMOPTN      DC.B    0                       ;OPTION ON THE MENU TO BE CHOSEN
00001C57                          2333  
00001C57                          2334  ; --- UTILITY VARIABLES ------------------------------------------------------
00001C57                          2335  
00001C57                          2336  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001C58                          2337              DS.W    0
00001C58                          2338  
00001C58                          2339  
00001C58                          2340  
00001C58                          2341  
00001C58                          2342  
00001C58                          2343  
00001C58                          2344  
00001C58                          2345  
00001C58                          2346  
00001C58                          2347  
00001C58                          2348  
00001C58                          2349  
00001C58                          2350  
00001C58                          2351  
00001C58                          2352  
00001C58                          2353  
00001C58                          2354  
00001C58                          2355  
00001C58                          2356  -------------------- end include --------------------
00001C58                          2357              INCLUDE "SYSVAR.X68"
00001C58                          2358  ; =============================================================================
00001C58                          2359  ; SYSTEM VARS
00001C58                          2360  ; NOTE THAT ALL THESE VARS ARE USED TO SHARE DATA FROM SYSTEM TO USER. THUS
00001C58                          2361  ; THEY MUST NOT BE IN PROTECTED MEMORY.
00001C58                          2362  ; NOTE THAT USING DMMDATA IN SUCH WAY IS A BAD IDEA, AS USER APPLICATIONS CAN
00001C58                          2363  ; ALSO FREE OR CHANGE OWNERSHIP. NONETHELESS, FOR THE SAKE OF THIS EXAMPLE
00001C58                          2364  ; THIS IS GOOD ENOUGH.
00001C58                          2365  ; =============================================================================
00001C58                          2366  
00001C58                          2367  ; --- KEYBOARD RELATED VARIABLES ----------------------------------------------
00001C58                          2368  
00001C58                          2369  KBDVAL      DS.B    1                       ; KEY PRESSED=1
00001C59                          2370  KBDEDGE     DS.B    1                       ; KEY CHANGED=1
00001C5A                          2371  
00001C5A                          2372              DS.W    0
00001C5A                          2373  
00001C5A                          2374  ; --- SCREEN RELATED VARIABLES ------------------------------------------------
00001C5A                          2375  
00001C5A                          2376  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER/FLAG
00001C5B                          2377  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00001C5C                          2378              DS.W    0
00001C5C                          2379  
00001C5C                          2380  ; --- DYNAMIC MEMORY VARIABLES ------------------------------------------------
00001C5C                          2381  
00001C80                          2382              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00001C80                          2383  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00002900                          2384              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00002900                          2385  
00002900                          2386  
00002900                          2387  -------------------- end include --------------------
00002900                          2388  
00002900                          2389              END    START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              14D4
AGLADD:END          14EA
AGLKILL             11AA
AGLPLOT             1522
AGLPLOT:END         1552
AGLPLOT:LOOP        152A
AGLPLOT:NEXT        154C
AGLUPD              14EE
AGLUPD:END          151C
AGLUPD:LOOP         14F6
AGLUPD:NEXT         1516
BGGNDFC             155DD8
BGGNDPC             0
BGGNDTP             190
BGGSSBT             190
BGGSSFC             990A
BGGSSPC             0
BGGSSTP             168
BGPLOT              1A9C
BGSKYFC             EFCE87
BGSKYPC             0
BGUPD               1A50
BGUPD:CLOUD         1A74
BGUPD:END           1A96
BLACK               0
CLDFCLR             FFFFFF
CLDINIT             1992
CLDPCLR             FFFFFF
CLDPLOT             19C2
CLDSIZE             3C
CLDTYPE             1
CLDUPD              19A4
CLDUPD:END          19B8
CLDUPD:KILL         19BC
CONTNUM             0
DMMALLOC            1190
DMMALLOC:END        11A8
DMMBNUM             32
DMMBSIZE            40
DMMDATA             1C80
DMMFCOM             116A
DMMFFND             1178
DMMFIRST            1120
DMMFLOOP            115E
DMMFRCOM            1132
DMMFREE             11AA
DMMFRFND            1140
DMMFRLOP            1126
DMMFRSTO            1158
DMMINIT             10FE
DMMINIT:LOOP        110C
DMMNEXT             1142
DMMNEXTO            117A
DMMSYSID            0
EXTNUM              2
GOVSTRC             FFFFFF
GOVSTRX             23
GOVSTRY             F
GREEN               8000
GSSDFC              39DB44
GSSDINIT            19FA
GSSDPLOT            1A1E
GSSDTYPE            2
GSSDUPD             1A04
GSSDUPD:END         1A14
GSSDUPD:KILL        1A18
GSSDWDTH            A
INTPRSC             80
INTPRSF             31A0001
INTPRSX             5
INTPRSY             8
INTTITC             FFFF
INTTITF             33D0001
INTTITX             1
INTTITY             1
JUMPSIZE            3C
JUMPSPEED           3
KBDBITDN            3
KBDBITF1            4
KBDBITF2            5
KBDBITF3            6
KBDBITLF            0
KBDBITPS            7
KBDBITRT            2
KBDBITUP            1
KBDCHRDN            28
KBDCHRLF            25
KBDCHRMK            4D
KBDCHRPK            50
KBDCHRRT            27
KBDCHRSH            10
KBDCHRSP            20
KBDCHRUP            26
KBDDOWN             28
KBDEDGE             1C59
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1090
KBDLEFT             25
KBDMSKDN            8
KBDMSKF1            10
KBDMSKF2            20
KBDMSKF3            40
KBDMSKLF            1
KBDMSKPS            80
KBDMSKRT            4
KBDMSKUP            2
KBDPAUSE            50
KBDREAD             10A6
KBDREAD:KEYSREADY   10E2
KBDREAD:LOOP        10C4
KBDREAD:NEXTKEYS    10C2
KBDREAD:NOTPRESSED  10CE
KBDRIGHT            27
KBDTRAP             0
KBDUP               26
KBDVAL              1C58
MAXPOS              1C3E
NEWGNUM             1
PAUCNTY             8
PAUEXTY             C
PAUNEWY             A
PAUOPTC             FFFFFF
PAUOPTFS            1130005
PAUOPTFU            1130001
PAUOPTX             F
PAUSELC             FF
PAUTITC             FFFF
PAUTITF             3300001
PAUTITX             2
PAUTITY             1
PIPBWDT             32
PIPCOUNT            1C50
PIPEPOSX            1C52
PIPFC               196600
PIPINIT             1B06
PIPINIT:SKIP        1B22
PIPOPEN             64
PIPPC               0
PIPPLOT             1B7E
PIPPLOT:SKIP        1BA2
PIPPLOT:SKP2        1BAA
PIPTBSPC            5
PIPTHGT             A
PIPTWDT             3C
PIPTYPE             3
PIPUPD              1B2C
PIPUPD:END          1B72
PIPUPD:KILL         1B78
PIPYSPD             2
PLRCOLOR            8000
PLRDEAD             1C44
PLRDOWNSPEED        1C42
PLREYECOLOR         FFFFFF
PLRHEIGHT           19
PLRINIT             11C0
PLRINITPOSX         96
PLRINITPOSY         B4
PLRIRISCOLOR        0
PLRMOUTHCOLOR       FF
PLRPLOT             12BE
PLRPOSX             1C3A
PLRPOSY             1C3C
PLRSCORE            1C46
PLRSCORETEXT        1C48
PLRUPD              11F6
PLRUPD:END          12B8
PLRUPD:GAMEOVER     12AC
PLRUPD:LASTJUMP     12A0
PLRUPD:MAKEJUMP     126C
PLRUPD:PRESSED      1248
PLRWIDTH            19
PMOPTN              1C56
PRPADD              1558
PRPADD:END          156E
PRPKILL             11AA
PRPPLOT             15A0
PRPPLOT:END         15C8
PRPPLOT:LOOP        15A8
PRPPLOT:NEXT        15C2
PRPUPD              1572
PRPUPD:END          159A
PRPUPD:LOOP         157A
PRPUPD:NEXT         1594
RED                 FF
SCRCYCCT            1C5B
SCRHEIGH            1E0
SCRINIT             101C
SCRINTCT            1C5A
SCRIRQ              1
SCRISR              1074
SCRTIM              14
SCRTRAP             1
SCRUPD              1082
SCRWIDTH            280
SPWUPD              15CE
SPWUPD:END          1606
STACUR              1C36
STAEMPTY            16A8
STAGOVR             3
STAGOVRP            1952
STAGOVRP:GOVSTR     1986
STAGOVRU            193C
STAGOVRU:END        1950
STAINIT             160C
STAINTR             0
STAINTRI            10FE
STAINTRP            16FC
STAINTRP:START_TEXT  175E
STAINTRP:TITLE      1752
STAINTRU            16E6
STAINTRU:END        16FA
STANEXT             1C38
STANONE             FFFFFFFF
STAPAU              2
STAPAUI             1774
STAPAUP             1816
STAPAUP:CNTSEL      1868
STAPAUP:CONT        1920
STAPAUP:EXIT        1936
STAPAUP:EXTSEL      18E8
STAPAUP:NEWG        192A
STAPAUP:NEWSEL      18A8
STAPAUP:SKPCNT      1878
STAPAUP:SKPEXT      18F8
STAPAUP:SKPNEW      18B8
STAPAUP:TITLE       1912
STAPAUU             177E
STAPAUU:CONTGAME    17F8
STAPAUU:DN          17C2
STAPAUU:END         17AE
STAPAUU:EXITGAME    180C
STAPAUU:JMPLST      17E6
STAPAUU:NEWGAME     1802
STAPAUU:OK          17D4
STAPAUU:UP          17B0
STAPLAY             1
STAPLAYI            11C0
STAPLAYP            16D4
STAPLAYU            16AA
STAPLAYU:PAUSE      16CA
STAPLOT             167C
STAPLOT:PLTTBL      1698
START               1C0E
START:LOOP          1C16
START:WINT          1C1C
STAUPD              161E
STAUPD:DOUPD        1644
STAUPD:INITBL       165C
STAUPD:UPDTBL       166C
SYSINIT             1000
UPPRESSED           1C40
UTLCHCOL            1380
UTLCHCOL:COL        13A4
UTLCHCOL:END        13B0
UTLCHCOL:NOCOL      13AC
UTLFONT             37C
UTLINIT             1378
UTLLOCT             254
UTLRAND             13B6
UTLRAND:RANDVEC     13D4
UTLRNDIX            1C57
UTLSFIL             12A
UTLSPEN             0
WHITE               FFFFFF
XSPEED              1C54
