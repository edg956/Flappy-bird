00001BB2 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 02/01/2019 12:48:06

00000000                             1  ; =============================================================================
00000000                             2  ; TITLE    : YET ANOTHER FLAPPY BIRD (YAF)
00000000                             3  ; AUTHORS  : DOÑAQUE, EUGENIO && LLABRÉS, NADAL.
00000000                             4  ; CREATION : DEC 2018
00000000                             5  ; =============================================================================
00000000                             6  
00001000                             7              ORG     $1000
00001000                             8  
00001000                             9  ; --- CODE INCLUDES -----------------------------------------------------------
00001000                            10  
00001000                            11              INCLUDE "SYSCONST.X68"               ; SYSTEM CONSTANTS
00001000                            12  ; =============================================================================
00001000                            13  ; SYSTEM CONSTANTS
00001000                            14  ; =============================================================================
00001000                            15  
00001000                            16  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
00001000                            17  
00001000  =00000000                 18  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
00001000  =00000001                 19  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
00001000                            20  
00001000                            21  ; --- KEY CODES (EASy68K)
00001000                            22  
00001000  =00000020                 23  KBDCHRSP    EQU     $20                     ; SPACE KEY
00001000  =0000004D                 24  KBDCHRMK    EQU     'M'                     ; M KEY
00001000  =00000010                 25  KBDCHRSH    EQU     $10                     ; SHIFT KEY
00001000  =00000050                 26  KBDCHRPK    EQU     'P'                     ; P KEY
00001000  =00000025                 27  KBDCHRLF    EQU     $25                     ; LEFT KEY
00001000  =00000026                 28  KBDCHRUP    EQU     $26                     ; UP KEY
00001000  =00000027                 29  KBDCHRRT    EQU     $27                     ; RIGHT KEY
00001000  =00000028                 30  KBDCHRDN    EQU     $28                     ; DOWN KEY
00001000                            31  
00001000                            32  ; --- KEYBOARD MAPPING --------------------------------------------------------
00001000                            33  
00001000  =00000025                 34  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
00001000  =00000026                 35  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
00001000  =00000027                 36  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
00001000  =00000028                 37  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
00001000  =00000020                 38  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
00001000  =0000004D                 39  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
00001000  =00000010                 40  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
00001000  =00000050                 41  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
00001000                            42  
00001000                            43  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
00001000                            44  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
00001000                            45  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
00001000                            46  ; +---+---+---+---+---+---+---+---+
00001000                            47  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
00001000                            48  ; +---+---+---+---+---+---+---+---+
00001000                            49  ;   |   |   |   |   |   |   |   |
00001000                            50  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
00001000                            51  ;   |   |   |   |   |   |   +-------------- UP BUTTON
00001000                            52  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
00001000                            53  ;   |   |   |   |   +---------------------- DOWN BUTTON
00001000                            54  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
00001000                            55  ;   |   |   +------------------------------ FIRE 2 BUTTON
00001000                            56  ;   |   +---------------------------------- FIRE 3 BUTTON
00001000                            57  ;   +-------------------------------------- PAUSE BUTTON
00001000                            58  
00001000  =00000001                 59  KBDMSKLF    EQU     %00000001
00001000  =00000002                 60  KBDMSKUP    EQU     %00000010
00001000  =00000004                 61  KBDMSKRT    EQU     %00000100
00001000  =00000008                 62  KBDMSKDN    EQU     %00001000
00001000  =00000010                 63  KBDMSKF1    EQU     %00010000
00001000  =00000020                 64  KBDMSKF2    EQU     %00100000
00001000  =00000040                 65  KBDMSKF3    EQU     %01000000
00001000  =00000080                 66  KBDMSKPS    EQU     %10000000
00001000                            67  
00001000                            68  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
00001000                            69  
00001000  =00000000                 70  KBDBITLF    EQU     0
00001000  =00000001                 71  KBDBITUP    EQU     1
00001000  =00000002                 72  KBDBITRT    EQU     2
00001000  =00000003                 73  KBDBITDN    EQU     3
00001000  =00000004                 74  KBDBITF1    EQU     4
00001000  =00000005                 75  KBDBITF2    EQU     5
00001000  =00000006                 76  KBDBITF3    EQU     6
00001000  =00000007                 77  KBDBITPS    EQU     7
00001000                            78  
00001000                            79  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
00001000                            80  
00001000  =00000280                 81  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
00001000  =000001E0                 82  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
00001000  =00000001                 83  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
00001000  =00000014                 84  SCRTIM      EQU     20                      ; SCREEN TIMER (MS)
00001000                            85  
00001000                            86  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
00001000                            87  
00001000  =00000040                 88  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001000  =00000032                 89  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001000  =00000000                 90  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001000                            91  
00001000                            92  
00001000                            93  
00001000                            94  
00001000                            95  -------------------- end include --------------------
00001000                            96              INCLUDE "SYSTEM.X68"                 ; SYSTEM CODE
00001000                            97  ; =============================================================================
00001000                            98  ; SYSTEM MANAGEMENT (SYSTEM CODE)
00001000                            99  ; =============================================================================
00001000                           100  
00001000                           101  ; -----------------------------------------------------------------------------
00001000                           102  SYSINIT
00001000                           103  ; INITIALIZES THE SYSTEM
00001000                           104  ; INPUT    - NONE
00001000                           105  ; OUTPUT   - NONE
00001000                           106  ; MODIFIES - NONE
00001000                           107  ; -----------------------------------------------------------------------------
00001000  205F                     108              MOVE.L  (A7)+,A0                ; GET RETURN ADDRESS
00001002  4EB9 00001090            109              JSR     KBDINIT                 ; INIT KEYBOARD
00001008  4EB9 0000101C            110              JSR     SCRINIT                 ; INIT SCREEN
0000100E  4EB9 000010FE            111              JSR     DMMINIT                 ; INIT DYNAMIC MEMORY
00001014  027C DFFF                112              ANDI.W  #$DFFF,SR               ; SWITCH TO USER
00001018  2F08                     113              MOVE.L  A0,-(A7)                ; PUT RETURN ADDRESS
0000101A  4E75                     114              RTS
0000101C                           115  
0000101C                           116  ; =============================================================================
0000101C                           117  ; SCREEN MANAGEMENT (SYSTEM CODE)
0000101C                           118  ; =============================================================================
0000101C                           119  
0000101C                           120  ; -----------------------------------------------------------------------------
0000101C                           121  SCRINIT
0000101C                           122  ; INITIALIZES THE SCREEN, SCREEN-RELATED INTERRUPT AND VARS.
0000101C                           123  ; INPUT    - NONE
0000101C                           124  ; OUTPUT   - NONE
0000101C                           125  ; MODIFIES - D0,D1,D2,D3
0000101C                           126  ; -----------------------------------------------------------------------------
0000101C                           127              ; TO DO:
0000101C                           128              ; - DISABLE INTS (SET INT BITS IN SR TO 111)
0000101C                           129              
0000101C  007C 0700                130              ORI.W #(7<<8)&$700,SR
00001020                           131              
00001020                           132              ; - INSTALL SCRUPD INTO TRAP SCRTRAP
00001020                           133              
00001020  21FC 00001082 0084       134              MOVE.L  #SCRUPD,($80+4*SCRTRAP)
00001028                           135              
00001028                           136              ; - SET RESOLUTION TO SCRWIDTH X SCRHEIGHT
00001028                           137              
00001028  7021                     138              MOVE.L  #33,D0
0000102A  223C 028001E0            139              MOVE.L  #SCRWIDTH*$10000+SCRHEIGH,D1
00001030  4E4F                     140              TRAP    #15
00001032                           141              
00001032                           142              ; - SET WINDOWED MODE
00001032                           143              
00001032  7201                     144              MOVEQ   #1, D1 
00001034  4E4F                     145              TRAP    #15
00001036                           146              
00001036                           147              ; - CLEAR VISIBLE BUFFER
00001036                           148              
00001036  700B                     149              MOVEQ   #11, D0
00001038  323C FF00                150              MOVE.W  #$FF00,D1
0000103C  4E4F                     151              TRAP    #15
0000103E                           152              
0000103E                           153              ; - ENABLE DOUBLE BUFFER
0000103E                           154              
0000103E  705C                     155              MOVEQ   #92, D0
00001040  7211                     156              MOVEQ   #17, D1     
00001042  4E4F                     157              TRAP    #15
00001044                           158              
00001044                           159              ; - CLEAR HIDDEN BUFFER
00001044                           160              
00001044  700B                     161              MOVEQ   #11, D0
00001046  323C FF00                162              MOVE.W  #$FF00,D1
0000104A  4E4F                     163              TRAP    #15
0000104C                           164              
0000104C                           165              ; - INSTALL SCRISR FOR IRQ SCRIRQ (IRQ INTERRUPT VECTOR BEGINS
0000104C                           166              ;   AT $60. INSTALLATION IS SIMILAR TO TRAP INSTALLATION)
0000104C                           167              
0000104C  21FC 00001074 0064       168              MOVE.L  #SCRISR,($60+4*SCRIRQ)
00001054                           169              
00001054                           170              ; - ENABLE AUTO-IRQ EVERY SCRTIM MS FOR IRQ SCRIRQ (SEE TRAP #15
00001054                           171              ;   TASK 32)
00001054                           172              
00001054  7020                     173              MOVEQ   #32,D0
00001056  7206                     174              MOVEQ   #6,D1
00001058  243C 00000081            175              MOVE.L  #$80+SCRIRQ,D2
0000105E  7614                     176              MOVE.L  #SCRTIM, D3
00001060  4E4F                     177              TRAP    #15
00001062                           178              
00001062                           179              ; - CLEAR SCRINTCT AND SCRCYCCT
00001062                           180              
00001062  4239 00001BF0            181              CLR.B   (SCRINTCT)
00001068  4239 00001BF1            182              CLR.B   (SCRCYCCT)
0000106E                           183              
0000106E                           184              ; - ENABLE INTS (SET INT BITS IN SR TO 000)
0000106E                           185              
0000106E  027C F8FF                186              ANDI.W #$F8FF,SR
00001072                           187              
00001072  4E75                     188              RTS
00001074                           189  
00001074                           190  ; -----------------------------------------------------------------------------
00001074                           191  SCRISR
00001074                           192  ; SCREEN TIMER ISR. INCREASES THE INTERRUPT COUNTER AND UPDATES DOUBLE BUFFER.
00001074                           193  ; INPUT    - NONE
00001074                           194  ; OUTPUT   - NONE
00001074                           195  ; MODIFIES - NONE
00001074                           196  ; -----------------------------------------------------------------------------
00001074  5239 00001BF0            197              ADDQ.B  #1,(SCRINTCT)           ; UPDATE INT FLAG/COUNTER
0000107A  5239 00001BF1            198              ADDQ.B  #1,(SCRCYCCT)           ; UPDATE CYCLE COUNTER
00001080  4E73                     199              RTE
00001082                           200  
00001082                           201  ; -----------------------------------------------------------------------------
00001082                           202  SCRUPD
00001082                           203  ; TRAP SERVICE ROUTINE IN CHARGE OF VISUALIZING CURRENT FRAME AND CLEARING
00001082                           204  ; BUFFER FOR THE NEXT ONE.
00001082                           205  ; INPUT    - NONE
00001082                           206  ; OUTPUT   - NONE
00001082                           207  ; MODIFIES - NONE
00001082                           208  ; -----------------------------------------------------------------------------
00001082                           209              ; TO DO: UPDATE DOUBLE BUFFER AND CLEAR HIDDEN BUFFER
00001082                           210              ; - UPDATE DOUBLE BUFFER
00001082                           211              
00001082  705E                     212              MOVEQ   #94,D0
00001084  4E4F                     213              TRAP    #15
00001086                           214              
00001086                           215              ; - CLEAR HIDDEN BUFFER
00001086                           216                                 
00001086  700B                     217              MOVEQ   #11, D0
00001088  323C FF00                218              MOVE.W  #$FF00,D1
0000108C  4E4F                     219              TRAP    #15
0000108E                           220              
0000108E  4E73                     221              RTE
00001090                           222  
00001090                           223  ; =============================================================================
00001090                           224  ; KEYBOARD MANAGEMENT (SYSTEM CODE)
00001090                           225  ; =============================================================================
00001090                           226  
00001090                           227  ; -----------------------------------------------------------------------------
00001090                           228  KBDINIT
00001090                           229  ; INITIALIZES THE SYSTEM VARIABLES KBDSYS AND KBDVAL
00001090                           230  ; INPUT    - NONE
00001090                           231  ; OUTPUT   - NONE
00001090                           232  ; MODIFIES - NONE
00001090                           233  ; -----------------------------------------------------------------------------
00001090  4239 00001BEE            234              CLR.B   (KBDVAL)                ; INIT VARS
00001096  4239 00001BEF            235              CLR.B   (KBDEDGE)
0000109C  21FC 000010A6 0080       236              MOVE.L  #KBDREAD,($80+KBDTRAP*4) ; INSTALL
000010A4  4E75                     237              RTS
000010A6                           238  
000010A6                           239  ; -----------------------------------------------------------------------------
000010A6                           240  KBDREAD
000010A6                           241  ; TRAP SERVICE ROUTINE.
000010A6                           242  ; UPDATES THE SYSTEM VARIABLES KBDEDGE AND KBDVAL ACCORDING TO THE BITFIELD
000010A6                           243  ; DESCRIBED IN SYSCONST. KBDVAL HOLDS THE CURRENT VALUES AND KBDEFGE HOLDS
000010A6                           244  ; RISING EDGES FROM PREVIOUS CALL TO THE CURRENT ONE.
000010A6                           245  ; INPUT    - NONE
000010A6                           246  ; OUTPUT   - (KBDVAL) AND (KBDEDGE)
000010A6                           247  ; MODIFIES - NONE
000010A6                           248  ; -----------------------------------------------------------------------------
000010A6                           249              ; TO DO: UPDATE KBDVAL AND KBDEDGE
000010A6                           250              ;Guardar registros en pila
000010A6  48E7 F800                251              MOVEM.L D0-D4,-(A7)
000010AA                           252  
000010AA                           253              ;Obtener estado de teclas
000010AA  7013                     254              MOVEQ   #19,D0
000010AC                           255              
000010AC                           256              ;Obtener estado de teclas PAUSE - FIRE3 - FIRE2 - FIRE1
000010AC  223C 50104D20            257              MOVE.L  #KBDCHRPK<<24+KBDCHRSH<<16+KBDCHRMK<<8+KBDCHRSP,D1
000010B2                           258              
000010B2  4E4F                     259              TRAP    #15
000010B4                           260              
000010B4                           261              ;GUARDAR ESTADO DE TECLAS
000010B4  2401                     262              MOVE.L  D1,D2                   
000010B6                           263              
000010B6                           264              ;Obtener estado de teclas DOWN - RIGHT - UP - LEFT
000010B6  223C 28272625            265              MOVE.L  #KBDCHRDN<<24+KBDCHRRT<<16+KBDCHRUP<<8+KBDCHRLF,D1
000010BC                           266  
000010BC  4E4F                     267              TRAP    #15
000010BE                           268            
000010BE                           269              ;Actualizar valores de KBDVAL
000010BE  4243                     270              CLR     D3        ;Registro que contendrá KBDVAL.
000010C0  4244                     271              CLR     D4        ;Registro con índice de bit a modificar de D3.
000010C2                           272              
000010C2                           273              
000010C2                           274              ;Bucle que recorre D1 para obtener estado de teclas.
000010C2  7003                     275  .NEXTKEYS   MOVEQ   #3, D0    ;Número de iteraciones del bucle (.LOOP).
000010C4                           276  
000010C4                           277  .LOOP                   
000010C4  0801 0000                278              BTST    #0, D1
000010C8  6700 0004                279              BEQ     .NOTPRESSED
000010CC                           280              ;If pressed, set corresponding bit
000010CC  09C3                     281              BSET    D4, D3                  
000010CE                           282                        
000010CE                           283  .NOTPRESSED              
000010CE                           284              *En cualquier caso, obtener siguiente byte de D1*
000010CE                           285              
000010CE                           286              ;Se desplaza el registro D1 8 bits a la derecha. 
000010CE  E089                     287              LSR.L   #8, D1
000010D0                           288              
000010D0                           289              ;Se incrementa el índice de D3.
000010D0  5244                     290              ADDQ    #1, D4
000010D2  51C8 FFF0                291              DBRA    D0, .LOOP
000010D6                           292              
000010D6                           293              ;Comprobar si hay que analizar el segundo conjunto de teclas. 
000010D6  B83C 0004                294              CMP.B   #4, D4
000010DA  6600 0006                295              BNE     .KEYSREADY            
000010DE                           296             
000010DE                           297              ;Se mueve el segundo conjunto de teclas al registro D1 y se
000010DE                           298              ;repite el bucle .LOOP.
000010DE  2202                     299              MOVE.L  D2, D1
000010E0  60E0                     300              BRA     .NEXTKEYS
000010E2                           301  
000010E2                           302  .KEYSREADY  
000010E2                           303              ;Recuperamos el anterior KBDVAL en D4.
000010E2  1839 00001BEE            304              MOVE.B  (KBDVAL), D4
000010E8                           305              ;Se mueve el byte obtenido a KBDVAL.         
000010E8  13C3 00001BEE            306              MOVE.B  D3, KBDVAL 
000010EE                           307  
000010EE  4604                     308              NOT.B   D4
000010F0  C604                     309              AND.B   D4, D3
000010F2  13C3 00001BEF            310              MOVE.B  D3, (KBDEDGE)             
000010F8                           311              
000010F8                           312              ;Restaurar registros a su estado original. 
000010F8  4CDF 001F                313              MOVEM.L (A7)+,D0-D4
000010FC                           314  
000010FC  4E73                     315              RTE
000010FE                           316  
000010FE                           317  ; =============================================================================
000010FE                           318  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
000010FE                           319  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
000010FE                           320  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
000010FE                           321  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
000010FE                           322  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
000010FE                           323  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
000010FE                           324  ; =============================================================================
000010FE                           325  
000010FE                           326  ; -----------------------------------------------------------------------------
000010FE                           327  DMMINIT
000010FE                           328  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
000010FE                           329  ; INPUT    - NONE
000010FE                           330  ; OUTPUT   - NONE
000010FE                           331  ; MODIFIES - NONE
000010FE                           332  ; -----------------------------------------------------------------------------
000010FE  48E7 8080                333              MOVEM.L D0/A0,-(A7)
00001102  41F9 00001C00            334              LEA     DMMDATA,A0
00001108  303C 0031                335              MOVE.W  #DMMBNUM-1,D0
0000110C  30BC 0000                336  .LOOP       MOVE.W  #DMMSYSID,(A0)
00001110  D1FC 00000040            337              ADD.L   #DMMBSIZE,A0
00001116  51C8 FFF4                338              DBRA.W  D0,.LOOP
0000111A  4CDF 0101                339              MOVEM.L (A7)+,D0/A0
0000111E  4E75                     340              RTS
00001120                           341  
00001120                           342  ; -----------------------------------------------------------------------------
00001120                           343  DMMFIRST
00001120                           344  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001120                           345  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001120                           346  ; INPUT    - NONE
00001120                           347  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001120                           348  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001120                           349  ; -----------------------------------------------------------------------------
00001120  41F9 00001C00            350              LEA     DMMDATA,A0
00001126  4A58                     351  DMMFRLOP    TST.W   (A0)+
00001128  6600 0016                352              BNE     DMMFRFND
0000112C  D1FC 0000003E            353              ADD.L   #DMMBSIZE-2,A0
00001132  B1FC 0000287F            354  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001138  6DEC                     355              BLT     DMMFRLOP
0000113A  207C 00000000            356              MOVE.L  #0,A0
00001140  4E75                     357  DMMFRFND    RTS
00001142                           358  
00001142                           359  ; -----------------------------------------------------------------------------
00001142                           360  DMMNEXT
00001142                           361  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001142                           362  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001142                           363  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
00001142                           364  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001142                           365  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001142                           366  ; -----------------------------------------------------------------------------
00001142  2F00                     367              MOVE.L  D0,-(A7)
00001144  2008                     368              MOVE.L  A0,D0
00001146  C0BC FFFFFFC0            369              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
0000114C  0680 00000040            370              ADD.L   #DMMBSIZE,D0
00001152  2040                     371              MOVE.L  D0,A0
00001154  201F                     372              MOVE.L  (A7)+,D0
00001156  60DA                     373              BRA     DMMFRCOM
00001158                           374  
00001158                           375  ; -----------------------------------------------------------------------------
00001158                           376  DMMFRSTO
00001158                           377  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
00001158                           378  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001158                           379  ; INPUT    - D0.W : ID TO SEARCH
00001158                           380  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001158                           381  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001158                           382  ; -----------------------------------------------------------------------------
00001158  41F9 00001C00            383              LEA     DMMDATA,A0
0000115E  B058                     384  DMMFLOOP    CMP.W   (A0)+,D0
00001160  6700 0016                385              BEQ     DMMFFND
00001164  D1FC 0000003E            386              ADD.L   #DMMBSIZE-2,A0
0000116A  B1FC 0000287F            387  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001170  6DEC                     388              BLT     DMMFLOOP
00001172  207C 00000000            389              MOVE.L  #0,A0
00001178  4E75                     390  DMMFFND     RTS
0000117A                           391  
0000117A                           392  ; -----------------------------------------------------------------------------
0000117A                           393  DMMNEXTO
0000117A                           394  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000117A                           395  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000117A                           396  ; INPUT    - D0.W : ID TO SEARCH
0000117A                           397  ;            A0   : POINTER WITHIN THE CURRENT SLOT
0000117A                           398  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000117A                           399  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000117A                           400  ; -----------------------------------------------------------------------------
0000117A  2F00                     401              MOVE.L  D0,-(A7)
0000117C  2008                     402              MOVE.L  A0,D0
0000117E  C0BC FFFFFFC0            403              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001184  0680 00000040            404              ADD.L   #DMMBSIZE,D0
0000118A  2040                     405              MOVE.L  D0,A0
0000118C  201F                     406              MOVE.L  (A7)+,D0
0000118E  60DA                     407              BRA     DMMFCOM
00001190                           408  
00001190                           409  ; -----------------------------------------------------------------------------
00001190                           410  DMMALLOC
00001190                           411  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
00001190                           412  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
00001190                           413  ; INPUT    - D0.W : ID TO ASSIGN
00001190                           414  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
00001190                           415  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001190                           416  ; -----------------------------------------------------------------------------
00001190  3F00                     417              MOVE.W  D0,-(A7)
00001192  4240                     418              CLR.W   D0
00001194  4EB8 1158                419              JSR     DMMFRSTO
00001198  301F                     420              MOVE.W  (A7)+,D0
0000119A  B1FC 00000000            421              CMP.L   #0,A0
000011A0  6700 0006                422              BEQ     .END
000011A4  3140 FFFE                423              MOVE.W  D0,-2(A0)
000011A8  4E75                     424  .END        RTS
000011AA                           425  
000011AA                           426  ; -----------------------------------------------------------------------------
000011AA                           427  DMMFREE
000011AA                           428  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000011AA                           429  ; SYSTEM (0)
000011AA                           430  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000011AA                           431  ; OUTPUT   - NONE
000011AA                           432  ; MODIFIES - NONE
000011AA                           433  ; -----------------------------------------------------------------------------
000011AA  48E7 8080                434              MOVEM.L D0/A0,-(A7)
000011AE  2008                     435              MOVE.L  A0,D0
000011B0  C0BC FFFFFFC0            436              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000011B6  2040                     437              MOVE.L  D0,A0
000011B8  4250                     438              CLR.W   (A0)
000011BA  4CDF 0101                439              MOVEM.L (A7)+,D0/A0
000011BE  4E75                     440              RTS
000011C0                           441  
000011C0                           442  
000011C0                           443  
000011C0                           444  
000011C0                           445  -------------------- end include --------------------
000011C0                           446              INCLUDE "SYSCONST.X68"               ; SYSTEM CONSTANTS
000011C0                           447  ; =============================================================================
000011C0                           448  ; SYSTEM CONSTANTS
000011C0                           449  ; =============================================================================
000011C0                           450  
000011C0                           451  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
000011C0                           452  
000011C0  =00000000                453  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
000011C0  =00000001                454  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
000011C0                           455  
000011C0                           456  ; --- KEY CODES (EASy68K)
000011C0                           457  
000011C0  =00000020                458  KBDCHRSP    EQU     $20                     ; SPACE KEY
000011C0  =0000004D                459  KBDCHRMK    EQU     'M'                     ; M KEY
000011C0  =00000010                460  KBDCHRSH    EQU     $10                     ; SHIFT KEY
000011C0  =00000050                461  KBDCHRPK    EQU     'P'                     ; P KEY
000011C0  =00000025                462  KBDCHRLF    EQU     $25                     ; LEFT KEY
000011C0  =00000026                463  KBDCHRUP    EQU     $26                     ; UP KEY
000011C0  =00000027                464  KBDCHRRT    EQU     $27                     ; RIGHT KEY
000011C0  =00000028                465  KBDCHRDN    EQU     $28                     ; DOWN KEY
000011C0                           466  
000011C0                           467  ; --- KEYBOARD MAPPING --------------------------------------------------------
000011C0                           468  
000011C0  =00000025                469  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
000011C0  =00000026                470  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
000011C0  =00000027                471  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
000011C0  =00000028                472  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
000011C0  =00000020                473  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
000011C0  =0000004D                474  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
000011C0  =00000010                475  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
000011C0  =00000050                476  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
000011C0                           477  
000011C0                           478  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
000011C0                           479  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
000011C0                           480  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
000011C0                           481  ; +---+---+---+---+---+---+---+---+
000011C0                           482  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
000011C0                           483  ; +---+---+---+---+---+---+---+---+
000011C0                           484  ;   |   |   |   |   |   |   |   |
000011C0                           485  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
000011C0                           486  ;   |   |   |   |   |   |   +-------------- UP BUTTON
000011C0                           487  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
000011C0                           488  ;   |   |   |   |   +---------------------- DOWN BUTTON
000011C0                           489  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
000011C0                           490  ;   |   |   +------------------------------ FIRE 2 BUTTON
000011C0                           491  ;   |   +---------------------------------- FIRE 3 BUTTON
000011C0                           492  ;   +-------------------------------------- PAUSE BUTTON
000011C0                           493  
000011C0  =00000001                494  KBDMSKLF    EQU     %00000001
000011C0  =00000002                495  KBDMSKUP    EQU     %00000010
000011C0  =00000004                496  KBDMSKRT    EQU     %00000100
000011C0  =00000008                497  KBDMSKDN    EQU     %00001000
000011C0  =00000010                498  KBDMSKF1    EQU     %00010000
000011C0  =00000020                499  KBDMSKF2    EQU     %00100000
000011C0  =00000040                500  KBDMSKF3    EQU     %01000000
000011C0  =00000080                501  KBDMSKPS    EQU     %10000000
000011C0                           502  
000011C0                           503  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
000011C0                           504  
000011C0  =00000000                505  KBDBITLF    EQU     0
000011C0  =00000001                506  KBDBITUP    EQU     1
000011C0  =00000002                507  KBDBITRT    EQU     2
000011C0  =00000003                508  KBDBITDN    EQU     3
000011C0  =00000004                509  KBDBITF1    EQU     4
000011C0  =00000005                510  KBDBITF2    EQU     5
000011C0  =00000006                511  KBDBITF3    EQU     6
000011C0  =00000007                512  KBDBITPS    EQU     7
000011C0                           513  
000011C0                           514  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
000011C0                           515  
000011C0  =00000280                516  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
000011C0  =000001E0                517  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
000011C0  =00000001                518  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
000011C0  =00000014                519  SCRTIM      EQU     20                      ; SCREEN TIMER (MS)
000011C0                           520  
000011C0                           521  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
000011C0                           522  
000011C0  =00000040                523  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
000011C0  =00000032                524  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
000011C0  =00000000                525  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
000011C0                           526  
000011C0                           527  
000011C0                           528  
000011C0                           529  
000011C0                           530  -------------------- end include --------------------
000011C0                           531              INCLUDE "CONST.X68"                  ; USER CONSTANTS
000011C0                           532  ; =============================================================================
000011C0                           533  ; SYSTEM CONSTANTS
000011C0                           534  ; =============================================================================
000011C0                           535  
000011C0                           536  ; --- GAME STATES -------------------------------------------------------------
000011C0                           537  
000011C0  =FFFFFFFF                538  STANONE     EQU     -1                      ; PLACEHOLDER TO FORCE CHANGE
000011C0  =00000000                539  STAINTR     EQU     0                       ; INTRO/PRESS FIRE STATE
000011C0  =00000001                540  STAPLAY     EQU     1                       ; NORMAL GAME STATE
000011C0  =00000002                541  STAPAU      EQU     2                       ; PAUSE GAME STATE
000011C0  =00000003                542  STAGOVR     EQU     3                       ; GAME OVER STATE
000011C0                           543  
000011C0                           544  ; --- AGENT & PROP TYPES -------------------------------------------------------------
000011C0                           545  
000011C0  =00000001                546  CLDTYPE     EQU     1                       ; NUMBER FOR CLOUD TYPES
000011C0  =00000002                547  GSSDTYPE    EQU     2                       ; NUMBER FOR GRASS DETAIL TYPES
000011C0  =00000003                548  PIPTYPE     EQU     3                       ; NUMBER FOR PIPE TYPES
000011C0                           549  
000011C0                           550  
000011C0                           551  ; --- INTRO STATE RELATED CONSTANTS -------------------------------------------
000011C0                           552  
000011C0  =00000001                553  INTTITX     EQU     1                       ; TITLE X COORDINATE
000011C0  =00000001                554  INTTITY     EQU     1                       ; TITLE Y COORDINATE
000011C0  =0000FFFF                555  INTTITC     EQU     $0000FFFF               ; TITLE COLOR
000011C0  =033D0001                556  INTTITF     EQU     $033D0001               ; TITLE FONT
000011C0  =00000005                557  INTPRSX     EQU     5                       ; PRESS FIRE X COORDINATE
000011C0  =00000008                558  INTPRSY     EQU     8                       ; PRESS FIRE Y COORDINATE
000011C0  =00000080                559  INTPRSC     EQU     $00000080               ; PRESS FIRE COLOR
000011C0  =031A0001                560  INTPRSF     EQU     $031A0001               ; PRESS FIRE FONT
000011C0                           561  
000011C0                           562  ; --- BACKGROUND RELATED CONSTANTS --------------------------------------------
000011C0                           563  
000011C0  =00000000                564  BGSKYPC     EQU     $00000000               ; BACKGROUND SKY PEN COLOUR
000011C0  =00EFCE87                565  BGSKYFC     EQU     $00EFCE87               ; BACKGROUND SKY FILL COLOUR
000011C0  =00000000                566  BGGSSPC     EQU     $00000000               ; BACKGROUND GRASS PEN COLOUR
000011C0  =0000990A                567  BGGSSFC     EQU     $0000990A               ; BACKGROUND GRASS FILL COLOUR
000011C0  =00000168                568  BGGSSTP     EQU     SCRHEIGH*3/4            ; GRASS TOP EDGE (Y) COORDINATE
000011C0  =00000190                569  BGGSSBT     EQU     BGGSSTP+40              ; GRASS BOTTOM EDGE (Y) COORDINATE
000011C0  =0000000A                570  GSSDWDTH    EQU     10                      ; GRASS DETAIL WIDTH
000011C0  =0039DB44                571  GSSDFC      EQU     $0039DB44               ; BACKGROUND GRASS DETAIL F.COLOUR
000011C0  =00000000                572  BGGNDPC     EQU     $00000000               ; BACKGROUND GROUND PEN COLOUR
000011C0  =00155DD8                573  BGGNDFC     EQU     $00155DD8               ; BACKGROUND GROUND FILL COLOUR
000011C0  =00000190                574  BGGNDTP     EQU     BGGSSBT                 ; GROUND TOP EDGE (Y) COORDINATE
000011C0                           575  
000011C0                           576  ; --- PLAYER RELATED CONSTANTS ------------------------------------------------
000011C0                           577  
000011C0                           578        ;Player colours
000011C0                           579  
000011C0  =00008000                580  GREEN EQU $00008000                         ;GREEN COLOR
000011C0  =000000FF                581  RED   EQU $000000FF                         ;RED COLOR
000011C0  =00FFFFFF                582  WHITE EQU $00FFFFFF                         ;WHITE COLOR
000011C0  =00000000                583  BLACK EQU $00000000                         ;BLACK COLOR
000011C0                           584  
000011C0                           585        ;Constants
000011C0                           586        
000011C0  =00008000                587  PLRCOLOR        EQU GREEN                   ;PLAYER COLOR
000011C0  =00FFFFFF                588  PLREYECOLOR     EQU WHITE                   ;PLAYER EYE COLOR
000011C0  =00000000                589  PLRIRISCOLOR    EQU BLACK                   ;PLAYER IRIS COLOR
000011C0  =000000FF                590  PLRMOUTHCOLOR   EQU RED                     ;PLAYER MOUTH COLOR
000011C0  =0000001E                591  PLRWIDTH        EQU 30                      ;PLAYER WIDTH
000011C0  =0000001E                592  PLRHEIGHT       EQU 30                      ;PLAYER HEIGHT
000011C0  =00000096                593  PLRINITPOSX     EQU 150                     ;INITIAL POSITION OF THE PLAYER (X)
000011C0  =000000B4                594  PLRINITPOSY     EQU 180                     ;INITIAL POSITION OF THE PLAYER (Y)
000011C0  =0000003C                595  JUMPSIZE        EQU 60                      ;JUMP SIZE
000011C0  =00000003                596  JUMPSPEED       EQU 3                       ;JUMP SPEED (BIG VALUE = SLOW SPEED).
000011C0                           597  
000011C0                           598  ; --- PIPE RELATED CONSTANTS --------------------------------------------------
000011C0                           599  
000011C0  =00000000                600  PIPPC       EQU     $00000000               ; PIPE PEN COLOUR
000011C0  =00196600                601  PIPFC       EQU     $00196600               ; PIPE FILL COLOUR
000011C0  =00000032                602  PIPBWDT     EQU     50                      ; PIPE BASE WIDTH
000011C0  =0000003C                603  PIPTWDT     EQU     60                      ; PIPE MOUTH WIDTH
000011C0  =0000000A                604  PIPTHGT     EQU     10                      ; PIPE MOUTH HEIGHT
000011C0  =00000005                605  PIPTBSPC    EQU     ((PIPTWDT-PIPBWDT)/2)   ; DIF.BETW. OUTER RAD. & IN. RAD
000011C0  =00000050                606  PIPOPEN     EQU     80                      ; SPACE BETW. TOP AND BOTTOM PIPES
000011C0  =00000002                607  PIPYSPD     EQU     2                       ; SPEED @ WHICH PIPES GO UP&DOWN
000011C0                           608  
000011C0                           609  ; --- CLOUD RELATED CONSTANTS -------------------------------------------------
000011C0                           610  
000011C0  =0000003C                611  CLDSIZE     EQU     60                      ; CLOUD DIAMETER
000011C0  =00FFFFFF                612  CLDPCLR     EQU     $00FFFFFF               ; CLOUD PEN COLOR
000011C0  =00FFFFFF                613  CLDFCLR     EQU     $00FFFFFF               ; CLOUD FIL COLOR
000011C0                           614  
000011C0                           615  ; --- PAUSE STATE RELATED CONSTANTS ---------------------------------------
000011C0                           616  
000011C0  =00000000                617  CONTNUM     EQU     0                       ; CONTINUE GAME NUMBER
000011C0  =00000001                618  NEWGNUM     EQU     1                       ; NEW GAME NUMBER
000011C0  =00000002                619  EXTNUM      EQU     2                       ; EXIT GAME NUMBER
000011C0  =0000FFFF                620  PAUTITC     EQU     $0000FFFF               ; TITLE COLOUR
000011C0  =03300001                621  PAUTITF     EQU     $03300001               ; TITLE FONT
000011C0  =01130001                622  PAUOPTFU    EQU     $01130001               ; OPTION FONT (unselected)
000011C0  =01130005                623  PAUOPTFS    EQU     $01130005               ; OPTION FONT (selected)
000011C0  =00FFFFFF                624  PAUOPTC     EQU     $00FFFFFF               ; OPTION COLOUR
000011C0  =00000002                625  PAUTITX     EQU     2                       ; TITLE COORD. X
000011C0  =00000001                626  PAUTITY     EQU     1                       ; TITLE COORD. Y
000011C0  =0000000F                627  PAUOPTX     EQU     15                      ; OPTIONS COORD. X
000011C0  =00000008                628  PAUCNTY     EQU     8                       ; CONTINUE OPTION COORD. Y
000011C0  =0000000A                629  PAUNEWY     EQU     10                      ; NEW GAME OPTION COORD. Y
000011C0  =0000000C                630  PAUEXTY     EQU     12                      ; EXIT OPTION COORD. Y
000011C0  =000000FF                631  PAUSELC     EQU     $000000FF               ; SELECTED OPTION COLOUR
000011C0                           632  
000011C0                           633  ; --- GAME OVER STATE RELATED CONSTANTS ---------------------------------------
000011C0                           634  
000011C0  =00000023                635  GOVSTRX     EQU     35                      ; TITLE X COORDINATE
000011C0  =0000000F                636  GOVSTRY     EQU     15                      ; TITLE Y COORDINATE
000011C0  =00FFFFFF                637  GOVSTRC     EQU     $00FFFFFF               ; TITLE COLOR
000011C0                           638  
000011C0                           639  
000011C0                           640  
000011C0                           641  
000011C0                           642  
000011C0                           643  
000011C0                           644  
000011C0                           645  
000011C0                           646  
000011C0                           647  
000011C0                           648  
000011C0                           649  
000011C0                           650  
000011C0                           651  
000011C0                           652  
000011C0                           653  
000011C0                           654  
000011C0                           655  
000011C0                           656  
000011C0                           657  
000011C0                           658  
000011C0                           659  
000011C0                           660  
000011C0                           661  
000011C0                           662  
000011C0                           663  
000011C0                           664  
000011C0                           665  
000011C0                           666  
000011C0                           667  
000011C0                           668  
000011C0                           669  
000011C0                           670  -------------------- end include --------------------
000011C0                           671              INCLUDE "PLAYER.X68"
000011C0                           672  ; =============================================================================
000011C0                           673  ; PLAYER MANAGEMENT
000011C0                           674  ; =============================================================================
000011C0                           675  
000011C0                           676  ; -----------------------------------------------------------------------------
000011C0                           677  PLRINIT
000011C0                           678  ; INITIALIZES THE PLAYER
000011C0                           679  ; INPUT    - NONE
000011C0                           680  ; OUTPUT   - NONE
000011C0                           681  ; MODIFIES - NONE
000011C0                           682  ; -----------------------------------------------------------------------------
000011C0                           683  
000011C0  33FC 0096 00001BDE       684          MOVE.W #PLRINITPOSX,(PLRPOSX)
000011C8  33FC 00B4 00001BE0       685          MOVE.W #PLRINITPOSY,(PLRPOSY)
000011D0  33FC 00B4 00001BE2       686          MOVE.W #PLRINITPOSY,(MAXPOS)
000011D8  33FC 0000 00001BE4       687          MOVE.W #0, (UPPRESSED)
000011E0  33FC 0001 00001BE6       688          MOVE.W #1, (PLRDOWNSPEED)
000011E8  4E75                     689          RTS
000011EA                           690  ; -----------------------------------------------------------------------------
000011EA                           691  PLRUPD
000011EA                           692  ; UPDATES THE PLAYER MOTION
000011EA                           693  ; INPUT    - NONE (ACCESSES KBDEDGE)
000011EA                           694  ; OUTPUT   - NONE (MODIFIES PLAYER DATA)
000011EA                           695  ; MODIFIES - NONE
000011EA                           696  ; -----------------------------------------------------------------------------
000011EA  48E7 C000                697            MOVEM.L D0/D1,-(A7)
000011EE  0839 0001 00001BEF       698            BTST.B #KBDBITUP, (KBDEDGE)    
000011F6  6600 0038                699            BNE.L  .PRESSED
000011FA                           700          
000011FA                           701            ;TECLA NO PRESIONADA
000011FA  0C79 0001 00001BE4       702            CMP #1, (UPPRESSED)
00001202  6700 0050                703            BEQ .MAKEJUMP
00001206                           704            ;No se ha apretado la tecla UP. Hay que bajar el pájaro. 
00001206  3039 00001BE0            705            MOVE.W (PLRPOSY), D0
0000120C  D079 00001BE6            706            ADD.W (PLRDOWNSPEED), D0
00001212                           707            ;Se incrementa la velocidad de bajada. 
00001212  5279 00001BE6            708            ADDQ #1, (PLRDOWNSPEED)
00001218  33C0 00001BE0            709            MOVE.W D0, (PLRPOSY)
0000121E                           710            ;Comprobar si ha salido por la parte inferior
0000121E  323C 0168                711            MOVE.W #BGGSSTP, D1
00001222  0640 001E                712            ADD.W #PLRHEIGHT, D0
00001226  B240                     713            CMP D0, D1
00001228  6B00 006A                714            BMI .GAMEOVER         
0000122C                           715         
0000122C  6000 0072                716            BRA .END         
00001230                           717  .PRESSED
00001230                           718            ;TECLA UP PRESIONADA
00001230                           719            ;Se reinicia la velocidad de bajada. 
00001230  33FC 0001 00001BE6       720            MOVE.W #1, (PLRDOWNSPEED)
00001238                           721  
00001238                           722            ;Se establece el límite hasta donde subirá
00001238  3039 00001BE0            723            MOVE.W (PLRPOSY), D0
0000123E  0440 003C                724            SUB.W #JUMPSIZE, D0
00001242  33C0 00001BE2            725            MOVE.W D0, (MAXPOS)
00001248                           726            ;Se indica que se ha presionado la tecla de salto
00001248  33FC 0001 00001BE4       727            MOVE.W #1, (UPPRESSED)
00001250                           728            
00001250  6000 004E                729            BRA .END   
00001254                           730        
00001254                           731  .MAKEJUMP
00001254                           732            ;Se ha apretado la tecla UP anteriormente (eso indica que el salto no
00001254                           733            ; ha finalizado). 
00001254                           734            
00001254  3039 00001BE0            735            MOVE.W (PLRPOSY), D0
0000125A  3239 00001BE2            736            MOVE.W (MAXPOS), D1
00001260  9041                     737            SUB.W  D1, D0             ;FÓRMULA: (PLRPOSY-MAXPOS)/JUMPSPEED = VALOR QUE SE TIENE QUE RESTAR A LA POSICIÓN ACTUAL PARA OBTENER LA NUEVA POSICIÓN
00001262  80FC 0003                738            DIVU.W #JUMPSPEED, D0
00001266  9179 00001BE0            739            SUB.W D0, (PLRPOSY)       ;NEWPOS
0000126C                           740            ;Ver si ha salido por la parte superior. 
0000126C  0C79 0000 00001BE0       741            CMP #0, (PLRPOSY)
00001274  6B00 001E                742            BMI .GAMEOVER
00001278  B07C 0001                743            CMP #1, D0
0000127C  6B00 000A                744            BMI .LASTJUMP
00001280  6700 0006                745            BEQ .LASTJUMP
00001284                           746            ;El salto no ha finalizado (No ha llegado a MAXPOS)
00001284                           747                                
00001284                           748            
00001284  6000 001A                749            BRA .END
00001288                           750            
00001288                           751  .LASTJUMP
00001288                           752            ;El salto ha llegado a MAXPOS
00001288                           753            ;Se desactiva la tecla UP indicando que lo siguiente será realizar la bajada. 
00001288  33FC 0000 00001BE4       754            MOVE.W #0, (UPPRESSED)         
00001290  6000 000E                755            BRA .END    
00001294                           756            
00001294                           757  .GAMEOVER
00001294                           758  
00001294  33FC 0003 00001BDC       759            MOVE.W #STAGOVR, (STANEXT)        
0000129C  6000 0002                760            BRA .END         
000012A0                           761                   
000012A0                           762  .END
000012A0                           763            
000012A0  4CDF 0003                764            MOVEM.L (A7)+,D0/D1
000012A4  4E75                     765            RTS
000012A6                           766            
000012A6                           767  ; -----------------------------------------------------------------------------
000012A6                           768  PLRPLOT
000012A6                           769  ; PLOTS THE PLAYER
000012A6                           770  ; INPUT    - NONE
000012A6                           771  ; OUTPUT   - NONE
000012A6                           772  ; MODIFIES - NONE
000012A6                           773  ; -----------------------------------------------------------------------------
000012A6                           774  
000012A6  48E7 FC00                775              MOVEM.L D0-D5,-(A7)
000012AA                           776  
000012AA                           777  
000012AA                           778              ;SET PLAYER COLOR 
000012AA  223C 00008000            779              MOVE.L  #PLRCOLOR,D1
000012B0  103C 0050                780              MOVE.B  #80,D0
000012B4  4E4F                     781              TRAP    #15
000012B6  5200                     782              ADDQ.B  #1,D0
000012B8  4E4F                     783              TRAP    #15
000012BA                           784              
000012BA                           785              ;SET PLAYER POSITION
000012BA  3239 00001BDE            786              MOVE.W  (PLRPOSX),D1            
000012C0  3439 00001BE0            787              MOVE.W  (PLRPOSY),D2
000012C6  3601                     788              MOVE.W  D1,D3
000012C8  3802                     789              MOVE.W  D2,D4
000012CA                           790              
000012CA                           791              ;SET PLAYER WIDTH AND HEIGHT
000012CA  0643 001E                792              ADD.W   #PLRWIDTH,D3
000012CE  0644 001E                793              ADD.W   #PLRHEIGHT,D4
000012D2  103C 0058                794              MOVE.B  #88,D0
000012D6  4E4F                     795              TRAP    #15
000012D8                           796              
000012D8                           797              
000012D8  0443 000F                798              SUB.W   #PLRWIDTH/2,D3
000012DC  103C 0057                799              MOVE.B  #87,D0
000012E0  4E4F                     800              TRAP    #15
000012E2                           801              
000012E2                           802              ;---------EYE---------
000012E2                           803                               
000012E2                           804              ;SET EYE COLOR
000012E2  7051                     805              MOVE.L  #81, D0
000012E4  223C 00FFFFFF            806              MOVE.L  #PLREYECOLOR, D1
000012EA  4E4F                     807              TRAP    #15
000012EC                           808              
000012EC  3239 00001BDE            809              MOVE.W  PLRPOSX,D1   
000012F2                           810              
000012F2                           811              ;EYE WIDTH         
000012F2  5A41                     812              ADD.W   #PLRWIDTH-25,D1
000012F4  3639 00001BDE            813              MOVE.W  (PLRPOSX),D3
000012FA                           814              
000012FA                           815              ;EYE POSX
000012FA  0643 0014                816              ADD.W   #PLRWIDTH-10,D3
000012FE  3439 00001BE0            817              MOVE.W (PLRPOSY),D2
00001304                           818              
00001304                           819              ;EYE POSY
00001304  0642 000A                820              ADD.W   #PLRHEIGHT/2-5,D2
00001308  3839 00001BE0            821              MOVE.W  (PLRPOSY),D4
0000130E                           822             
0000130E                           823              ;EYE HEIGHT 
0000130E  0644 FFF6                824              ADD.W   #PLRHEIGHT/2-25,D4
00001312  103C 0058                825              MOVE.B  #88,D0
00001316  4E4F                     826              TRAP    #15
00001318                           827              
00001318                           828              
00001318                           829             ;---------MOUTH------
00001318                           830                                 
00001318                           831              ;SET MOUTH COLOR
00001318  7051                     832              MOVE.L  #81, D0
0000131A  223C 000000FF            833              MOVE.L  #RED, D1
00001320  4E4F                     834              TRAP    #15
00001322                           835              
00001322                           836                 
00001322  3239 00001BDE            837              MOVE.W  (PLRPOSX),D1   
00001328                           838              
00001328                           839              ;EYE WIDTH         
00001328  0641 001D                840              ADD.W   #PLRWIDTH-1,D1
0000132C  3639 00001BDE            841              MOVE.W  (PLRPOSX),D3
00001332                           842              
00001332                           843              ;EYE POSX
00001332  0643 000A                844              ADD.W   #PLRWIDTH-20,D3
00001336  3439 00001BE0            845              MOVE.W  (PLRPOSY),D2
0000133C                           846              
0000133C                           847              ;EYE POSY
0000133C  0642 0019                848              ADD.W   #PLRHEIGHT-5,D2
00001340  3839 00001BE0            849              MOVE.W  (PLRPOSY),D4
00001346                           850             
00001346                           851              ;EYE HEIGHT 
00001346  0644 000F                852              ADD.W   #PLRHEIGHT-15,D4
0000134A  103C 0058                853              MOVE.B  #88,D0
0000134E  4E4F                     854              TRAP    #15
00001350                           855              
00001350                           856  
00001350                           857              
00001350  4CDF 003F                858              MOVEM.L (A7)+,D0-D5
00001354                           859              
00001354  4E75                     860              RTS
00001356                           861  
00001356                           862  
00001356                           863  -------------------- end include --------------------
00001356                           864              INCLUDE "UTIL.X68"                   ; UTILITY MACRO AND SUBROUTINES
00001356                           865  ; =============================================================================
00001356                           866  ; UTILITY MACROS
00001356                           867  ; =============================================================================
00001356                           868  
00001356                           869  ; -----------------------------------------------------------------------------
00001356                           870  UTLSPEN     MACRO
00001356                           871  ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001356                           872  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
00001356                           873  ; OUTPUT   - NONE
00001356                           874  ; MODIFIES - D0,D1
00001356                           875  ; -----------------------------------------------------------------------------
00001356                           876              MOVE.B  #80,D0
00001356                           877              MOVE.L  \1,D1
00001356                           878              TRAP    #15
00001356                           879              ENDM
00001356                           880  
00001356                           881  ; -----------------------------------------------------------------------------
00001356                           882  UTLSFIL     MACRO
00001356                           883  ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001356                           884  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
00001356                           885  ; OUTPUT   - NONE
00001356                           886  ; MODIFIES - D0,D1
00001356                           887  ; -----------------------------------------------------------------------------
00001356                           888              MOVE.B  #81,D0
00001356                           889              MOVE.L  \1,D1
00001356                           890              TRAP    #15
00001356                           891              ENDM
00001356                           892  
00001356                           893  ; -----------------------------------------------------------------------------
00001356                           894  UTLLOCT     MACRO
00001356                           895  ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001356                           896  ; INPUT    - \1 X, \2 Y
00001356                           897  ; OUTPUT   - NONE
00001356                           898  ; MODIFIES - D0,D1
00001356                           899  ; -----------------------------------------------------------------------------
00001356                           900              MOVE.W  #\1<<8|\2, D1
00001356                           901              MOVE.B  #11,D0
00001356                           902              TRAP    #15
00001356                           903              ENDM
00001356                           904  
00001356                           905  ; -----------------------------------------------------------------------------
00001356                           906  UTLFONT     MACRO
00001356                           907  ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001356                           908  ; INPUT    - \1 COLOR, \2 FONT
00001356                           909  ; OUTPUT   - NONE
00001356                           910  ; MODIFIES - D0,D1,D2
00001356                           911  ; -----------------------------------------------------------------------------
00001356                           912              MOVE.L  #\1,D1
00001356                           913              MOVE.L  #\2,D2
00001356                           914              MOVEQ   #21,D0
00001356                           915              TRAP    #15
00001356                           916              ENDM
00001356                           917  
00001356                           918  ; =============================================================================
00001356                           919  ; UTILITY SUBROUTINES
00001356                           920  ; =============================================================================
00001356                           921  
00001356                           922  ; -----------------------------------------------------------------------------
00001356                           923  UTLINIT
00001356                           924  ; INITIALIZES UTILITY CODE
00001356                           925  ; INPUT    - NONE
00001356                           926  ; OUTPUT   - NONE
00001356                           927  ; MODIFIES - NONE
00001356                           928  ; -----------------------------------------------------------------------------
00001356  4239 00001BED            929              CLR.B   (UTLRNDIX)
0000135C  4E75                     930              RTS
0000135E                           931  ; -----------------------------------------------------------------------------
0000135E                           932  UTLCHCOL
0000135E                           933  ; CHECKS COLLISION
0000135E                           934  ; INPUT    - D0.W X0 COORDINATE
0000135E                           935  ;            D1.W Y0 COORDINATE
0000135E                           936  ;            D2.W X1 COORDINATE
0000135E                           937  ;            D3.W Y1 COORDINATE
0000135E                           938  ;            D4.W WIDTH 0
0000135E                           939  ;            D5.W WIDTH 1
0000135E                           940  ;            D6.W HEIGHT 0
0000135E                           941  ;            D7.W HEIGHT 1
0000135E                           942  ; OUTPUT   - D0.B=FF - COLLISION, =0 - NO COLLISION
0000135E                           943  ; MODIFIES - NONE
0000135E                           944  ; -----------------------------------------------------------------------------
0000135E  48A7 0F00                945              MOVEM.W D4-D7,-(A7)
00001362  D840                     946              ADD.W   D0,D4
00001364  B842                     947              CMP.W   D2,D4
00001366  6F00 0022                948              BLE     .NOCOL
0000136A  DA42                     949              ADD.W   D2,D5
0000136C  BA40                     950              CMP.W   D0,D5
0000136E  6F00 001A                951              BLE     .NOCOL
00001372  DC41                     952              ADD.W   D1,D6
00001374  BC43                     953              CMP.W   D3,D6
00001376  6F00 0012                954              BLE     .NOCOL
0000137A  DE43                     955              ADD.W   D3,D7
0000137C  BE41                     956              CMP.W   D1,D7
0000137E  6F00 000A                957              BLE     .NOCOL
00001382  103C 00FF                958              MOVE.B  #$FF,D0
00001386  6000 0004                959              BRA     .END
0000138A  4200                     960  .NOCOL      CLR.B   D0
0000138C  4C9F 00F0                961  .END        MOVEM.W (A7)+,D4-D7
00001390  4E75                     962              RTS
00001392                           963  
00001392                           964  ; -----------------------------------------------------------------------------
00001392                           965  UTLRAND
00001392                           966  ; PROVIDES A PSEUDO-RANDOM BYTE
00001392                           967  ; INPUT    - NONE
00001392                           968  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001392                           969  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001392                           970  ; -----------------------------------------------------------------------------
00001392  2F08                     971              MOVE.L  A0,-(A7)
00001394  41F9 000013B0            972              LEA     .RANDVEC,A0
0000139A  4280                     973              CLR.L   D0
0000139C  1039 00001BED            974              MOVE.B  (UTLRNDIX),D0
000013A2  1030 0800                975              MOVE.B  (A0,D0.L),D0
000013A6  5239 00001BED            976              ADDQ.B  #1,(UTLRNDIX)
000013AC  205F                     977              MOVE.L  (A7)+,A0
000013AE  4E75                     978              RTS
000013B0                           979  
000013B0                           980  
000013B0= A2 EE 9A 0C F5 24 ...    981  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000013B8= 2A A3 51 26 E0 AC ...    982              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
000013C0= 75 51 CA FD 33 EB ...    983              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
000013C8= 60 CC E7 B8 9A EB ...    984              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000013D0= 1D 76 B5 95 B0 89 ...    985              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000013D8= 39 15 48 C9 6E CA ...    986              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
000013E0= 43 E7 E2 7C 37 25 ...    987              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
000013E8= E9 94 CE E9 E4 52 ...    988              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
000013F0= 37 6D 9A 84 A2 28 ...    989              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
000013F8= 19 E2 C6 77 80 D4 ...    990              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001400= 0A 5A 32 67 33 C2 ...    991              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001408= 59 80 DC 0E 57 FC ...    992              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001410= 8A AB BC F7 07 4D ...    993              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001418= EF D5 77 6E 1E BB ...    994              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001420= D6 E0 2A 8F BD 28 ...    995              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001428= 13 4F 66 EC 0A 64 ...    996              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001430= 56 52 9A 16 9B 90 ...    997              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001438= 06 8A A4 F7 01 DA ...    998              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001440= F2 E7 77 28 B1 76 ...    999              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001448= A4 42 E3 81 B1 67 ...   1000              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001450= BF CE FA 16 BF 38 ...   1001              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001458= D1 8B 50 0C 5F 49 ...   1002              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001460= DE 4C 14 A2 40 DC ...   1003              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001468= B6 9B 0A 38 5D AB ...   1004              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001470= E2 1B DD 75 15 82 ...   1005              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001478= 8A 26 51 30 9F 47 ...   1006              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
00001480= 1E 8A BB 71 C6 6E ...   1007              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001488= 9F 47 E5 34 94 27 ...   1008              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
00001490= 7D 06 D6 BA 30 0F ...   1009              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001498= EC 7F 7E 03 CF 2D ...   1010              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
000014A0= 94 5B 23 F2 8B CD ...   1011              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000014A8= 74 33 EC B9 0F D5 ...   1012              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
000014B0                          1013  
000014B0                          1014  
000014B0                          1015  -------------------- end include --------------------
000014B0                          1016              INCLUDE "AGENTLST.X68"               ; AGENT LIST MANAGEMENT
000014B0                          1017  ; =============================================================================
000014B0                          1018  ; AGENT MANAGEMENT
000014B0                          1019  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000014B0                          1020  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000014B0                          1021  ; +4 - LONG : PLOT SUBROUTINE POINTER
000014B0                          1022  ; +8:END    : DATA (AGENT SPECIFIC)
000014B0                          1023  ; =============================================================================
000014B0                          1024  
000014B0                          1025  ; -----------------------------------------------------------------------------
000014B0                          1026  AGLADD
000014B0                          1027  ; CREATES A NEW AGENT
000014B0                          1028  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000014B0                          1029  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000014B0                          1030  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000014B0                          1031  ;            D0 - AGENT TYPE (USED AS OWNED BY DMM)
000014B0                          1032  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000014B0                          1033  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000014B0                          1034  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000014B0                          1035  ; OUTPUT   - NONE
000014B0                          1036  ; MODIFIES - NONE
000014B0                          1037  ; -----------------------------------------------------------------------------
000014B0  2F08                    1038              MOVE.L  A0,-(A7)
000014B2                          1039              
000014B2  4EB8 1190               1040              JSR     DMMALLOC
000014B6  B1FC 00000000           1041              CMP.L   #0,A0
000014BC  6700 0008               1042              BEQ     .END
000014C0  20CA                    1043              MOVE.L  A2,(A0)+
000014C2  20CB                    1044              MOVE.L  A3,(A0)+
000014C4  4E91                    1045              JSR     (A1)
000014C6                          1046  
000014C6  205F                    1047  .END        MOVE.L  (A7)+,A0
000014C8  4E75                    1048              RTS
000014CA                          1049  
000014CA                          1050  ; -----------------------------------------------------------------------------
000014CA                          1051  AGLUPD
000014CA                          1052  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000014CA                          1053  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000014CA                          1054  ; INPUT    - NONE
000014CA                          1055  ; OUTPUT   - NONE
000014CA                          1056  ; MODIFIES - NONE
000014CA                          1057  ; -----------------------------------------------------------------------------
000014CA  48E7 00C0               1058              MOVEM.L A0-A1,-(A7)
000014CE                          1059              
000014CE  4EB8 1120               1060              JSR     DMMFIRST
000014D2  B1FC 00000000           1061  .LOOP       CMP.L   #0,A0
000014D8  6700 001E               1062              BEQ     .END
000014DC  0C68 0002 FFFE          1063              CMP.W   #GSSDTYPE,-2(A0)    ;IF MEMORY DOESN'T BELONG TO AGENT
000014E2  670E                    1064              BEQ.S   .NEXT               ;SKIP
000014E4  0C68 0001 FFFE          1065              CMP.W   #CLDTYPE,-2(A0)
000014EA  6706                    1066              BEQ.S   .NEXT
000014EC                          1067              
000014EC  2250                    1068              MOVE.L  (A0),A1
000014EE  5088                    1069              ADD.L   #8,A0
000014F0  4E91                    1070              JSR     (A1)
000014F2  4EB8 1142               1071  .NEXT       JSR     DMMNEXT
000014F6  60DA                    1072              BRA     .LOOP
000014F8                          1073              
000014F8  4CDF 0300               1074  .END        MOVEM.L (A7)+,A0-A1            
000014FC  4E75                    1075              RTS
000014FE                          1076  
000014FE                          1077  ; -----------------------------------------------------------------------------
000014FE                          1078  AGLPLOT
000014FE                          1079  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000014FE                          1080  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000014FE                          1081  ; INPUT    - NONE
000014FE                          1082  ; OUTPUT   - NONE
000014FE                          1083  ; MODIFIES - NONE
000014FE                          1084  ; -----------------------------------------------------------------------------
000014FE  48E7 00C0               1085              MOVEM.L A0-A1,-(A7)
00001502                          1086  
00001502  4EB8 1120               1087              JSR     DMMFIRST
00001506  B1FC 00000000           1088  .LOOP       CMP.L   #0,A0
0000150C  6700 0020               1089              BEQ     .END
00001510  0C68 0002 FFFE          1090              CMP.W   #GSSDTYPE,-2(A0)    ;IF MEMORY DOESN'T BELONG TO AGENT
00001516  6710                    1091              BEQ.S   .NEXT               ;SKIP
00001518  0C68 0001 FFFE          1092              CMP.W   #CLDTYPE,-2(A0)
0000151E  6708                    1093              BEQ.S   .NEXT
00001520                          1094              
00001520  2268 0004               1095              MOVE.L  4(A0),A1
00001524  5088                    1096              ADD.L   #8,A0
00001526  4E91                    1097              JSR     (A1)
00001528  4EB8 1142               1098  .NEXT       JSR     DMMNEXT
0000152C  60D8                    1099              BRA     .LOOP
0000152E  4CDF 0300               1100  .END        MOVEM.L (A7)+,A0-A1
00001532                          1101  
00001532  4E75                    1102              RTS
00001534                          1103  
00001534                          1104  ; -----------------------------------------------------------------------------
00001534  =000011AA               1105  AGLKILL     EQU     DMMFREE
00001534                          1106  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001534                          1107  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001534                          1108  ; OUTPUT   - NONE
00001534                          1109  ; MODIFIES - NONE
00001534                          1110  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001534                          1111  ; -----------------------------------------------------------------------------
00001534                          1112  
00001534                          1113  
00001534                          1114  
00001534                          1115  
00001534                          1116  
00001534                          1117  
00001534                          1118  
00001534                          1119  
00001534                          1120  
00001534                          1121  
00001534                          1122  
00001534                          1123  -------------------- end include --------------------
00001534                          1124              INCLUDE "PROPLST.X68"                ; PROPS LIST MANAGEMENT
00001534                          1125  ; =============================================================================
00001534                          1126  ; PROP MANAGEMENT
00001534                          1127  ; EACH PROP HAS A DATA BLOCK FROM DMM AS FOLLOWS:
00001534                          1128  ; +0 - LONG : UPDATE SUBROUTINE POINTER
00001534                          1129  ; +4 - LONG : PLOT SUBROUTINE POINTER
00001534                          1130  ; +8:END    : DATA (PROP SPECIFIC)
00001534                          1131  ; =============================================================================
00001534                          1132  
00001534                          1133  ; -----------------------------------------------------------------------------
00001534                          1134  PRPADD
00001534                          1135  ; CREATES A NEW PROP
00001534                          1136  ; INPUT    - A1 - POINTER TO PROP INIT FUNCTION
00001534                          1137  ;            A2 - POINTER TO PROP UPDATE FUNCTION
00001534                          1138  ;            A3 - POINTER TO PROP PLOT FUNCTION
00001534                          1139  ;            D0 - PROP TYPE (USED AS OWNED BY DMM)
00001534                          1140  ;            D1 - PROP INITIALIZATION PARAMETER 1
00001534                          1141  ;            D2 - PROP INITIALIZATION PARAMETER 2
00001534                          1142  ;            D3 - PROP INITIALIZATION PARAMETER 3
00001534                          1143  ; OUTPUT   - NONE
00001534                          1144  ; MODIFIES - NONE
00001534                          1145  ; -----------------------------------------------------------------------------
00001534  2F08                    1146              MOVE.L  A0,-(A7)
00001536                          1147              
00001536  4EB8 1190               1148              JSR     DMMALLOC
0000153A  B1FC 00000000           1149              CMP.L   #0,A0
00001540  6700 0008               1150              BEQ     .END
00001544  20CA                    1151              MOVE.L  A2,(A0)+
00001546  20CB                    1152              MOVE.L  A3,(A0)+
00001548  4E91                    1153              JSR     (A1)
0000154A                          1154  
0000154A  205F                    1155  .END        MOVE.L  (A7)+,A0
0000154C  4E75                    1156              RTS
0000154E                          1157  
0000154E                          1158  ; -----------------------------------------------------------------------------
0000154E                          1159  PRPUPD
0000154E                          1160  ; UPDATES THE PROP LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
0000154E                          1161  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
0000154E                          1162  ; INPUT    - NONE
0000154E                          1163  ; OUTPUT   - NONE
0000154E                          1164  ; MODIFIES - NONE
0000154E                          1165  ; -----------------------------------------------------------------------------
0000154E  48E7 00C0               1166              MOVEM.L A0-A1,-(A7)
00001552                          1167              
00001552  4EB8 1120               1168              JSR     DMMFIRST
00001556  B1FC 00000000           1169  .LOOP       CMP.L   #0,A0
0000155C  6700 0018               1170              BEQ     .END
00001560  0C68 0003 FFFE          1171              CMP.W   #PIPTYPE,-2(A0) ;IF MEMORY DOESN'T BELONG TO PROPS
00001566  6700 0008               1172              BEQ     .NEXT           ;SKIP
0000156A                          1173              
0000156A  2250                    1174              MOVE.L  (A0),A1
0000156C  5088                    1175              ADD.L   #8,A0
0000156E  4E91                    1176              JSR     (A1)
00001570                          1177              
00001570  4EB8 1142               1178  .NEXT       JSR     DMMNEXT
00001574  60E0                    1179              BRA     .LOOP
00001576                          1180              
00001576  4CDF 0300               1181  .END        MOVEM.L (A7)+,A0-A1            
0000157A  4E75                    1182              RTS
0000157C                          1183              
0000157C                          1184  ; -----------------------------------------------------------------------------
0000157C                          1185  PRPPLOT
0000157C                          1186  ; PLOTS THE PROP LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
0000157C                          1187  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
0000157C                          1188  ; INPUT    - NONE
0000157C                          1189  ; OUTPUT   - NONE
0000157C                          1190  ; MODIFIES - NONE
0000157C                          1191  ; -----------------------------------------------------------------------------
0000157C  48E7 00C0               1192              MOVEM.L A0-A1,-(A7)
00001580                          1193  
00001580  4EB8 1120               1194              JSR     DMMFIRST
00001584  B1FC 00000000           1195  .LOOP       CMP.L   #0,A0
0000158A  6700 0018               1196              BEQ     .END
0000158E  0C68 0003 FFFE          1197              CMP.W   #PIPTYPE,-2(A0)     ;IF MEMORY DOESN'T BELONG TO PROP
00001594  6708                    1198              BEQ.S   .NEXT               ;SKIP
00001596                          1199              
00001596  2268 0004               1200              MOVE.L  4(A0),A1
0000159A  5088                    1201              ADD.L   #8,A0
0000159C  4E91                    1202              JSR     (A1)
0000159E  4EB8 1142               1203  .NEXT       JSR     DMMNEXT
000015A2  60E0                    1204              BRA     .LOOP
000015A4  4CDF 0300               1205  .END        MOVEM.L (A7)+,A0-A1
000015A8                          1206  
000015A8  4E75                    1207              RTS
000015AA                          1208  
000015AA                          1209  ; -----------------------------------------------------------------------------
000015AA  =000011AA               1210  PRPKILL     EQU     DMMFREE
000015AA                          1211  ; KILLS THE PRP BY RELEASING ITS MEMORY
000015AA                          1212  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
000015AA                          1213  ; OUTPUT   - NONE
000015AA                          1214  ; MODIFIES - NONE
000015AA                          1215  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
000015AA                          1216  ; -----------------------------------------------------------------------------
000015AA                          1217  
000015AA                          1218  
000015AA                          1219  
000015AA                          1220  
000015AA                          1221  
000015AA                          1222  
000015AA                          1223  
000015AA                          1224  
000015AA                          1225  
000015AA                          1226  
000015AA                          1227  
000015AA                          1228  
000015AA                          1229  
000015AA                          1230  
000015AA                          1231  -------------------- end include --------------------
000015AA                          1232              INCLUDE "SPAWNER.X68"                ; SPAWNER
000015AA                          1233  ; =============================================================================
000015AA                          1234  ; SPAWNER MANAGEMENT.
000015AA                          1235  ; =============================================================================
000015AA                          1236  
000015AA                          1237  ; -----------------------------------------------------------------------------
000015AA                          1238  SPWUPD
000015AA                          1239  ; UPDATES THE SPAWNER
000015AA                          1240  ; INPUT    - NONE
000015AA                          1241  ; OUTPUT   - NONE
000015AA                          1242  ; MODIFIES - NONE
000015AA                          1243  ; -----------------------------------------------------------------------------
000015AA  48E7 8070               1244              MOVEM.L  D0/A1-A3,-(A7)
000015AE                          1245  
000015AE  1039 00001BF1           1246              MOVE.B  (SCRCYCCT),D0
000015B4  C07C 003F               1247              AND     #$3F,D0                 ; EVERY 64 CYCLES
000015B8  6600 0028               1248              BNE     .END                    ; CREATE A NEW PIPE
000015BC  43F9 00001AE2           1249              LEA     PIPINIT,A1
000015C2  45F9 00001B08           1250              LEA     PIPUPD,A2
000015C8  47F9 00001B22           1251              LEA     PIPPLOT,A3
000015CE  303C 0003               1252              MOVE.W  #PIPTYPE,D0
000015D2  1239 00001BE8           1253              MOVE.B  (PIPCOUNT),D1
000015D8  5239 00001BE8           1254              ADDQ.B  #1,(PIPCOUNT)
000015DE                          1255              
000015DE  4EB8 14B0               1256              JSR     AGLADD
000015E2                          1257              
000015E2  4CDF 0E01               1258  .END        MOVEM.L (A7)+,D0/A1-A3
000015E6  4E75                    1259              RTS
000015E8                          1260  
000015E8                          1261  
000015E8                          1262  
000015E8                          1263  
000015E8                          1264  
000015E8                          1265  
000015E8                          1266  
000015E8                          1267  
000015E8                          1268  
000015E8                          1269  
000015E8                          1270  
000015E8                          1271  
000015E8                          1272  
000015E8                          1273  
000015E8                          1274  
000015E8                          1275  
000015E8                          1276  
000015E8                          1277  
000015E8                          1278  
000015E8                          1279  
000015E8                          1280  
000015E8                          1281  -------------------- end include --------------------
000015E8                          1282              INCLUDE "STATES2.X68"                ; GAME STATES MANAGEMENT
000015E8                          1283  ; =============================================================================
000015E8                          1284  ; GAME STATE MANAGEMENT
000015E8                          1285  ; =============================================================================
000015E8                          1286  
000015E8                          1287  ; -----------------------------------------------------------------------------
000015E8                          1288  STAINIT
000015E8                          1289  ; INITALIZES THE STATE MANAGER
000015E8                          1290  ; INPUT    - NONE
000015E8                          1291  ; OUTPUT   - NONE
000015E8                          1292  ; MODIFIES - NONE
000015E8                          1293  ; -----------------------------------------------------------------------------
000015E8  33FC FFFF 00001BDA      1294              MOVE.W  #STANONE,(STACUR)
000015F0  33FC 0000 00001BDC      1295              MOVE.W  #STAINTR,(STANEXT)
000015F8  4E75                    1296              RTS
000015FA                          1297  
000015FA                          1298  ; -----------------------------------------------------------------------------
000015FA                          1299  STAUPD
000015FA                          1300  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
000015FA                          1301  ; INPUT    - NONE
000015FA                          1302  ; OUTPUT   - NONE
000015FA                          1303  ; MODIFIES - NONE
000015FA                          1304  ; -----------------------------------------------------------------------------
000015FA  48E7 8080               1305              MOVEM.L D0/A0,-(A7)
000015FE  4280                    1306              CLR.L   D0
00001600  3039 00001BDC           1307              MOVE.W  (STANEXT),D0
00001606  B079 00001BDA           1308              CMP.W   (STACUR),D0
0000160C  6700 0012               1309              BEQ     .DOUPD
00001610  33C0 00001BDA           1310              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00001616  E588                    1311              LSL.L   #2,D0
00001618  2040                    1312              MOVE.L  D0,A0
0000161A  2068 1638               1313              MOVE.L  .INITBL(A0),A0
0000161E  4E90                    1314              JSR     (A0)
00001620  4280                    1315  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00001622  3039 00001BDA           1316              MOVE.W  (STACUR),D0
00001628  E588                    1317              LSL.L   #2,D0
0000162A  2040                    1318              MOVE.L  D0,A0
0000162C  2068 1648               1319              MOVE.L  .UPDTBL(A0),A0
00001630  4E90                    1320              JSR     (A0)
00001632  4CDF 0101               1321              MOVEM.L (A7)+,D0/A0
00001636  4E75                    1322              RTS
00001638= 000010FE 000011C0 ...   1323  .INITBL     DC.L    STAINTRI,STAPLAYI,STAEMPTY,STAEMPTY
00001648= 000016C2 00001686 ...   1324  .UPDTBL     DC.L    STAINTRU,STAPLAYU,STAPAUU,STAGOVRU
00001658                          1325  
00001658                          1326  ; -----------------------------------------------------------------------------
00001658                          1327  STAPLOT
00001658                          1328  ; PERFORMS STATE PLOT
00001658                          1329  ; INPUT    - NONE
00001658                          1330  ; OUTPUT   - NONE
00001658                          1331  ; MODIFIES - NONE
00001658                          1332  ; -----------------------------------------------------------------------------
00001658  48E7 8080               1333              MOVEM.L D0/A0,-(A7)
0000165C  4280                    1334              CLR.L   D0
0000165E  3039 00001BDA           1335              MOVE.W  (STACUR),D0
00001664  E588                    1336              LSL.L   #2,D0
00001666  2040                    1337              MOVE.L  D0,A0
00001668  2068 1674               1338              MOVE.L  .PLTTBL(A0),A0
0000166C  4E90                    1339              JSR     (A0)
0000166E  4CDF 0101               1340              MOVEM.L (A7)+,D0/A0
00001672  4E75                    1341              RTS
00001674= 000016D8 000016B0 ...   1342  .PLTTBL     DC.L    STAINTRP,STAPLAYP,STAPAUP,STAGOVRP
00001684                          1343  
00001684                          1344  ; -----------------------------------------------------------------------------
00001684                          1345  STAEMPTY
00001684                          1346  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00001684                          1347  ; INPUT    - NONE
00001684                          1348  ; OUTPUT   - NONE
00001684                          1349  ; MODIFIES - NONE
00001684                          1350  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00001684                          1351  ; -----------------------------------------------------------------------------
00001684  4E75                    1352              RTS
00001686                          1353  
00001686                          1354  ; -----------------------------------------------------------------------------
00001686  =000011C0               1355  STAPLAYI    EQU     PLRINIT
00001686                          1356  ; PLAY STATE INITIALIZATION.
00001686                          1357  ; INPUT    - NONE
00001686                          1358  ; OUTPUT   - NONE
00001686                          1359  ; MODIFIES - NONE
00001686                          1360  ; NOTE     - JUST A WRAPPER FOR PLRINIT
00001686                          1361  ; -----------------------------------------------------------------------------
00001686                          1362  
00001686                          1363  ; -----------------------------------------------------------------------------
00001686                          1364  STAPLAYU
00001686                          1365  ; PLAY STATE UPDATE
00001686                          1366  ; INPUT    - NONE
00001686                          1367  ; OUTPUT   - NONE
00001686                          1368  ; MODIFIES - NONE
00001686                          1369  ; -----------------------------------------------------------------------------
00001686  0839 0007 00001BEF      1370              BTST.B   #KBDBITPS,(KBDEDGE)         ;Si 'P' es presionado, pausa.
0000168E  6616                    1371              BNE.S   .PAUSE
00001690                          1372              
00001690  4EB8 11EA               1373              JSR     PLRUPD
00001694  4EB9 00001A2C           1374              JSR     BGUPD
0000169A  4EB8 154E               1375              JSR     PRPUPD
0000169E  4EB8 15AA               1376              JSR     SPWUPD
000016A2  6000 FE26               1377              BRA     AGLUPD
000016A6                          1378  .PAUSE      
000016A6  33FC 0002 00001BDC      1379              MOVE.W  #STAPAU,(STANEXT)
000016AE  4E75                    1380              RTS
000016B0                          1381  ; -----------------------------------------------------------------------------
000016B0                          1382  STAPLAYP
000016B0                          1383  ; PLAY STATE PLOT
000016B0                          1384  ; INPUT    - NONE
000016B0                          1385  ; OUTPUT   - NONE
000016B0                          1386  ; MODIFIES - NONE
000016B0                          1387  ; -----------------------------------------------------------------------------
000016B0  4EB9 00001A78           1388              JSR     BGPLOT
000016B6  4EB8 157C               1389              JSR     PRPPLOT
000016BA  4EB8 14FE               1390              JSR     AGLPLOT
000016BE                          1391              ;BRA     AGLPLOT
000016BE  6000 FBE6               1392              BRA     PLRPLOT
000016C2                          1393  
000016C2                          1394  ; -----------------------------------------------------------------------------
000016C2  =000010FE               1395  STAINTRI    EQU     DMMINIT
000016C2                          1396  ; INTRO STATE INIT
000016C2                          1397  ; INPUT    - NONE
000016C2                          1398  ; OUTPUT   - NONE
000016C2                          1399  ; MODIFIES - NONE
000016C2                          1400  ; NOTE     - JUST A WRAPPER FOR DMMINIT TO RELEASE ALL MEMORY
000016C2                          1401  ; -----------------------------------------------------------------------------
000016C2                          1402  
000016C2                          1403  ; -----------------------------------------------------------------------------
000016C2                          1404  STAINTRU
000016C2                          1405  ; INTRO STATE UPDATE
000016C2                          1406  ; INPUT    - NONE
000016C2                          1407  ; OUTPUT   - NONE
000016C2                          1408  ; MODIFIES - NONE
000016C2                          1409  ; -----------------------------------------------------------------------------
000016C2  0839 0004 00001BEF      1410              BTST.B  #KBDBITF1,(KBDEDGE)
000016CA  6700 000A               1411              BEQ     .END
000016CE  33FC 0001 00001BDC      1412              MOVE.W  #STAPLAY,(STANEXT)
000016D6  4E75                    1413  .END        RTS
000016D8                          1414  
000016D8                          1415  ; -----------------------------------------------------------------------------
000016D8                          1416  STAINTRP
000016D8                          1417  ; INTRO STATE PLOT
000016D8                          1418  ; INPUT    - NONE
000016D8                          1419  ; OUTPUT   - NONE
000016D8                          1420  ; MODIFIES - NONE
000016D8                          1421  ; -----------------------------------------------------------------------------
000016D8                          1422              ;Guardar registros en pila
000016D8  48E7 C040               1423              MOVEM.L A1/D0-D1,-(A7)
000016DC                          1424              
000016DC                          1425              ;Seleccionar fuente de texto
000016DC                          1426m             UTLFONT INTTITC,INTTITF
000016DC                          1427m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000016DC                          1428m ; INPUT    - INTTITC COLOR, INTTITF FONT
000016DC                          1429m ; OUTPUT   - NONE
000016DC                          1430m ; MODIFIES - D0,D1,D2
000016DC                          1431m ; -----------------------------------------------------------------------------
000016EC                          1432              ;Seleccionar posicion de texto      
000016EC                          1433m             UTLLOCT INTTITX,INTTITY               
000016EC                          1434m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000016EC                          1435m ; INPUT    - INTTITX X, INTTITY Y
000016EC                          1436m ; OUTPUT   - NONE
000016EC                          1437m ; MODIFIES - D0,D1
000016EC                          1438m ; -----------------------------------------------------------------------------
000016F6                          1439  
000016F6  43F9 0000172E           1440              LEA     .TITLE,A1
000016FC  103C 000E               1441              MOVE.B  #14,D0
00001700  4E4F                    1442              TRAP    #15
00001702                          1443              
00001702                          1444              ;Seleccionar fuente de texto
00001702                          1445m             UTLFONT INTPRSC,INTPRSF     
00001702                          1446m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001702                          1447m ; INPUT    - INTPRSC COLOR, INTPRSF FONT
00001702                          1448m ; OUTPUT   - NONE
00001702                          1449m ; MODIFIES - D0,D1,D2
00001702                          1450m ; -----------------------------------------------------------------------------
00001712                          1451              ;Seleccionar posicion de texto
00001712                          1452m             UTLLOCT INTPRSX,INTPRSY     
00001712                          1453m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001712                          1454m ; INPUT    - INTPRSX X, INTPRSY Y
00001712                          1455m ; OUTPUT   - NONE
00001712                          1456m ; MODIFIES - D0,D1
00001712                          1457m ; -----------------------------------------------------------------------------
0000171C                          1458  
0000171C  43F9 0000173A           1459              LEA     .START_TEXT,A1
00001722  103C 000E               1460              MOVE.B  #14,D0
00001726  4E4F                    1461              TRAP    #15
00001728                          1462              
00001728                          1463              ;Restaurar registros
00001728  4CDF 0203               1464              MOVEM.L (A7)+,A1/D0-D1
0000172C  4E75                    1465              RTS
0000172E                          1466  
0000172E= 46 4C 41 50 50 59 ...   1467  .TITLE      DC.B    'FLAPPY BIRD',0 
0000173A= 50 52 45 53 53 20 ...   1468  .START_TEXT DC.B    'PRESS SPACE TO START',0
00001750                          1469              DS.W    0
00001750                          1470  
00001750                          1471  
00001750                          1472  
00001750                          1473  ; -----------------------------------------------------------------------------
00001750                          1474  STAPAUI    
00001750                          1475  ; PAUSE STATE INIT
00001750                          1476  ; INPUT    - NONE
00001750                          1477  ; OUTPUT   - NONE
00001750                          1478  ; MODIFIES - NONE
00001750                          1479  ; -----------------------------------------------------------------------------
00001750                          1480              ;Guardar registros de juego
00001750  48E7 FFFE               1481              MOVEM.L D0-D7/A0-A6,-(A7)
00001754  40E7                    1482              MOVE.W  SR,-(A7)
00001756                          1483              
00001756  4EEF FFC0               1484              JMP     -64(A7)
0000175A                          1485  ; -----------------------------------------------------------------------------
0000175A                          1486  STAPAUU
0000175A                          1487  ; INTRO STATE UPDATE
0000175A                          1488  ; INPUT    - NONE
0000175A                          1489  ; OUTPUT   - NONE
0000175A                          1490  ; MODIFIES - NONE
0000175A                          1491  ; -----------------------------------------------------------------------------
0000175A  0839 0001 00001BEF      1492              BTST.B  #KBDBITUP,(KBDEDGE)     ;Check cambio en estado de UP
00001762  6628                    1493              BNE.S   .UP
00001764  0839 0003 00001BEF      1494              BTST.B  #KBDBITDN,(KBDEDGE)     ;Check cambio en estado de DOWN
0000176C  6630                    1495              BNE.S   .DN
0000176E  0839 0004 00001BEF      1496              BTST.B  #KBDBITF1,(KBDEDGE)     ;Check cambio en estado de FIRE1
00001776  6638                    1497              BNE.S   .OK
00001778  0839 0007 00001BEF      1498              BTST.B  #KBDBITPS,(KBDEDGE)     ;Check cambio en estado de 'P'
00001780  6708                    1499              BEQ.S   .END
00001782                          1500              
00001782  33FC 0001 00001BDC      1501              MOVE.W  #STAPLAY,(STANEXT)      ;Si hay cambio en estado de 'P'
0000178A                          1502                                              ;Actualizar siguiente estado
0000178A  4E75                    1503  .END        RTS
0000178C                          1504  
0000178C  0C39 0000 00001BEC      1505  .UP         CMP.B   #CONTNUM,(PMOPTN)       ;Check si es posible cambiar a una
00001794  6FF4                    1506              BLE.S   .END                    ;opción superior
00001796  5379 00001BEC           1507              SUBQ    #1,(PMOPTN)
0000179C  60EC                    1508              BRA.S   .END
0000179E                          1509              
0000179E  0C39 0002 00001BEC      1510  .DN         CMP.B   #EXTNUM,(PMOPTN)        ;Check si es posible cambiar a una
000017A6  6CE2                    1511              BGE.S   .END                    ;opción inferior
000017A8  5279 00001BEC           1512              ADDQ    #1,(PMOPTN)
000017AE  60DA                    1513              BRA.S   .END
000017B0                          1514              
000017B0                          1515  .OK         
000017B0  4280                    1516              CLR.L   D0                      ;Preparar registro D0
000017B2  1039 00001BEC           1517              MOVE.B  (PMOPTN),D0
000017B8  C0FC 0006               1518              MULU    #6,D0                   
000017BC                          1519              
000017BC  2040                    1520              MOVEA.L D0,A0                   ;Usar D0 como indice para .JMPLST
000017BE                          1521              
000017BE  4EE8 17C2               1522              JMP     .JMPLST(A0)
000017C2                          1523              
000017C2  4EF9 000017D4           1524  .JMPLST     JMP     .contgame               
000017C8  4EF9 000017DE           1525              JMP     .newgame
000017CE  4EF9 000017E8           1526              JMP     .exitgame
000017D4                          1527  .contgame
000017D4                          1528              ;Si última PMOPT == continuar juego, actualizar estado
000017D4  33FC 0001 00001BDC      1529              MOVE.W  #STAPLAY,(STANEXT)
000017DC  60AC                    1530              BRA     .END
000017DE                          1531  .newgame    
000017DE                          1532              ;Si última PMOPT == nuevo juego, actualizar estado
000017DE  33FC 0000 00001BDC      1533              MOVE.W  #STAINTR,(STANEXT)
000017E6  60A2                    1534              BRA     .END
000017E8                          1535              
000017E8                          1536  .exitgame   
000017E8                          1537              ;Si última PMOPT == salir de juego, actualizar estado
000017E8  33FC 0003 00001BDC      1538              MOVE.W  #STAGOVR,(STANEXT)
000017F0  6098                    1539              BRA     .END
000017F2                          1540  
000017F2                          1541  ; -----------------------------------------------------------------------------
000017F2                          1542  STAPAUP
000017F2                          1543  ; INTRO STATE PLOT
000017F2                          1544  ; INPUT    - NONE
000017F2                          1545  ; OUTPUT   - NONE
000017F2                          1546  ; MODIFIES - NONE
000017F2                          1547  ; -----------------------------------------------------------------------------
000017F2                          1548              ;Guardar registros
000017F2  48E7 8040               1549              MOVEM.L D0/A1,-(A7)
000017F6                          1550  
000017F6                          1551m             UTLSFIL #$00000000
000017F6                          1552m ; WRAPPER FOR SET FIL TRAP 15 TASK.
000017F6                          1553m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
000017F6                          1554m ; OUTPUT   - NONE
000017F6                          1555m ; MODIFIES - D0,D1
000017F6                          1556m ; -----------------------------------------------------------------------------
000017FE                          1557  
000017FE                          1558              **********DIBUJAR TÍTULO**********
000017FE                          1559              ;Seleccionar fuente de texto
000017FE                          1560m             UTLFONT PAUTITC,PAUTITF
000017FE                          1561m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000017FE                          1562m ; INPUT    - PAUTITC COLOR, PAUTITF FONT
000017FE                          1563m ; OUTPUT   - NONE
000017FE                          1564m ; MODIFIES - D0,D1,D2
000017FE                          1565m ; -----------------------------------------------------------------------------
0000180E                          1566              ;Seleccionar posicion de texto      
0000180E                          1567m             UTLLOCT PAUTITX,PAUTITY               
0000180E                          1568m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
0000180E                          1569m ; INPUT    - PAUTITX X, PAUTITY Y
0000180E                          1570m ; OUTPUT   - NONE
0000180E                          1571m ; MODIFIES - D0,D1
0000180E                          1572m ; -----------------------------------------------------------------------------
00001818                          1573  
00001818  43F9 000018EE           1574              LEA     .TITLE,A1
0000181E  700E                    1575              MOVEQ   #14,D0
00001820  4E4F                    1576              TRAP    #15
00001822                          1577              
00001822  1E39 00001BEC           1578              MOVE.B  (PMOPTN),D7
00001828                          1579              
00001828                          1580              
00001828                          1581              **********DIBUJAR OPCION CONTINUAR**********
00001828                          1582              ;Seleccionar fuente de texto
00001828  0C39 0000 00001BEC      1583              CMP.B   #CONTNUM,(PMOPTN)
00001830  6712                    1584              BEQ.S   .CNTSEL
00001832                          1585m             UTLFONT PAUOPTC,PAUOPTFU
00001832                          1586m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001832                          1587m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
00001832                          1588m ; OUTPUT   - NONE
00001832                          1589m ; MODIFIES - D0,D1,D2
00001832                          1590m ; -----------------------------------------------------------------------------
00001842  6010                    1591              BRA.S   .SKPCNT
00001844                          1592  
00001844                          1593m .CNTSEL     UTLFONT PAUOPTC,PAUOPTFS
00001844                          1594m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001844                          1595m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
00001844                          1596m ; OUTPUT   - NONE
00001844                          1597m ; MODIFIES - D0,D1,D2
00001844                          1598m ; -----------------------------------------------------------------------------
00001854                          1599  .SKPCNT
00001854                          1600              ;Seleccionar posición de texto
00001854                          1601m             UTLLOCT PAUOPTX,PAUCNTY
00001854                          1602m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001854                          1603m ; INPUT    - PAUOPTX X, PAUCNTY Y
00001854                          1604m ; OUTPUT   - NONE
00001854                          1605m ; MODIFIES - D0,D1
00001854                          1606m ; -----------------------------------------------------------------------------
0000185E                          1607              
0000185E  43F9 000018FC           1608              LEA     .CONT,A1
00001864  700E                    1609              MOVEQ   #14,D0
00001866  4E4F                    1610              TRAP    #15
00001868                          1611              
00001868                          1612              **********DIBUJAR OPCION JUEGO NUEVO**********
00001868                          1613              ;Seleccionar fuente de texto
00001868  0C39 0001 00001BEC      1614              CMP.B   #NEWGNUM,(PMOPTN)
00001870  6712                    1615              BEQ.S   .NEWSEL
00001872                          1616m             UTLFONT PAUOPTC,PAUOPTFU
00001872                          1617m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001872                          1618m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
00001872                          1619m ; OUTPUT   - NONE
00001872                          1620m ; MODIFIES - D0,D1,D2
00001872                          1621m ; -----------------------------------------------------------------------------
00001882  6010                    1622              BRA.S   .SKPNEW
00001884                          1623  
00001884                          1624m .NEWSEL     UTLFONT PAUOPTC,PAUOPTFS
00001884                          1625m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001884                          1626m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
00001884                          1627m ; OUTPUT   - NONE
00001884                          1628m ; MODIFIES - D0,D1,D2
00001884                          1629m ; -----------------------------------------------------------------------------
00001894                          1630  .SKPNEW
00001894                          1631              ;Seleccionar posición de texto
00001894                          1632m             UTLLOCT PAUOPTX,PAUNEWY
00001894                          1633m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001894                          1634m ; INPUT    - PAUOPTX X, PAUNEWY Y
00001894                          1635m ; OUTPUT   - NONE
00001894                          1636m ; MODIFIES - D0,D1
00001894                          1637m ; -----------------------------------------------------------------------------
0000189E                          1638              
0000189E  43F9 00001906           1639              LEA     .NEWG,A1
000018A4  700E                    1640              MOVEQ   #14,D0
000018A6  4E4F                    1641              TRAP    #15
000018A8                          1642              
000018A8                          1643              **********DIBUJAR OPCION SALIR**********
000018A8                          1644              ;Seleccionar fuente de texto
000018A8  0C39 0002 00001BEC      1645              CMP.B   #EXTNUM,(PMOPTN)
000018B0  6712                    1646              BEQ.S   .EXTSEL
000018B2                          1647m             UTLFONT PAUOPTC,PAUOPTFU
000018B2                          1648m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018B2                          1649m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
000018B2                          1650m ; OUTPUT   - NONE
000018B2                          1651m ; MODIFIES - D0,D1,D2
000018B2                          1652m ; -----------------------------------------------------------------------------
000018C2  6010                    1653              BRA.S   .SKPEXT
000018C4                          1654  
000018C4                          1655m .EXTSEL     UTLFONT PAUOPTC,PAUOPTFS
000018C4                          1656m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018C4                          1657m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
000018C4                          1658m ; OUTPUT   - NONE
000018C4                          1659m ; MODIFIES - D0,D1,D2
000018C4                          1660m ; -----------------------------------------------------------------------------
000018D4                          1661  .SKPEXT
000018D4                          1662              ;Seleccionar posición de texto
000018D4                          1663m             UTLLOCT PAUOPTX,PAUEXTY
000018D4                          1664m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000018D4                          1665m ; INPUT    - PAUOPTX X, PAUEXTY Y
000018D4                          1666m ; OUTPUT   - NONE
000018D4                          1667m ; MODIFIES - D0,D1
000018D4                          1668m ; -----------------------------------------------------------------------------
000018DE                          1669              
000018DE  43F9 00001912           1670              LEA     .EXIT,A1
000018E4  700E                    1671              MOVEQ   #14,D0
000018E6  4E4F                    1672              TRAP    #15
000018E8                          1673              
000018E8                          1674              ;Restaurar registros
000018E8  4CDF 0201               1675              MOVEM.L (A7)+,D0/A1
000018EC  4E75                    1676              RTS
000018EE                          1677              
000018EE                          1678  ; --- LOCAL DATA -----------------
000018EE= 4D 45 4E 55 20 44 ...   1679  .TITLE      DC.B    'MENU DE PAUSA',0
000018FC= 43 4F 4E 54 49 4E ...   1680  .CONT       DC.B    'CONTINUAR',0
00001906= 4A 55 45 47 4F 20 ...   1681  .NEWG       DC.B    'JUEGO NUEVO',0
00001912= 53 41 4C 49 52 00       1682  .EXIT       DC.B    'SALIR',0
00001918                          1683              DS.W    0
00001918                          1684              
00001918                          1685  ; -----------------------------------------------------------------------------
00001918                          1686  STAGOVRU
00001918                          1687  ; GAME OVER STATE UPDATE
00001918                          1688  ; INPUT    - NONE
00001918                          1689  ; OUTPUT   - NONE
00001918                          1690  ; MODIFIES - NONE
00001918                          1691  ; -----------------------------------------------------------------------------
00001918  0839 0004 00001BEF      1692              BTST.B  #KBDBITF1,(KBDEDGE)
00001920  6700 000A               1693              BEQ     .END
00001924  33FC 0000 00001BDC      1694              MOVE.W  #STAINTR,(STANEXT)
0000192C  4E75                    1695  .END        RTS
0000192E                          1696  
0000192E                          1697  ; -----------------------------------------------------------------------------
0000192E                          1698  STAGOVRP
0000192E                          1699  ; GAME OVER STATE PLOT
0000192E                          1700  ; INPUT    - NONE
0000192E                          1701  ; OUTPUT   - NONE
0000192E                          1702  ; MODIFIES - NONE
0000192E                          1703  ; -----------------------------------------------------------------------------
0000192E  48E7 C040               1704              MOVEM.L A1/D0-D1,-(A7)
00001932                          1705m             UTLLOCT GOVSTRX,GOVSTRY
00001932                          1706m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001932                          1707m ; INPUT    - GOVSTRX X, GOVSTRY Y
00001932                          1708m ; OUTPUT   - NONE
00001932                          1709m ; MODIFIES - D0,D1
00001932                          1710m ; -----------------------------------------------------------------------------
0000193C                          1711m             UTLSPEN #GOVSTRC
0000193C                          1712m ; WRAPPER FOR SET PEN TRAP 15 TASK.
0000193C                          1713m ; INPUT    - #GOVSTRC COLOR IN FORMAT $00BBGGRR
0000193C                          1714m ; OUTPUT   - NONE
0000193C                          1715m ; MODIFIES - D0,D1
0000193C                          1716m ; -----------------------------------------------------------------------------
00001948                          1717m             UTLSFIL #$00000000
00001948                          1718m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001948                          1719m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001948                          1720m ; OUTPUT   - NONE
00001948                          1721m ; MODIFIES - D0,D1
00001948                          1722m ; -----------------------------------------------------------------------------
00001950  43F9 00001962           1723              LEA     .GOVSTR,A1
00001956  103C 000E               1724              MOVE.B  #14,D0
0000195A  4E4F                    1725              TRAP    #15
0000195C  4CDF 0203               1726              MOVEM.L (A7)+,A1/D0-D1
00001960  4E75                    1727              RTS
00001962                          1728  
00001962= 47 41 4D 45 20 20 ...   1729  .GOVSTR     DC.B    'GAME  OVER',0
0000196E                          1730              DS.W    0
0000196E                          1731  
0000196E                          1732  
0000196E                          1733  
0000196E                          1734  
0000196E                          1735  
0000196E                          1736  
0000196E                          1737  
0000196E                          1738  
0000196E                          1739  
0000196E                          1740  
0000196E                          1741  
0000196E                          1742  
0000196E                          1743  
0000196E                          1744  
0000196E                          1745  
0000196E                          1746  
0000196E                          1747  
0000196E                          1748  
0000196E                          1749  
0000196E                          1750  
0000196E                          1751  
0000196E                          1752  
0000196E                          1753  
0000196E                          1754  -------------------- end include --------------------
0000196E                          1755              INCLUDE "BACKGROUND/BACKGROUND.X68"  ; BACKGROUND MANAGEMENT
0000196E                          1756  ;------------------------------------------------------------------------------
0000196E                          1757  ; BACKGROUND
0000196E                          1758  ;------------------------------------------------------------------------------
0000196E                          1759              INCLUDE "BACKGROUND/CLOUD.X68"     ; BACKGROUND CLOUDS MANAGEMENT 
0000196E                          1760  ; =============================================================================
0000196E                          1761  ; CLOUD MANAGEMENT. IT IS A PROP.
0000196E                          1762  ; LOCAL MEMORY IS:
0000196E                          1763  ; +0 WORD X COORDINATE
0000196E                          1764  ; +2 WORD Y COORDINATE
0000196E                          1765  ; =============================================================================
0000196E                          1766  
0000196E                          1767  ; -----------------------------------------------------------------------------
0000196E                          1768  CLDINIT
0000196E                          1769  ; INITALIZES CLOUD
0000196E                          1770  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
0000196E                          1771  ; OUTPUT   - NONE
0000196E                          1772  ; MODIFIES - NONE
0000196E                          1773  ; NOTE     - ASSUMES SCRHEIGH IS GREATER THAN 255
0000196E                          1774  ; -----------------------------------------------------------------------------
0000196E                          1775          ;Guardar registros
0000196E  2F00                    1776          MOVE.L      D0,-(A7)
00001970                          1777              
00001970  30BC 0280               1778          MOVE.W      #SCRWIDTH,(A0)
00001974                          1779          
00001974  4EB8 1392               1780          JSR         UTLRAND
00001978  3140 0002               1781          MOVE.W      D0,2(A0)
0000197C                          1782          
0000197C                          1783          ;Restaurar registros
0000197C  201F                    1784          MOVE.L      (A7)+,D0
0000197E                          1785          
0000197E  4E75                    1786          RTS
00001980                          1787  
00001980                          1788  ; -----------------------------------------------------------------------------
00001980                          1789  CLDUPD
00001980                          1790  ; UPDATES THE STATE OF CLOUDS
00001980                          1791  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
00001980                          1792  ; OUTPUT   - NONE
00001980                          1793  ; MODIFIES - NONE
00001980                          1794  ; -----------------------------------------------------------------------------
00001980                          1795          ;Actualizar posición
00001980  2F00                    1796          MOVE.L      D0,-(A7)
00001982                          1797          
00001982  3039 00001BEA           1798          MOVE.W      (XSPEED),D0
00001988  80FC 0002               1799          DIVU.W      #2,D0
0000198C  9150                    1800          SUB.W       D0,(A0)
0000198E  0C50 FF88               1801          CMP.W       #-CLDSIZE*2,(A0)
00001992  6F04                    1802          BLE.S       .KILL
00001994                          1803  
00001994                          1804  .END    
00001994  201F                    1805          MOVE.L      (A7)+,D0
00001996  4E75                    1806          RTS
00001998                          1807          
00001998  4EB8 11AA               1808  .KILL   JSR PRPKILL
0000199C  60F6                    1809          BRA         .END     
0000199E                          1810  
0000199E                          1811  ; -----------------------------------------------------------------------------
0000199E                          1812  CLDPLOT
0000199E                          1813  ; PLOTS THE CLOUD IN ITS RIGHTFUL POSITION
0000199E                          1814  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
0000199E                          1815  ; OUTPUT   - NONE
0000199E                          1816  ; MODIFIES - NONE
0000199E                          1817  ; -----------------------------------------------------------------------------       
0000199E                          1818          ;Guardar registros
0000199E  48E7 F800               1819          MOVEM.L     D0-D4,-(A7)
000019A2                          1820          
000019A2                          1821m         UTLSPEN     #CLDPCLR
000019A2                          1822m ; WRAPPER FOR SET PEN TRAP 15 TASK.
000019A2                          1823m ; INPUT    - #CLDPCLR COLOR IN FORMAT $00BBGGRR
000019A2                          1824m ; OUTPUT   - NONE
000019A2                          1825m ; MODIFIES - D0,D1
000019A2                          1826m ; -----------------------------------------------------------------------------
000019AE                          1827m         UTLSFIL     #CLDFCLR
000019AE                          1828m ; WRAPPER FOR SET FIL TRAP 15 TASK.
000019AE                          1829m ; INPUT    - #CLDFCLR COLOR IN FORMAT $00BBGGRR
000019AE                          1830m ; OUTPUT   - NONE
000019AE                          1831m ; MODIFIES - D0,D1
000019AE                          1832m ; -----------------------------------------------------------------------------
000019BA                          1833          
000019BA                          1834          ;Preparar parametros
000019BA  3210                    1835          MOVE.W      (A0),D1     ;X0 COORD
000019BC  3428 0002               1836          MOVE.W      2(A0),D2    ;Y0 COORD
000019C0  3601                    1837          MOVE.W      D1,D3       
000019C2  3802                    1838          MOVE.W      D2,D4       
000019C4  0643 0078               1839          ADD.W       #CLDSIZE*2,D3 ;X1 COORD
000019C8  0644 003C               1840          ADD.W       #CLDSIZE,D4 ;Y2 COORD
000019CC                          1841          
000019CC  7058                    1842          MOVEQ       #88,D0      ;TASK NUM
000019CE                          1843          
000019CE  4E4F                    1844          TRAP        #15
000019D0                          1845          
000019D0                          1846          ;Restaurar registros
000019D0  4CDF 001F               1847          MOVEM.L     (A7)+,D0-D4
000019D4  4E75                    1848          RTS
000019D6                          1849  
000019D6                          1850  
000019D6                          1851  
000019D6                          1852  
000019D6                          1853  
000019D6                          1854  
000019D6                          1855  
000019D6                          1856  
000019D6                          1857  
000019D6                          1858  
000019D6                          1859  
000019D6                          1860  
000019D6                          1861  
000019D6                          1862  
000019D6                          1863  
000019D6                          1864  
000019D6                          1865  
000019D6                          1866  
000019D6                          1867  
000019D6                          1868  
000019D6                          1869  
000019D6                          1870  
000019D6                          1871  
000019D6                          1872  
000019D6                          1873  
000019D6                          1874  -------------------- end include --------------------
000019D6                          1875              INCLUDE "BACKGROUND/GSSDETAIL.X68" ; GRASS DETAILS MANAGEMENT
000019D6                          1876  ; =============================================================================
000019D6                          1877  ; GRASS DETAILS MANAGEMENT. IT IS A PROP.
000019D6                          1878  ; LOCAL MEMORY IS:
000019D6                          1879  ; +0 WORD X COORDINATE
000019D6                          1880  ; =============================================================================
000019D6                          1881  
000019D6                          1882  ; -----------------------------------------------------------------------------
000019D6                          1883  GSSDINIT
000019D6                          1884  ; INITIALIZES THE LITTLE DETAILS ON THE GRASS
000019D6                          1885  ; -----------------------------------------------------------------------------
000019D6  2F00                    1886          MOVE.L      D0,-(A7)
000019D8                          1887          
000019D8  30BC 0280               1888          MOVE.W      #SCRWIDTH,(A0)
000019DC                          1889          
000019DC  201F                    1890          MOVE.L      (A7)+,D0
000019DE  4E75                    1891          RTS
000019E0                          1892          
000019E0                          1893          
000019E0                          1894  ; -----------------------------------------------------------------------------
000019E0                          1895  GSSDUPD
000019E0                          1896  ; MODIFIES THE LITTLE DETAILS ON THE GRASS' X COORDINATE
000019E0                          1897  ; -----------------------------------------------------------------------------
000019E0                          1898          ;Guardar registros
000019E0  2F00                    1899          MOVE.L      D0,-(A7)
000019E2                          1900  
000019E2  3039 00001BEA           1901          MOVE.W      (XSPEED),D0
000019E8  9150                    1902          SUB.W       D0,(A0)         ;UPDATE X COORDINATE
000019EA  0C50 FFF6               1903          CMP.W       #-GSSDWDTH,(A0)
000019EE  6F04                    1904          BLE.S       .KILL
000019F0                          1905          
000019F0                          1906  .END    ;Restaurar registros
000019F0  201F                    1907          MOVE.L      (A7)+,D0
000019F2  4E75                    1908          RTS
000019F4                          1909  
000019F4  4EB8 11AA               1910  .KILL   JSR         PRPKILL
000019F8  60F6                    1911          BRA         .END
000019FA                          1912          
000019FA                          1913  ; -----------------------------------------------------------------------------
000019FA                          1914  GSSDPLOT
000019FA                          1915  ; PLOTS THE LITTLE DETAILS ON THE GRASS' X COORDINATE
000019FA                          1916  ; -----------------------------------------------------------------------------
000019FA  48E7 F800               1917          MOVEM.L     D0-D4,-(A7)
000019FE                          1918          
000019FE                          1919m         UTLSPEN     #$00000000
000019FE                          1920m ; WRAPPER FOR SET PEN TRAP 15 TASK.
000019FE                          1921m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
000019FE                          1922m ; OUTPUT   - NONE
000019FE                          1923m ; MODIFIES - D0,D1
000019FE                          1924m ; -----------------------------------------------------------------------------
00001A06                          1925m         UTLSFIL     #GSSDFC
00001A06                          1926m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001A06                          1927m ; INPUT    - #GSSDFC COLOR IN FORMAT $00BBGGRR
00001A06                          1928m ; OUTPUT   - NONE
00001A06                          1929m ; MODIFIES - D0,D1
00001A06                          1930m ; -----------------------------------------------------------------------------
00001A12                          1931          
00001A12  3210                    1932          MOVE.W      (A0),D1
00001A14  343C 0168               1933          MOVE.W      #BGGSSTP,D2
00001A18  3601                    1934          MOVE.W      D1,D3
00001A1A  0643 000A               1935          ADD.W       #GSSDWDTH,D3
00001A1E  383C 0190               1936          MOVE.W      #BGGSSBT,D4
00001A22                          1937          
00001A22  7057                    1938          MOVEQ       #87,D0
00001A24  4E4F                    1939          TRAP        #15
00001A26                          1940          
00001A26  4CDF 001F               1941          MOVEM.L     (A7)+,D0-D4
00001A2A  4E75                    1942          RTS
00001A2C                          1943          
00001A2C                          1944  
00001A2C                          1945  
00001A2C                          1946  
00001A2C                          1947  
00001A2C                          1948  
00001A2C                          1949  
00001A2C                          1950  
00001A2C                          1951  -------------------- end include --------------------
00001A2C                          1952  ; -----------------------------------------------------------------------------
00001A2C                          1953  BGUPD
00001A2C                          1954  ; UPDATES DETAILS OF BACKGROUND
00001A2C                          1955  ; INPUT    - NONE
00001A2C                          1956  ; OUTPUT   - NONE
00001A2C                          1957  ; MODIFIES - MEMORY WHEN NEEDED
00001A2C                          1958  ; -----------------------------------------------------------------------------
00001A2C  48E7 8070               1959              MOVEM.L  D0/A1-A3,-(A7)
00001A30                          1960  
00001A30  1039 00001BF1           1961              MOVE.B  (SCRCYCCT),D0
00001A36  C07C 0007               1962              AND     #$07,D0                 ;EVERY 8 CYCLES
00001A3A  6614                    1963              BNE.S   .CLOUD                  ;CREATE A NEW MARK ON GRASS
00001A3C  43F8 19D6               1964              LEA     GSSDINIT,A1
00001A40  45F8 19E0               1965              LEA     GSSDUPD,A2
00001A44  47F8 19FA               1966              LEA     GSSDPLOT,A3
00001A48  303C 0002               1967              MOVE.W  #GSSDTYPE,D0
00001A4C                          1968              
00001A4C  4EB8 1534               1969              JSR     PRPADD
00001A50                          1970  
00001A50  1039 00001BF1           1971  .CLOUD      MOVE.B  (SCRCYCCT),D0
00001A56  C07C 00FF               1972              AND     #$FF,D0                 ; EVERY 256 CYCLES
00001A5A  6600 0016               1973              BNE     .END                    ; CREATE A NEW CLOUD
00001A5E  43F8 196E               1974              LEA     CLDINIT,A1
00001A62  45F8 1980               1975              LEA     CLDUPD,A2
00001A66  47F8 199E               1976              LEA     CLDPLOT,A3
00001A6A  303C 0001               1977              MOVE.W  #CLDTYPE,D0
00001A6E                          1978              
00001A6E  4EB8 1534               1979              JSR     PRPADD
00001A72                          1980              
00001A72  4CDF 0E01               1981  .END        MOVEM.L (A7)+,D0/A1-A3
00001A76  4E75                    1982              RTS
00001A78                          1983  
00001A78                          1984  
00001A78                          1985  ; -----------------------------------------------------------------------------
00001A78                          1986  BGPLOT
00001A78                          1987  ; PLOTS BACKGROUND
00001A78                          1988  ; INPUT    - NONE
00001A78                          1989  ; OUTPUT   - NONE
00001A78                          1990  ; MODIFIES - NONE
00001A78                          1991  ; -----------------------------------------------------------------------------
00001A78                          1992              
00001A78  48A7 7800               1993              MOVEM.W D1-D4,-(A7)
00001A7C                          1994              
00001A7C                          1995m             UTLSPEN #BGSKYPC
00001A7C                          1996m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001A7C                          1997m ; INPUT    - #BGSKYPC COLOR IN FORMAT $00BBGGRR
00001A7C                          1998m ; OUTPUT   - NONE
00001A7C                          1999m ; MODIFIES - D0,D1
00001A7C                          2000m ; -----------------------------------------------------------------------------
00001A84                          2001m             UTLSFIL #BGSKYFC
00001A84                          2002m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001A84                          2003m ; INPUT    - #BGSKYFC COLOR IN FORMAT $00BBGGRR
00001A84                          2004m ; OUTPUT   - NONE
00001A84                          2005m ; MODIFIES - D0,D1
00001A84                          2006m ; -----------------------------------------------------------------------------
00001A90                          2007              
00001A90  4241                    2008              CLR.W   D1
00001A92  4242                    2009              CLR.W   D2
00001A94  363C 0280               2010              MOVE.W  #SCRWIDTH,D3
00001A98  383C 01E0               2011              MOVE.W  #SCRHEIGH,D4
00001A9C                          2012              
00001A9C  7057                    2013              MOVEQ   #87,D0
00001A9E  4E4F                    2014              TRAP    #15
00001AA0                          2015              
00001AA0                          2016m             UTLSFIL #BGGNDFC
00001AA0                          2017m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001AA0                          2018m ; INPUT    - #BGGNDFC COLOR IN FORMAT $00BBGGRR
00001AA0                          2019m ; OUTPUT   - NONE
00001AA0                          2020m ; MODIFIES - D0,D1
00001AA0                          2021m ; -----------------------------------------------------------------------------
00001AAC                          2022              
00001AAC  4241                    2023              CLR     D1
00001AAE  343C 0190               2024              MOVE.W  #BGGSSBT,D2
00001AB2  363C 0280               2025              MOVE.W  #SCRWIDTH,D3
00001AB6  383C 01E0               2026              MOVE.W  #SCRHEIGH,D4
00001ABA                          2027              
00001ABA  7057                    2028              MOVEQ   #87,D0
00001ABC  4E4F                    2029              TRAP    #15
00001ABE                          2030              
00001ABE                          2031m             UTLSFIL #BGGSSFC
00001ABE                          2032m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001ABE                          2033m ; INPUT    - #BGGSSFC COLOR IN FORMAT $00BBGGRR
00001ABE                          2034m ; OUTPUT   - NONE
00001ABE                          2035m ; MODIFIES - D0,D1
00001ABE                          2036m ; -----------------------------------------------------------------------------
00001ACA                          2037  
00001ACA                          2038  
00001ACA  4241                    2039              CLR     D1
00001ACC  343C 0168               2040              MOVE.W  #BGGSSTP,D2
00001AD0  363C 0280               2041              MOVE.W  #SCRWIDTH,D3
00001AD4  383C 0190               2042              MOVE.W  #BGGSSBT,D4
00001AD8                          2043              
00001AD8  7057                    2044              MOVEQ   #87,D0
00001ADA  4E4F                    2045              TRAP    #15
00001ADC                          2046              
00001ADC  4C9F 001E               2047              MOVEM.W (A7)+,D1-D4
00001AE0  4E75                    2048              RTS
00001AE2                          2049  
00001AE2                          2050  
00001AE2                          2051  
00001AE2                          2052  
00001AE2                          2053  
00001AE2                          2054  
00001AE2                          2055  
00001AE2                          2056  
00001AE2                          2057  
00001AE2                          2058  
00001AE2                          2059  
00001AE2                          2060  
00001AE2                          2061  
00001AE2                          2062  
00001AE2                          2063  
00001AE2                          2064  
00001AE2                          2065  
00001AE2                          2066  
00001AE2                          2067  -------------------- end include --------------------
00001AE2                          2068              INCLUDE "PIPES.X68"                  ; PIPES MANAGEMENT          
00001AE2                          2069  ; =============================================================================
00001AE2                          2070  ; PIPES MANAGEMENT. IT IS AN AGENT.
00001AE2                          2071  ; LOCAL MEMORY IS:
00001AE2                          2072  ; +0 WORD X COORDINATE OF THE LEFTMOST EDGE OF THE VERTICALLY ALIGNED PIPES
00001AE2                          2073  ; +2 WORD Y COORDINATE OF THE DOWNMOST EDGE OF THE TOP PIPE (FACING DOWN)
00001AE2                          2074  ; +4 WORD BOOLEAN THAT TELLS WHETHER THE PIPE SHOULD MOVE OR NOT
00001AE2                          2075  ;    (0 == TRUE. ELSE FALSE)
00001AE2                          2076  ; =============================================================================
00001AE2                          2077  
00001AE2                          2078  ; -----------------------------------------------------------------------------
00001AE2                          2079  PIPINIT
00001AE2                          2080  ; PIPE INITIALIZATION
00001AE2                          2081  ; -----------------------------------------------------------------------------
00001AE2                          2082              ;Guardar registros
00001AE2  48E7 C000               2083              MOVEM.L D0-D1,-(A7)
00001AE6                          2084          
00001AE6  30BC 0280               2085              MOVE.W  #SCRWIDTH,(A0)      ;X COORDINATE OF STARTING POSITION
00001AEA  4EB8 1392               2086              JSR     UTLRAND             ;RANDOM Y COORDINATE OF STARTING
00001AEE  3140 0002               2087              MOVE.W  D0,2(A0)            *POSITION
00001AF2  B23C 0004               2088              CMP.B   #4,D1
00001AF6  6606                    2089              BNE.S   .skip
00001AF8                          2090              
00001AF8  4239 00001BE8           2091              CLR.B   (PIPCOUNT)
00001AFE                          2092  .skip            
00001AFE  1141 0004               2093              MOVE.B  D1,4(A0)            ;BOOLEAN: MOVING OR NOT
00001B02                          2094          
00001B02                          2095              ;Restaurar registros
00001B02  4CDF 0003               2096              MOVEM.L (A7)+,D0-D1
00001B06  4E75                    2097              RTS
00001B08                          2098              
00001B08                          2099  ; -----------------------------------------------------------------------------
00001B08                          2100  PIPUPD
00001B08                          2101  ; PIPE UPDATE
00001B08                          2102  ; -----------------------------------------------------------------------------
00001B08                          2103              ;Guardar registros
00001B08  2F00                    2104              MOVE.L  D0,-(A7)
00001B0A                          2105              
00001B0A  3039 00001BEA           2106              MOVE.W  (XSPEED),D0     
00001B10  9150                    2107              SUB.W   D0,(A0)         ;UPDATE X COORDINATE
00001B12                          2108              
00001B12  0C50 FFC4               2109              CMP.W   #-PIPTWDT,(A0)
00001B16  6F04                    2110              BLE.S   .KILL
00001B18                          2111              
00001B18                          2112              
00001B18                          2113              
00001B18                          2114  .END        ;Restaurar registros
00001B18  201F                    2115              MOVE.L  (A7)+,D0
00001B1A  4E75                    2116              RTS
00001B1C                          2117              
00001B1C  4EB8 11AA               2118  .KILL       JSR     AGLKILL
00001B20  60F6                    2119              BRA.S  .END
00001B22                          2120              
00001B22                          2121  ; -----------------------------------------------------------------------------
00001B22                          2122  PIPPLOT
00001B22                          2123  ; PIPE PLOT
00001B22                          2124  ; -----------------------------------------------------------------------------
00001B22                          2125              ;Guardar registros
00001B22  48E7 F800               2126              MOVEM.L D0-D4,-(A7)
00001B26                          2127              
00001B26                          2128m             UTLSPEN #PIPPC
00001B26                          2129m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001B26                          2130m ; INPUT    - #PIPPC COLOR IN FORMAT $00BBGGRR
00001B26                          2131m ; OUTPUT   - NONE
00001B26                          2132m ; MODIFIES - D0,D1
00001B26                          2133m ; -----------------------------------------------------------------------------
00001B2E                          2134              
00001B2E  0C28 0000 0004          2135              CMP.B   #0,4(A0)
00001B34  6710                    2136              BEQ.S   .skip
00001B36                          2137              
00001B36                          2138m             UTLSFIL #PIPFC
00001B36                          2139m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001B36                          2140m ; INPUT    - #PIPFC COLOR IN FORMAT $00BBGGRR
00001B36                          2141m ; OUTPUT   - NONE
00001B36                          2142m ; MODIFIES - D0,D1
00001B36                          2143m ; -----------------------------------------------------------------------------
00001B42  6000 000A               2144              BRA     .skp2
00001B46                          2145  .skip       
00001B46                          2146m             UTLSFIL #$00000000      ;prueba para pipes que se han de mover
00001B46                          2147m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001B46                          2148m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001B46                          2149m ; OUTPUT   - NONE
00001B46                          2150m ; MODIFIES - D0,D1
00001B46                          2151m ; -----------------------------------------------------------------------------
00001B4E                          2152  .skp2
00001B4E                          2153              
00001B4E  3210                    2154              MOVE.W  (A0),D1         ;PAINT THE BASE OF THE TOP PIPE
00001B50  5A41                    2155              ADDQ    #PIPTBSPC,D1
00001B52  4242                    2156              CLR     D2
00001B54  3601                    2157              MOVE.W  D1,D3
00001B56  0643 0032               2158              ADD.W   #PIPBWDT,D3
00001B5A  3828 0002               2159              MOVE.W  2(A0),D4
00001B5E                          2160              
00001B5E  7057                    2161              MOVEQ   #87,D0
00001B60  4E4F                    2162              TRAP    #15
00001B62                          2163              
00001B62  3210                    2164              MOVE.W  (A0),D1         ;PAINT THE MOUTH OF THE TOP PIPE
00001B64  3828 0002               2165              MOVE.W  2(A0),D4
00001B68  3404                    2166              MOVE.W  D4,D2
00001B6A  0442 000A               2167              SUB.W   #PIPTHGT,D2
00001B6E  3601                    2168              MOVE.W  D1,D3
00001B70  0643 003C               2169              ADD.W   #PIPTWDT,D3
00001B74                          2170              
00001B74  7057                    2171              MOVEQ   #87,D0
00001B76  4E4F                    2172              TRAP    #15
00001B78                          2173              
00001B78  3210                    2174              MOVE.W  (A0),D1         ;PAINT THE BASE OF THE BOTTOM PIPE
00001B7A  5A41                    2175              ADD.W   #PIPTBSPC,D1
00001B7C  3428 0002               2176              MOVE.W  2(A0),D2
00001B80  0642 0050               2177              ADD.W   #PIPOPEN,D2
00001B84  3601                    2178              MOVE.W  D1,D3
00001B86  0643 0032               2179              ADD.W   #PIPBWDT,D3
00001B8A  383C 0168               2180              MOVE.W  #BGGSSTP,D4
00001B8E                          2181              
00001B8E  7057                    2182              MOVEQ   #87,D0
00001B90  4E4F                    2183              TRAP    #15
00001B92                          2184              
00001B92  3210                    2185              MOVE.W  (A0),D1         ;PAINT THE MOUTH OF THE BOTTOM PIPE
00001B94  3428 0002               2186              MOVE.W  2(A0),D2
00001B98  0642 0050               2187              ADD.W   #PIPOPEN,D2
00001B9C  3601                    2188              MOVE.W  D1,D3
00001B9E  0643 003C               2189              ADD.W   #PIPTWDT,D3
00001BA2  3802                    2190              MOVE.W  D2,D4
00001BA4  0644 000A               2191              ADD.W   #PIPTHGT,D4
00001BA8                          2192              
00001BA8  7057                    2193              MOVEQ   #87,D0
00001BAA  4E4F                    2194              TRAP    #15
00001BAC                          2195  
00001BAC                          2196              ;Restaurar registros
00001BAC  4CDF 001F               2197              MOVEM.L (A7)+,D0-D4
00001BB0  4E75                    2198              RTS
00001BB2                          2199  
00001BB2                          2200  
00001BB2                          2201  
00001BB2                          2202  
00001BB2                          2203  
00001BB2                          2204  
00001BB2                          2205  
00001BB2                          2206  -------------------- end include --------------------
00001BB2                          2207  
00001BB2                          2208  
00001BB2                          2209  ; --- INITIALIZE --------------------------------------------------------------
00001BB2                          2210  
00001BB2  4EB8 1000               2211  START       JSR     SYSINIT
00001BB6  4EB8 15E8               2212              JSR     STAINIT
00001BBA                          2213  
00001BBA                          2214  ; --- UPDATE ------------------------------------------------------------------
00001BBA                          2215   
00001BBA  4E40                    2216  .LOOP       TRAP    #KBDTRAP                ; READ KEYBOARD
00001BBC  4EB8 15FA               2217              JSR     STAUPD
00001BC0                          2218  
00001BC0                          2219  ; --- WAIT SYNCH --------------------------------------------------------------
00001BC0                          2220  
00001BC0  4A39 00001BF0           2221  .WINT       TST.B   (SCRINTCT)              ; WAIT FOR INTERRUPT
00001BC6  67F8                    2222              BEQ     .WINT
00001BC8  4239 00001BF0           2223              CLR.B   (SCRINTCT)
00001BCE                          2224  
00001BCE                          2225  ; --- PLOT --------------------------------------------------------------------
00001BCE                          2226  
00001BCE  4EB8 1658               2227              JSR     STAPLOT
00001BD2  4E41                    2228              TRAP    #SCRTRAP                ; SHOW GRAPHICS
00001BD4  60E4                    2229              BRA     .LOOP
00001BD6  FFFF FFFF               2230              SIMHALT
00001BDA                          2231  
00001BDA                          2232  ; --- VARIABLES ---------------------------------------------------------------
00001BDA                          2233  
00001BDA                          2234              INCLUDE "VAR.X68"
00001BDA                          2235  ; =============================================================================
00001BDA                          2236  ; GAME VARS
00001BDA                          2237  ; =============================================================================
00001BDA                          2238  
00001BDA                          2239  ; --- GAME STATE RELATED VARIABLES --------------------------------------------
00001BDA                          2240  
00001BDA                          2241  STACUR      DS.W    1                       ; CURRENT GAME STATE
00001BDC                          2242  STANEXT     DS.W    1                       ; NEXT GAME STATE
00001BDE                          2243  
00001BDE                          2244  ; --- PLAYER RELATED VARIABLES ------------------------------------------------
00001BDE                          2245  
00001BDE                          2246  PLRPOSX      DS.W    1                       ; PLAYER X POSITION (PIXELS)
00001BE0                          2247  PLRPOSY      DS.W    1                       ; PLAYER Y POSITION (PIXELS)
00001BE2                          2248  MAXPOS       DS.W    1                       ; JUMP MAX POSITION
00001BE4                          2249  UPPRESSED    DS.W    1                       ; 1 IF UP PRESSED, 0 IF NO PRESSED
00001BE6                          2250  PLRDOWNSPEED DS.W    1                       ; PLAYER DOWN SPEED
00001BE8                          2251               DS.W    0
00001BE8                          2252              
00001BE8                          2253  ; --- PIPE RELATED VARIABLES --------------------------------------------------
00001BE8                          2254  
00001BE8= 01                      2255  PIPCOUNT    DC.B    1
00001BEA                          2256              DS.W    0
00001BEA                          2257  
00001BEA                          2258  ; --- GAME RELATED VARIABLES --------------------------------------------------
00001BEA                          2259  
00001BEA= 0005                    2260  XSPEED      DC.W    5                       ;HORIZONTAL SPEED OF OBJECTS
00001BEC                          2261  
00001BEC                          2262  ; --- PAUSE MENU RELATED VARIABLES -------------------------------------------
00001BEC                          2263  
00001BEC= 00                      2264  PMOPTN      DC.B    0                       ;OPTION ON THE MENU TO BE CHOSEN
00001BED                          2265  
00001BED                          2266  ; --- UTILITY VARIABLES ------------------------------------------------------
00001BED                          2267  
00001BED                          2268  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001BEE                          2269              DS.W    0
00001BEE                          2270  
00001BEE                          2271  
00001BEE                          2272  
00001BEE                          2273  
00001BEE                          2274  
00001BEE                          2275  
00001BEE                          2276  
00001BEE                          2277  
00001BEE                          2278  
00001BEE                          2279  
00001BEE                          2280  
00001BEE                          2281  
00001BEE                          2282  
00001BEE                          2283  
00001BEE                          2284  -------------------- end include --------------------
00001BEE                          2285              INCLUDE "SYSVAR.X68"
00001BEE                          2286  ; =============================================================================
00001BEE                          2287  ; SYSTEM VARS
00001BEE                          2288  ; NOTE THAT ALL THESE VARS ARE USED TO SHARE DATA FROM SYSTEM TO USER. THUS
00001BEE                          2289  ; THEY MUST NOT BE IN PROTECTED MEMORY.
00001BEE                          2290  ; NOTE THAT USING DMMDATA IN SUCH WAY IS A BAD IDEA, AS USER APPLICATIONS CAN
00001BEE                          2291  ; ALSO FREE OR CHANGE OWNERSHIP. NONETHELESS, FOR THE SAKE OF THIS EXAMPLE
00001BEE                          2292  ; THIS IS GOOD ENOUGH.
00001BEE                          2293  ; =============================================================================
00001BEE                          2294  
00001BEE                          2295  ; --- KEYBOARD RELATED VARIABLES ----------------------------------------------
00001BEE                          2296  
00001BEE                          2297  KBDVAL      DS.B    1                       ; KEY PRESSED=1
00001BEF                          2298  KBDEDGE     DS.B    1                       ; KEY CHANGED=1
00001BF0                          2299  
00001BF0                          2300              DS.W    0
00001BF0                          2301  
00001BF0                          2302  ; --- SCREEN RELATED VARIABLES ------------------------------------------------
00001BF0                          2303  
00001BF0                          2304  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER/FLAG
00001BF1                          2305  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00001BF2                          2306              DS.W    0
00001BF2                          2307  
00001BF2                          2308  ; --- DYNAMIC MEMORY VARIABLES ------------------------------------------------
00001BF2                          2309  
00001C00                          2310              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00001C00                          2311  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00002880                          2312              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00002880                          2313  
00002880                          2314  
00002880                          2315  -------------------- end include --------------------
00002880                          2316  
00002880                          2317              END    START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              14B0
AGLADD:END          14C6
AGLKILL             11AA
AGLPLOT             14FE
AGLPLOT:END         152E
AGLPLOT:LOOP        1506
AGLPLOT:NEXT        1528
AGLUPD              14CA
AGLUPD:END          14F8
AGLUPD:LOOP         14D2
AGLUPD:NEXT         14F2
BGGNDFC             155DD8
BGGNDPC             0
BGGNDTP             190
BGGSSBT             190
BGGSSFC             990A
BGGSSPC             0
BGGSSTP             168
BGPLOT              1A78
BGSKYFC             EFCE87
BGSKYPC             0
BGUPD               1A2C
BGUPD:CLOUD         1A50
BGUPD:END           1A72
BLACK               0
CLDFCLR             FFFFFF
CLDINIT             196E
CLDPCLR             FFFFFF
CLDPLOT             199E
CLDSIZE             3C
CLDTYPE             1
CLDUPD              1980
CLDUPD:END          1994
CLDUPD:KILL         1998
CONTNUM             0
DMMALLOC            1190
DMMALLOC:END        11A8
DMMBNUM             32
DMMBSIZE            40
DMMDATA             1C00
DMMFCOM             116A
DMMFFND             1178
DMMFIRST            1120
DMMFLOOP            115E
DMMFRCOM            1132
DMMFREE             11AA
DMMFRFND            1140
DMMFRLOP            1126
DMMFRSTO            1158
DMMINIT             10FE
DMMINIT:LOOP        110C
DMMNEXT             1142
DMMNEXTO            117A
DMMSYSID            0
EXTNUM              2
GOVSTRC             FFFFFF
GOVSTRX             23
GOVSTRY             F
GREEN               8000
GSSDFC              39DB44
GSSDINIT            19D6
GSSDPLOT            19FA
GSSDTYPE            2
GSSDUPD             19E0
GSSDUPD:END         19F0
GSSDUPD:KILL        19F4
GSSDWDTH            A
INTPRSC             80
INTPRSF             31A0001
INTPRSX             5
INTPRSY             8
INTTITC             FFFF
INTTITF             33D0001
INTTITX             1
INTTITY             1
JUMPSIZE            3C
JUMPSPEED           3
KBDBITDN            3
KBDBITF1            4
KBDBITF2            5
KBDBITF3            6
KBDBITLF            0
KBDBITPS            7
KBDBITRT            2
KBDBITUP            1
KBDCHRDN            28
KBDCHRLF            25
KBDCHRMK            4D
KBDCHRPK            50
KBDCHRRT            27
KBDCHRSH            10
KBDCHRSP            20
KBDCHRUP            26
KBDDOWN             28
KBDEDGE             1BEF
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1090
KBDLEFT             25
KBDMSKDN            8
KBDMSKF1            10
KBDMSKF2            20
KBDMSKF3            40
KBDMSKLF            1
KBDMSKPS            80
KBDMSKRT            4
KBDMSKUP            2
KBDPAUSE            50
KBDREAD             10A6
KBDREAD:KEYSREADY   10E2
KBDREAD:LOOP        10C4
KBDREAD:NEXTKEYS    10C2
KBDREAD:NOTPRESSED  10CE
KBDRIGHT            27
KBDTRAP             0
KBDUP               26
KBDVAL              1BEE
MAXPOS              1BE2
NEWGNUM             1
PAUCNTY             8
PAUEXTY             C
PAUNEWY             A
PAUOPTC             FFFFFF
PAUOPTFS            1130005
PAUOPTFU            1130001
PAUOPTX             F
PAUSELC             FF
PAUTITC             FFFF
PAUTITF             3300001
PAUTITX             2
PAUTITY             1
PIPBWDT             32
PIPCOUNT            1BE8
PIPFC               196600
PIPINIT             1AE2
PIPINIT:SKIP        1AFE
PIPOPEN             50
PIPPC               0
PIPPLOT             1B22
PIPPLOT:SKIP        1B46
PIPPLOT:SKP2        1B4E
PIPTBSPC            5
PIPTHGT             A
PIPTWDT             3C
PIPTYPE             3
PIPUPD              1B08
PIPUPD:END          1B18
PIPUPD:KILL         1B1C
PIPYSPD             2
PLRCOLOR            8000
PLRDOWNSPEED        1BE6
PLREYECOLOR         FFFFFF
PLRHEIGHT           1E
PLRINIT             11C0
PLRINITPOSX         96
PLRINITPOSY         B4
PLRIRISCOLOR        0
PLRMOUTHCOLOR       FF
PLRPLOT             12A6
PLRPOSX             1BDE
PLRPOSY             1BE0
PLRUPD              11EA
PLRUPD:END          12A0
PLRUPD:GAMEOVER     1294
PLRUPD:LASTJUMP     1288
PLRUPD:MAKEJUMP     1254
PLRUPD:PRESSED      1230
PLRWIDTH            1E
PMOPTN              1BEC
PRPADD              1534
PRPADD:END          154A
PRPKILL             11AA
PRPPLOT             157C
PRPPLOT:END         15A4
PRPPLOT:LOOP        1584
PRPPLOT:NEXT        159E
PRPUPD              154E
PRPUPD:END          1576
PRPUPD:LOOP         1556
PRPUPD:NEXT         1570
RED                 FF
SCRCYCCT            1BF1
SCRHEIGH            1E0
SCRINIT             101C
SCRINTCT            1BF0
SCRIRQ              1
SCRISR              1074
SCRTIM              14
SCRTRAP             1
SCRUPD              1082
SCRWIDTH            280
SPWUPD              15AA
SPWUPD:END          15E2
STACUR              1BDA
STAEMPTY            1684
STAGOVR             3
STAGOVRP            192E
STAGOVRP:GOVSTR     1962
STAGOVRU            1918
STAGOVRU:END        192C
STAINIT             15E8
STAINTR             0
STAINTRI            10FE
STAINTRP            16D8
STAINTRP:START_TEXT  173A
STAINTRP:TITLE      172E
STAINTRU            16C2
STAINTRU:END        16D6
STANEXT             1BDC
STANONE             FFFFFFFF
STAPAU              2
STAPAUI             1750
STAPAUP             17F2
STAPAUP:CNTSEL      1844
STAPAUP:CONT        18FC
STAPAUP:EXIT        1912
STAPAUP:EXTSEL      18C4
STAPAUP:NEWG        1906
STAPAUP:NEWSEL      1884
STAPAUP:SKPCNT      1854
STAPAUP:SKPEXT      18D4
STAPAUP:SKPNEW      1894
STAPAUP:TITLE       18EE
STAPAUU             175A
STAPAUU:CONTGAME    17D4
STAPAUU:DN          179E
STAPAUU:END         178A
STAPAUU:EXITGAME    17E8
STAPAUU:JMPLST      17C2
STAPAUU:NEWGAME     17DE
STAPAUU:OK          17B0
STAPAUU:UP          178C
STAPLAY             1
STAPLAYI            11C0
STAPLAYP            16B0
STAPLAYU            1686
STAPLAYU:PAUSE      16A6
STAPLOT             1658
STAPLOT:PLTTBL      1674
START               1BB2
START:LOOP          1BBA
START:WINT          1BC0
STAUPD              15FA
STAUPD:DOUPD        1620
STAUPD:INITBL       1638
STAUPD:UPDTBL       1648
SYSINIT             1000
UPPRESSED           1BE4
UTLCHCOL            135E
UTLCHCOL:END        138C
UTLCHCOL:NOCOL      138A
UTLFONT             37C
UTLINIT             1356
UTLLOCT             254
UTLRAND             1392
UTLRAND:RANDVEC     13B0
UTLRNDIX            1BED
UTLSFIL             12A
UTLSPEN             0
WHITE               FFFFFF
XSPEED              1BEA
