00001BBE Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 30/12/2018 19:50:18

00000000                             1  ; =============================================================================
00000000                             2  ; TITLE    : YET ANOTHER FLAPPY BIRD (YAF)
00000000                             3  ; AUTHORS  : DOÑAQUE, EUGENIO && LLABRÉS, NADAL.
00000000                             4  ; CREATION : DEC 2018
00000000                             5  ; =============================================================================
00000000                             6  
00001000                             7              ORG     $1000
00001000                             8  
00001000                             9  ; --- CODE INCLUDES -----------------------------------------------------------
00001000                            10  
00001000                            11              INCLUDE "SYSCONST.X68"               ; SYSTEM CONSTANTS
00001000                            12  ; =============================================================================
00001000                            13  ; SYSTEM CONSTANTS
00001000                            14  ; =============================================================================
00001000                            15  
00001000                            16  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
00001000                            17  
00001000  =00000000                 18  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
00001000  =00000001                 19  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
00001000                            20  
00001000                            21  ; --- KEY CODES (EASy68K)
00001000                            22  
00001000  =00000020                 23  KBDCHRSP    EQU     $20                     ; SPACE KEY
00001000  =0000004D                 24  KBDCHRMK    EQU     'M'                     ; M KEY
00001000  =00000010                 25  KBDCHRSH    EQU     $10                     ; SHIFT KEY
00001000  =00000050                 26  KBDCHRPK    EQU     'P'                     ; P KEY
00001000  =00000025                 27  KBDCHRLF    EQU     $25                     ; LEFT KEY
00001000  =00000026                 28  KBDCHRUP    EQU     $26                     ; UP KEY
00001000  =00000027                 29  KBDCHRRT    EQU     $27                     ; RIGHT KEY
00001000  =00000028                 30  KBDCHRDN    EQU     $28                     ; DOWN KEY
00001000                            31  
00001000                            32  ; --- KEYBOARD MAPPING --------------------------------------------------------
00001000                            33  
00001000  =00000025                 34  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
00001000  =00000026                 35  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
00001000  =00000027                 36  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
00001000  =00000028                 37  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
00001000  =00000020                 38  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
00001000  =0000004D                 39  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
00001000  =00000010                 40  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
00001000  =00000050                 41  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
00001000                            42  
00001000                            43  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
00001000                            44  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
00001000                            45  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
00001000                            46  ; +---+---+---+---+---+---+---+---+
00001000                            47  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
00001000                            48  ; +---+---+---+---+---+---+---+---+
00001000                            49  ;   |   |   |   |   |   |   |   |
00001000                            50  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
00001000                            51  ;   |   |   |   |   |   |   +-------------- UP BUTTON
00001000                            52  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
00001000                            53  ;   |   |   |   |   +---------------------- DOWN BUTTON
00001000                            54  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
00001000                            55  ;   |   |   +------------------------------ FIRE 2 BUTTON
00001000                            56  ;   |   +---------------------------------- FIRE 3 BUTTON
00001000                            57  ;   +-------------------------------------- PAUSE BUTTON
00001000                            58  
00001000  =00000001                 59  KBDMSKLF    EQU     %00000001
00001000  =00000002                 60  KBDMSKUP    EQU     %00000010
00001000  =00000004                 61  KBDMSKRT    EQU     %00000100
00001000  =00000008                 62  KBDMSKDN    EQU     %00001000
00001000  =00000010                 63  KBDMSKF1    EQU     %00010000
00001000  =00000020                 64  KBDMSKF2    EQU     %00100000
00001000  =00000040                 65  KBDMSKF3    EQU     %01000000
00001000  =00000080                 66  KBDMSKPS    EQU     %10000000
00001000                            67  
00001000                            68  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
00001000                            69  
00001000  =00000000                 70  KBDBITLF    EQU     0
00001000  =00000001                 71  KBDBITUP    EQU     1
00001000  =00000002                 72  KBDBITRT    EQU     2
00001000  =00000003                 73  KBDBITDN    EQU     3
00001000  =00000004                 74  KBDBITF1    EQU     4
00001000  =00000005                 75  KBDBITF2    EQU     5
00001000  =00000006                 76  KBDBITF3    EQU     6
00001000  =00000007                 77  KBDBITPS    EQU     7
00001000                            78  
00001000                            79  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
00001000                            80  
00001000  =00000280                 81  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
00001000  =000001E0                 82  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
00001000  =00000001                 83  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
00001000  =00000014                 84  SCRTIM      EQU     20                      ; SCREEN TIMER (MS)
00001000                            85  
00001000                            86  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
00001000                            87  
00001000  =00000040                 88  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001000  =00000032                 89  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001000  =00000000                 90  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001000                            91  
00001000                            92  
00001000                            93  
00001000                            94  
00001000                            95  -------------------- end include --------------------
00001000                            96              INCLUDE "SYSTEM.X68"                 ; SYSTEM CODE
00001000                            97  ; =============================================================================
00001000                            98  ; SYSTEM MANAGEMENT (SYSTEM CODE)
00001000                            99  ; =============================================================================
00001000                           100  
00001000                           101  ; -----------------------------------------------------------------------------
00001000                           102  SYSINIT
00001000                           103  ; INITIALIZES THE SYSTEM
00001000                           104  ; INPUT    - NONE
00001000                           105  ; OUTPUT   - NONE
00001000                           106  ; MODIFIES - NONE
00001000                           107  ; -----------------------------------------------------------------------------
00001000  205F                     108              MOVE.L  (A7)+,A0                ; GET RETURN ADDRESS
00001002  4EB9 00001090            109              JSR     KBDINIT                 ; INIT KEYBOARD
00001008  4EB9 0000101C            110              JSR     SCRINIT                 ; INIT SCREEN
0000100E  4EB9 000010FE            111              JSR     DMMINIT                 ; INIT DYNAMIC MEMORY
00001014  027C DFFF                112              ANDI.W  #$DFFF,SR               ; SWITCH TO USER
00001018  2F08                     113              MOVE.L  A0,-(A7)                ; PUT RETURN ADDRESS
0000101A  4E75                     114              RTS
0000101C                           115  
0000101C                           116  ; =============================================================================
0000101C                           117  ; SCREEN MANAGEMENT (SYSTEM CODE)
0000101C                           118  ; =============================================================================
0000101C                           119  
0000101C                           120  ; -----------------------------------------------------------------------------
0000101C                           121  SCRINIT
0000101C                           122  ; INITIALIZES THE SCREEN, SCREEN-RELATED INTERRUPT AND VARS.
0000101C                           123  ; INPUT    - NONE
0000101C                           124  ; OUTPUT   - NONE
0000101C                           125  ; MODIFIES - D0,D1,D2,D3
0000101C                           126  ; -----------------------------------------------------------------------------
0000101C                           127              ; TO DO:
0000101C                           128              ; - DISABLE INTS (SET INT BITS IN SR TO 111)
0000101C                           129              
0000101C  007C 0700                130              ORI.W #(7<<8)&$700,SR
00001020                           131              
00001020                           132              ; - INSTALL SCRUPD INTO TRAP SCRTRAP
00001020                           133              
00001020  21FC 00001082 0084       134              MOVE.L  #SCRUPD,($80+4*SCRTRAP)
00001028                           135              
00001028                           136              ; - SET RESOLUTION TO SCRWIDTH X SCRHEIGHT
00001028                           137              
00001028  7021                     138              MOVE.L  #33,D0
0000102A  223C 028001E0            139              MOVE.L  #SCRWIDTH*$10000+SCRHEIGH,D1
00001030  4E4F                     140              TRAP    #15
00001032                           141              
00001032                           142              ; - SET WINDOWED MODE
00001032                           143              
00001032  7201                     144              MOVEQ   #1, D1 
00001034  4E4F                     145              TRAP    #15
00001036                           146              
00001036                           147              ; - CLEAR VISIBLE BUFFER
00001036                           148              
00001036  700B                     149              MOVEQ   #11, D0
00001038  323C FF00                150              MOVE.W  #$FF00,D1
0000103C  4E4F                     151              TRAP    #15
0000103E                           152              
0000103E                           153              ; - ENABLE DOUBLE BUFFER
0000103E                           154              
0000103E  705C                     155              MOVEQ   #92, D0
00001040  7211                     156              MOVEQ   #17, D1     
00001042  4E4F                     157              TRAP    #15
00001044                           158              
00001044                           159              ; - CLEAR HIDDEN BUFFER
00001044                           160              
00001044  700B                     161              MOVEQ   #11, D0
00001046  323C FF00                162              MOVE.W  #$FF00,D1
0000104A  4E4F                     163              TRAP    #15
0000104C                           164              
0000104C                           165              ; - INSTALL SCRISR FOR IRQ SCRIRQ (IRQ INTERRUPT VECTOR BEGINS
0000104C                           166              ;   AT $60. INSTALLATION IS SIMILAR TO TRAP INSTALLATION)
0000104C                           167              
0000104C  21FC 00001074 0064       168              MOVE.L  #SCRISR,($60+4*SCRIRQ)
00001054                           169              
00001054                           170              ; - ENABLE AUTO-IRQ EVERY SCRTIM MS FOR IRQ SCRIRQ (SEE TRAP #15
00001054                           171              ;   TASK 32)
00001054                           172              
00001054  7020                     173              MOVEQ   #32,D0
00001056  7206                     174              MOVEQ   #6,D1
00001058  243C 00000081            175              MOVE.L  #$80+SCRIRQ,D2
0000105E  7614                     176              MOVE.L  #SCRTIM, D3
00001060  4E4F                     177              TRAP    #15
00001062                           178              
00001062                           179              ; - CLEAR SCRINTCT AND SCRCYCCT
00001062                           180              
00001062  4239 00001BFC            181              CLR.B   (SCRINTCT)
00001068  4239 00001BFD            182              CLR.B   (SCRCYCCT)
0000106E                           183              
0000106E                           184              ; - ENABLE INTS (SET INT BITS IN SR TO 000)
0000106E                           185              
0000106E  027C F8FF                186              ANDI.W #$F8FF,SR
00001072                           187              
00001072  4E75                     188              RTS
00001074                           189  
00001074                           190  ; -----------------------------------------------------------------------------
00001074                           191  SCRISR
00001074                           192  ; SCREEN TIMER ISR. INCREASES THE INTERRUPT COUNTER AND UPDATES DOUBLE BUFFER.
00001074                           193  ; INPUT    - NONE
00001074                           194  ; OUTPUT   - NONE
00001074                           195  ; MODIFIES - NONE
00001074                           196  ; -----------------------------------------------------------------------------
00001074  5239 00001BFC            197              ADDQ.B  #1,(SCRINTCT)           ; UPDATE INT FLAG/COUNTER
0000107A  5239 00001BFD            198              ADDQ.B  #1,(SCRCYCCT)           ; UPDATE CYCLE COUNTER
00001080  4E73                     199              RTE
00001082                           200  
00001082                           201  ; -----------------------------------------------------------------------------
00001082                           202  SCRUPD
00001082                           203  ; TRAP SERVICE ROUTINE IN CHARGE OF VISUALIZING CURRENT FRAME AND CLEARING
00001082                           204  ; BUFFER FOR THE NEXT ONE.
00001082                           205  ; INPUT    - NONE
00001082                           206  ; OUTPUT   - NONE
00001082                           207  ; MODIFIES - NONE
00001082                           208  ; -----------------------------------------------------------------------------
00001082                           209              ; TO DO: UPDATE DOUBLE BUFFER AND CLEAR HIDDEN BUFFER
00001082                           210              ; - UPDATE DOUBLE BUFFER
00001082                           211              
00001082  705E                     212              MOVEQ   #94,D0
00001084  4E4F                     213              TRAP    #15
00001086                           214              
00001086                           215              ; - CLEAR HIDDEN BUFFER
00001086                           216                                 
00001086  700B                     217              MOVEQ   #11, D0
00001088  323C FF00                218              MOVE.W  #$FF00,D1
0000108C  4E4F                     219              TRAP    #15
0000108E                           220              
0000108E  4E73                     221              RTE
00001090                           222  
00001090                           223  ; =============================================================================
00001090                           224  ; KEYBOARD MANAGEMENT (SYSTEM CODE)
00001090                           225  ; =============================================================================
00001090                           226  
00001090                           227  ; -----------------------------------------------------------------------------
00001090                           228  KBDINIT
00001090                           229  ; INITIALIZES THE SYSTEM VARIABLES KBDSYS AND KBDVAL
00001090                           230  ; INPUT    - NONE
00001090                           231  ; OUTPUT   - NONE
00001090                           232  ; MODIFIES - NONE
00001090                           233  ; -----------------------------------------------------------------------------
00001090  4239 00001BFA            234              CLR.B   (KBDVAL)                ; INIT VARS
00001096  4239 00001BFB            235              CLR.B   (KBDEDGE)
0000109C  21FC 000010A6 0080       236              MOVE.L  #KBDREAD,($80+KBDTRAP*4) ; INSTALL
000010A4  4E75                     237              RTS
000010A6                           238  
000010A6                           239  ; -----------------------------------------------------------------------------
000010A6                           240  KBDREAD
000010A6                           241  ; TRAP SERVICE ROUTINE.
000010A6                           242  ; UPDATES THE SYSTEM VARIABLES KBDEDGE AND KBDVAL ACCORDING TO THE BITFIELD
000010A6                           243  ; DESCRIBED IN SYSCONST. KBDVAL HOLDS THE CURRENT VALUES AND KBDEFGE HOLDS
000010A6                           244  ; RISING EDGES FROM PREVIOUS CALL TO THE CURRENT ONE.
000010A6                           245  ; INPUT    - NONE
000010A6                           246  ; OUTPUT   - (KBDVAL) AND (KBDEDGE)
000010A6                           247  ; MODIFIES - NONE
000010A6                           248  ; -----------------------------------------------------------------------------
000010A6                           249              ; TO DO: UPDATE KBDVAL AND KBDEDGE
000010A6                           250              ;Guardar registros en pila
000010A6  48E7 F800                251              MOVEM.L D0-D4,-(A7)
000010AA                           252  
000010AA                           253              ;Obtener estado de teclas
000010AA  7013                     254              MOVEQ   #19,D0
000010AC                           255              
000010AC                           256              ;Obtener estado de teclas PAUSE - FIRE3 - FIRE2 - FIRE1
000010AC  223C 50104D20            257              MOVE.L  #KBDCHRPK<<24+KBDCHRSH<<16+KBDCHRMK<<8+KBDCHRSP,D1
000010B2                           258              
000010B2  4E4F                     259              TRAP    #15
000010B4                           260              
000010B4                           261              ;GUARDAR ESTADO DE TECLAS
000010B4  2401                     262              MOVE.L  D1,D2                   
000010B6                           263              
000010B6                           264              ;Obtener estado de teclas DOWN - RIGHT - UP - LEFT
000010B6  223C 28272625            265              MOVE.L  #KBDCHRDN<<24+KBDCHRRT<<16+KBDCHRUP<<8+KBDCHRLF,D1
000010BC                           266  
000010BC  4E4F                     267              TRAP    #15
000010BE                           268            
000010BE                           269              ;Actualizar valores de KBDVAL
000010BE  4243                     270              CLR     D3        ;Registro que contendrá KBDVAL.
000010C0  4244                     271              CLR     D4        ;Registro con índice de bit a modificar de D3.
000010C2                           272              
000010C2                           273              
000010C2                           274              ;Bucle que recorre D1 para obtener estado de teclas.
000010C2  7003                     275  .NEXTKEYS   MOVEQ   #3, D0    ;Número de iteraciones del bucle (.LOOP).
000010C4                           276  
000010C4                           277  .LOOP                   
000010C4  0801 0000                278              BTST    #0, D1
000010C8  6700 0004                279              BEQ     .NOTPRESSED
000010CC                           280              ;If pressed, set corresponding bit
000010CC  09C3                     281              BSET    D4, D3                  
000010CE                           282                        
000010CE                           283  .NOTPRESSED              
000010CE                           284              *En cualquier caso, obtener siguiente byte de D1*
000010CE                           285              
000010CE                           286              ;Se desplaza el registro D1 8 bits a la derecha. 
000010CE  E089                     287              LSR.L   #8, D1
000010D0                           288              
000010D0                           289              ;Se incrementa el índice de D3.
000010D0  5244                     290              ADDQ    #1, D4
000010D2  51C8 FFF0                291              DBRA    D0, .LOOP
000010D6                           292              
000010D6                           293              ;Comprobar si hay que analizar el segundo conjunto de teclas. 
000010D6  B83C 0004                294              CMP.B   #4, D4
000010DA  6600 0006                295              BNE     .KEYSREADY            
000010DE                           296             
000010DE                           297              ;Se mueve el segundo conjunto de teclas al registro D1 y se
000010DE                           298              ;repite el bucle .LOOP.
000010DE  2202                     299              MOVE.L  D2, D1
000010E0  60E0                     300              BRA     .NEXTKEYS
000010E2                           301  
000010E2                           302  .KEYSREADY  
000010E2                           303              ;Recuperamos el anterior KBDVAL en D4.
000010E2  1839 00001BFA            304              MOVE.B  (KBDVAL), D4
000010E8                           305              ;Se mueve el byte obtenido a KBDVAL.         
000010E8  13C3 00001BFA            306              MOVE.B  D3, KBDVAL 
000010EE                           307  
000010EE  4604                     308              NOT.B   D4
000010F0  C604                     309              AND.B   D4, D3
000010F2  13C3 00001BFB            310              MOVE.B  D3, (KBDEDGE)             
000010F8                           311              
000010F8                           312              ;Restaurar registros a su estado original. 
000010F8  4CDF 001F                313              MOVEM.L (A7)+,D0-D4
000010FC                           314  
000010FC  4E73                     315              RTE
000010FE                           316  
000010FE                           317  ; =============================================================================
000010FE                           318  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
000010FE                           319  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
000010FE                           320  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
000010FE                           321  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
000010FE                           322  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
000010FE                           323  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
000010FE                           324  ; =============================================================================
000010FE                           325  
000010FE                           326  ; -----------------------------------------------------------------------------
000010FE                           327  DMMINIT
000010FE                           328  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
000010FE                           329  ; INPUT    - NONE
000010FE                           330  ; OUTPUT   - NONE
000010FE                           331  ; MODIFIES - NONE
000010FE                           332  ; -----------------------------------------------------------------------------
000010FE  48E7 8080                333              MOVEM.L D0/A0,-(A7)
00001102  41F9 00001C00            334              LEA     DMMDATA,A0
00001108  303C 0031                335              MOVE.W  #DMMBNUM-1,D0
0000110C  30BC 0000                336  .LOOP       MOVE.W  #DMMSYSID,(A0)
00001110  D1FC 00000040            337              ADD.L   #DMMBSIZE,A0
00001116  51C8 FFF4                338              DBRA.W  D0,.LOOP
0000111A  4CDF 0101                339              MOVEM.L (A7)+,D0/A0
0000111E  4E75                     340              RTS
00001120                           341  
00001120                           342  ; -----------------------------------------------------------------------------
00001120                           343  DMMFIRST
00001120                           344  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001120                           345  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001120                           346  ; INPUT    - NONE
00001120                           347  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001120                           348  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001120                           349  ; -----------------------------------------------------------------------------
00001120  41F9 00001C00            350              LEA     DMMDATA,A0
00001126  4A58                     351  DMMFRLOP    TST.W   (A0)+
00001128  6600 0016                352              BNE     DMMFRFND
0000112C  D1FC 0000003E            353              ADD.L   #DMMBSIZE-2,A0
00001132  B1FC 0000287F            354  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001138  6DEC                     355              BLT     DMMFRLOP
0000113A  207C 00000000            356              MOVE.L  #0,A0
00001140  4E75                     357  DMMFRFND    RTS
00001142                           358  
00001142                           359  ; -----------------------------------------------------------------------------
00001142                           360  DMMNEXT
00001142                           361  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001142                           362  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001142                           363  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
00001142                           364  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001142                           365  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001142                           366  ; -----------------------------------------------------------------------------
00001142  2F00                     367              MOVE.L  D0,-(A7)
00001144  2008                     368              MOVE.L  A0,D0
00001146  C0BC FFFFFFC0            369              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
0000114C  0680 00000040            370              ADD.L   #DMMBSIZE,D0
00001152  2040                     371              MOVE.L  D0,A0
00001154  201F                     372              MOVE.L  (A7)+,D0
00001156  60DA                     373              BRA     DMMFRCOM
00001158                           374  
00001158                           375  ; -----------------------------------------------------------------------------
00001158                           376  DMMFRSTO
00001158                           377  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
00001158                           378  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001158                           379  ; INPUT    - D0.W : ID TO SEARCH
00001158                           380  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001158                           381  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001158                           382  ; -----------------------------------------------------------------------------
00001158  41F9 00001C00            383              LEA     DMMDATA,A0
0000115E  B058                     384  DMMFLOOP    CMP.W   (A0)+,D0
00001160  6700 0016                385              BEQ     DMMFFND
00001164  D1FC 0000003E            386              ADD.L   #DMMBSIZE-2,A0
0000116A  B1FC 0000287F            387  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001170  6DEC                     388              BLT     DMMFLOOP
00001172  207C 00000000            389              MOVE.L  #0,A0
00001178  4E75                     390  DMMFFND     RTS
0000117A                           391  
0000117A                           392  ; -----------------------------------------------------------------------------
0000117A                           393  DMMNEXTO
0000117A                           394  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000117A                           395  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000117A                           396  ; INPUT    - D0.W : ID TO SEARCH
0000117A                           397  ;            A0   : POINTER WITHIN THE CURRENT SLOT
0000117A                           398  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000117A                           399  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000117A                           400  ; -----------------------------------------------------------------------------
0000117A  2F00                     401              MOVE.L  D0,-(A7)
0000117C  2008                     402              MOVE.L  A0,D0
0000117E  C0BC FFFFFFC0            403              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001184  0680 00000040            404              ADD.L   #DMMBSIZE,D0
0000118A  2040                     405              MOVE.L  D0,A0
0000118C  201F                     406              MOVE.L  (A7)+,D0
0000118E  60DA                     407              BRA     DMMFCOM
00001190                           408  
00001190                           409  ; -----------------------------------------------------------------------------
00001190                           410  DMMALLOC
00001190                           411  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
00001190                           412  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
00001190                           413  ; INPUT    - D0.W : ID TO ASSIGN
00001190                           414  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
00001190                           415  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001190                           416  ; -----------------------------------------------------------------------------
00001190  3F00                     417              MOVE.W  D0,-(A7)
00001192  4240                     418              CLR.W   D0
00001194  4EB8 1158                419              JSR     DMMFRSTO
00001198  301F                     420              MOVE.W  (A7)+,D0
0000119A  B1FC 00000000            421              CMP.L   #0,A0
000011A0  6700 0006                422              BEQ     .END
000011A4  3140 FFFE                423              MOVE.W  D0,-2(A0)
000011A8  4E75                     424  .END        RTS
000011AA                           425  
000011AA                           426  ; -----------------------------------------------------------------------------
000011AA                           427  DMMFREE
000011AA                           428  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000011AA                           429  ; SYSTEM (0)
000011AA                           430  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000011AA                           431  ; OUTPUT   - NONE
000011AA                           432  ; MODIFIES - NONE
000011AA                           433  ; -----------------------------------------------------------------------------
000011AA  48E7 8080                434              MOVEM.L D0/A0,-(A7)
000011AE  2008                     435              MOVE.L  A0,D0
000011B0  C0BC FFFFFFC0            436              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000011B6  2040                     437              MOVE.L  D0,A0
000011B8  4250                     438              CLR.W   (A0)
000011BA  4CDF 0101                439              MOVEM.L (A7)+,D0/A0
000011BE  4E75                     440              RTS
000011C0                           441  
000011C0                           442  
000011C0                           443  
000011C0                           444  
000011C0                           445  -------------------- end include --------------------
000011C0                           446              INCLUDE "SYSCONST.X68"               ; SYSTEM CONSTANTS
000011C0                           447  ; =============================================================================
000011C0                           448  ; SYSTEM CONSTANTS
000011C0                           449  ; =============================================================================
000011C0                           450  
000011C0                           451  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
000011C0                           452  
000011C0  =00000000                453  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
000011C0  =00000001                454  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
000011C0                           455  
000011C0                           456  ; --- KEY CODES (EASy68K)
000011C0                           457  
000011C0  =00000020                458  KBDCHRSP    EQU     $20                     ; SPACE KEY
000011C0  =0000004D                459  KBDCHRMK    EQU     'M'                     ; M KEY
000011C0  =00000010                460  KBDCHRSH    EQU     $10                     ; SHIFT KEY
000011C0  =00000050                461  KBDCHRPK    EQU     'P'                     ; P KEY
000011C0  =00000025                462  KBDCHRLF    EQU     $25                     ; LEFT KEY
000011C0  =00000026                463  KBDCHRUP    EQU     $26                     ; UP KEY
000011C0  =00000027                464  KBDCHRRT    EQU     $27                     ; RIGHT KEY
000011C0  =00000028                465  KBDCHRDN    EQU     $28                     ; DOWN KEY
000011C0                           466  
000011C0                           467  ; --- KEYBOARD MAPPING --------------------------------------------------------
000011C0                           468  
000011C0  =00000025                469  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
000011C0  =00000026                470  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
000011C0  =00000027                471  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
000011C0  =00000028                472  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
000011C0  =00000020                473  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
000011C0  =0000004D                474  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
000011C0  =00000010                475  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
000011C0  =00000050                476  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
000011C0                           477  
000011C0                           478  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
000011C0                           479  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
000011C0                           480  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
000011C0                           481  ; +---+---+---+---+---+---+---+---+
000011C0                           482  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
000011C0                           483  ; +---+---+---+---+---+---+---+---+
000011C0                           484  ;   |   |   |   |   |   |   |   |
000011C0                           485  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
000011C0                           486  ;   |   |   |   |   |   |   +-------------- UP BUTTON
000011C0                           487  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
000011C0                           488  ;   |   |   |   |   +---------------------- DOWN BUTTON
000011C0                           489  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
000011C0                           490  ;   |   |   +------------------------------ FIRE 2 BUTTON
000011C0                           491  ;   |   +---------------------------------- FIRE 3 BUTTON
000011C0                           492  ;   +-------------------------------------- PAUSE BUTTON
000011C0                           493  
000011C0  =00000001                494  KBDMSKLF    EQU     %00000001
000011C0  =00000002                495  KBDMSKUP    EQU     %00000010
000011C0  =00000004                496  KBDMSKRT    EQU     %00000100
000011C0  =00000008                497  KBDMSKDN    EQU     %00001000
000011C0  =00000010                498  KBDMSKF1    EQU     %00010000
000011C0  =00000020                499  KBDMSKF2    EQU     %00100000
000011C0  =00000040                500  KBDMSKF3    EQU     %01000000
000011C0  =00000080                501  KBDMSKPS    EQU     %10000000
000011C0                           502  
000011C0                           503  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
000011C0                           504  
000011C0  =00000000                505  KBDBITLF    EQU     0
000011C0  =00000001                506  KBDBITUP    EQU     1
000011C0  =00000002                507  KBDBITRT    EQU     2
000011C0  =00000003                508  KBDBITDN    EQU     3
000011C0  =00000004                509  KBDBITF1    EQU     4
000011C0  =00000005                510  KBDBITF2    EQU     5
000011C0  =00000006                511  KBDBITF3    EQU     6
000011C0  =00000007                512  KBDBITPS    EQU     7
000011C0                           513  
000011C0                           514  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
000011C0                           515  
000011C0  =00000280                516  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
000011C0  =000001E0                517  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
000011C0  =00000001                518  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
000011C0  =00000014                519  SCRTIM      EQU     20                      ; SCREEN TIMER (MS)
000011C0                           520  
000011C0                           521  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
000011C0                           522  
000011C0  =00000040                523  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
000011C0  =00000032                524  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
000011C0  =00000000                525  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
000011C0                           526  
000011C0                           527  
000011C0                           528  
000011C0                           529  
000011C0                           530  -------------------- end include --------------------
000011C0                           531              INCLUDE "CONST.X68"                  ; USER CONSTANTS
000011C0                           532  ; =============================================================================
000011C0                           533  ; SYSTEM CONSTANTS
000011C0                           534  ; =============================================================================
000011C0                           535  
000011C0                           536  ; --- GAME STATES -------------------------------------------------------------
000011C0                           537  
000011C0  =FFFFFFFF                538  STANONE     EQU     -1                      ; PLACEHOLDER TO FORCE CHANGE
000011C0  =00000000                539  STAINTR     EQU     0                       ; INTRO/PRESS FIRE STATE
000011C0  =00000001                540  STAPLAY     EQU     1                       ; NORMAL GAME STATE
000011C0  =00000002                541  STAPAU      EQU     2                       ; PAUSE GAME STATE
000011C0  =00000003                542  STAGOVR     EQU     3                       ; GAME OVER STATE
000011C0                           543  
000011C0                           544  ; --- AGENT & PROP TYPES -------------------------------------------------------------
000011C0                           545  
000011C0  =00000001                546  CLDTYPE     EQU     1                       ; NUMBER FOR CLOUD TYPES
000011C0  =00000002                547  GSSDTYPE    EQU     2                       ; NUMBER FOR GRASS DETAIL TYPES
000011C0  =00000003                548  PIPTYPE     EQU     3                       ; NUMBER FOR PIPE TYPES
000011C0                           549  
000011C0                           550  
000011C0                           551  ; --- INTRO STATE RELATED CONSTANTS -------------------------------------------
000011C0                           552  
000011C0  =00000001                553  INTTITX     EQU     1                       ; TITLE X COORDINATE
000011C0  =00000001                554  INTTITY     EQU     1                       ; TITLE Y COORDINATE
000011C0  =0000FFFF                555  INTTITC     EQU     $0000FFFF               ; TITLE COLOR
000011C0  =033D0001                556  INTTITF     EQU     $033D0001               ; TITLE FONT
000011C0  =00000005                557  INTPRSX     EQU     5                       ; PRESS FIRE X COORDINATE
000011C0  =00000008                558  INTPRSY     EQU     8                       ; PRESS FIRE Y COORDINATE
000011C0  =00000080                559  INTPRSC     EQU     $00000080               ; PRESS FIRE COLOR
000011C0  =031A0001                560  INTPRSF     EQU     $031A0001               ; PRESS FIRE FONT
000011C0                           561  
000011C0                           562  ; --- BACKGROUND RELATED CONSTANTS --------------------------------------------
000011C0                           563  
000011C0  =00000000                564  BGSKYPC     EQU     $00000000               ; BACKGROUND SKY PEN COLOUR
000011C0  =00EFCE87                565  BGSKYFC     EQU     $00EFCE87               ; BACKGROUND SKY FILL COLOUR
000011C0  =00000000                566  BGGSSPC     EQU     $00000000               ; BACKGROUND GRASS PEN COLOUR
000011C0  =0000990A                567  BGGSSFC     EQU     $0000990A               ; BACKGROUND GRASS FILL COLOUR
000011C0  =00000168                568  BGGSSTP     EQU     SCRHEIGH*3/4            ; GRASS TOP EDGE (Y) COORDINATE
000011C0  =00000190                569  BGGSSBT     EQU     BGGSSTP+40              ; GRASS BOTTOM EDGE (Y) COORDINATE
000011C0  =0000000A                570  GSSDWDTH    EQU     10                      ; GRASS DETAIL WIDTH
000011C0  =0039DB44                571  GSSDFC      EQU     $0039DB44               ; BACKGROUND GRASS DETAIL F.COLOUR
000011C0  =00000000                572  BGGNDPC     EQU     $00000000               ; BACKGROUND GROUND PEN COLOUR
000011C0  =00155DD8                573  BGGNDFC     EQU     $00155DD8               ; BACKGROUND GROUND FILL COLOUR
000011C0  =00000190                574  BGGNDTP     EQU     BGGSSBT                 ; GROUND TOP EDGE (Y) COORDINATE
000011C0                           575  
000011C0                           576  ; --- PLAYER RELATED CONSTANTS ------------------------------------------------
000011C0                           577  
000011C0                           578        ;Player colours
000011C0                           579  
000011C0  =00008000                580  GREEN EQU $00008000 
000011C0  =000000FF                581  RED   EQU $000000FF 
000011C0  =00FFFFFF                582  WHITE EQU $00FFFFFF 
000011C0  =00000000                583  BLACK EQU $00000000
000011C0                           584  
000011C0                           585        ;Constants
000011C0                           586        
000011C0  =00008000                587  PLRCOLOR        EQU GREEN
000011C0  =00FFFFFF                588  PLREYECOLOR     EQU WHITE
000011C0  =00000000                589  PLRIRISCOLOR    EQU BLACK
000011C0  =000000FF                590  PLRMOUTHCOLOR   EQU RED
000011C0  =0000001E                591  PLRWIDTH        EQU 30
000011C0  =0000001E                592  PLRHEIGHT       EQU 30
000011C0  =00000096                593  PLRINITPOSX     EQU 150
000011C0  =000000B4                594  PLRINITPOSY     EQU 180
000011C0  =0000003C                595  JUMPSIZE        EQU 60
000011C0                           596  
000011C0                           597  ; --- PIPE RELATED CONSTANTS --------------------------------------------------
000011C0                           598  
000011C0  =00000000                599  PIPPC       EQU     $00000000               ; PIPE PEN COLOUR
000011C0  =00196600                600  PIPFC       EQU     $00196600               ; PIPE FILL COLOUR
000011C0  =00000032                601  PIPBWDT     EQU     50                      ; PIPE BASE WIDTH
000011C0  =0000003C                602  PIPTWDT     EQU     60                      ; PIPE MOUTH WIDTH
000011C0  =0000000A                603  PIPTHGT     EQU     10                      ; PIPE MOUTH HEIGHT
000011C0  =00000005                604  PIPTBSPC    EQU     ((PIPTWDT-PIPBWDT)/2)   ; DIF.BETW. OUTER RAD. & IN. RAD
000011C0  =00000050                605  PIPOPEN     EQU     80                      ; SPACE BETW. TOP AND BOTTOM PIPES
000011C0  =00000002                606  PIPYSPD     EQU     2                       ; SPEED @ WHICH PIPES GO UP&DOWN
000011C0                           607  
000011C0                           608  ; --- CLOUD RELATED CONSTANTS -------------------------------------------------
000011C0                           609  
000011C0  =0000003C                610  CLDSIZE     EQU     60                      ; CLOUD DIAMETER
000011C0  =00FFFFFF                611  CLDPCLR     EQU     $00FFFFFF               ; CLOUD PEN COLOR
000011C0  =00FFFFFF                612  CLDFCLR     EQU     $00FFFFFF               ; CLOUD FIL COLOR
000011C0                           613  
000011C0                           614  ; --- PAUSE STATE RELATED CONSTANTS ---------------------------------------
000011C0                           615  
000011C0  =00000000                616  CONTNUM     EQU     0                       ; CONTINUE GAME NUMBER
000011C0  =00000001                617  NEWGNUM     EQU     1                       ; NEW GAME NUMBER
000011C0  =00000002                618  EXTNUM      EQU     2                       ; EXIT GAME NUMBER
000011C0  =0000FFFF                619  PAUTITC     EQU     $0000FFFF               ; TITLE COLOUR
000011C0  =03300001                620  PAUTITF     EQU     $03300001               ; TITLE FONT
000011C0  =01130001                621  PAUOPTFU    EQU     $01130001               ; OPTION FONT (unselected)
000011C0  =01130005                622  PAUOPTFS    EQU     $01130005               ; OPTION FONT (selected)
000011C0  =00FFFFFF                623  PAUOPTC     EQU     $00FFFFFF               ; OPTION COLOUR
000011C0  =00000002                624  PAUTITX     EQU     2                       ; TITLE COORD. X
000011C0  =00000001                625  PAUTITY     EQU     1                       ; TITLE COORD. Y
000011C0  =0000000F                626  PAUOPTX     EQU     15                      ; OPTIONS COORD. X
000011C0  =00000008                627  PAUCNTY     EQU     8                       ; CONTINUE OPTION COORD. Y
000011C0  =0000000A                628  PAUNEWY     EQU     10                      ; NEW GAME OPTION COORD. Y
000011C0  =0000000C                629  PAUEXTY     EQU     12                      ; EXIT OPTION COORD. Y
000011C0  =000000FF                630  PAUSELC     EQU     $000000FF               ; SELECTED OPTION COLOUR
000011C0                           631  
000011C0                           632  ; --- GAME OVER STATE RELATED CONSTANTS ---------------------------------------
000011C0                           633  
000011C0  =00000023                634  GOVSTRX     EQU     35                      ; TITLE X COORDINATE
000011C0  =0000000F                635  GOVSTRY     EQU     15                      ; TITLE Y COORDINATE
000011C0  =00FFFFFF                636  GOVSTRC     EQU     $00FFFFFF               ; TITLE COLOR
000011C0                           637  
000011C0                           638  
000011C0                           639  
000011C0                           640  
000011C0                           641  
000011C0                           642  
000011C0                           643  
000011C0                           644  
000011C0                           645  
000011C0                           646  
000011C0                           647  
000011C0                           648  
000011C0                           649  
000011C0                           650  
000011C0                           651  
000011C0                           652  
000011C0                           653  
000011C0                           654  
000011C0                           655  
000011C0                           656  
000011C0                           657  
000011C0                           658  
000011C0                           659  
000011C0                           660  
000011C0                           661  
000011C0                           662  
000011C0                           663  
000011C0                           664  
000011C0                           665  -------------------- end include --------------------
000011C0                           666              INCLUDE "PLAYER.X68"
000011C0                           667  ; =============================================================================
000011C0                           668  ; PLAYER MANAGEMENT
000011C0                           669  ; =============================================================================
000011C0                           670  
000011C0                           671  ; -----------------------------------------------------------------------------
000011C0                           672  PLRINIT
000011C0                           673  ; INITIALIZES THE PLAYER
000011C0                           674  ; INPUT    - NONE
000011C0                           675  ; OUTPUT   - NONE
000011C0                           676  ; MODIFIES - NONE
000011C0                           677  ; -----------------------------------------------------------------------------
000011C0                           678  
000011C0  33FC 0096 00001BEA       679          MOVE.W #PLRINITPOSX,(PLRPOSX)
000011C8  33FC 00B4 00001BEC       680          MOVE.W #PLRINITPOSY,(PLRPOSY)
000011D0  33FC 00B4 00001BEE       681          MOVE.W #PLRINITPOSY,(MAXPOS)
000011D8  33FC 0000 00001BF0       682          MOVE.W #0, (UPPRESSED)
000011E0  33FC 0001 00001BF2       683          MOVE.W #1, (PLRSPEED)
000011E8  4E75                     684          RTS
000011EA                           685  ; -----------------------------------------------------------------------------
000011EA                           686  PLRUPD
000011EA                           687  ; UPDATES THE PLAYER MOTION
000011EA                           688  ; INPUT    - NONE (ACCESSES KBDVAL AND KBDEDGE)
000011EA                           689  ; OUTPUT   - NONE (MODIFIES PLAYER DATA)
000011EA                           690  ; MODIFIES - NONE
000011EA                           691  ; -----------------------------------------------------------------------------
000011EA  48E7 E000                692            MOVEM.L D0/D1/D2,-(A7)
000011EE  0839 0001 00001BFB       693            BTST.B #KBDBITUP, (KBDEDGE)    
000011F6  6600 0038                694            BNE.L  .PRESSED
000011FA                           695          
000011FA                           696            ;TECLA NO PRESIONADA
000011FA  0C79 0001 00001BF0       697            CMP #1, (UPPRESSED)
00001202  6700 0050                698            BEQ .MAKEJUMP
00001206                           699            ;No se ha apretado la tecla UP. Hay que bajar el pájaro. 
00001206  3039 00001BEC            700            MOVE.W (PLRPOSY), D0
0000120C  D079 00001BF2            701            ADD.W (PLRSPEED), D0
00001212                           702            ;Se incrementa la velocidad de bajada. 
00001212  5279 00001BF2            703            ADDQ #1, (PLRSPEED)
00001218  33C0 00001BEC            704            MOVE.W D0, (PLRPOSY)
0000121E                           705            ;Comprobar si ha salido por la parte inferior
0000121E  323C 0168                706            MOVE.W #BGGSSTP, D1
00001222  0640 001E                707            ADD.W #PLRHEIGHT, D0
00001226  B240                     708            CMP D0, D1
00001228  6B00 006A                709            BMI .GAMEOVER         
0000122C                           710         
0000122C  6000 0072                711            BRA .END         
00001230                           712  .PRESSED
00001230                           713            ;TECLA UP PRESIONADA
00001230                           714            ;Se reinicia la velocidad de bajada. 
00001230  33FC 0001 00001BF2       715            MOVE.W #1, (PLRSPEED)
00001238                           716  
00001238                           717            ;Se establece el límite hasta donde subirá
00001238  3039 00001BEC            718            MOVE.W (PLRPOSY), D0
0000123E  0440 003C                719            SUB.W #JUMPSIZE, D0
00001242  33C0 00001BEE            720            MOVE.W D0, (MAXPOS)
00001248                           721            ;Se indica que se ha presionado la tecla de salto
00001248  33FC 0001 00001BF0       722            MOVE.W #1, (UPPRESSED)
00001250                           723            
00001250  6000 004E                724            BRA .END   
00001254                           725        
00001254                           726  .MAKEJUMP
00001254                           727            ;Se ha apretado la tecla UP anteriormente (eso indica que el salto no
00001254                           728            ; ha finalizado). 
00001254                           729            
00001254  3039 00001BEC            730            MOVE.W (PLRPOSY), D0
0000125A  3239 00001BEE            731            MOVE.W (MAXPOS), D1
00001260  9041                     732            SUB.W  D1, D0             ;FÓRMULA: (PLRPOSY-MAXPOS)/2 = VALOR QUE SE TIENE QUE RESTAR A LA POSICIÓN ACTUAL PARA OBTENER LA NUEVA POSICIÓN
00001262  80FC 0003                733            DIVU.W #3, D0
00001266  9179 00001BEC            734            SUB.W D0, (PLRPOSY)       ;NEWPOS
0000126C                           735            ;Ver si ha salido por la parte superior. 
0000126C  0C79 0000 00001BEC       736            CMP #0, (PLRPOSY)
00001274  6B00 001E                737            BMI .GAMEOVER
00001278  B07C 0001                738            CMP #1, D0
0000127C  6B00 000A                739            BMI .LASTJUMP
00001280  6700 0006                740            BEQ .LASTJUMP
00001284                           741            ;El salto no ha finalizado (No ha llegado a MAXPOS)
00001284                           742                                
00001284                           743            
00001284  6000 001A                744            BRA .END
00001288                           745            
00001288                           746  .LASTJUMP
00001288                           747            ;El salto ha llegado a MAXPOS
00001288                           748            ;Se desactiva la tecla UP indicando que lo siguiente será realizar la bajada. 
00001288  33FC 0000 00001BF0       749            MOVE.W #0, (UPPRESSED)         
00001290  6000 000E                750            BRA .END    
00001294                           751            
00001294                           752  .GAMEOVER
00001294                           753  
00001294  33FC 0003 00001BE8       754            MOVE.W #STAGOVR, (STANEXT)        
0000129C  6000 0002                755            BRA .END         
000012A0                           756                   
000012A0                           757  .END
000012A0                           758            
000012A0  4CDF 0007                759            MOVEM.L (A7)+,D0/D1/D2
000012A4  4E75                     760            RTS
000012A6                           761            
000012A6                           762            
000012A6                           763            
000012A6                           764            
000012A6                           765            
000012A6                           766  
000012A6                           767  ; -----------------------------------------------------------------------------
000012A6                           768  PLRPLOT
000012A6                           769  ; PLOTS THE PLAYER
000012A6                           770  ; INPUT    - NONE
000012A6                           771  ; OUTPUT   - NONE
000012A6                           772  ; MODIFIES - NONE
000012A6                           773  ; -----------------------------------------------------------------------------
000012A6                           774  
000012A6  48E7 F800                775              MOVEM.L D0-D4,-(A7)
000012AA                           776  
000012AA                           777  
000012AA                           778              ;SET PLAYER COLOR 
000012AA  223C 00008000            779              MOVE.L  #PLRCOLOR,D1
000012B0  103C 0050                780              MOVE.B  #80,D0
000012B4  4E4F                     781              TRAP    #15
000012B6  5200                     782              ADDQ.B  #1,D0
000012B8  4E4F                     783              TRAP    #15
000012BA                           784              
000012BA                           785              ;SET PLAYER POSITION
000012BA  3239 00001BEA            786              MOVE.W  (PLRPOSX),D1            
000012C0  3439 00001BEC            787              MOVE.W  (PLRPOSY),D2
000012C6  3601                     788              MOVE.W  D1,D3
000012C8  3802                     789              MOVE.W  D2,D4
000012CA                           790              
000012CA                           791              ;SET PLAYER WIDTH AND HEIGHT
000012CA  0643 001E                792              ADD.W   #PLRWIDTH,D3
000012CE  0644 001E                793              ADD.W   #PLRHEIGHT,D4
000012D2  103C 0058                794              MOVE.B  #88,D0
000012D6  4E4F                     795              TRAP    #15
000012D8  0443 000F                796              SUB.W   #PLRWIDTH/2,D3
000012DC  103C 0057                797              MOVE.B  #87,D0
000012E0  4E4F                     798              TRAP    #15
000012E2                           799              
000012E2                           800              ;---------EYE---------
000012E2                           801                               
000012E2                           802              ;SET EYE COLOR
000012E2  7051                     803              MOVE.L  #81, D0
000012E4  223C 00FFFFFF            804              MOVE.L  #PLREYECOLOR, D1
000012EA  4E4F                     805              TRAP    #15
000012EC                           806              
000012EC  3239 00001BEA            807              MOVE.W  PLRPOSX,D1   
000012F2                           808              
000012F2                           809              ;EYE WIDTH         
000012F2  5A41                     810              ADD.W   #PLRWIDTH-25,D1
000012F4  3639 00001BEA            811              MOVE.W  (PLRPOSX),D3
000012FA                           812              
000012FA                           813              ;EYE POSX
000012FA  0643 0014                814              ADD.W   #PLRWIDTH-10,D3
000012FE  3439 00001BEC            815              MOVE.W (PLRPOSY),D2
00001304                           816              
00001304                           817              ;EYE POSY
00001304  0642 000A                818              ADD.W   #PLRHEIGHT/2-5,D2
00001308  3839 00001BEC            819              MOVE.W  (PLRPOSY),D4
0000130E                           820             
0000130E                           821              ;EYE HEIGHT 
0000130E  0644 FFF6                822              ADD.W   #PLRHEIGHT/2-25,D4
00001312  103C 0058                823              MOVE.B  #88,D0
00001316  4E4F                     824              TRAP    #15
00001318                           825              
00001318                           826              
00001318                           827             ;---------MOUTH------
00001318                           828              
00001318                           829              ;PLOT EYE OF CHARACTER
00001318  4241                     830              CLR     D1
0000131A  103C 0050                831              MOVE.B  #80,D0
0000131E  4E4F                     832              TRAP    #15
00001320  5200                     833              ADDQ.B  #1,D0
00001322  4E4F                     834              TRAP    #15
00001324                           835                     
00001324                           836              ;SET EYE COLOR
00001324  7051                     837              MOVE.L  #81, D0
00001326  223C 000000FF            838              MOVE.L  #RED, D1
0000132C  4E4F                     839              TRAP    #15
0000132E                           840  
0000132E                           841              
0000132E  3239 00001BEA            842              MOVE.W  (PLRPOSX),D1   
00001334                           843              
00001334                           844              ;EYE WIDTH         
00001334  0641 001D                845              ADD.W   #PLRWIDTH-1,D1
00001338  3639 00001BEA            846              MOVE.W  (PLRPOSX),D3
0000133E                           847              
0000133E                           848              ;EYE POSX
0000133E  0643 000A                849              ADD.W   #PLRWIDTH-20,D3
00001342  3439 00001BEC            850              MOVE.W  (PLRPOSY),D2
00001348                           851              
00001348                           852              ;EYE POSY
00001348  0642 0019                853              ADD.W   #PLRHEIGHT-5,D2
0000134C  3839 00001BEC            854              MOVE.W  (PLRPOSY),D4
00001352                           855             
00001352                           856              ;EYE HEIGHT 
00001352  0644 000F                857              ADD.W   #PLRHEIGHT-15,D4
00001356  103C 0058                858              MOVE.B  #88,D0
0000135A  4E4F                     859              TRAP    #15
0000135C                           860              
0000135C  4CDF 001F                861              MOVEM.L (A7)+,D0-D4
00001360                           862              
00001360  4E75                     863              RTS
00001362                           864  
00001362                           865  
00001362                           866  
00001362                           867  
00001362                           868  
00001362                           869  -------------------- end include --------------------
00001362                           870              INCLUDE "UTIL.X68"                   ; UTILITY MACRO AND SUBROUTINES
00001362                           871  ; =============================================================================
00001362                           872  ; UTILITY MACROS
00001362                           873  ; =============================================================================
00001362                           874  
00001362                           875  ; -----------------------------------------------------------------------------
00001362                           876  UTLSPEN     MACRO
00001362                           877  ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001362                           878  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
00001362                           879  ; OUTPUT   - NONE
00001362                           880  ; MODIFIES - D0,D1
00001362                           881  ; -----------------------------------------------------------------------------
00001362                           882              MOVE.B  #80,D0
00001362                           883              MOVE.L  \1,D1
00001362                           884              TRAP    #15
00001362                           885              ENDM
00001362                           886  
00001362                           887  ; -----------------------------------------------------------------------------
00001362                           888  UTLSFIL     MACRO
00001362                           889  ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001362                           890  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
00001362                           891  ; OUTPUT   - NONE
00001362                           892  ; MODIFIES - D0,D1
00001362                           893  ; -----------------------------------------------------------------------------
00001362                           894              MOVE.B  #81,D0
00001362                           895              MOVE.L  \1,D1
00001362                           896              TRAP    #15
00001362                           897              ENDM
00001362                           898  
00001362                           899  ; -----------------------------------------------------------------------------
00001362                           900  UTLLOCT     MACRO
00001362                           901  ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001362                           902  ; INPUT    - \1 X, \2 Y
00001362                           903  ; OUTPUT   - NONE
00001362                           904  ; MODIFIES - D0,D1
00001362                           905  ; -----------------------------------------------------------------------------
00001362                           906              MOVE.W  #\1<<8|\2, D1
00001362                           907              MOVE.B  #11,D0
00001362                           908              TRAP    #15
00001362                           909              ENDM
00001362                           910  
00001362                           911  ; -----------------------------------------------------------------------------
00001362                           912  UTLFONT     MACRO
00001362                           913  ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001362                           914  ; INPUT    - \1 COLOR, \2 FONT
00001362                           915  ; OUTPUT   - NONE
00001362                           916  ; MODIFIES - D0,D1,D2
00001362                           917  ; -----------------------------------------------------------------------------
00001362                           918              MOVE.L  #\1,D1
00001362                           919              MOVE.L  #\2,D2
00001362                           920              MOVEQ   #21,D0
00001362                           921              TRAP    #15
00001362                           922              ENDM
00001362                           923  
00001362                           924  ; =============================================================================
00001362                           925  ; UTILITY SUBROUTINES
00001362                           926  ; =============================================================================
00001362                           927  
00001362                           928  ; -----------------------------------------------------------------------------
00001362                           929  UTLINIT
00001362                           930  ; INITIALIZES UTILITY CODE
00001362                           931  ; INPUT    - NONE
00001362                           932  ; OUTPUT   - NONE
00001362                           933  ; MODIFIES - NONE
00001362                           934  ; -----------------------------------------------------------------------------
00001362  4239 00001BF9            935              CLR.B   (UTLRNDIX)
00001368  4E75                     936              RTS
0000136A                           937  ; -----------------------------------------------------------------------------
0000136A                           938  UTLCHCOL
0000136A                           939  ; CHECKS COLLISION
0000136A                           940  ; INPUT    - D0.W X0 COORDINATE
0000136A                           941  ;            D1.W Y0 COORDINATE
0000136A                           942  ;            D2.W X1 COORDINATE
0000136A                           943  ;            D3.W Y1 COORDINATE
0000136A                           944  ;            D4.W WIDTH 0
0000136A                           945  ;            D5.W WIDTH 1
0000136A                           946  ;            D6.W HEIGHT 0
0000136A                           947  ;            D7.W HEIGHT 1
0000136A                           948  ; OUTPUT   - D0.B=FF - COLLISION, =0 - NO COLLISION
0000136A                           949  ; MODIFIES - NONE
0000136A                           950  ; -----------------------------------------------------------------------------
0000136A  48A7 0F00                951              MOVEM.W D4-D7,-(A7)
0000136E  D840                     952              ADD.W   D0,D4
00001370  B842                     953              CMP.W   D2,D4
00001372  6F00 0022                954              BLE     .NOCOL
00001376  DA42                     955              ADD.W   D2,D5
00001378  BA40                     956              CMP.W   D0,D5
0000137A  6F00 001A                957              BLE     .NOCOL
0000137E  DC41                     958              ADD.W   D1,D6
00001380  BC43                     959              CMP.W   D3,D6
00001382  6F00 0012                960              BLE     .NOCOL
00001386  DE43                     961              ADD.W   D3,D7
00001388  BE41                     962              CMP.W   D1,D7
0000138A  6F00 000A                963              BLE     .NOCOL
0000138E  103C 00FF                964              MOVE.B  #$FF,D0
00001392  6000 0004                965              BRA     .END
00001396  4200                     966  .NOCOL      CLR.B   D0
00001398  4C9F 00F0                967  .END        MOVEM.W (A7)+,D4-D7
0000139C  4E75                     968              RTS
0000139E                           969  
0000139E                           970  ; -----------------------------------------------------------------------------
0000139E                           971  UTLRAND
0000139E                           972  ; PROVIDES A PSEUDO-RANDOM BYTE
0000139E                           973  ; INPUT    - NONE
0000139E                           974  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
0000139E                           975  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000139E                           976  ; -----------------------------------------------------------------------------
0000139E  2F08                     977              MOVE.L  A0,-(A7)
000013A0  41F9 000013BC            978              LEA     .RANDVEC,A0
000013A6  4280                     979              CLR.L   D0
000013A8  1039 00001BF9            980              MOVE.B  (UTLRNDIX),D0
000013AE  1030 0800                981              MOVE.B  (A0,D0.L),D0
000013B2  5239 00001BF9            982              ADDQ.B  #1,(UTLRNDIX)
000013B8  205F                     983              MOVE.L  (A7)+,A0
000013BA  4E75                     984              RTS
000013BC                           985  
000013BC                           986  
000013BC= A2 EE 9A 0C F5 24 ...    987  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000013C4= 2A A3 51 26 E0 AC ...    988              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
000013CC= 75 51 CA FD 33 EB ...    989              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
000013D4= 60 CC E7 B8 9A EB ...    990              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000013DC= 1D 76 B5 95 B0 89 ...    991              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000013E4= 39 15 48 C9 6E CA ...    992              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
000013EC= 43 E7 E2 7C 37 25 ...    993              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
000013F4= E9 94 CE E9 E4 52 ...    994              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
000013FC= 37 6D 9A 84 A2 28 ...    995              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001404= 19 E2 C6 77 80 D4 ...    996              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
0000140C= 0A 5A 32 67 33 C2 ...    997              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001414= 59 80 DC 0E 57 FC ...    998              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
0000141C= 8A AB BC F7 07 4D ...    999              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001424= EF D5 77 6E 1E BB ...   1000              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
0000142C= D6 E0 2A 8F BD 28 ...   1001              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001434= 13 4F 66 EC 0A 64 ...   1002              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
0000143C= 56 52 9A 16 9B 90 ...   1003              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001444= 06 8A A4 F7 01 DA ...   1004              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
0000144C= F2 E7 77 28 B1 76 ...   1005              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001454= A4 42 E3 81 B1 67 ...   1006              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
0000145C= BF CE FA 16 BF 38 ...   1007              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001464= D1 8B 50 0C 5F 49 ...   1008              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
0000146C= DE 4C 14 A2 40 DC ...   1009              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001474= B6 9B 0A 38 5D AB ...   1010              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
0000147C= E2 1B DD 75 15 82 ...   1011              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001484= 8A 26 51 30 9F 47 ...   1012              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
0000148C= 1E 8A BB 71 C6 6E ...   1013              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001494= 9F 47 E5 34 94 27 ...   1014              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
0000149C= 7D 06 D6 BA 30 0F ...   1015              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
000014A4= EC 7F 7E 03 CF 2D ...   1016              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
000014AC= 94 5B 23 F2 8B CD ...   1017              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000014B4= 74 33 EC B9 0F D5 ...   1018              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
000014BC                          1019  
000014BC                          1020  
000014BC                          1021  -------------------- end include --------------------
000014BC                          1022              INCLUDE "AGENTLST.X68"               ; AGENT LIST MANAGEMENT
000014BC                          1023  ; =============================================================================
000014BC                          1024  ; AGENT MANAGEMENT
000014BC                          1025  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000014BC                          1026  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000014BC                          1027  ; +4 - LONG : PLOT SUBROUTINE POINTER
000014BC                          1028  ; +8:END    : DATA (AGENT SPECIFIC)
000014BC                          1029  ; =============================================================================
000014BC                          1030  
000014BC                          1031  ; -----------------------------------------------------------------------------
000014BC                          1032  AGLADD
000014BC                          1033  ; CREATES A NEW AGENT
000014BC                          1034  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000014BC                          1035  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000014BC                          1036  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000014BC                          1037  ;            D0 - AGENT TYPE (USED AS OWNED BY DMM)
000014BC                          1038  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000014BC                          1039  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000014BC                          1040  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000014BC                          1041  ; OUTPUT   - NONE
000014BC                          1042  ; MODIFIES - NONE
000014BC                          1043  ; -----------------------------------------------------------------------------
000014BC  2F08                    1044              MOVE.L  A0,-(A7)
000014BE                          1045              
000014BE  4EB8 1190               1046              JSR     DMMALLOC
000014C2  B1FC 00000000           1047              CMP.L   #0,A0
000014C8  6700 0008               1048              BEQ     .END
000014CC  20CA                    1049              MOVE.L  A2,(A0)+
000014CE  20CB                    1050              MOVE.L  A3,(A0)+
000014D0  4E91                    1051              JSR     (A1)
000014D2                          1052  
000014D2  205F                    1053  .END        MOVE.L  (A7)+,A0
000014D4  4E75                    1054              RTS
000014D6                          1055  
000014D6                          1056  ; -----------------------------------------------------------------------------
000014D6                          1057  AGLUPD
000014D6                          1058  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000014D6                          1059  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000014D6                          1060  ; INPUT    - NONE
000014D6                          1061  ; OUTPUT   - NONE
000014D6                          1062  ; MODIFIES - NONE
000014D6                          1063  ; -----------------------------------------------------------------------------
000014D6  48E7 00C0               1064              MOVEM.L A0-A1,-(A7)
000014DA                          1065              
000014DA  4EB8 1120               1066              JSR     DMMFIRST
000014DE  B1FC 00000000           1067  .LOOP       CMP.L   #0,A0
000014E4  6700 001E               1068              BEQ     .END
000014E8  0C68 0002 FFFE          1069              CMP.W   #GSSDTYPE,-2(A0)    ;IF MEMORY DOESN'T BELONG TO AGENT
000014EE  670E                    1070              BEQ.S   .NEXT               ;SKIP
000014F0  0C68 0001 FFFE          1071              CMP.W   #CLDTYPE,-2(A0)
000014F6  6706                    1072              BEQ.S   .NEXT
000014F8                          1073              
000014F8  2250                    1074              MOVE.L  (A0),A1
000014FA  5088                    1075              ADD.L   #8,A0
000014FC  4E91                    1076              JSR     (A1)
000014FE  4EB8 1142               1077  .NEXT       JSR     DMMNEXT
00001502  60DA                    1078              BRA     .LOOP
00001504                          1079              
00001504  4CDF 0300               1080  .END        MOVEM.L (A7)+,A0-A1            
00001508  4E75                    1081              RTS
0000150A                          1082  
0000150A                          1083  ; -----------------------------------------------------------------------------
0000150A                          1084  AGLPLOT
0000150A                          1085  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
0000150A                          1086  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
0000150A                          1087  ; INPUT    - NONE
0000150A                          1088  ; OUTPUT   - NONE
0000150A                          1089  ; MODIFIES - NONE
0000150A                          1090  ; -----------------------------------------------------------------------------
0000150A  48E7 00C0               1091              MOVEM.L A0-A1,-(A7)
0000150E                          1092  
0000150E  4EB8 1120               1093              JSR     DMMFIRST
00001512  B1FC 00000000           1094  .LOOP       CMP.L   #0,A0
00001518  6700 0020               1095              BEQ     .END
0000151C  0C68 0002 FFFE          1096              CMP.W   #GSSDTYPE,-2(A0)    ;IF MEMORY DOESN'T BELONG TO AGENT
00001522  6710                    1097              BEQ.S   .NEXT               ;SKIP
00001524  0C68 0001 FFFE          1098              CMP.W   #CLDTYPE,-2(A0)
0000152A  6708                    1099              BEQ.S   .NEXT
0000152C                          1100              
0000152C  2268 0004               1101              MOVE.L  4(A0),A1
00001530  5088                    1102              ADD.L   #8,A0
00001532  4E91                    1103              JSR     (A1)
00001534  4EB8 1142               1104  .NEXT       JSR     DMMNEXT
00001538  60D8                    1105              BRA     .LOOP
0000153A  4CDF 0300               1106  .END        MOVEM.L (A7)+,A0-A1
0000153E                          1107  
0000153E  4E75                    1108              RTS
00001540                          1109  
00001540                          1110  ; -----------------------------------------------------------------------------
00001540  =000011AA               1111  AGLKILL     EQU     DMMFREE
00001540                          1112  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001540                          1113  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001540                          1114  ; OUTPUT   - NONE
00001540                          1115  ; MODIFIES - NONE
00001540                          1116  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001540                          1117  ; -----------------------------------------------------------------------------
00001540                          1118  
00001540                          1119  
00001540                          1120  
00001540                          1121  
00001540                          1122  
00001540                          1123  
00001540                          1124  
00001540                          1125  
00001540                          1126  
00001540                          1127  
00001540                          1128  
00001540                          1129  -------------------- end include --------------------
00001540                          1130              INCLUDE "PROPLST.X68"                ; PROPS LIST MANAGEMENT
00001540                          1131  ; =============================================================================
00001540                          1132  ; PROP MANAGEMENT
00001540                          1133  ; EACH PROP HAS A DATA BLOCK FROM DMM AS FOLLOWS:
00001540                          1134  ; +0 - LONG : UPDATE SUBROUTINE POINTER
00001540                          1135  ; +4 - LONG : PLOT SUBROUTINE POINTER
00001540                          1136  ; +8:END    : DATA (PROP SPECIFIC)
00001540                          1137  ; =============================================================================
00001540                          1138  
00001540                          1139  ; -----------------------------------------------------------------------------
00001540                          1140  PRPADD
00001540                          1141  ; CREATES A NEW PROP
00001540                          1142  ; INPUT    - A1 - POINTER TO PROP INIT FUNCTION
00001540                          1143  ;            A2 - POINTER TO PROP UPDATE FUNCTION
00001540                          1144  ;            A3 - POINTER TO PROP PLOT FUNCTION
00001540                          1145  ;            D0 - PROP TYPE (USED AS OWNED BY DMM)
00001540                          1146  ;            D1 - PROP INITIALIZATION PARAMETER 1
00001540                          1147  ;            D2 - PROP INITIALIZATION PARAMETER 2
00001540                          1148  ;            D3 - PROP INITIALIZATION PARAMETER 3
00001540                          1149  ; OUTPUT   - NONE
00001540                          1150  ; MODIFIES - NONE
00001540                          1151  ; -----------------------------------------------------------------------------
00001540  2F08                    1152              MOVE.L  A0,-(A7)
00001542                          1153              
00001542  4EB8 1190               1154              JSR     DMMALLOC
00001546  B1FC 00000000           1155              CMP.L   #0,A0
0000154C  6700 0008               1156              BEQ     .END
00001550  20CA                    1157              MOVE.L  A2,(A0)+
00001552  20CB                    1158              MOVE.L  A3,(A0)+
00001554  4E91                    1159              JSR     (A1)
00001556                          1160  
00001556  205F                    1161  .END        MOVE.L  (A7)+,A0
00001558  4E75                    1162              RTS
0000155A                          1163  
0000155A                          1164  ; -----------------------------------------------------------------------------
0000155A                          1165  PRPUPD
0000155A                          1166  ; UPDATES THE PROP LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
0000155A                          1167  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
0000155A                          1168  ; INPUT    - NONE
0000155A                          1169  ; OUTPUT   - NONE
0000155A                          1170  ; MODIFIES - NONE
0000155A                          1171  ; -----------------------------------------------------------------------------
0000155A  48E7 00C0               1172              MOVEM.L A0-A1,-(A7)
0000155E                          1173              
0000155E  4EB8 1120               1174              JSR     DMMFIRST
00001562  B1FC 00000000           1175  .LOOP       CMP.L   #0,A0
00001568  6700 0018               1176              BEQ     .END
0000156C  0C68 0003 FFFE          1177              CMP.W   #PIPTYPE,-2(A0) ;IF MEMORY DOESN'T BELONG TO PROPS
00001572  6700 0008               1178              BEQ     .NEXT           ;SKIP
00001576                          1179              
00001576  2250                    1180              MOVE.L  (A0),A1
00001578  5088                    1181              ADD.L   #8,A0
0000157A  4E91                    1182              JSR     (A1)
0000157C                          1183              
0000157C  4EB8 1142               1184  .NEXT       JSR     DMMNEXT
00001580  60E0                    1185              BRA     .LOOP
00001582                          1186              
00001582  4CDF 0300               1187  .END        MOVEM.L (A7)+,A0-A1            
00001586  4E75                    1188              RTS
00001588                          1189              
00001588                          1190  ; -----------------------------------------------------------------------------
00001588                          1191  PRPPLOT
00001588                          1192  ; PLOTS THE PROP LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001588                          1193  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001588                          1194  ; INPUT    - NONE
00001588                          1195  ; OUTPUT   - NONE
00001588                          1196  ; MODIFIES - NONE
00001588                          1197  ; -----------------------------------------------------------------------------
00001588  48E7 00C0               1198              MOVEM.L A0-A1,-(A7)
0000158C                          1199  
0000158C  4EB8 1120               1200              JSR     DMMFIRST
00001590  B1FC 00000000           1201  .LOOP       CMP.L   #0,A0
00001596  6700 0018               1202              BEQ     .END
0000159A  0C68 0003 FFFE          1203              CMP.W   #PIPTYPE,-2(A0)     ;IF MEMORY DOESN'T BELONG TO PROP
000015A0  6708                    1204              BEQ.S   .NEXT               ;SKIP
000015A2                          1205              
000015A2  2268 0004               1206              MOVE.L  4(A0),A1
000015A6  5088                    1207              ADD.L   #8,A0
000015A8  4E91                    1208              JSR     (A1)
000015AA  4EB8 1142               1209  .NEXT       JSR     DMMNEXT
000015AE  60E0                    1210              BRA     .LOOP
000015B0  4CDF 0300               1211  .END        MOVEM.L (A7)+,A0-A1
000015B4                          1212  
000015B4  4E75                    1213              RTS
000015B6                          1214  
000015B6                          1215  ; -----------------------------------------------------------------------------
000015B6  =000011AA               1216  PRPKILL     EQU     DMMFREE
000015B6                          1217  ; KILLS THE PRP BY RELEASING ITS MEMORY
000015B6                          1218  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
000015B6                          1219  ; OUTPUT   - NONE
000015B6                          1220  ; MODIFIES - NONE
000015B6                          1221  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
000015B6                          1222  ; -----------------------------------------------------------------------------
000015B6                          1223  
000015B6                          1224  
000015B6                          1225  
000015B6                          1226  
000015B6                          1227  
000015B6                          1228  
000015B6                          1229  
000015B6                          1230  
000015B6                          1231  
000015B6                          1232  
000015B6                          1233  
000015B6                          1234  
000015B6                          1235  
000015B6                          1236  
000015B6                          1237  -------------------- end include --------------------
000015B6                          1238              INCLUDE "SPAWNER.X68"                ; SPAWNER
000015B6                          1239  ; =============================================================================
000015B6                          1240  ; SPAWNER MANAGEMENT.
000015B6                          1241  ; =============================================================================
000015B6                          1242  
000015B6                          1243  ; -----------------------------------------------------------------------------
000015B6                          1244  SPWUPD
000015B6                          1245  ; UPDATES THE SPAWNER
000015B6                          1246  ; INPUT    - NONE
000015B6                          1247  ; OUTPUT   - NONE
000015B6                          1248  ; MODIFIES - NONE
000015B6                          1249  ; -----------------------------------------------------------------------------
000015B6  48E7 8070               1250              MOVEM.L  D0/A1-A3,-(A7)
000015BA                          1251  
000015BA  1039 00001BFD           1252              MOVE.B  (SCRCYCCT),D0
000015C0  C07C 003F               1253              AND     #$3F,D0                 ; EVERY 64 CYCLES
000015C4  6600 0028               1254              BNE     .END                    ; CREATE A NEW PIPE
000015C8  43F9 00001AEE           1255              LEA     PIPINIT,A1
000015CE  45F9 00001B14           1256              LEA     PIPUPD,A2
000015D4  47F9 00001B2E           1257              LEA     PIPPLOT,A3
000015DA  303C 0003               1258              MOVE.W  #PIPTYPE,D0
000015DE  1239 00001BF4           1259              MOVE.B  (PIPCOUNT),D1
000015E4  5239 00001BF4           1260              ADDQ.B  #1,(PIPCOUNT)
000015EA                          1261              
000015EA  4EB8 14BC               1262              JSR     AGLADD
000015EE                          1263              
000015EE  4CDF 0E01               1264  .END        MOVEM.L (A7)+,D0/A1-A3
000015F2  4E75                    1265              RTS
000015F4                          1266  
000015F4                          1267  
000015F4                          1268  
000015F4                          1269  
000015F4                          1270  
000015F4                          1271  
000015F4                          1272  
000015F4                          1273  
000015F4                          1274  
000015F4                          1275  
000015F4                          1276  
000015F4                          1277  
000015F4                          1278  
000015F4                          1279  
000015F4                          1280  
000015F4                          1281  
000015F4                          1282  
000015F4                          1283  
000015F4                          1284  
000015F4                          1285  
000015F4                          1286  
000015F4                          1287  -------------------- end include --------------------
000015F4                          1288              INCLUDE "STATES2.X68"                ; GAME STATES MANAGEMENT
000015F4                          1289  ; =============================================================================
000015F4                          1290  ; GAME STATE MANAGEMENT
000015F4                          1291  ; =============================================================================
000015F4                          1292  
000015F4                          1293  ; -----------------------------------------------------------------------------
000015F4                          1294  STAINIT
000015F4                          1295  ; INITALIZES THE STATE MANAGER
000015F4                          1296  ; INPUT    - NONE
000015F4                          1297  ; OUTPUT   - NONE
000015F4                          1298  ; MODIFIES - NONE
000015F4                          1299  ; -----------------------------------------------------------------------------
000015F4  33FC FFFF 00001BE6      1300              MOVE.W  #STANONE,(STACUR)
000015FC  33FC 0000 00001BE8      1301              MOVE.W  #STAINTR,(STANEXT)
00001604  4E75                    1302              RTS
00001606                          1303  
00001606                          1304  ; -----------------------------------------------------------------------------
00001606                          1305  STAUPD
00001606                          1306  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00001606                          1307  ; INPUT    - NONE
00001606                          1308  ; OUTPUT   - NONE
00001606                          1309  ; MODIFIES - NONE
00001606                          1310  ; -----------------------------------------------------------------------------
00001606  48E7 8080               1311              MOVEM.L D0/A0,-(A7)
0000160A  4280                    1312              CLR.L   D0
0000160C  3039 00001BE8           1313              MOVE.W  (STANEXT),D0
00001612  B079 00001BE6           1314              CMP.W   (STACUR),D0
00001618  6700 0012               1315              BEQ     .DOUPD
0000161C  33C0 00001BE6           1316              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00001622  E588                    1317              LSL.L   #2,D0
00001624  2040                    1318              MOVE.L  D0,A0
00001626  2068 1644               1319              MOVE.L  .INITBL(A0),A0
0000162A  4E90                    1320              JSR     (A0)
0000162C  4280                    1321  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
0000162E  3039 00001BE6           1322              MOVE.W  (STACUR),D0
00001634  E588                    1323              LSL.L   #2,D0
00001636  2040                    1324              MOVE.L  D0,A0
00001638  2068 1654               1325              MOVE.L  .UPDTBL(A0),A0
0000163C  4E90                    1326              JSR     (A0)
0000163E  4CDF 0101               1327              MOVEM.L (A7)+,D0/A0
00001642  4E75                    1328              RTS
00001644= 000010FE 000011C0 ...   1329  .INITBL     DC.L    STAINTRI,STAPLAYI,STAEMPTY,STAEMPTY
00001654= 000016CE 00001692 ...   1330  .UPDTBL     DC.L    STAINTRU,STAPLAYU,STAPAUU,STAGOVRU
00001664                          1331  
00001664                          1332  ; -----------------------------------------------------------------------------
00001664                          1333  STAPLOT
00001664                          1334  ; PERFORMS STATE PLOT
00001664                          1335  ; INPUT    - NONE
00001664                          1336  ; OUTPUT   - NONE
00001664                          1337  ; MODIFIES - NONE
00001664                          1338  ; -----------------------------------------------------------------------------
00001664  48E7 8080               1339              MOVEM.L D0/A0,-(A7)
00001668  4280                    1340              CLR.L   D0
0000166A  3039 00001BE6           1341              MOVE.W  (STACUR),D0
00001670  E588                    1342              LSL.L   #2,D0
00001672  2040                    1343              MOVE.L  D0,A0
00001674  2068 1680               1344              MOVE.L  .PLTTBL(A0),A0
00001678  4E90                    1345              JSR     (A0)
0000167A  4CDF 0101               1346              MOVEM.L (A7)+,D0/A0
0000167E  4E75                    1347              RTS
00001680= 000016E4 000016BC ...   1348  .PLTTBL     DC.L    STAINTRP,STAPLAYP,STAPAUP,STAGOVRP
00001690                          1349  
00001690                          1350  ; -----------------------------------------------------------------------------
00001690                          1351  STAEMPTY
00001690                          1352  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00001690                          1353  ; INPUT    - NONE
00001690                          1354  ; OUTPUT   - NONE
00001690                          1355  ; MODIFIES - NONE
00001690                          1356  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00001690                          1357  ; -----------------------------------------------------------------------------
00001690  4E75                    1358              RTS
00001692                          1359  
00001692                          1360  ; -----------------------------------------------------------------------------
00001692  =000011C0               1361  STAPLAYI    EQU     PLRINIT
00001692                          1362  ; PLAY STATE INITIALIZATION.
00001692                          1363  ; INPUT    - NONE
00001692                          1364  ; OUTPUT   - NONE
00001692                          1365  ; MODIFIES - NONE
00001692                          1366  ; NOTE     - JUST A WRAPPER FOR PLRINIT
00001692                          1367  ; -----------------------------------------------------------------------------
00001692                          1368  
00001692                          1369  ; -----------------------------------------------------------------------------
00001692                          1370  STAPLAYU
00001692                          1371  ; PLAY STATE UPDATE
00001692                          1372  ; INPUT    - NONE
00001692                          1373  ; OUTPUT   - NONE
00001692                          1374  ; MODIFIES - NONE
00001692                          1375  ; -----------------------------------------------------------------------------
00001692  0839 0007 00001BFB      1376              BTST.B   #KBDBITPS,(KBDEDGE)         ;Si 'P' es presionado, pausa.
0000169A  6616                    1377              BNE.S   .PAUSE
0000169C                          1378              
0000169C  4EB8 11EA               1379              JSR     PLRUPD
000016A0  4EB9 00001A38           1380              JSR     BGUPD
000016A6  4EB8 155A               1381              JSR     PRPUPD
000016AA  4EB8 15B6               1382              JSR     SPWUPD
000016AE  6000 FE26               1383              BRA     AGLUPD
000016B2                          1384  .PAUSE      
000016B2  33FC 0002 00001BE8      1385              MOVE.W  #STAPAU,(STANEXT)
000016BA  4E75                    1386              RTS
000016BC                          1387  ; -----------------------------------------------------------------------------
000016BC                          1388  STAPLAYP
000016BC                          1389  ; PLAY STATE PLOT
000016BC                          1390  ; INPUT    - NONE
000016BC                          1391  ; OUTPUT   - NONE
000016BC                          1392  ; MODIFIES - NONE
000016BC                          1393  ; -----------------------------------------------------------------------------
000016BC  4EB9 00001A84           1394              JSR     BGPLOT
000016C2  4EB8 1588               1395              JSR     PRPPLOT
000016C6  4EB8 150A               1396              JSR     AGLPLOT
000016CA                          1397              ;BRA     AGLPLOT
000016CA  6000 FBDA               1398              BRA     PLRPLOT
000016CE                          1399  
000016CE                          1400  ; -----------------------------------------------------------------------------
000016CE  =000010FE               1401  STAINTRI    EQU     DMMINIT
000016CE                          1402  ; INTRO STATE INIT
000016CE                          1403  ; INPUT    - NONE
000016CE                          1404  ; OUTPUT   - NONE
000016CE                          1405  ; MODIFIES - NONE
000016CE                          1406  ; NOTE     - JUST A WRAPPER FOR DMMINIT TO RELEASE ALL MEMORY
000016CE                          1407  ; -----------------------------------------------------------------------------
000016CE                          1408  
000016CE                          1409  ; -----------------------------------------------------------------------------
000016CE                          1410  STAINTRU
000016CE                          1411  ; INTRO STATE UPDATE
000016CE                          1412  ; INPUT    - NONE
000016CE                          1413  ; OUTPUT   - NONE
000016CE                          1414  ; MODIFIES - NONE
000016CE                          1415  ; -----------------------------------------------------------------------------
000016CE  0839 0004 00001BFB      1416              BTST.B  #KBDBITF1,(KBDEDGE)
000016D6  6700 000A               1417              BEQ     .END
000016DA  33FC 0001 00001BE8      1418              MOVE.W  #STAPLAY,(STANEXT)
000016E2  4E75                    1419  .END        RTS
000016E4                          1420  
000016E4                          1421  ; -----------------------------------------------------------------------------
000016E4                          1422  STAINTRP
000016E4                          1423  ; INTRO STATE PLOT
000016E4                          1424  ; INPUT    - NONE
000016E4                          1425  ; OUTPUT   - NONE
000016E4                          1426  ; MODIFIES - NONE
000016E4                          1427  ; -----------------------------------------------------------------------------
000016E4                          1428              ;Guardar registros en pila
000016E4  48E7 C040               1429              MOVEM.L A1/D0-D1,-(A7)
000016E8                          1430              
000016E8                          1431              ;Seleccionar fuente de texto
000016E8                          1432m             UTLFONT INTTITC,INTTITF
000016E8                          1433m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000016E8                          1434m ; INPUT    - INTTITC COLOR, INTTITF FONT
000016E8                          1435m ; OUTPUT   - NONE
000016E8                          1436m ; MODIFIES - D0,D1,D2
000016E8                          1437m ; -----------------------------------------------------------------------------
000016F8                          1438              ;Seleccionar posicion de texto      
000016F8                          1439m             UTLLOCT INTTITX,INTTITY               
000016F8                          1440m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000016F8                          1441m ; INPUT    - INTTITX X, INTTITY Y
000016F8                          1442m ; OUTPUT   - NONE
000016F8                          1443m ; MODIFIES - D0,D1
000016F8                          1444m ; -----------------------------------------------------------------------------
00001702                          1445  
00001702  43F9 0000173A           1446              LEA     .TITLE,A1
00001708  103C 000E               1447              MOVE.B  #14,D0
0000170C  4E4F                    1448              TRAP    #15
0000170E                          1449              
0000170E                          1450              ;Seleccionar fuente de texto
0000170E                          1451m             UTLFONT INTPRSC,INTPRSF     
0000170E                          1452m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
0000170E                          1453m ; INPUT    - INTPRSC COLOR, INTPRSF FONT
0000170E                          1454m ; OUTPUT   - NONE
0000170E                          1455m ; MODIFIES - D0,D1,D2
0000170E                          1456m ; -----------------------------------------------------------------------------
0000171E                          1457              ;Seleccionar posicion de texto
0000171E                          1458m             UTLLOCT INTPRSX,INTPRSY     
0000171E                          1459m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
0000171E                          1460m ; INPUT    - INTPRSX X, INTPRSY Y
0000171E                          1461m ; OUTPUT   - NONE
0000171E                          1462m ; MODIFIES - D0,D1
0000171E                          1463m ; -----------------------------------------------------------------------------
00001728                          1464  
00001728  43F9 00001746           1465              LEA     .START_TEXT,A1
0000172E  103C 000E               1466              MOVE.B  #14,D0
00001732  4E4F                    1467              TRAP    #15
00001734                          1468              
00001734                          1469              ;Restaurar registros
00001734  4CDF 0203               1470              MOVEM.L (A7)+,A1/D0-D1
00001738  4E75                    1471              RTS
0000173A                          1472  
0000173A= 46 4C 41 50 50 59 ...   1473  .TITLE      DC.B    'FLAPPY BIRD',0 
00001746= 50 52 45 53 53 20 ...   1474  .START_TEXT DC.B    'PRESS SPACE TO START',0
0000175C                          1475              DS.W    0
0000175C                          1476  
0000175C                          1477  
0000175C                          1478  
0000175C                          1479  ; -----------------------------------------------------------------------------
0000175C                          1480  STAPAUI    
0000175C                          1481  ; PAUSE STATE INIT
0000175C                          1482  ; INPUT    - NONE
0000175C                          1483  ; OUTPUT   - NONE
0000175C                          1484  ; MODIFIES - NONE
0000175C                          1485  ; -----------------------------------------------------------------------------
0000175C                          1486              ;Guardar registros de juego
0000175C  48E7 FFFE               1487              MOVEM.L D0-D7/A0-A6,-(A7)
00001760  40E7                    1488              MOVE.W  SR,-(A7)
00001762                          1489              
00001762  4EEF FFC0               1490              JMP     -64(A7)
00001766                          1491  ; -----------------------------------------------------------------------------
00001766                          1492  STAPAUU
00001766                          1493  ; INTRO STATE UPDATE
00001766                          1494  ; INPUT    - NONE
00001766                          1495  ; OUTPUT   - NONE
00001766                          1496  ; MODIFIES - NONE
00001766                          1497  ; -----------------------------------------------------------------------------
00001766  0839 0001 00001BFB      1498              BTST.B  #KBDBITUP,(KBDEDGE)     ;Check cambio en estado de UP
0000176E  6628                    1499              BNE.S   .UP
00001770  0839 0003 00001BFB      1500              BTST.B  #KBDBITDN,(KBDEDGE)     ;Check cambio en estado de DOWN
00001778  6630                    1501              BNE.S   .DN
0000177A  0839 0004 00001BFB      1502              BTST.B  #KBDBITF1,(KBDEDGE)     ;Check cambio en estado de FIRE1
00001782  6638                    1503              BNE.S   .OK
00001784  0839 0007 00001BFB      1504              BTST.B  #KBDBITPS,(KBDEDGE)     ;Check cambio en estado de 'P'
0000178C  6708                    1505              BEQ.S   .END
0000178E                          1506              
0000178E  33FC 0001 00001BE8      1507              MOVE.W  #STAPLAY,(STANEXT)      ;Si hay cambio en estado de 'P'
00001796                          1508                                              ;Actualizar siguiente estado
00001796  4E75                    1509  .END        RTS
00001798                          1510  
00001798  0C39 0000 00001BF8      1511  .UP         CMP.B   #CONTNUM,(PMOPTN)       ;Check si es posible cambiar a una
000017A0  6FF4                    1512              BLE.S   .END                    ;opción superior
000017A2  5379 00001BF8           1513              SUBQ    #1,(PMOPTN)
000017A8  60EC                    1514              BRA.S   .END
000017AA                          1515              
000017AA  0C39 0002 00001BF8      1516  .DN         CMP.B   #EXTNUM,(PMOPTN)        ;Check si es posible cambiar a una
000017B2  6CE2                    1517              BGE.S   .END                    ;opción inferior
000017B4  5279 00001BF8           1518              ADDQ    #1,(PMOPTN)
000017BA  60DA                    1519              BRA.S   .END
000017BC                          1520              
000017BC                          1521  .OK         
000017BC  4280                    1522              CLR.L   D0                      ;Preparar registro D0
000017BE  1039 00001BF8           1523              MOVE.B  (PMOPTN),D0
000017C4  C0FC 0006               1524              MULU    #6,D0                   
000017C8                          1525              
000017C8  2040                    1526              MOVEA.L D0,A0                   ;Usar D0 como indice para .JMPLST
000017CA                          1527              
000017CA  4EE8 17CE               1528              JMP     .JMPLST(A0)
000017CE                          1529              
000017CE  4EF9 000017E0           1530  .JMPLST     JMP     .contgame               
000017D4  4EF9 000017EA           1531              JMP     .newgame
000017DA  4EF9 000017F4           1532              JMP     .exitgame
000017E0                          1533  .contgame
000017E0                          1534              ;Si última PMOPT == continuar juego, actualizar estado
000017E0  33FC 0001 00001BE8      1535              MOVE.W  #STAPLAY,(STANEXT)
000017E8  60AC                    1536              BRA     .END
000017EA                          1537  .newgame    
000017EA                          1538              ;Si última PMOPT == nuevo juego, actualizar estado
000017EA  33FC 0000 00001BE8      1539              MOVE.W  #STAINTR,(STANEXT)
000017F2  60A2                    1540              BRA     .END
000017F4                          1541              
000017F4                          1542  .exitgame   
000017F4                          1543              ;Si última PMOPT == salir de juego, actualizar estado
000017F4  33FC 0003 00001BE8      1544              MOVE.W  #STAGOVR,(STANEXT)
000017FC  6098                    1545              BRA     .END
000017FE                          1546  
000017FE                          1547  ; -----------------------------------------------------------------------------
000017FE                          1548  STAPAUP
000017FE                          1549  ; INTRO STATE PLOT
000017FE                          1550  ; INPUT    - NONE
000017FE                          1551  ; OUTPUT   - NONE
000017FE                          1552  ; MODIFIES - NONE
000017FE                          1553  ; -----------------------------------------------------------------------------
000017FE                          1554              ;Guardar registros
000017FE  48E7 8040               1555              MOVEM.L D0/A1,-(A7)
00001802                          1556  
00001802                          1557m             UTLSFIL #$00000000
00001802                          1558m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001802                          1559m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001802                          1560m ; OUTPUT   - NONE
00001802                          1561m ; MODIFIES - D0,D1
00001802                          1562m ; -----------------------------------------------------------------------------
0000180A                          1563  
0000180A                          1564              **********DIBUJAR TÍTULO**********
0000180A                          1565              ;Seleccionar fuente de texto
0000180A                          1566m             UTLFONT PAUTITC,PAUTITF
0000180A                          1567m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
0000180A                          1568m ; INPUT    - PAUTITC COLOR, PAUTITF FONT
0000180A                          1569m ; OUTPUT   - NONE
0000180A                          1570m ; MODIFIES - D0,D1,D2
0000180A                          1571m ; -----------------------------------------------------------------------------
0000181A                          1572              ;Seleccionar posicion de texto      
0000181A                          1573m             UTLLOCT PAUTITX,PAUTITY               
0000181A                          1574m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
0000181A                          1575m ; INPUT    - PAUTITX X, PAUTITY Y
0000181A                          1576m ; OUTPUT   - NONE
0000181A                          1577m ; MODIFIES - D0,D1
0000181A                          1578m ; -----------------------------------------------------------------------------
00001824                          1579  
00001824  43F9 000018FA           1580              LEA     .TITLE,A1
0000182A  700E                    1581              MOVEQ   #14,D0
0000182C  4E4F                    1582              TRAP    #15
0000182E                          1583              
0000182E  1E39 00001BF8           1584              MOVE.B  (PMOPTN),D7
00001834                          1585              
00001834                          1586              
00001834                          1587              **********DIBUJAR OPCION CONTINUAR**********
00001834                          1588              ;Seleccionar fuente de texto
00001834  0C39 0000 00001BF8      1589              CMP.B   #CONTNUM,(PMOPTN)
0000183C  6712                    1590              BEQ.S   .CNTSEL
0000183E                          1591m             UTLFONT PAUOPTC,PAUOPTFU
0000183E                          1592m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
0000183E                          1593m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
0000183E                          1594m ; OUTPUT   - NONE
0000183E                          1595m ; MODIFIES - D0,D1,D2
0000183E                          1596m ; -----------------------------------------------------------------------------
0000184E  6010                    1597              BRA.S   .SKPCNT
00001850                          1598  
00001850                          1599m .CNTSEL     UTLFONT PAUOPTC,PAUOPTFS
00001850                          1600m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001850                          1601m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
00001850                          1602m ; OUTPUT   - NONE
00001850                          1603m ; MODIFIES - D0,D1,D2
00001850                          1604m ; -----------------------------------------------------------------------------
00001860                          1605  .SKPCNT
00001860                          1606              ;Seleccionar posición de texto
00001860                          1607m             UTLLOCT PAUOPTX,PAUCNTY
00001860                          1608m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001860                          1609m ; INPUT    - PAUOPTX X, PAUCNTY Y
00001860                          1610m ; OUTPUT   - NONE
00001860                          1611m ; MODIFIES - D0,D1
00001860                          1612m ; -----------------------------------------------------------------------------
0000186A                          1613              
0000186A  43F9 00001908           1614              LEA     .CONT,A1
00001870  700E                    1615              MOVEQ   #14,D0
00001872  4E4F                    1616              TRAP    #15
00001874                          1617              
00001874                          1618              **********DIBUJAR OPCION JUEGO NUEVO**********
00001874                          1619              ;Seleccionar fuente de texto
00001874  0C39 0001 00001BF8      1620              CMP.B   #NEWGNUM,(PMOPTN)
0000187C  6712                    1621              BEQ.S   .NEWSEL
0000187E                          1622m             UTLFONT PAUOPTC,PAUOPTFU
0000187E                          1623m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
0000187E                          1624m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
0000187E                          1625m ; OUTPUT   - NONE
0000187E                          1626m ; MODIFIES - D0,D1,D2
0000187E                          1627m ; -----------------------------------------------------------------------------
0000188E  6010                    1628              BRA.S   .SKPNEW
00001890                          1629  
00001890                          1630m .NEWSEL     UTLFONT PAUOPTC,PAUOPTFS
00001890                          1631m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001890                          1632m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
00001890                          1633m ; OUTPUT   - NONE
00001890                          1634m ; MODIFIES - D0,D1,D2
00001890                          1635m ; -----------------------------------------------------------------------------
000018A0                          1636  .SKPNEW
000018A0                          1637              ;Seleccionar posición de texto
000018A0                          1638m             UTLLOCT PAUOPTX,PAUNEWY
000018A0                          1639m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000018A0                          1640m ; INPUT    - PAUOPTX X, PAUNEWY Y
000018A0                          1641m ; OUTPUT   - NONE
000018A0                          1642m ; MODIFIES - D0,D1
000018A0                          1643m ; -----------------------------------------------------------------------------
000018AA                          1644              
000018AA  43F9 00001912           1645              LEA     .NEWG,A1
000018B0  700E                    1646              MOVEQ   #14,D0
000018B2  4E4F                    1647              TRAP    #15
000018B4                          1648              
000018B4                          1649              **********DIBUJAR OPCION SALIR**********
000018B4                          1650              ;Seleccionar fuente de texto
000018B4  0C39 0002 00001BF8      1651              CMP.B   #EXTNUM,(PMOPTN)
000018BC  6712                    1652              BEQ.S   .EXTSEL
000018BE                          1653m             UTLFONT PAUOPTC,PAUOPTFU
000018BE                          1654m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018BE                          1655m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
000018BE                          1656m ; OUTPUT   - NONE
000018BE                          1657m ; MODIFIES - D0,D1,D2
000018BE                          1658m ; -----------------------------------------------------------------------------
000018CE  6010                    1659              BRA.S   .SKPEXT
000018D0                          1660  
000018D0                          1661m .EXTSEL     UTLFONT PAUOPTC,PAUOPTFS
000018D0                          1662m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018D0                          1663m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
000018D0                          1664m ; OUTPUT   - NONE
000018D0                          1665m ; MODIFIES - D0,D1,D2
000018D0                          1666m ; -----------------------------------------------------------------------------
000018E0                          1667  .SKPEXT
000018E0                          1668              ;Seleccionar posición de texto
000018E0                          1669m             UTLLOCT PAUOPTX,PAUEXTY
000018E0                          1670m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000018E0                          1671m ; INPUT    - PAUOPTX X, PAUEXTY Y
000018E0                          1672m ; OUTPUT   - NONE
000018E0                          1673m ; MODIFIES - D0,D1
000018E0                          1674m ; -----------------------------------------------------------------------------
000018EA                          1675              
000018EA  43F9 0000191E           1676              LEA     .EXIT,A1
000018F0  700E                    1677              MOVEQ   #14,D0
000018F2  4E4F                    1678              TRAP    #15
000018F4                          1679              
000018F4                          1680              ;Restaurar registros
000018F4  4CDF 0201               1681              MOVEM.L (A7)+,D0/A1
000018F8  4E75                    1682              RTS
000018FA                          1683              
000018FA                          1684  ; --- LOCAL DATA -----------------
000018FA= 4D 45 4E 55 20 44 ...   1685  .TITLE      DC.B    'MENU DE PAUSA',0
00001908= 43 4F 4E 54 49 4E ...   1686  .CONT       DC.B    'CONTINUAR',0
00001912= 4A 55 45 47 4F 20 ...   1687  .NEWG       DC.B    'JUEGO NUEVO',0
0000191E= 53 41 4C 49 52 00       1688  .EXIT       DC.B    'SALIR',0
00001924                          1689              DS.W    0
00001924                          1690              
00001924                          1691  ; -----------------------------------------------------------------------------
00001924                          1692  STAGOVRU
00001924                          1693  ; GAME OVER STATE UPDATE
00001924                          1694  ; INPUT    - NONE
00001924                          1695  ; OUTPUT   - NONE
00001924                          1696  ; MODIFIES - NONE
00001924                          1697  ; -----------------------------------------------------------------------------
00001924  0839 0004 00001BFB      1698              BTST.B  #KBDBITF1,(KBDEDGE)
0000192C  6700 000A               1699              BEQ     .END
00001930  33FC 0000 00001BE8      1700              MOVE.W  #STAINTR,(STANEXT)
00001938  4E75                    1701  .END        RTS
0000193A                          1702  
0000193A                          1703  ; -----------------------------------------------------------------------------
0000193A                          1704  STAGOVRP
0000193A                          1705  ; GAME OVER STATE PLOT
0000193A                          1706  ; INPUT    - NONE
0000193A                          1707  ; OUTPUT   - NONE
0000193A                          1708  ; MODIFIES - NONE
0000193A                          1709  ; -----------------------------------------------------------------------------
0000193A  48E7 C040               1710              MOVEM.L A1/D0-D1,-(A7)
0000193E                          1711m             UTLLOCT GOVSTRX,GOVSTRY
0000193E                          1712m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
0000193E                          1713m ; INPUT    - GOVSTRX X, GOVSTRY Y
0000193E                          1714m ; OUTPUT   - NONE
0000193E                          1715m ; MODIFIES - D0,D1
0000193E                          1716m ; -----------------------------------------------------------------------------
00001948                          1717m             UTLSPEN #GOVSTRC
00001948                          1718m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001948                          1719m ; INPUT    - #GOVSTRC COLOR IN FORMAT $00BBGGRR
00001948                          1720m ; OUTPUT   - NONE
00001948                          1721m ; MODIFIES - D0,D1
00001948                          1722m ; -----------------------------------------------------------------------------
00001954                          1723m             UTLSFIL #$00000000
00001954                          1724m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001954                          1725m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001954                          1726m ; OUTPUT   - NONE
00001954                          1727m ; MODIFIES - D0,D1
00001954                          1728m ; -----------------------------------------------------------------------------
0000195C  43F9 0000196E           1729              LEA     .GOVSTR,A1
00001962  103C 000E               1730              MOVE.B  #14,D0
00001966  4E4F                    1731              TRAP    #15
00001968  4CDF 0203               1732              MOVEM.L (A7)+,A1/D0-D1
0000196C  4E75                    1733              RTS
0000196E                          1734  
0000196E= 47 41 4D 45 20 20 ...   1735  .GOVSTR     DC.B    'GAME  OVER',0
0000197A                          1736              DS.W    0
0000197A                          1737  
0000197A                          1738  
0000197A                          1739  
0000197A                          1740  
0000197A                          1741  
0000197A                          1742  
0000197A                          1743  
0000197A                          1744  
0000197A                          1745  
0000197A                          1746  
0000197A                          1747  
0000197A                          1748  
0000197A                          1749  
0000197A                          1750  
0000197A                          1751  
0000197A                          1752  
0000197A                          1753  
0000197A                          1754  
0000197A                          1755  
0000197A                          1756  
0000197A                          1757  
0000197A                          1758  
0000197A                          1759  
0000197A                          1760  -------------------- end include --------------------
0000197A                          1761              INCLUDE "BACKGROUND/BACKGROUND.X68"  ; BACKGROUND MANAGEMENT
0000197A                          1762  ;------------------------------------------------------------------------------
0000197A                          1763  ; BACKGROUND
0000197A                          1764  ;------------------------------------------------------------------------------
0000197A                          1765              INCLUDE "BACKGROUND/CLOUD.X68"     ; BACKGROUND CLOUDS MANAGEMENT 
0000197A                          1766  ; =============================================================================
0000197A                          1767  ; CLOUD MANAGEMENT. IT IS A PROP.
0000197A                          1768  ; LOCAL MEMORY IS:
0000197A                          1769  ; +0 WORD X COORDINATE
0000197A                          1770  ; +2 WORD Y COORDINATE
0000197A                          1771  ; =============================================================================
0000197A                          1772  
0000197A                          1773  ; -----------------------------------------------------------------------------
0000197A                          1774  CLDINIT
0000197A                          1775  ; INITALIZES CLOUD
0000197A                          1776  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
0000197A                          1777  ; OUTPUT   - NONE
0000197A                          1778  ; MODIFIES - NONE
0000197A                          1779  ; NOTE     - ASSUMES SCRHEIGH IS GREATER THAN 255
0000197A                          1780  ; -----------------------------------------------------------------------------
0000197A                          1781          ;Guardar registros
0000197A  2F00                    1782          MOVE.L      D0,-(A7)
0000197C                          1783              
0000197C  30BC 0280               1784          MOVE.W      #SCRWIDTH,(A0)
00001980                          1785          
00001980  4EB8 139E               1786          JSR         UTLRAND
00001984  3140 0002               1787          MOVE.W      D0,2(A0)
00001988                          1788          
00001988                          1789          ;Restaurar registros
00001988  201F                    1790          MOVE.L      (A7)+,D0
0000198A                          1791          
0000198A  4E75                    1792          RTS
0000198C                          1793  
0000198C                          1794  ; -----------------------------------------------------------------------------
0000198C                          1795  CLDUPD
0000198C                          1796  ; UPDATES THE STATE OF CLOUDS
0000198C                          1797  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
0000198C                          1798  ; OUTPUT   - NONE
0000198C                          1799  ; MODIFIES - NONE
0000198C                          1800  ; -----------------------------------------------------------------------------
0000198C                          1801          ;Actualizar posición
0000198C  2F00                    1802          MOVE.L      D0,-(A7)
0000198E                          1803          
0000198E  3039 00001BF6           1804          MOVE.W      (XSPEED),D0
00001994  80FC 0002               1805          DIVU.W      #2,D0
00001998  9150                    1806          SUB.W       D0,(A0)
0000199A  0C50 FF88               1807          CMP.W       #-CLDSIZE*2,(A0)
0000199E  6F04                    1808          BLE.S       .KILL
000019A0                          1809  
000019A0                          1810  .END    
000019A0  201F                    1811          MOVE.L      (A7)+,D0
000019A2  4E75                    1812          RTS
000019A4                          1813          
000019A4  4EB8 11AA               1814  .KILL   JSR PRPKILL
000019A8  60F6                    1815          BRA         .END     
000019AA                          1816  
000019AA                          1817  ; -----------------------------------------------------------------------------
000019AA                          1818  CLDPLOT
000019AA                          1819  ; PLOTS THE CLOUD IN ITS RIGHTFUL POSITION
000019AA                          1820  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
000019AA                          1821  ; OUTPUT   - NONE
000019AA                          1822  ; MODIFIES - NONE
000019AA                          1823  ; -----------------------------------------------------------------------------       
000019AA                          1824          ;Guardar registros
000019AA  48E7 F800               1825          MOVEM.L     D0-D4,-(A7)
000019AE                          1826          
000019AE                          1827m         UTLSPEN     #CLDPCLR
000019AE                          1828m ; WRAPPER FOR SET PEN TRAP 15 TASK.
000019AE                          1829m ; INPUT    - #CLDPCLR COLOR IN FORMAT $00BBGGRR
000019AE                          1830m ; OUTPUT   - NONE
000019AE                          1831m ; MODIFIES - D0,D1
000019AE                          1832m ; -----------------------------------------------------------------------------
000019BA                          1833m         UTLSFIL     #CLDFCLR
000019BA                          1834m ; WRAPPER FOR SET FIL TRAP 15 TASK.
000019BA                          1835m ; INPUT    - #CLDFCLR COLOR IN FORMAT $00BBGGRR
000019BA                          1836m ; OUTPUT   - NONE
000019BA                          1837m ; MODIFIES - D0,D1
000019BA                          1838m ; -----------------------------------------------------------------------------
000019C6                          1839          
000019C6                          1840          ;Preparar parametros
000019C6  3210                    1841          MOVE.W      (A0),D1     ;X0 COORD
000019C8  3428 0002               1842          MOVE.W      2(A0),D2    ;Y0 COORD
000019CC  3601                    1843          MOVE.W      D1,D3       
000019CE  3802                    1844          MOVE.W      D2,D4       
000019D0  0643 0078               1845          ADD.W       #CLDSIZE*2,D3 ;X1 COORD
000019D4  0644 003C               1846          ADD.W       #CLDSIZE,D4 ;Y2 COORD
000019D8                          1847          
000019D8  7058                    1848          MOVEQ       #88,D0      ;TASK NUM
000019DA                          1849          
000019DA  4E4F                    1850          TRAP        #15
000019DC                          1851          
000019DC                          1852          ;Restaurar registros
000019DC  4CDF 001F               1853          MOVEM.L     (A7)+,D0-D4
000019E0  4E75                    1854          RTS
000019E2                          1855  
000019E2                          1856  
000019E2                          1857  
000019E2                          1858  
000019E2                          1859  
000019E2                          1860  
000019E2                          1861  
000019E2                          1862  
000019E2                          1863  
000019E2                          1864  
000019E2                          1865  
000019E2                          1866  
000019E2                          1867  
000019E2                          1868  
000019E2                          1869  
000019E2                          1870  
000019E2                          1871  
000019E2                          1872  
000019E2                          1873  
000019E2                          1874  
000019E2                          1875  
000019E2                          1876  
000019E2                          1877  
000019E2                          1878  
000019E2                          1879  
000019E2                          1880  -------------------- end include --------------------
000019E2                          1881              INCLUDE "BACKGROUND/GSSDETAIL.X68" ; GRASS DETAILS MANAGEMENT
000019E2                          1882  ; =============================================================================
000019E2                          1883  ; GRASS DETAILS MANAGEMENT. IT IS A PROP.
000019E2                          1884  ; LOCAL MEMORY IS:
000019E2                          1885  ; +0 WORD X COORDINATE
000019E2                          1886  ; =============================================================================
000019E2                          1887  
000019E2                          1888  ; -----------------------------------------------------------------------------
000019E2                          1889  GSSDINIT
000019E2                          1890  ; INITIALIZES THE LITTLE DETAILS ON THE GRASS
000019E2                          1891  ; -----------------------------------------------------------------------------
000019E2  2F00                    1892          MOVE.L      D0,-(A7)
000019E4                          1893          
000019E4  30BC 0280               1894          MOVE.W      #SCRWIDTH,(A0)
000019E8                          1895          
000019E8  201F                    1896          MOVE.L      (A7)+,D0
000019EA  4E75                    1897          RTS
000019EC                          1898          
000019EC                          1899          
000019EC                          1900  ; -----------------------------------------------------------------------------
000019EC                          1901  GSSDUPD
000019EC                          1902  ; MODIFIES THE LITTLE DETAILS ON THE GRASS' X COORDINATE
000019EC                          1903  ; -----------------------------------------------------------------------------
000019EC                          1904          ;Guardar registros
000019EC  2F00                    1905          MOVE.L      D0,-(A7)
000019EE                          1906  
000019EE  3039 00001BF6           1907          MOVE.W      (XSPEED),D0
000019F4  9150                    1908          SUB.W       D0,(A0)         ;UPDATE X COORDINATE
000019F6  0C50 FFF6               1909          CMP.W       #-GSSDWDTH,(A0)
000019FA  6F04                    1910          BLE.S       .KILL
000019FC                          1911          
000019FC                          1912  .END    ;Restaurar registros
000019FC  201F                    1913          MOVE.L      (A7)+,D0
000019FE  4E75                    1914          RTS
00001A00                          1915  
00001A00  4EB8 11AA               1916  .KILL   JSR         PRPKILL
00001A04  60F6                    1917          BRA         .END
00001A06                          1918          
00001A06                          1919  ; -----------------------------------------------------------------------------
00001A06                          1920  GSSDPLOT
00001A06                          1921  ; PLOTS THE LITTLE DETAILS ON THE GRASS' X COORDINATE
00001A06                          1922  ; -----------------------------------------------------------------------------
00001A06  48E7 F800               1923          MOVEM.L     D0-D4,-(A7)
00001A0A                          1924          
00001A0A                          1925m         UTLSPEN     #$00000000
00001A0A                          1926m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001A0A                          1927m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001A0A                          1928m ; OUTPUT   - NONE
00001A0A                          1929m ; MODIFIES - D0,D1
00001A0A                          1930m ; -----------------------------------------------------------------------------
00001A12                          1931m         UTLSFIL     #GSSDFC
00001A12                          1932m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001A12                          1933m ; INPUT    - #GSSDFC COLOR IN FORMAT $00BBGGRR
00001A12                          1934m ; OUTPUT   - NONE
00001A12                          1935m ; MODIFIES - D0,D1
00001A12                          1936m ; -----------------------------------------------------------------------------
00001A1E                          1937          
00001A1E  3210                    1938          MOVE.W      (A0),D1
00001A20  343C 0168               1939          MOVE.W      #BGGSSTP,D2
00001A24  3601                    1940          MOVE.W      D1,D3
00001A26  0643 000A               1941          ADD.W       #GSSDWDTH,D3
00001A2A  383C 0190               1942          MOVE.W      #BGGSSBT,D4
00001A2E                          1943          
00001A2E  7057                    1944          MOVEQ       #87,D0
00001A30  4E4F                    1945          TRAP        #15
00001A32                          1946          
00001A32  4CDF 001F               1947          MOVEM.L     (A7)+,D0-D4
00001A36  4E75                    1948          RTS
00001A38                          1949          
00001A38                          1950  
00001A38                          1951  
00001A38                          1952  
00001A38                          1953  
00001A38                          1954  
00001A38                          1955  
00001A38                          1956  
00001A38                          1957  -------------------- end include --------------------
00001A38                          1958  ; -----------------------------------------------------------------------------
00001A38                          1959  BGUPD
00001A38                          1960  ; UPDATES DETAILS OF BACKGROUND
00001A38                          1961  ; INPUT    - NONE
00001A38                          1962  ; OUTPUT   - NONE
00001A38                          1963  ; MODIFIES - MEMORY WHEN NEEDED
00001A38                          1964  ; -----------------------------------------------------------------------------
00001A38  48E7 8070               1965              MOVEM.L  D0/A1-A3,-(A7)
00001A3C                          1966  
00001A3C  1039 00001BFD           1967              MOVE.B  (SCRCYCCT),D0
00001A42  C07C 0007               1968              AND     #$07,D0                 ;EVERY 8 CYCLES
00001A46  6614                    1969              BNE.S   .CLOUD                  ;CREATE A NEW MARK ON GRASS
00001A48  43F8 19E2               1970              LEA     GSSDINIT,A1
00001A4C  45F8 19EC               1971              LEA     GSSDUPD,A2
00001A50  47F8 1A06               1972              LEA     GSSDPLOT,A3
00001A54  303C 0002               1973              MOVE.W  #GSSDTYPE,D0
00001A58                          1974              
00001A58  4EB8 1540               1975              JSR     PRPADD
00001A5C                          1976  
00001A5C  1039 00001BFD           1977  .CLOUD      MOVE.B  (SCRCYCCT),D0
00001A62  C07C 00FF               1978              AND     #$FF,D0                 ; EVERY 256 CYCLES
00001A66  6600 0016               1979              BNE     .END                    ; CREATE A NEW CLOUD
00001A6A  43F8 197A               1980              LEA     CLDINIT,A1
00001A6E  45F8 198C               1981              LEA     CLDUPD,A2
00001A72  47F8 19AA               1982              LEA     CLDPLOT,A3
00001A76  303C 0001               1983              MOVE.W  #CLDTYPE,D0
00001A7A                          1984              
00001A7A  4EB8 1540               1985              JSR     PRPADD
00001A7E                          1986              
00001A7E  4CDF 0E01               1987  .END        MOVEM.L (A7)+,D0/A1-A3
00001A82  4E75                    1988              RTS
00001A84                          1989  
00001A84                          1990  
00001A84                          1991  ; -----------------------------------------------------------------------------
00001A84                          1992  BGPLOT
00001A84                          1993  ; PLOTS BACKGROUND
00001A84                          1994  ; INPUT    - NONE
00001A84                          1995  ; OUTPUT   - NONE
00001A84                          1996  ; MODIFIES - NONE
00001A84                          1997  ; -----------------------------------------------------------------------------
00001A84                          1998              
00001A84  48A7 7800               1999              MOVEM.W D1-D4,-(A7)
00001A88                          2000              
00001A88                          2001m             UTLSPEN #BGSKYPC
00001A88                          2002m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001A88                          2003m ; INPUT    - #BGSKYPC COLOR IN FORMAT $00BBGGRR
00001A88                          2004m ; OUTPUT   - NONE
00001A88                          2005m ; MODIFIES - D0,D1
00001A88                          2006m ; -----------------------------------------------------------------------------
00001A90                          2007m             UTLSFIL #BGSKYFC
00001A90                          2008m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001A90                          2009m ; INPUT    - #BGSKYFC COLOR IN FORMAT $00BBGGRR
00001A90                          2010m ; OUTPUT   - NONE
00001A90                          2011m ; MODIFIES - D0,D1
00001A90                          2012m ; -----------------------------------------------------------------------------
00001A9C                          2013              
00001A9C  4241                    2014              CLR.W   D1
00001A9E  4242                    2015              CLR.W   D2
00001AA0  363C 0280               2016              MOVE.W  #SCRWIDTH,D3
00001AA4  383C 01E0               2017              MOVE.W  #SCRHEIGH,D4
00001AA8                          2018              
00001AA8  7057                    2019              MOVEQ   #87,D0
00001AAA  4E4F                    2020              TRAP    #15
00001AAC                          2021              
00001AAC                          2022m             UTLSFIL #BGGNDFC
00001AAC                          2023m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001AAC                          2024m ; INPUT    - #BGGNDFC COLOR IN FORMAT $00BBGGRR
00001AAC                          2025m ; OUTPUT   - NONE
00001AAC                          2026m ; MODIFIES - D0,D1
00001AAC                          2027m ; -----------------------------------------------------------------------------
00001AB8                          2028              
00001AB8  4241                    2029              CLR     D1
00001ABA  343C 0190               2030              MOVE.W  #BGGSSBT,D2
00001ABE  363C 0280               2031              MOVE.W  #SCRWIDTH,D3
00001AC2  383C 01E0               2032              MOVE.W  #SCRHEIGH,D4
00001AC6                          2033              
00001AC6  7057                    2034              MOVEQ   #87,D0
00001AC8  4E4F                    2035              TRAP    #15
00001ACA                          2036              
00001ACA                          2037m             UTLSFIL #BGGSSFC
00001ACA                          2038m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001ACA                          2039m ; INPUT    - #BGGSSFC COLOR IN FORMAT $00BBGGRR
00001ACA                          2040m ; OUTPUT   - NONE
00001ACA                          2041m ; MODIFIES - D0,D1
00001ACA                          2042m ; -----------------------------------------------------------------------------
00001AD6                          2043  
00001AD6                          2044  
00001AD6  4241                    2045              CLR     D1
00001AD8  343C 0168               2046              MOVE.W  #BGGSSTP,D2
00001ADC  363C 0280               2047              MOVE.W  #SCRWIDTH,D3
00001AE0  383C 0190               2048              MOVE.W  #BGGSSBT,D4
00001AE4                          2049              
00001AE4  7057                    2050              MOVEQ   #87,D0
00001AE6  4E4F                    2051              TRAP    #15
00001AE8                          2052              
00001AE8  4C9F 001E               2053              MOVEM.W (A7)+,D1-D4
00001AEC  4E75                    2054              RTS
00001AEE                          2055  
00001AEE                          2056  
00001AEE                          2057  
00001AEE                          2058  
00001AEE                          2059  
00001AEE                          2060  
00001AEE                          2061  
00001AEE                          2062  
00001AEE                          2063  
00001AEE                          2064  
00001AEE                          2065  
00001AEE                          2066  
00001AEE                          2067  
00001AEE                          2068  
00001AEE                          2069  
00001AEE                          2070  
00001AEE                          2071  
00001AEE                          2072  
00001AEE                          2073  -------------------- end include --------------------
00001AEE                          2074              INCLUDE "PIPES.X68"                  ; PIPES MANAGEMENT          
00001AEE                          2075  ; =============================================================================
00001AEE                          2076  ; PIPES MANAGEMENT. IT IS AN AGENT.
00001AEE                          2077  ; LOCAL MEMORY IS:
00001AEE                          2078  ; +0 WORD X COORDINATE OF THE LEFTMOST EDGE OF THE VERTICALLY ALIGNED PIPES
00001AEE                          2079  ; +2 WORD Y COORDINATE OF THE DOWNMOST EDGE OF THE TOP PIPE (FACING DOWN)
00001AEE                          2080  ; +4 WORD BOOLEAN THAT TELLS WHETHER THE PIPE SHOULD MOVE OR NOT
00001AEE                          2081  ;    (0 == TRUE. ELSE FALSE)
00001AEE                          2082  ; =============================================================================
00001AEE                          2083  
00001AEE                          2084  ; -----------------------------------------------------------------------------
00001AEE                          2085  PIPINIT
00001AEE                          2086  ; PIPE INITIALIZATION
00001AEE                          2087  ; -----------------------------------------------------------------------------
00001AEE                          2088              ;Guardar registros
00001AEE  48E7 C000               2089              MOVEM.L D0-D1,-(A7)
00001AF2                          2090          
00001AF2  30BC 0280               2091              MOVE.W  #SCRWIDTH,(A0)      ;X COORDINATE OF STARTING POSITION
00001AF6  4EB8 139E               2092              JSR     UTLRAND             ;RANDOM Y COORDINATE OF STARTING
00001AFA  3140 0002               2093              MOVE.W  D0,2(A0)            *POSITION
00001AFE  B23C 0004               2094              CMP.B   #4,D1
00001B02  6606                    2095              BNE.S   .skip
00001B04                          2096              
00001B04  4239 00001BF4           2097              CLR.B   (PIPCOUNT)
00001B0A                          2098  .skip            
00001B0A  1141 0004               2099              MOVE.B  D1,4(A0)            ;BOOLEAN: MOVING OR NOT
00001B0E                          2100          
00001B0E                          2101              ;Restaurar registros
00001B0E  4CDF 0003               2102              MOVEM.L (A7)+,D0-D1
00001B12  4E75                    2103              RTS
00001B14                          2104              
00001B14                          2105  ; -----------------------------------------------------------------------------
00001B14                          2106  PIPUPD
00001B14                          2107  ; PIPE UPDATE
00001B14                          2108  ; -----------------------------------------------------------------------------
00001B14                          2109              ;Guardar registros
00001B14  2F00                    2110              MOVE.L  D0,-(A7)
00001B16                          2111              
00001B16  3039 00001BF6           2112              MOVE.W  (XSPEED),D0     
00001B1C  9150                    2113              SUB.W   D0,(A0)         ;UPDATE X COORDINATE
00001B1E                          2114              
00001B1E  0C50 FFC4               2115              CMP.W   #-PIPTWDT,(A0)
00001B22  6F04                    2116              BLE.S   .KILL
00001B24                          2117              
00001B24                          2118              
00001B24                          2119              
00001B24                          2120  .END        ;Restaurar registros
00001B24  201F                    2121              MOVE.L  (A7)+,D0
00001B26  4E75                    2122              RTS
00001B28                          2123              
00001B28  4EB8 11AA               2124  .KILL       JSR     AGLKILL
00001B2C  60F6                    2125              BRA.S  .END
00001B2E                          2126              
00001B2E                          2127  ; -----------------------------------------------------------------------------
00001B2E                          2128  PIPPLOT
00001B2E                          2129  ; PIPE PLOT
00001B2E                          2130  ; -----------------------------------------------------------------------------
00001B2E                          2131              ;Guardar registros
00001B2E  48E7 F800               2132              MOVEM.L D0-D4,-(A7)
00001B32                          2133              
00001B32                          2134m             UTLSPEN #PIPPC
00001B32                          2135m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001B32                          2136m ; INPUT    - #PIPPC COLOR IN FORMAT $00BBGGRR
00001B32                          2137m ; OUTPUT   - NONE
00001B32                          2138m ; MODIFIES - D0,D1
00001B32                          2139m ; -----------------------------------------------------------------------------
00001B3A                          2140              
00001B3A  0C28 0000 0004          2141              CMP.B   #0,4(A0)
00001B40  6710                    2142              BEQ.S   .skip
00001B42                          2143              
00001B42                          2144m             UTLSFIL #PIPFC
00001B42                          2145m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001B42                          2146m ; INPUT    - #PIPFC COLOR IN FORMAT $00BBGGRR
00001B42                          2147m ; OUTPUT   - NONE
00001B42                          2148m ; MODIFIES - D0,D1
00001B42                          2149m ; -----------------------------------------------------------------------------
00001B4E  6000 000A               2150              BRA     .skp2
00001B52                          2151  .skip       
00001B52                          2152m             UTLSFIL #$00000000      ;prueba para pipes que se han de mover
00001B52                          2153m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001B52                          2154m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001B52                          2155m ; OUTPUT   - NONE
00001B52                          2156m ; MODIFIES - D0,D1
00001B52                          2157m ; -----------------------------------------------------------------------------
00001B5A                          2158  .skp2
00001B5A                          2159              
00001B5A  3210                    2160              MOVE.W  (A0),D1         ;PAINT THE BASE OF THE TOP PIPE
00001B5C  5A41                    2161              ADDQ    #PIPTBSPC,D1
00001B5E  4242                    2162              CLR     D2
00001B60  3601                    2163              MOVE.W  D1,D3
00001B62  0643 0032               2164              ADD.W   #PIPBWDT,D3
00001B66  3828 0002               2165              MOVE.W  2(A0),D4
00001B6A                          2166              
00001B6A  7057                    2167              MOVEQ   #87,D0
00001B6C  4E4F                    2168              TRAP    #15
00001B6E                          2169              
00001B6E  3210                    2170              MOVE.W  (A0),D1         ;PAINT THE MOUTH OF THE TOP PIPE
00001B70  3828 0002               2171              MOVE.W  2(A0),D4
00001B74  3404                    2172              MOVE.W  D4,D2
00001B76  0442 000A               2173              SUB.W   #PIPTHGT,D2
00001B7A  3601                    2174              MOVE.W  D1,D3
00001B7C  0643 003C               2175              ADD.W   #PIPTWDT,D3
00001B80                          2176              
00001B80  7057                    2177              MOVEQ   #87,D0
00001B82  4E4F                    2178              TRAP    #15
00001B84                          2179              
00001B84  3210                    2180              MOVE.W  (A0),D1         ;PAINT THE BASE OF THE BOTTOM PIPE
00001B86  5A41                    2181              ADD.W   #PIPTBSPC,D1
00001B88  3428 0002               2182              MOVE.W  2(A0),D2
00001B8C  0642 0050               2183              ADD.W   #PIPOPEN,D2
00001B90  3601                    2184              MOVE.W  D1,D3
00001B92  0643 0032               2185              ADD.W   #PIPBWDT,D3
00001B96  383C 0168               2186              MOVE.W  #BGGSSTP,D4
00001B9A                          2187              
00001B9A  7057                    2188              MOVEQ   #87,D0
00001B9C  4E4F                    2189              TRAP    #15
00001B9E                          2190              
00001B9E  3210                    2191              MOVE.W  (A0),D1         ;PAINT THE MOUTH OF THE BOTTOM PIPE
00001BA0  3428 0002               2192              MOVE.W  2(A0),D2
00001BA4  0642 0050               2193              ADD.W   #PIPOPEN,D2
00001BA8  3601                    2194              MOVE.W  D1,D3
00001BAA  0643 003C               2195              ADD.W   #PIPTWDT,D3
00001BAE  3802                    2196              MOVE.W  D2,D4
00001BB0  0644 000A               2197              ADD.W   #PIPTHGT,D4
00001BB4                          2198              
00001BB4  7057                    2199              MOVEQ   #87,D0
00001BB6  4E4F                    2200              TRAP    #15
00001BB8                          2201  
00001BB8                          2202              ;Restaurar registros
00001BB8  4CDF 001F               2203              MOVEM.L (A7)+,D0-D4
00001BBC  4E75                    2204              RTS
00001BBE                          2205  
00001BBE                          2206  
00001BBE                          2207  
00001BBE                          2208  
00001BBE                          2209  
00001BBE                          2210  
00001BBE                          2211  
00001BBE                          2212  -------------------- end include --------------------
00001BBE                          2213  
00001BBE                          2214  
00001BBE                          2215  ; --- INITIALIZE --------------------------------------------------------------
00001BBE                          2216  
00001BBE  4EB8 1000               2217  START       JSR     SYSINIT
00001BC2  4EB8 15F4               2218              JSR     STAINIT
00001BC6                          2219  
00001BC6                          2220  ; --- UPDATE ------------------------------------------------------------------
00001BC6                          2221   
00001BC6  4E40                    2222  .LOOP       TRAP    #KBDTRAP                ; READ KEYBOARD
00001BC8  4EB8 1606               2223              JSR     STAUPD
00001BCC                          2224  
00001BCC                          2225  ; --- WAIT SYNCH --------------------------------------------------------------
00001BCC                          2226  
00001BCC  4A39 00001BFC           2227  .WINT       TST.B   (SCRINTCT)              ; WAIT FOR INTERRUPT
00001BD2  67F8                    2228              BEQ     .WINT
00001BD4  4239 00001BFC           2229              CLR.B   (SCRINTCT)
00001BDA                          2230  
00001BDA                          2231  ; --- PLOT --------------------------------------------------------------------
00001BDA                          2232  
00001BDA  4EB8 1664               2233              JSR     STAPLOT
00001BDE  4E41                    2234              TRAP    #SCRTRAP                ; SHOW GRAPHICS
00001BE0  60E4                    2235              BRA     .LOOP
00001BE2  FFFF FFFF               2236              SIMHALT
00001BE6                          2237  
00001BE6                          2238  ; --- VARIABLES ---------------------------------------------------------------
00001BE6                          2239  
00001BE6                          2240              INCLUDE "VAR.X68"
00001BE6                          2241  ; =============================================================================
00001BE6                          2242  ; GAME VARS
00001BE6                          2243  ; =============================================================================
00001BE6                          2244  
00001BE6                          2245  ; --- GAME STATE RELATED VARIABLES --------------------------------------------
00001BE6                          2246  
00001BE6                          2247  STACUR      DS.W    1                       ; CURRENT GAME STATE
00001BE8                          2248  STANEXT     DS.W    1                       ; NEXT GAME STATE
00001BEA                          2249  
00001BEA                          2250  ; --- PLAYER RELATED VARIABLES ------------------------------------------------
00001BEA                          2251  
00001BEA                          2252  PLRPOSX     DS.W    1                       ; PLAYER X POSITION (PIXELS)
00001BEC                          2253  PLRPOSY     DS.W    1                       ; PLAYER Y POSITION (PIXELS)
00001BEE                          2254  MAXPOS      DS.W    1
00001BF0                          2255  UPPRESSED   DS.W    1
00001BF2                          2256  PLRSPEED    DS.W    1
00001BF4                          2257              DS.W    0
00001BF4                          2258              
00001BF4                          2259  ; --- PIPE RELATED VARIABLES --------------------------------------------------
00001BF4                          2260  
00001BF4= 01                      2261  PIPCOUNT    DC.B    1
00001BF6                          2262              DS.W    0
00001BF6                          2263  
00001BF6                          2264  ; --- GAME RELATED VARIABLES --------------------------------------------------
00001BF6                          2265  
00001BF6= 0005                    2266  XSPEED      DC.W    5                       ;HORIZONTAL SPEED OF OBJECTS
00001BF8                          2267  
00001BF8                          2268  ; --- PAUSE MENU RELATED VARIABLES -------------------------------------------
00001BF8                          2269  
00001BF8= 00                      2270  PMOPTN      DC.B    0                       ;OPTION ON THE MENU TO BE CHOSEN
00001BF9                          2271  
00001BF9                          2272  ; --- UTILITY VARIABLES ------------------------------------------------------
00001BF9                          2273  
00001BF9                          2274  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001BFA                          2275              DS.W    0
00001BFA                          2276  
00001BFA                          2277  
00001BFA                          2278  
00001BFA                          2279  
00001BFA                          2280  
00001BFA                          2281  
00001BFA                          2282  
00001BFA                          2283  
00001BFA                          2284  
00001BFA                          2285  
00001BFA                          2286  
00001BFA                          2287  
00001BFA                          2288  
00001BFA                          2289  -------------------- end include --------------------
00001BFA                          2290              INCLUDE "SYSVAR.X68"
00001BFA                          2291  ; =============================================================================
00001BFA                          2292  ; SYSTEM VARS
00001BFA                          2293  ; NOTE THAT ALL THESE VARS ARE USED TO SHARE DATA FROM SYSTEM TO USER. THUS
00001BFA                          2294  ; THEY MUST NOT BE IN PROTECTED MEMORY.
00001BFA                          2295  ; NOTE THAT USING DMMDATA IN SUCH WAY IS A BAD IDEA, AS USER APPLICATIONS CAN
00001BFA                          2296  ; ALSO FREE OR CHANGE OWNERSHIP. NONETHELESS, FOR THE SAKE OF THIS EXAMPLE
00001BFA                          2297  ; THIS IS GOOD ENOUGH.
00001BFA                          2298  ; =============================================================================
00001BFA                          2299  
00001BFA                          2300  ; --- KEYBOARD RELATED VARIABLES ----------------------------------------------
00001BFA                          2301  
00001BFA                          2302  KBDVAL      DS.B    1                       ; KEY PRESSED=1
00001BFB                          2303  KBDEDGE     DS.B    1                       ; KEY CHANGED=1
00001BFC                          2304  
00001BFC                          2305              DS.W    0
00001BFC                          2306  
00001BFC                          2307  ; --- SCREEN RELATED VARIABLES ------------------------------------------------
00001BFC                          2308  
00001BFC                          2309  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER/FLAG
00001BFD                          2310  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00001BFE                          2311              DS.W    0
00001BFE                          2312  
00001BFE                          2313  ; --- DYNAMIC MEMORY VARIABLES ------------------------------------------------
00001BFE                          2314  
00001C00                          2315              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00001C00                          2316  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00002880                          2317              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00002880                          2318  
00002880                          2319  
00002880                          2320  -------------------- end include --------------------
00002880                          2321  
00002880                          2322              END    START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              14BC
AGLADD:END          14D2
AGLKILL             11AA
AGLPLOT             150A
AGLPLOT:END         153A
AGLPLOT:LOOP        1512
AGLPLOT:NEXT        1534
AGLUPD              14D6
AGLUPD:END          1504
AGLUPD:LOOP         14DE
AGLUPD:NEXT         14FE
BGGNDFC             155DD8
BGGNDPC             0
BGGNDTP             190
BGGSSBT             190
BGGSSFC             990A
BGGSSPC             0
BGGSSTP             168
BGPLOT              1A84
BGSKYFC             EFCE87
BGSKYPC             0
BGUPD               1A38
BGUPD:CLOUD         1A5C
BGUPD:END           1A7E
BLACK               0
CLDFCLR             FFFFFF
CLDINIT             197A
CLDPCLR             FFFFFF
CLDPLOT             19AA
CLDSIZE             3C
CLDTYPE             1
CLDUPD              198C
CLDUPD:END          19A0
CLDUPD:KILL         19A4
CONTNUM             0
DMMALLOC            1190
DMMALLOC:END        11A8
DMMBNUM             32
DMMBSIZE            40
DMMDATA             1C00
DMMFCOM             116A
DMMFFND             1178
DMMFIRST            1120
DMMFLOOP            115E
DMMFRCOM            1132
DMMFREE             11AA
DMMFRFND            1140
DMMFRLOP            1126
DMMFRSTO            1158
DMMINIT             10FE
DMMINIT:LOOP        110C
DMMNEXT             1142
DMMNEXTO            117A
DMMSYSID            0
EXTNUM              2
GOVSTRC             FFFFFF
GOVSTRX             23
GOVSTRY             F
GREEN               8000
GSSDFC              39DB44
GSSDINIT            19E2
GSSDPLOT            1A06
GSSDTYPE            2
GSSDUPD             19EC
GSSDUPD:END         19FC
GSSDUPD:KILL        1A00
GSSDWDTH            A
INTPRSC             80
INTPRSF             31A0001
INTPRSX             5
INTPRSY             8
INTTITC             FFFF
INTTITF             33D0001
INTTITX             1
INTTITY             1
JUMPSIZE            3C
KBDBITDN            3
KBDBITF1            4
KBDBITF2            5
KBDBITF3            6
KBDBITLF            0
KBDBITPS            7
KBDBITRT            2
KBDBITUP            1
KBDCHRDN            28
KBDCHRLF            25
KBDCHRMK            4D
KBDCHRPK            50
KBDCHRRT            27
KBDCHRSH            10
KBDCHRSP            20
KBDCHRUP            26
KBDDOWN             28
KBDEDGE             1BFB
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1090
KBDLEFT             25
KBDMSKDN            8
KBDMSKF1            10
KBDMSKF2            20
KBDMSKF3            40
KBDMSKLF            1
KBDMSKPS            80
KBDMSKRT            4
KBDMSKUP            2
KBDPAUSE            50
KBDREAD             10A6
KBDREAD:KEYSREADY   10E2
KBDREAD:LOOP        10C4
KBDREAD:NEXTKEYS    10C2
KBDREAD:NOTPRESSED  10CE
KBDRIGHT            27
KBDTRAP             0
KBDUP               26
KBDVAL              1BFA
MAXPOS              1BEE
NEWGNUM             1
PAUCNTY             8
PAUEXTY             C
PAUNEWY             A
PAUOPTC             FFFFFF
PAUOPTFS            1130005
PAUOPTFU            1130001
PAUOPTX             F
PAUSELC             FF
PAUTITC             FFFF
PAUTITF             3300001
PAUTITX             2
PAUTITY             1
PIPBWDT             32
PIPCOUNT            1BF4
PIPFC               196600
PIPINIT             1AEE
PIPINIT:SKIP        1B0A
PIPOPEN             50
PIPPC               0
PIPPLOT             1B2E
PIPPLOT:SKIP        1B52
PIPPLOT:SKP2        1B5A
PIPTBSPC            5
PIPTHGT             A
PIPTWDT             3C
PIPTYPE             3
PIPUPD              1B14
PIPUPD:END          1B24
PIPUPD:KILL         1B28
PIPYSPD             2
PLRCOLOR            8000
PLREYECOLOR         FFFFFF
PLRHEIGHT           1E
PLRINIT             11C0
PLRINITPOSX         96
PLRINITPOSY         B4
PLRIRISCOLOR        0
PLRMOUTHCOLOR       FF
PLRPLOT             12A6
PLRPOSX             1BEA
PLRPOSY             1BEC
PLRSPEED            1BF2
PLRUPD              11EA
PLRUPD:END          12A0
PLRUPD:GAMEOVER     1294
PLRUPD:LASTJUMP     1288
PLRUPD:MAKEJUMP     1254
PLRUPD:PRESSED      1230
PLRWIDTH            1E
PMOPTN              1BF8
PRPADD              1540
PRPADD:END          1556
PRPKILL             11AA
PRPPLOT             1588
PRPPLOT:END         15B0
PRPPLOT:LOOP        1590
PRPPLOT:NEXT        15AA
PRPUPD              155A
PRPUPD:END          1582
PRPUPD:LOOP         1562
PRPUPD:NEXT         157C
RED                 FF
SCRCYCCT            1BFD
SCRHEIGH            1E0
SCRINIT             101C
SCRINTCT            1BFC
SCRIRQ              1
SCRISR              1074
SCRTIM              14
SCRTRAP             1
SCRUPD              1082
SCRWIDTH            280
SPWUPD              15B6
SPWUPD:END          15EE
STACUR              1BE6
STAEMPTY            1690
STAGOVR             3
STAGOVRP            193A
STAGOVRP:GOVSTR     196E
STAGOVRU            1924
STAGOVRU:END        1938
STAINIT             15F4
STAINTR             0
STAINTRI            10FE
STAINTRP            16E4
STAINTRP:START_TEXT  1746
STAINTRP:TITLE      173A
STAINTRU            16CE
STAINTRU:END        16E2
STANEXT             1BE8
STANONE             FFFFFFFF
STAPAU              2
STAPAUI             175C
STAPAUP             17FE
STAPAUP:CNTSEL      1850
STAPAUP:CONT        1908
STAPAUP:EXIT        191E
STAPAUP:EXTSEL      18D0
STAPAUP:NEWG        1912
STAPAUP:NEWSEL      1890
STAPAUP:SKPCNT      1860
STAPAUP:SKPEXT      18E0
STAPAUP:SKPNEW      18A0
STAPAUP:TITLE       18FA
STAPAUU             1766
STAPAUU:CONTGAME    17E0
STAPAUU:DN          17AA
STAPAUU:END         1796
STAPAUU:EXITGAME    17F4
STAPAUU:JMPLST      17CE
STAPAUU:NEWGAME     17EA
STAPAUU:OK          17BC
STAPAUU:UP          1798
STAPLAY             1
STAPLAYI            11C0
STAPLAYP            16BC
STAPLAYU            1692
STAPLAYU:PAUSE      16B2
STAPLOT             1664
STAPLOT:PLTTBL      1680
START               1BBE
START:LOOP          1BC6
START:WINT          1BCC
STAUPD              1606
STAUPD:DOUPD        162C
STAUPD:INITBL       1644
STAUPD:UPDTBL       1654
SYSINIT             1000
UPPRESSED           1BF0
UTLCHCOL            136A
UTLCHCOL:END        1398
UTLCHCOL:NOCOL      1396
UTLFONT             37C
UTLINIT             1362
UTLLOCT             254
UTLRAND             139E
UTLRAND:RANDVEC     13BC
UTLRNDIX            1BF9
UTLSFIL             12A
UTLSPEN             0
WHITE               FFFFFF
XSPEED              1BF6
