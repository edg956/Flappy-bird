00001BFE Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 02/01/2019 19:47:15

00000000                             1  ; =============================================================================
00000000                             2  ; TITLE    : YET ANOTHER FLAPPY BIRD (YAF)
00000000                             3  ; AUTHORS  : DOÑAQUE, EUGENIO && LLABRÉS, NADAL.
00000000                             4  ; CREATION : DEC 2018
00000000                             5  ; =============================================================================
00000000                             6  
00001000                             7              ORG     $1000
00001000                             8  
00001000                             9  ; --- CODE INCLUDES -----------------------------------------------------------
00001000                            10  
00001000                            11              INCLUDE "SYSCONST.X68"               ; SYSTEM CONSTANTS
00001000                            12  ; =============================================================================
00001000                            13  ; SYSTEM CONSTANTS
00001000                            14  ; =============================================================================
00001000                            15  
00001000                            16  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
00001000                            17  
00001000  =00000000                 18  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
00001000  =00000001                 19  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
00001000                            20  
00001000                            21  ; --- KEY CODES (EASy68K)
00001000                            22  
00001000  =00000020                 23  KBDCHRSP    EQU     $20                     ; SPACE KEY
00001000  =0000004D                 24  KBDCHRMK    EQU     'M'                     ; M KEY
00001000  =00000010                 25  KBDCHRSH    EQU     $10                     ; SHIFT KEY
00001000  =00000050                 26  KBDCHRPK    EQU     'P'                     ; P KEY
00001000  =00000025                 27  KBDCHRLF    EQU     $25                     ; LEFT KEY
00001000  =00000026                 28  KBDCHRUP    EQU     $26                     ; UP KEY
00001000  =00000027                 29  KBDCHRRT    EQU     $27                     ; RIGHT KEY
00001000  =00000028                 30  KBDCHRDN    EQU     $28                     ; DOWN KEY
00001000                            31  
00001000                            32  ; --- KEYBOARD MAPPING --------------------------------------------------------
00001000                            33  
00001000  =00000025                 34  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
00001000  =00000026                 35  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
00001000  =00000027                 36  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
00001000  =00000028                 37  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
00001000  =00000020                 38  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
00001000  =0000004D                 39  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
00001000  =00000010                 40  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
00001000  =00000050                 41  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
00001000                            42  
00001000                            43  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
00001000                            44  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
00001000                            45  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
00001000                            46  ; +---+---+---+---+---+---+---+---+
00001000                            47  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
00001000                            48  ; +---+---+---+---+---+---+---+---+
00001000                            49  ;   |   |   |   |   |   |   |   |
00001000                            50  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
00001000                            51  ;   |   |   |   |   |   |   +-------------- UP BUTTON
00001000                            52  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
00001000                            53  ;   |   |   |   |   +---------------------- DOWN BUTTON
00001000                            54  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
00001000                            55  ;   |   |   +------------------------------ FIRE 2 BUTTON
00001000                            56  ;   |   +---------------------------------- FIRE 3 BUTTON
00001000                            57  ;   +-------------------------------------- PAUSE BUTTON
00001000                            58  
00001000  =00000001                 59  KBDMSKLF    EQU     %00000001
00001000  =00000002                 60  KBDMSKUP    EQU     %00000010
00001000  =00000004                 61  KBDMSKRT    EQU     %00000100
00001000  =00000008                 62  KBDMSKDN    EQU     %00001000
00001000  =00000010                 63  KBDMSKF1    EQU     %00010000
00001000  =00000020                 64  KBDMSKF2    EQU     %00100000
00001000  =00000040                 65  KBDMSKF3    EQU     %01000000
00001000  =00000080                 66  KBDMSKPS    EQU     %10000000
00001000                            67  
00001000                            68  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
00001000                            69  
00001000  =00000000                 70  KBDBITLF    EQU     0
00001000  =00000001                 71  KBDBITUP    EQU     1
00001000  =00000002                 72  KBDBITRT    EQU     2
00001000  =00000003                 73  KBDBITDN    EQU     3
00001000  =00000004                 74  KBDBITF1    EQU     4
00001000  =00000005                 75  KBDBITF2    EQU     5
00001000  =00000006                 76  KBDBITF3    EQU     6
00001000  =00000007                 77  KBDBITPS    EQU     7
00001000                            78  
00001000                            79  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
00001000                            80  
00001000  =00000280                 81  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
00001000  =000001E0                 82  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
00001000  =00000001                 83  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
00001000  =00000014                 84  SCRTIM      EQU     20                      ; SCREEN TIMER (MS)
00001000                            85  
00001000                            86  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
00001000                            87  
00001000  =00000040                 88  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001000  =00000032                 89  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001000  =00000000                 90  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001000                            91  
00001000                            92  
00001000                            93  
00001000                            94  
00001000                            95  -------------------- end include --------------------
00001000                            96              INCLUDE "SYSTEM.X68"                 ; SYSTEM CODE
00001000                            97  ; =============================================================================
00001000                            98  ; SYSTEM MANAGEMENT (SYSTEM CODE)
00001000                            99  ; =============================================================================
00001000                           100  
00001000                           101  ; -----------------------------------------------------------------------------
00001000                           102  SYSINIT
00001000                           103  ; INITIALIZES THE SYSTEM
00001000                           104  ; INPUT    - NONE
00001000                           105  ; OUTPUT   - NONE
00001000                           106  ; MODIFIES - NONE
00001000                           107  ; -----------------------------------------------------------------------------
00001000  205F                     108              MOVE.L  (A7)+,A0                ; GET RETURN ADDRESS
00001002  4EB9 00001090            109              JSR     KBDINIT                 ; INIT KEYBOARD
00001008  4EB9 0000101C            110              JSR     SCRINIT                 ; INIT SCREEN
0000100E  4EB9 000010FE            111              JSR     DMMINIT                 ; INIT DYNAMIC MEMORY
00001014  027C DFFF                112              ANDI.W  #$DFFF,SR               ; SWITCH TO USER
00001018  2F08                     113              MOVE.L  A0,-(A7)                ; PUT RETURN ADDRESS
0000101A  4E75                     114              RTS
0000101C                           115  
0000101C                           116  ; =============================================================================
0000101C                           117  ; SCREEN MANAGEMENT (SYSTEM CODE)
0000101C                           118  ; =============================================================================
0000101C                           119  
0000101C                           120  ; -----------------------------------------------------------------------------
0000101C                           121  SCRINIT
0000101C                           122  ; INITIALIZES THE SCREEN, SCREEN-RELATED INTERRUPT AND VARS.
0000101C                           123  ; INPUT    - NONE
0000101C                           124  ; OUTPUT   - NONE
0000101C                           125  ; MODIFIES - D0,D1,D2,D3
0000101C                           126  ; -----------------------------------------------------------------------------
0000101C                           127              ; TO DO:
0000101C                           128              ; - DISABLE INTS (SET INT BITS IN SR TO 111)
0000101C                           129              
0000101C  007C 0700                130              ORI.W #(7<<8)&$700,SR
00001020                           131              
00001020                           132              ; - INSTALL SCRUPD INTO TRAP SCRTRAP
00001020                           133              
00001020  21FC 00001082 0084       134              MOVE.L  #SCRUPD,($80+4*SCRTRAP)
00001028                           135              
00001028                           136              ; - SET RESOLUTION TO SCRWIDTH X SCRHEIGHT
00001028                           137              
00001028  7021                     138              MOVE.L  #33,D0
0000102A  223C 028001E0            139              MOVE.L  #SCRWIDTH*$10000+SCRHEIGH,D1
00001030  4E4F                     140              TRAP    #15
00001032                           141              
00001032                           142              ; - SET WINDOWED MODE
00001032                           143              
00001032  7201                     144              MOVEQ   #1, D1 
00001034  4E4F                     145              TRAP    #15
00001036                           146              
00001036                           147              ; - CLEAR VISIBLE BUFFER
00001036                           148              
00001036  700B                     149              MOVEQ   #11, D0
00001038  323C FF00                150              MOVE.W  #$FF00,D1
0000103C  4E4F                     151              TRAP    #15
0000103E                           152              
0000103E                           153              ; - ENABLE DOUBLE BUFFER
0000103E                           154              
0000103E  705C                     155              MOVEQ   #92, D0
00001040  7211                     156              MOVEQ   #17, D1     
00001042  4E4F                     157              TRAP    #15
00001044                           158              
00001044                           159              ; - CLEAR HIDDEN BUFFER
00001044                           160              
00001044  700B                     161              MOVEQ   #11, D0
00001046  323C FF00                162              MOVE.W  #$FF00,D1
0000104A  4E4F                     163              TRAP    #15
0000104C                           164              
0000104C                           165              ; - INSTALL SCRISR FOR IRQ SCRIRQ (IRQ INTERRUPT VECTOR BEGINS
0000104C                           166              ;   AT $60. INSTALLATION IS SIMILAR TO TRAP INSTALLATION)
0000104C                           167              
0000104C  21FC 00001074 0064       168              MOVE.L  #SCRISR,($60+4*SCRIRQ)
00001054                           169              
00001054                           170              ; - ENABLE AUTO-IRQ EVERY SCRTIM MS FOR IRQ SCRIRQ (SEE TRAP #15
00001054                           171              ;   TASK 32)
00001054                           172              
00001054  7020                     173              MOVEQ   #32,D0
00001056  7206                     174              MOVEQ   #6,D1
00001058  243C 00000081            175              MOVE.L  #$80+SCRIRQ,D2
0000105E  7614                     176              MOVE.L  #SCRTIM, D3
00001060  4E4F                     177              TRAP    #15
00001062                           178              
00001062                           179              ; - CLEAR SCRINTCT AND SCRCYCCT
00001062                           180              
00001062  4239 00001C40            181              CLR.B   (SCRINTCT)
00001068  4239 00001C41            182              CLR.B   (SCRCYCCT)
0000106E                           183              
0000106E                           184              ; - ENABLE INTS (SET INT BITS IN SR TO 000)
0000106E                           185              
0000106E  027C F8FF                186              ANDI.W #$F8FF,SR
00001072                           187              
00001072  4E75                     188              RTS
00001074                           189  
00001074                           190  ; -----------------------------------------------------------------------------
00001074                           191  SCRISR
00001074                           192  ; SCREEN TIMER ISR. INCREASES THE INTERRUPT COUNTER AND UPDATES DOUBLE BUFFER.
00001074                           193  ; INPUT    - NONE
00001074                           194  ; OUTPUT   - NONE
00001074                           195  ; MODIFIES - NONE
00001074                           196  ; -----------------------------------------------------------------------------
00001074  5239 00001C40            197              ADDQ.B  #1,(SCRINTCT)           ; UPDATE INT FLAG/COUNTER
0000107A  5239 00001C41            198              ADDQ.B  #1,(SCRCYCCT)           ; UPDATE CYCLE COUNTER
00001080  4E73                     199              RTE
00001082                           200  
00001082                           201  ; -----------------------------------------------------------------------------
00001082                           202  SCRUPD
00001082                           203  ; TRAP SERVICE ROUTINE IN CHARGE OF VISUALIZING CURRENT FRAME AND CLEARING
00001082                           204  ; BUFFER FOR THE NEXT ONE.
00001082                           205  ; INPUT    - NONE
00001082                           206  ; OUTPUT   - NONE
00001082                           207  ; MODIFIES - NONE
00001082                           208  ; -----------------------------------------------------------------------------
00001082                           209              ; TO DO: UPDATE DOUBLE BUFFER AND CLEAR HIDDEN BUFFER
00001082                           210              ; - UPDATE DOUBLE BUFFER
00001082                           211              
00001082  705E                     212              MOVEQ   #94,D0
00001084  4E4F                     213              TRAP    #15
00001086                           214              
00001086                           215              ; - CLEAR HIDDEN BUFFER
00001086                           216                                 
00001086  700B                     217              MOVEQ   #11, D0
00001088  323C FF00                218              MOVE.W  #$FF00,D1
0000108C  4E4F                     219              TRAP    #15
0000108E                           220              
0000108E  4E73                     221              RTE
00001090                           222  
00001090                           223  ; =============================================================================
00001090                           224  ; KEYBOARD MANAGEMENT (SYSTEM CODE)
00001090                           225  ; =============================================================================
00001090                           226  
00001090                           227  ; -----------------------------------------------------------------------------
00001090                           228  KBDINIT
00001090                           229  ; INITIALIZES THE SYSTEM VARIABLES KBDSYS AND KBDVAL
00001090                           230  ; INPUT    - NONE
00001090                           231  ; OUTPUT   - NONE
00001090                           232  ; MODIFIES - NONE
00001090                           233  ; -----------------------------------------------------------------------------
00001090  4239 00001C3E            234              CLR.B   (KBDVAL)                ; INIT VARS
00001096  4239 00001C3F            235              CLR.B   (KBDEDGE)
0000109C  21FC 000010A6 0080       236              MOVE.L  #KBDREAD,($80+KBDTRAP*4) ; INSTALL
000010A4  4E75                     237              RTS
000010A6                           238  
000010A6                           239  ; -----------------------------------------------------------------------------
000010A6                           240  KBDREAD
000010A6                           241  ; TRAP SERVICE ROUTINE.
000010A6                           242  ; UPDATES THE SYSTEM VARIABLES KBDEDGE AND KBDVAL ACCORDING TO THE BITFIELD
000010A6                           243  ; DESCRIBED IN SYSCONST. KBDVAL HOLDS THE CURRENT VALUES AND KBDEFGE HOLDS
000010A6                           244  ; RISING EDGES FROM PREVIOUS CALL TO THE CURRENT ONE.
000010A6                           245  ; INPUT    - NONE
000010A6                           246  ; OUTPUT   - (KBDVAL) AND (KBDEDGE)
000010A6                           247  ; MODIFIES - NONE
000010A6                           248  ; -----------------------------------------------------------------------------
000010A6                           249              ; TO DO: UPDATE KBDVAL AND KBDEDGE
000010A6                           250              ;Guardar registros en pila
000010A6  48E7 F800                251              MOVEM.L D0-D4,-(A7)
000010AA                           252  
000010AA                           253              ;Obtener estado de teclas
000010AA  7013                     254              MOVEQ   #19,D0
000010AC                           255              
000010AC                           256              ;Obtener estado de teclas PAUSE - FIRE3 - FIRE2 - FIRE1
000010AC  223C 50104D20            257              MOVE.L  #KBDCHRPK<<24+KBDCHRSH<<16+KBDCHRMK<<8+KBDCHRSP,D1
000010B2                           258              
000010B2  4E4F                     259              TRAP    #15
000010B4                           260              
000010B4                           261              ;GUARDAR ESTADO DE TECLAS
000010B4  2401                     262              MOVE.L  D1,D2                   
000010B6                           263              
000010B6                           264              ;Obtener estado de teclas DOWN - RIGHT - UP - LEFT
000010B6  223C 28272625            265              MOVE.L  #KBDCHRDN<<24+KBDCHRRT<<16+KBDCHRUP<<8+KBDCHRLF,D1
000010BC                           266  
000010BC  4E4F                     267              TRAP    #15
000010BE                           268            
000010BE                           269              ;Actualizar valores de KBDVAL
000010BE  4243                     270              CLR     D3        ;Registro que contendrá KBDVAL.
000010C0  4244                     271              CLR     D4        ;Registro con índice de bit a modificar de D3.
000010C2                           272              
000010C2                           273              
000010C2                           274              ;Bucle que recorre D1 para obtener estado de teclas.
000010C2  7003                     275  .NEXTKEYS   MOVEQ   #3, D0    ;Número de iteraciones del bucle (.LOOP).
000010C4                           276  
000010C4                           277  .LOOP                   
000010C4  0801 0000                278              BTST    #0, D1
000010C8  6700 0004                279              BEQ     .NOTPRESSED
000010CC                           280              ;If pressed, set corresponding bit
000010CC  09C3                     281              BSET    D4, D3                  
000010CE                           282                        
000010CE                           283  .NOTPRESSED              
000010CE                           284              *En cualquier caso, obtener siguiente byte de D1*
000010CE                           285              
000010CE                           286              ;Se desplaza el registro D1 8 bits a la derecha. 
000010CE  E089                     287              LSR.L   #8, D1
000010D0                           288              
000010D0                           289              ;Se incrementa el índice de D3.
000010D0  5244                     290              ADDQ    #1, D4
000010D2  51C8 FFF0                291              DBRA    D0, .LOOP
000010D6                           292              
000010D6                           293              ;Comprobar si hay que analizar el segundo conjunto de teclas. 
000010D6  B83C 0004                294              CMP.B   #4, D4
000010DA  6600 0006                295              BNE     .KEYSREADY            
000010DE                           296             
000010DE                           297              ;Se mueve el segundo conjunto de teclas al registro D1 y se
000010DE                           298              ;repite el bucle .LOOP.
000010DE  2202                     299              MOVE.L  D2, D1
000010E0  60E0                     300              BRA     .NEXTKEYS
000010E2                           301  
000010E2                           302  .KEYSREADY  
000010E2                           303              ;Recuperamos el anterior KBDVAL en D4.
000010E2  1839 00001C3E            304              MOVE.B  (KBDVAL), D4
000010E8                           305              ;Se mueve el byte obtenido a KBDVAL.         
000010E8  13C3 00001C3E            306              MOVE.B  D3, KBDVAL 
000010EE                           307  
000010EE  4604                     308              NOT.B   D4
000010F0  C604                     309              AND.B   D4, D3
000010F2  13C3 00001C3F            310              MOVE.B  D3, (KBDEDGE)             
000010F8                           311              
000010F8                           312              ;Restaurar registros a su estado original. 
000010F8  4CDF 001F                313              MOVEM.L (A7)+,D0-D4
000010FC                           314  
000010FC  4E73                     315              RTE
000010FE                           316  
000010FE                           317  ; =============================================================================
000010FE                           318  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
000010FE                           319  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
000010FE                           320  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
000010FE                           321  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
000010FE                           322  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
000010FE                           323  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
000010FE                           324  ; =============================================================================
000010FE                           325  
000010FE                           326  ; -----------------------------------------------------------------------------
000010FE                           327  DMMINIT
000010FE                           328  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
000010FE                           329  ; INPUT    - NONE
000010FE                           330  ; OUTPUT   - NONE
000010FE                           331  ; MODIFIES - NONE
000010FE                           332  ; -----------------------------------------------------------------------------
000010FE  48E7 8080                333              MOVEM.L D0/A0,-(A7)
00001102  41F9 00001C80            334              LEA     DMMDATA,A0
00001108  303C 0031                335              MOVE.W  #DMMBNUM-1,D0
0000110C  30BC 0000                336  .LOOP       MOVE.W  #DMMSYSID,(A0)
00001110  D1FC 00000040            337              ADD.L   #DMMBSIZE,A0
00001116  51C8 FFF4                338              DBRA.W  D0,.LOOP
0000111A  4CDF 0101                339              MOVEM.L (A7)+,D0/A0
0000111E  4E75                     340              RTS
00001120                           341  
00001120                           342  ; -----------------------------------------------------------------------------
00001120                           343  DMMFIRST
00001120                           344  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001120                           345  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001120                           346  ; INPUT    - NONE
00001120                           347  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001120                           348  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001120                           349  ; -----------------------------------------------------------------------------
00001120  41F9 00001C80            350              LEA     DMMDATA,A0
00001126  4A58                     351  DMMFRLOP    TST.W   (A0)+
00001128  6600 0016                352              BNE     DMMFRFND
0000112C  D1FC 0000003E            353              ADD.L   #DMMBSIZE-2,A0
00001132  B1FC 000028FF            354  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001138  6DEC                     355              BLT     DMMFRLOP
0000113A  207C 00000000            356              MOVE.L  #0,A0
00001140  4E75                     357  DMMFRFND    RTS
00001142                           358  
00001142                           359  ; -----------------------------------------------------------------------------
00001142                           360  DMMNEXT
00001142                           361  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001142                           362  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001142                           363  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
00001142                           364  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001142                           365  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001142                           366  ; -----------------------------------------------------------------------------
00001142  2F00                     367              MOVE.L  D0,-(A7)
00001144  2008                     368              MOVE.L  A0,D0
00001146  C0BC FFFFFFC0            369              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
0000114C  0680 00000040            370              ADD.L   #DMMBSIZE,D0
00001152  2040                     371              MOVE.L  D0,A0
00001154  201F                     372              MOVE.L  (A7)+,D0
00001156  60DA                     373              BRA     DMMFRCOM
00001158                           374  
00001158                           375  ; -----------------------------------------------------------------------------
00001158                           376  DMMFRSTO
00001158                           377  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
00001158                           378  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001158                           379  ; INPUT    - D0.W : ID TO SEARCH
00001158                           380  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001158                           381  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001158                           382  ; -----------------------------------------------------------------------------
00001158  41F9 00001C80            383              LEA     DMMDATA,A0
0000115E  B058                     384  DMMFLOOP    CMP.W   (A0)+,D0
00001160  6700 0016                385              BEQ     DMMFFND
00001164  D1FC 0000003E            386              ADD.L   #DMMBSIZE-2,A0
0000116A  B1FC 000028FF            387  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001170  6DEC                     388              BLT     DMMFLOOP
00001172  207C 00000000            389              MOVE.L  #0,A0
00001178  4E75                     390  DMMFFND     RTS
0000117A                           391  
0000117A                           392  ; -----------------------------------------------------------------------------
0000117A                           393  DMMNEXTO
0000117A                           394  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000117A                           395  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000117A                           396  ; INPUT    - D0.W : ID TO SEARCH
0000117A                           397  ;            A0   : POINTER WITHIN THE CURRENT SLOT
0000117A                           398  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000117A                           399  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000117A                           400  ; -----------------------------------------------------------------------------
0000117A  2F00                     401              MOVE.L  D0,-(A7)
0000117C  2008                     402              MOVE.L  A0,D0
0000117E  C0BC FFFFFFC0            403              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001184  0680 00000040            404              ADD.L   #DMMBSIZE,D0
0000118A  2040                     405              MOVE.L  D0,A0
0000118C  201F                     406              MOVE.L  (A7)+,D0
0000118E  60DA                     407              BRA     DMMFCOM
00001190                           408  
00001190                           409  ; -----------------------------------------------------------------------------
00001190                           410  DMMALLOC
00001190                           411  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
00001190                           412  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
00001190                           413  ; INPUT    - D0.W : ID TO ASSIGN
00001190                           414  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
00001190                           415  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001190                           416  ; -----------------------------------------------------------------------------
00001190  3F00                     417              MOVE.W  D0,-(A7)
00001192  4240                     418              CLR.W   D0
00001194  4EB8 1158                419              JSR     DMMFRSTO
00001198  301F                     420              MOVE.W  (A7)+,D0
0000119A  B1FC 00000000            421              CMP.L   #0,A0
000011A0  6700 0006                422              BEQ     .END
000011A4  3140 FFFE                423              MOVE.W  D0,-2(A0)
000011A8  4E75                     424  .END        RTS
000011AA                           425  
000011AA                           426  ; -----------------------------------------------------------------------------
000011AA                           427  DMMFREE
000011AA                           428  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000011AA                           429  ; SYSTEM (0)
000011AA                           430  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000011AA                           431  ; OUTPUT   - NONE
000011AA                           432  ; MODIFIES - NONE
000011AA                           433  ; -----------------------------------------------------------------------------
000011AA  48E7 8080                434              MOVEM.L D0/A0,-(A7)
000011AE  2008                     435              MOVE.L  A0,D0
000011B0  C0BC FFFFFFC0            436              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000011B6  2040                     437              MOVE.L  D0,A0
000011B8  4250                     438              CLR.W   (A0)
000011BA  4CDF 0101                439              MOVEM.L (A7)+,D0/A0
000011BE  4E75                     440              RTS
000011C0                           441  
000011C0                           442  
000011C0                           443  
000011C0                           444  
000011C0                           445  -------------------- end include --------------------
000011C0                           446              INCLUDE "SYSCONST.X68"               ; SYSTEM CONSTANTS
000011C0                           447  ; =============================================================================
000011C0                           448  ; SYSTEM CONSTANTS
000011C0                           449  ; =============================================================================
000011C0                           450  
000011C0                           451  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
000011C0                           452  
000011C0  =00000000                453  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
000011C0  =00000001                454  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
000011C0                           455  
000011C0                           456  ; --- KEY CODES (EASy68K)
000011C0                           457  
000011C0  =00000020                458  KBDCHRSP    EQU     $20                     ; SPACE KEY
000011C0  =0000004D                459  KBDCHRMK    EQU     'M'                     ; M KEY
000011C0  =00000010                460  KBDCHRSH    EQU     $10                     ; SHIFT KEY
000011C0  =00000050                461  KBDCHRPK    EQU     'P'                     ; P KEY
000011C0  =00000025                462  KBDCHRLF    EQU     $25                     ; LEFT KEY
000011C0  =00000026                463  KBDCHRUP    EQU     $26                     ; UP KEY
000011C0  =00000027                464  KBDCHRRT    EQU     $27                     ; RIGHT KEY
000011C0  =00000028                465  KBDCHRDN    EQU     $28                     ; DOWN KEY
000011C0                           466  
000011C0                           467  ; --- KEYBOARD MAPPING --------------------------------------------------------
000011C0                           468  
000011C0  =00000025                469  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
000011C0  =00000026                470  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
000011C0  =00000027                471  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
000011C0  =00000028                472  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
000011C0  =00000020                473  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
000011C0  =0000004D                474  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
000011C0  =00000010                475  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
000011C0  =00000050                476  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
000011C0                           477  
000011C0                           478  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
000011C0                           479  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
000011C0                           480  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
000011C0                           481  ; +---+---+---+---+---+---+---+---+
000011C0                           482  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
000011C0                           483  ; +---+---+---+---+---+---+---+---+
000011C0                           484  ;   |   |   |   |   |   |   |   |
000011C0                           485  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
000011C0                           486  ;   |   |   |   |   |   |   +-------------- UP BUTTON
000011C0                           487  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
000011C0                           488  ;   |   |   |   |   +---------------------- DOWN BUTTON
000011C0                           489  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
000011C0                           490  ;   |   |   +------------------------------ FIRE 2 BUTTON
000011C0                           491  ;   |   +---------------------------------- FIRE 3 BUTTON
000011C0                           492  ;   +-------------------------------------- PAUSE BUTTON
000011C0                           493  
000011C0  =00000001                494  KBDMSKLF    EQU     %00000001
000011C0  =00000002                495  KBDMSKUP    EQU     %00000010
000011C0  =00000004                496  KBDMSKRT    EQU     %00000100
000011C0  =00000008                497  KBDMSKDN    EQU     %00001000
000011C0  =00000010                498  KBDMSKF1    EQU     %00010000
000011C0  =00000020                499  KBDMSKF2    EQU     %00100000
000011C0  =00000040                500  KBDMSKF3    EQU     %01000000
000011C0  =00000080                501  KBDMSKPS    EQU     %10000000
000011C0                           502  
000011C0                           503  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
000011C0                           504  
000011C0  =00000000                505  KBDBITLF    EQU     0
000011C0  =00000001                506  KBDBITUP    EQU     1
000011C0  =00000002                507  KBDBITRT    EQU     2
000011C0  =00000003                508  KBDBITDN    EQU     3
000011C0  =00000004                509  KBDBITF1    EQU     4
000011C0  =00000005                510  KBDBITF2    EQU     5
000011C0  =00000006                511  KBDBITF3    EQU     6
000011C0  =00000007                512  KBDBITPS    EQU     7
000011C0                           513  
000011C0                           514  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
000011C0                           515  
000011C0  =00000280                516  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
000011C0  =000001E0                517  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
000011C0  =00000001                518  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
000011C0  =00000014                519  SCRTIM      EQU     20                      ; SCREEN TIMER (MS)
000011C0                           520  
000011C0                           521  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
000011C0                           522  
000011C0  =00000040                523  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
000011C0  =00000032                524  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
000011C0  =00000000                525  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
000011C0                           526  
000011C0                           527  
000011C0                           528  
000011C0                           529  
000011C0                           530  -------------------- end include --------------------
000011C0                           531              INCLUDE "CONST.X68"                  ; USER CONSTANTS
000011C0                           532  ; =============================================================================
000011C0                           533  ; SYSTEM CONSTANTS
000011C0                           534  ; =============================================================================
000011C0                           535  
000011C0                           536  ; --- GAME STATES -------------------------------------------------------------
000011C0                           537  
000011C0  =FFFFFFFF                538  STANONE     EQU     -1                      ; PLACEHOLDER TO FORCE CHANGE
000011C0  =00000000                539  STAINTR     EQU     0                       ; INTRO/PRESS FIRE STATE
000011C0  =00000001                540  STAPLAY     EQU     1                       ; NORMAL GAME STATE
000011C0  =00000002                541  STAPAU      EQU     2                       ; PAUSE GAME STATE
000011C0  =00000003                542  STAGOVR     EQU     3                       ; GAME OVER STATE
000011C0                           543  
000011C0                           544  ; --- AGENT & PROP TYPES -------------------------------------------------------------
000011C0                           545  
000011C0  =00000001                546  CLDTYPE     EQU     1                       ; NUMBER FOR CLOUD TYPES
000011C0  =00000002                547  GSSDTYPE    EQU     2                       ; NUMBER FOR GRASS DETAIL TYPES
000011C0  =00000003                548  PIPTYPE     EQU     3                       ; NUMBER FOR PIPE TYPES
000011C0                           549  
000011C0                           550  
000011C0                           551  ; --- INTRO STATE RELATED CONSTANTS -------------------------------------------
000011C0                           552  
000011C0  =00000001                553  INTTITX     EQU     1                       ; TITLE X COORDINATE
000011C0  =00000001                554  INTTITY     EQU     1                       ; TITLE Y COORDINATE
000011C0  =0000FFFF                555  INTTITC     EQU     $0000FFFF               ; TITLE COLOR
000011C0  =033D0001                556  INTTITF     EQU     $033D0001               ; TITLE FONT
000011C0  =00000005                557  INTPRSX     EQU     5                       ; PRESS FIRE X COORDINATE
000011C0  =00000008                558  INTPRSY     EQU     8                       ; PRESS FIRE Y COORDINATE
000011C0  =00000080                559  INTPRSC     EQU     $00000080               ; PRESS FIRE COLOR
000011C0  =031A0001                560  INTPRSF     EQU     $031A0001               ; PRESS FIRE FONT
000011C0                           561  
000011C0                           562  ; --- BACKGROUND RELATED CONSTANTS --------------------------------------------
000011C0                           563  
000011C0  =00000000                564  BGSKYPC     EQU     $00000000               ; BACKGROUND SKY PEN COLOUR
000011C0  =00EFCE87                565  BGSKYFC     EQU     $00EFCE87               ; BACKGROUND SKY FILL COLOUR
000011C0  =00000000                566  BGGSSPC     EQU     $00000000               ; BACKGROUND GRASS PEN COLOUR
000011C0  =0000990A                567  BGGSSFC     EQU     $0000990A               ; BACKGROUND GRASS FILL COLOUR
000011C0  =00000168                568  BGGSSTP     EQU     SCRHEIGH*3/4            ; GRASS TOP EDGE (Y) COORDINATE
000011C0  =00000190                569  BGGSSBT     EQU     BGGSSTP+40              ; GRASS BOTTOM EDGE (Y) COORDINATE
000011C0  =0000000A                570  GSSDWDTH    EQU     10                      ; GRASS DETAIL WIDTH
000011C0  =0039DB44                571  GSSDFC      EQU     $0039DB44               ; BACKGROUND GRASS DETAIL F.COLOUR
000011C0  =00000000                572  BGGNDPC     EQU     $00000000               ; BACKGROUND GROUND PEN COLOUR
000011C0  =00155DD8                573  BGGNDFC     EQU     $00155DD8               ; BACKGROUND GROUND FILL COLOUR
000011C0  =00000190                574  BGGNDTP     EQU     BGGSSBT                 ; GROUND TOP EDGE (Y) COORDINATE
000011C0                           575  
000011C0                           576  ; --- PLAYER RELATED CONSTANTS ------------------------------------------------
000011C0                           577  
000011C0                           578        ;Player colours
000011C0                           579  
000011C0  =00008000                580  GREEN EQU $00008000                         ;GREEN COLOR
000011C0  =000000FF                581  RED   EQU $000000FF                         ;RED COLOR
000011C0  =00FFFFFF                582  WHITE EQU $00FFFFFF                         ;WHITE COLOR
000011C0  =00000000                583  BLACK EQU $00000000                         ;BLACK COLOR
000011C0                           584  
000011C0                           585        ;Constants
000011C0                           586        
000011C0  =00008000                587  PLRCOLOR        EQU GREEN                   ;PLAYER COLOR
000011C0  =00FFFFFF                588  PLREYECOLOR     EQU WHITE                   ;PLAYER EYE COLOR
000011C0  =00000000                589  PLRIRISCOLOR    EQU BLACK                   ;PLAYER IRIS COLOR
000011C0  =000000FF                590  PLRMOUTHCOLOR   EQU RED                     ;PLAYER MOUTH COLOR
000011C0  =0000001E                591  PLRWIDTH        EQU 30                      ;PLAYER WIDTH
000011C0  =0000001E                592  PLRHEIGHT       EQU 30                      ;PLAYER HEIGHT
000011C0  =00000096                593  PLRINITPOSX     EQU 150                     ;INITIAL POSITION OF THE PLAYER (X)
000011C0  =000000B4                594  PLRINITPOSY     EQU 180                     ;INITIAL POSITION OF THE PLAYER (Y)
000011C0  =0000003C                595  JUMPSIZE        EQU 60                      ;JUMP SIZE
000011C0  =00000003                596  JUMPSPEED       EQU 3                       ;JUMP SPEED (BIG VALUE = SLOW SPEED).
000011C0                           597  
000011C0                           598  ; --- PIPE RELATED CONSTANTS --------------------------------------------------
000011C0                           599  
000011C0  =00000000                600  PIPPC       EQU     $00000000               ; PIPE PEN COLOUR
000011C0  =00196600                601  PIPFC       EQU     $00196600               ; PIPE FILL COLOUR
000011C0  =00000032                602  PIPBWDT     EQU     50                      ; PIPE BASE WIDTH
000011C0  =0000003C                603  PIPTWDT     EQU     60                      ; PIPE MOUTH WIDTH
000011C0  =0000000A                604  PIPTHGT     EQU     10                      ; PIPE MOUTH HEIGHT
000011C0  =00000005                605  PIPTBSPC    EQU     ((PIPTWDT-PIPBWDT)/2)   ; DIF.BETW. OUTER RAD. & IN. RAD
000011C0  =00000050                606  PIPOPEN     EQU     80                      ; SPACE BETW. TOP AND BOTTOM PIPES
000011C0  =00000002                607  PIPYSPD     EQU     2                       ; SPEED @ WHICH PIPES GO UP&DOWN
000011C0                           608  
000011C0                           609  ; --- CLOUD RELATED CONSTANTS -------------------------------------------------
000011C0                           610  
000011C0  =0000003C                611  CLDSIZE     EQU     60                      ; CLOUD DIAMETER
000011C0  =00FFFFFF                612  CLDPCLR     EQU     $00FFFFFF               ; CLOUD PEN COLOR
000011C0  =00FFFFFF                613  CLDFCLR     EQU     $00FFFFFF               ; CLOUD FIL COLOR
000011C0                           614  
000011C0                           615  ; --- PAUSE STATE RELATED CONSTANTS ---------------------------------------
000011C0                           616  
000011C0  =00000000                617  CONTNUM     EQU     0                       ; CONTINUE GAME NUMBER
000011C0  =00000001                618  NEWGNUM     EQU     1                       ; NEW GAME NUMBER
000011C0  =00000002                619  EXTNUM      EQU     2                       ; EXIT GAME NUMBER
000011C0  =0000FFFF                620  PAUTITC     EQU     $0000FFFF               ; TITLE COLOUR
000011C0  =03300001                621  PAUTITF     EQU     $03300001               ; TITLE FONT
000011C0  =01130001                622  PAUOPTFU    EQU     $01130001               ; OPTION FONT (unselected)
000011C0  =01130005                623  PAUOPTFS    EQU     $01130005               ; OPTION FONT (selected)
000011C0  =00FFFFFF                624  PAUOPTC     EQU     $00FFFFFF               ; OPTION COLOUR
000011C0  =00000002                625  PAUTITX     EQU     2                       ; TITLE COORD. X
000011C0  =00000001                626  PAUTITY     EQU     1                       ; TITLE COORD. Y
000011C0  =0000000F                627  PAUOPTX     EQU     15                      ; OPTIONS COORD. X
000011C0  =00000008                628  PAUCNTY     EQU     8                       ; CONTINUE OPTION COORD. Y
000011C0  =0000000A                629  PAUNEWY     EQU     10                      ; NEW GAME OPTION COORD. Y
000011C0  =0000000C                630  PAUEXTY     EQU     12                      ; EXIT OPTION COORD. Y
000011C0  =000000FF                631  PAUSELC     EQU     $000000FF               ; SELECTED OPTION COLOUR
000011C0                           632  
000011C0                           633  ; --- GAME OVER STATE RELATED CONSTANTS ---------------------------------------
000011C0                           634  
000011C0  =00000023                635  GOVSTRX     EQU     35                      ; TITLE X COORDINATE
000011C0  =0000000F                636  GOVSTRY     EQU     15                      ; TITLE Y COORDINATE
000011C0  =00FFFFFF                637  GOVSTRC     EQU     $00FFFFFF               ; TITLE COLOR
000011C0                           638  
000011C0                           639  
000011C0                           640  
000011C0                           641  
000011C0                           642  
000011C0                           643  
000011C0                           644  
000011C0                           645  
000011C0                           646  
000011C0                           647  
000011C0                           648  
000011C0                           649  
000011C0                           650  
000011C0                           651  
000011C0                           652  
000011C0                           653  
000011C0                           654  
000011C0                           655  
000011C0                           656  
000011C0                           657  
000011C0                           658  
000011C0                           659  
000011C0                           660  
000011C0                           661  
000011C0                           662  
000011C0                           663  
000011C0                           664  
000011C0                           665  
000011C0                           666  
000011C0                           667  
000011C0                           668  
000011C0                           669  
000011C0                           670  -------------------- end include --------------------
000011C0                           671              INCLUDE "PLAYER.X68"
000011C0                           672  ; =============================================================================
000011C0                           673  ; PLAYER MANAGEMENT
000011C0                           674  ; =============================================================================
000011C0                           675  
000011C0                           676  ; -----------------------------------------------------------------------------
000011C0                           677  PLRINIT
000011C0                           678  ; INITIALIZES THE PLAYER
000011C0                           679  ; INPUT    - NONE
000011C0                           680  ; OUTPUT   - NONE
000011C0                           681  ; MODIFIES - NONE
000011C0                           682  ; -----------------------------------------------------------------------------
000011C0                           683  
000011C0  33FC 0096 00001C2A       684          MOVE.W #PLRINITPOSX,(PLRPOSX)
000011C8  33FC 00B4 00001C2C       685          MOVE.W #PLRINITPOSY,(PLRPOSY)
000011D0  33FC 00B4 00001C2E       686          MOVE.W #PLRINITPOSY,(MAXPOS)
000011D8  33FC 0000 00001C30       687          MOVE.W #0, (UPPRESSED)
000011E0  33FC 0001 00001C32       688          MOVE.W #1, (PLRDOWNSPEED)
000011E8  4279 00001C34            689          CLR    (PLRDEAD)               ;Poner a 0 PLRDEAD (Jugador vivo).
000011EE                           690  
000011EE  4E75                     691          RTS
000011F0                           692  ; -----------------------------------------------------------------------------
000011F0                           693  PLRUPD
000011F0                           694  ; UPDATES THE PLAYER MOTION
000011F0                           695  ; INPUT    - NONE (ACCESSES KBDEDGE)
000011F0                           696  ; OUTPUT   - NONE (MODIFIES PLAYER DATA)
000011F0                           697  ; MODIFIES - NONE
000011F0                           698  ; -----------------------------------------------------------------------------
000011F0  48E7 F000                699            MOVEM.L D0/D1/D2/D3,-(A7)
000011F4  0839 0001 00001C3F       700            BTST.B #KBDBITUP, (KBDEDGE)    
000011FC  6600 0044                701            BNE.L  .PRESSED
00001200                           702          
00001200                           703           ;Comprobar colisión con tubería. 
00001200  0C79 0001 00001C34       704            CMP #1, (PLRDEAD)
00001208  6700 009C                705            BEQ .GAMEOVER 
0000120C                           706          
0000120C                           707            ;TECLA NO PRESIONADA
0000120C  0C79 0001 00001C30       708            CMP #1, (UPPRESSED)
00001214  6700 0050                709            BEQ .MAKEJUMP
00001218                           710            ;No se ha apretado la tecla UP. Hay que bajar el pájaro. 
00001218  3039 00001C2C            711            MOVE.W (PLRPOSY), D0
0000121E  D079 00001C32            712            ADD.W (PLRDOWNSPEED), D0
00001224                           713            ;Se incrementa la velocidad de bajada. 
00001224  5279 00001C32            714            ADDQ #1, (PLRDOWNSPEED)
0000122A  33C0 00001C2C            715            MOVE.W D0, (PLRPOSY)
00001230                           716           
00001230                           717            ;Comprobar si ha salido por la parte inferior
00001230  323C 0168                718            MOVE.W #BGGSSTP, D1
00001234  0640 001E                719            ADD.W #PLRHEIGHT, D0
00001238  B240                     720            CMP D0, D1
0000123A  6B00 006A                721            BMI .GAMEOVER         
0000123E                           722         
0000123E  6000 0072                723            BRA .END         
00001242                           724  .PRESSED
00001242                           725            ;TECLA UP PRESIONADA
00001242                           726            ;Se reinicia la velocidad de bajada. 
00001242  33FC 0001 00001C32       727            MOVE.W #1, (PLRDOWNSPEED)
0000124A                           728  
0000124A                           729            ;Se establece el límite hasta donde subirá
0000124A  3039 00001C2C            730            MOVE.W (PLRPOSY), D0
00001250  0440 003C                731            SUB.W #JUMPSIZE, D0
00001254  33C0 00001C2E            732            MOVE.W D0, (MAXPOS)
0000125A                           733            ;Se indica que se ha presionado la tecla de salto
0000125A  33FC 0001 00001C30       734            MOVE.W #1, (UPPRESSED)
00001262                           735            
00001262  6000 004E                736            BRA .END   
00001266                           737        
00001266                           738  .MAKEJUMP
00001266                           739            ;Se ha apretado la tecla UP anteriormente (eso indica que el salto no
00001266                           740            ; ha finalizado). 
00001266                           741            
00001266  3039 00001C2C            742            MOVE.W (PLRPOSY), D0
0000126C  3239 00001C2E            743            MOVE.W (MAXPOS), D1
00001272  9041                     744            SUB.W  D1, D0             ;FÓRMULA: (PLRPOSY-MAXPOS)/JUMPSPEED = VALOR QUE SE TIENE QUE RESTAR A LA POSICIÓN ACTUAL PARA OBTENER LA NUEVA POSICIÓN
00001274  80FC 0003                745            DIVU.W #JUMPSPEED, D0
00001278  9179 00001C2C            746            SUB.W D0, (PLRPOSY)       ;NEWPOS
0000127E                           747  
0000127E                           748            ;Ver si ha salido por la parte superior. 
0000127E  0C79 0000 00001C2C       749            CMP #0, (PLRPOSY)
00001286  6B00 001E                750            BMI .GAMEOVER
0000128A  B07C 0001                751            CMP #1, D0
0000128E  6B00 000A                752            BMI .LASTJUMP
00001292  6700 0006                753            BEQ .LASTJUMP
00001296                           754            ;El salto no ha finalizado (No ha llegado a MAXPOS)
00001296                           755                                
00001296  6000 001A                756            BRA .END
0000129A                           757            
0000129A                           758  .LASTJUMP
0000129A                           759            ;El salto ha llegado a MAXPOS
0000129A                           760            ;Se desactiva la tecla UP indicando que lo siguiente será realizar la bajada. 
0000129A  33FC 0000 00001C30       761            MOVE.W #0, (UPPRESSED)         
000012A2  6000 000E                762            BRA .END    
000012A6                           763            
000012A6                           764  .GAMEOVER
000012A6                           765  
000012A6  33FC 0003 00001C28       766            MOVE.W #STAGOVR, (STANEXT)        
000012AE  6000 0002                767            BRA .END         
000012B2                           768                   
000012B2                           769  .END
000012B2                           770            
000012B2  4CDF 000F                771            MOVEM.L (A7)+,D0/D1/D2/D3
000012B6  4E75                     772            RTS
000012B8                           773            
000012B8                           774  ; -----------------------------------------------------------------------------
000012B8                           775  PLRPLOT
000012B8                           776  ; PLOTS THE PLAYER
000012B8                           777  ; INPUT    - NONE
000012B8                           778  ; OUTPUT   - NONE
000012B8                           779  ; MODIFIES - NONE
000012B8                           780  ; -----------------------------------------------------------------------------
000012B8                           781  
000012B8  48E7 FC00                782              MOVEM.L D0-D5,-(A7)
000012BC                           783  
000012BC                           784  
000012BC                           785              ;SET PLAYER COLOR 
000012BC  223C 00008000            786              MOVE.L  #PLRCOLOR,D1
000012C2  103C 0050                787              MOVE.B  #80,D0
000012C6  4E4F                     788              TRAP    #15
000012C8  5200                     789              ADDQ.B  #1,D0
000012CA  4E4F                     790              TRAP    #15
000012CC                           791              
000012CC                           792              ;SET PLAYER POSITION
000012CC  3239 00001C2A            793              MOVE.W  (PLRPOSX),D1            
000012D2  3439 00001C2C            794              MOVE.W  (PLRPOSY),D2
000012D8  3601                     795              MOVE.W  D1,D3
000012DA  3802                     796              MOVE.W  D2,D4
000012DC                           797              
000012DC                           798              ;SET PLAYER WIDTH AND HEIGHT
000012DC  0643 001E                799              ADD.W   #PLRWIDTH,D3
000012E0  0644 001E                800              ADD.W   #PLRHEIGHT,D4
000012E4  103C 0058                801              MOVE.B  #88,D0
000012E8  4E4F                     802              TRAP    #15
000012EA                           803              
000012EA                           804              
000012EA  0443 000F                805              SUB.W   #PLRWIDTH/2,D3
000012EE  103C 0057                806              MOVE.B  #87,D0
000012F2  4E4F                     807              TRAP    #15
000012F4                           808              
000012F4                           809              ;---------EYE---------
000012F4                           810                               
000012F4                           811              ;SET EYE COLOR
000012F4  7051                     812              MOVE.L  #81, D0
000012F6  223C 00FFFFFF            813              MOVE.L  #PLREYECOLOR, D1
000012FC  4E4F                     814              TRAP    #15
000012FE                           815              
000012FE  3239 00001C2A            816              MOVE.W  PLRPOSX,D1   
00001304                           817              
00001304                           818              ;EYE WIDTH         
00001304  5A41                     819              ADD.W   #PLRWIDTH-25,D1
00001306  3639 00001C2A            820              MOVE.W  (PLRPOSX),D3
0000130C                           821              
0000130C                           822              ;EYE POSX
0000130C  0643 0014                823              ADD.W   #PLRWIDTH-10,D3
00001310  3439 00001C2C            824              MOVE.W (PLRPOSY),D2
00001316                           825              
00001316                           826              ;EYE POSY
00001316  0642 000A                827              ADD.W   #PLRHEIGHT/2-5,D2
0000131A  3839 00001C2C            828              MOVE.W  (PLRPOSY),D4
00001320                           829             
00001320                           830              ;EYE HEIGHT 
00001320  0644 FFF6                831              ADD.W   #PLRHEIGHT/2-25,D4
00001324  103C 0058                832              MOVE.B  #88,D0
00001328  4E4F                     833              TRAP    #15
0000132A                           834              
0000132A                           835              
0000132A                           836             ;---------MOUTH------
0000132A                           837                                 
0000132A                           838              ;SET MOUTH COLOR
0000132A  7051                     839              MOVE.L  #81, D0
0000132C  223C 000000FF            840              MOVE.L  #RED, D1
00001332  4E4F                     841              TRAP    #15
00001334                           842              
00001334                           843                 
00001334  3239 00001C2A            844              MOVE.W  (PLRPOSX),D1   
0000133A                           845              
0000133A                           846              ;EYE WIDTH         
0000133A  0641 001D                847              ADD.W   #PLRWIDTH-1,D1
0000133E  3639 00001C2A            848              MOVE.W  (PLRPOSX),D3
00001344                           849              
00001344                           850              ;EYE POSX
00001344  0643 000A                851              ADD.W   #PLRWIDTH-20,D3
00001348  3439 00001C2C            852              MOVE.W  (PLRPOSY),D2
0000134E                           853              
0000134E                           854              ;EYE POSY
0000134E  0642 0019                855              ADD.W   #PLRHEIGHT-5,D2
00001352  3839 00001C2C            856              MOVE.W  (PLRPOSY),D4
00001358                           857             
00001358                           858              ;EYE HEIGHT 
00001358  0644 000F                859              ADD.W   #PLRHEIGHT-15,D4
0000135C  103C 0058                860              MOVE.B  #88,D0
00001360  4E4F                     861              TRAP    #15
00001362                           862              
00001362                           863  
00001362                           864              
00001362  4CDF 003F                865              MOVEM.L (A7)+,D0-D5
00001366                           866              
00001366  4E75                     867              RTS
00001368                           868  
00001368                           869  
00001368                           870  
00001368                           871  
00001368                           872  
00001368                           873  
00001368                           874  
00001368                           875  -------------------- end include --------------------
00001368                           876              INCLUDE "UTIL.X68"                   ; UTILITY MACRO AND SUBROUTINES
00001368                           877  ; =============================================================================
00001368                           878  ; UTILITY MACROS
00001368                           879  ; =============================================================================
00001368                           880  
00001368                           881  ; -----------------------------------------------------------------------------
00001368                           882  UTLSPEN     MACRO
00001368                           883  ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001368                           884  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
00001368                           885  ; OUTPUT   - NONE
00001368                           886  ; MODIFIES - D0,D1
00001368                           887  ; -----------------------------------------------------------------------------
00001368                           888              MOVE.B  #80,D0
00001368                           889              MOVE.L  \1,D1
00001368                           890              TRAP    #15
00001368                           891              ENDM
00001368                           892  
00001368                           893  ; -----------------------------------------------------------------------------
00001368                           894  UTLSFIL     MACRO
00001368                           895  ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001368                           896  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
00001368                           897  ; OUTPUT   - NONE
00001368                           898  ; MODIFIES - D0,D1
00001368                           899  ; -----------------------------------------------------------------------------
00001368                           900              MOVE.B  #81,D0
00001368                           901              MOVE.L  \1,D1
00001368                           902              TRAP    #15
00001368                           903              ENDM
00001368                           904  
00001368                           905  ; -----------------------------------------------------------------------------
00001368                           906  UTLLOCT     MACRO
00001368                           907  ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001368                           908  ; INPUT    - \1 X, \2 Y
00001368                           909  ; OUTPUT   - NONE
00001368                           910  ; MODIFIES - D0,D1
00001368                           911  ; -----------------------------------------------------------------------------
00001368                           912              MOVE.W  #\1<<8|\2, D1
00001368                           913              MOVE.B  #11,D0
00001368                           914              TRAP    #15
00001368                           915              ENDM
00001368                           916  
00001368                           917  ; -----------------------------------------------------------------------------
00001368                           918  UTLFONT     MACRO
00001368                           919  ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001368                           920  ; INPUT    - \1 COLOR, \2 FONT
00001368                           921  ; OUTPUT   - NONE
00001368                           922  ; MODIFIES - D0,D1,D2
00001368                           923  ; -----------------------------------------------------------------------------
00001368                           924              MOVE.L  #\1,D1
00001368                           925              MOVE.L  #\2,D2
00001368                           926              MOVEQ   #21,D0
00001368                           927              TRAP    #15
00001368                           928              ENDM
00001368                           929  
00001368                           930  ; =============================================================================
00001368                           931  ; UTILITY SUBROUTINES
00001368                           932  ; =============================================================================
00001368                           933  
00001368                           934  ; -----------------------------------------------------------------------------
00001368                           935  UTLINIT
00001368                           936  ; INITIALIZES UTILITY CODE
00001368                           937  ; INPUT    - NONE
00001368                           938  ; OUTPUT   - NONE
00001368                           939  ; MODIFIES - NONE
00001368                           940  ; -----------------------------------------------------------------------------
00001368  4239 00001C3D            941              CLR.B   (UTLRNDIX)
0000136E  4E75                     942              RTS
00001370                           943  ; -----------------------------------------------------------------------------
00001370                           944  UTLCHCOL
00001370                           945  ; CHECKS COLLISION
00001370                           946  ; INPUT    - D0.W X0 COORDINATE
00001370                           947  ;            D1.W Y0 COORDINATE
00001370                           948  ;            D2.W X1 COORDINATE
00001370                           949  ;            D3.W Y1 COORDINATE
00001370                           950  ;            D4.W WIDTH 0
00001370                           951  ;            D5.W WIDTH 1
00001370                           952  ;            D6.W HEIGHT 0
00001370                           953  ;            D7.W HEIGHT 1
00001370                           954  ; OUTPUT   - D0.B=FF - COLLISION, =0 - NO COLLISION
00001370                           955  ; MODIFIES - NONE
00001370                           956  ; -----------------------------------------------------------------------------
00001370  48A7 AB00                957               MOVEM.W D0/D2/D4/D6/D7,-(A7)
00001374                           958  
00001374                           959              ;Verificar si la tubería esta delante o detrás del pájaro. 
00001374                           960              
00001374  D840                     961              ADD.W D0, D4 ;Pared derecha de la tubería.
00001376  B842                     962              CMP D2, D4
00001378  6500 002C                963              BCS .NOCOL
0000137C                           964              
0000137C                           965              ;Comprobar si el pájaro ha alcanzado la tubería.
0000137C                           966              
0000137C  D445                     967              ADD.W D5, D2 ;Parte delantera del pájaro.
0000137E  B441                     968              CMP D1, D2
00001380  6500 0024                969              BCS .NOCOL
00001384                           970            
00001384                           971              ;Comprobar parte inferior del pájaro con la parte superior de la 
00001384                           972              ;tubería inferior.
00001384                           973              
00001384  DC41                     974              ADD.W D1, D6 ;Parte superior de la tubería inferior.
00001386  DE43                     975              ADD.W D3, D7 ;Parte inferior del pájaro. 
00001388  BE46                     976              CMP D6, D7
0000138A  6500 001A                977              BCS .NOCOL
0000138E                           978  
0000138E  B641                     979              CMP D1, D3
00001390  6F00 0008                980              BLE .COL 
00001394                           981              
00001394                           982              ;Comprobar la colisión de la parte superior del pájaro con la 
00001394                           983              ;parte inferior de la tubería superior. 
00001394  B243                     984              CMP D3, D1
00001396  6500 000E                985              BCS .NOCOL
0000139A                           986              
0000139A                           987             ;Si no se realiza ninguno de los saltos anteriores, hay colisión. 
0000139A                           988  .COL
0000139A  33FC 0001 00001C34       989              MOVE.W  #1, (PLRDEAD)
000013A2  6000 000A                990              BRA .END                
000013A6                           991  
000013A6                           992  .NOCOL                    
000013A6  33FC 0000 00001C34       993              MOVE.W #0, (PLRDEAD)
000013AE                           994  .END          
000013AE  4C9F 00D5                995              MOVEM.W (A7)+,D0/D2/D4/D6/D7
000013B2  4E75                     996              RTS
000013B4                           997  
000013B4                           998  ; -----------------------------------------------------------------------------
000013B4                           999  UTLRAND
000013B4                          1000  ; PROVIDES A PSEUDO-RANDOM BYTE
000013B4                          1001  ; INPUT    - NONE
000013B4                          1002  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
000013B4                          1003  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000013B4                          1004  ; -----------------------------------------------------------------------------
000013B4  2F08                    1005              MOVE.L  A0,-(A7)
000013B6  41F9 000013D2           1006              LEA     .RANDVEC,A0
000013BC  4280                    1007              CLR.L   D0
000013BE  1039 00001C3D           1008              MOVE.B  (UTLRNDIX),D0
000013C4  1030 0800               1009              MOVE.B  (A0,D0.L),D0
000013C8  5239 00001C3D           1010              ADDQ.B  #1,(UTLRNDIX)
000013CE  205F                    1011              MOVE.L  (A7)+,A0
000013D0  4E75                    1012              RTS
000013D2                          1013  
000013D2                          1014  
000013D2= A2 EE 9A 0C F5 24 ...   1015  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000013DA= 2A A3 51 26 E0 AC ...   1016              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
000013E2= 75 51 CA FD 33 EB ...   1017              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
000013EA= 60 CC E7 B8 9A EB ...   1018              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000013F2= 1D 76 B5 95 B0 89 ...   1019              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000013FA= 39 15 48 C9 6E CA ...   1020              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
00001402= 43 E7 E2 7C 37 25 ...   1021              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
0000140A= E9 94 CE E9 E4 52 ...   1022              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
00001412= 37 6D 9A 84 A2 28 ...   1023              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
0000141A= 19 E2 C6 77 80 D4 ...   1024              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
00001422= 0A 5A 32 67 33 C2 ...   1025              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
0000142A= 59 80 DC 0E 57 FC ...   1026              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
00001432= 8A AB BC F7 07 4D ...   1027              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
0000143A= EF D5 77 6E 1E BB ...   1028              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
00001442= D6 E0 2A 8F BD 28 ...   1029              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
0000144A= 13 4F 66 EC 0A 64 ...   1030              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
00001452= 56 52 9A 16 9B 90 ...   1031              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
0000145A= 06 8A A4 F7 01 DA ...   1032              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
00001462= F2 E7 77 28 B1 76 ...   1033              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
0000146A= A4 42 E3 81 B1 67 ...   1034              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
00001472= BF CE FA 16 BF 38 ...   1035              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
0000147A= D1 8B 50 0C 5F 49 ...   1036              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
00001482= DE 4C 14 A2 40 DC ...   1037              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
0000148A= B6 9B 0A 38 5D AB ...   1038              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
00001492= E2 1B DD 75 15 82 ...   1039              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
0000149A= 8A 26 51 30 9F 47 ...   1040              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
000014A2= 1E 8A BB 71 C6 6E ...   1041              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
000014AA= 9F 47 E5 34 94 27 ...   1042              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
000014B2= 7D 06 D6 BA 30 0F ...   1043              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
000014BA= EC 7F 7E 03 CF 2D ...   1044              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
000014C2= 94 5B 23 F2 8B CD ...   1045              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000014CA= 74 33 EC B9 0F D5 ...   1046              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
000014D2                          1047  
000014D2                          1048  
000014D2                          1049  
000014D2                          1050  
000014D2                          1051  
000014D2                          1052  
000014D2                          1053  
000014D2                          1054  
000014D2                          1055  -------------------- end include --------------------
000014D2                          1056              INCLUDE "AGENTLST.X68"               ; AGENT LIST MANAGEMENT
000014D2                          1057  ; =============================================================================
000014D2                          1058  ; AGENT MANAGEMENT
000014D2                          1059  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000014D2                          1060  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000014D2                          1061  ; +4 - LONG : PLOT SUBROUTINE POINTER
000014D2                          1062  ; +8:END    : DATA (AGENT SPECIFIC)
000014D2                          1063  ; =============================================================================
000014D2                          1064  
000014D2                          1065  ; -----------------------------------------------------------------------------
000014D2                          1066  AGLADD
000014D2                          1067  ; CREATES A NEW AGENT
000014D2                          1068  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000014D2                          1069  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000014D2                          1070  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000014D2                          1071  ;            D0 - AGENT TYPE (USED AS OWNED BY DMM)
000014D2                          1072  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000014D2                          1073  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000014D2                          1074  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000014D2                          1075  ; OUTPUT   - NONE
000014D2                          1076  ; MODIFIES - NONE
000014D2                          1077  ; -----------------------------------------------------------------------------
000014D2  2F08                    1078              MOVE.L  A0,-(A7)
000014D4                          1079              
000014D4  4EB8 1190               1080              JSR     DMMALLOC
000014D8  B1FC 00000000           1081              CMP.L   #0,A0
000014DE  6700 0008               1082              BEQ     .END
000014E2  20CA                    1083              MOVE.L  A2,(A0)+
000014E4  20CB                    1084              MOVE.L  A3,(A0)+
000014E6  4E91                    1085              JSR     (A1)
000014E8                          1086  
000014E8  205F                    1087  .END        MOVE.L  (A7)+,A0
000014EA  4E75                    1088              RTS
000014EC                          1089  
000014EC                          1090  ; -----------------------------------------------------------------------------
000014EC                          1091  AGLUPD
000014EC                          1092  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000014EC                          1093  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000014EC                          1094  ; INPUT    - NONE
000014EC                          1095  ; OUTPUT   - NONE
000014EC                          1096  ; MODIFIES - NONE
000014EC                          1097  ; -----------------------------------------------------------------------------
000014EC  48E7 00C0               1098              MOVEM.L A0-A1,-(A7)
000014F0                          1099              
000014F0  4EB8 1120               1100              JSR     DMMFIRST
000014F4  B1FC 00000000           1101  .LOOP       CMP.L   #0,A0
000014FA  6700 001E               1102              BEQ     .END
000014FE  0C68 0002 FFFE          1103              CMP.W   #GSSDTYPE,-2(A0)    ;IF MEMORY DOESN'T BELONG TO AGENT
00001504  670E                    1104              BEQ.S   .NEXT               ;SKIP
00001506  0C68 0001 FFFE          1105              CMP.W   #CLDTYPE,-2(A0)
0000150C  6706                    1106              BEQ.S   .NEXT
0000150E                          1107              
0000150E  2250                    1108              MOVE.L  (A0),A1
00001510  5088                    1109              ADD.L   #8,A0
00001512  4E91                    1110              JSR     (A1)
00001514  4EB8 1142               1111  .NEXT       JSR     DMMNEXT
00001518  60DA                    1112              BRA     .LOOP
0000151A                          1113              
0000151A  4CDF 0300               1114  .END        MOVEM.L (A7)+,A0-A1            
0000151E  4E75                    1115              RTS
00001520                          1116  
00001520                          1117  ; -----------------------------------------------------------------------------
00001520                          1118  AGLPLOT
00001520                          1119  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001520                          1120  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001520                          1121  ; INPUT    - NONE
00001520                          1122  ; OUTPUT   - NONE
00001520                          1123  ; MODIFIES - NONE
00001520                          1124  ; -----------------------------------------------------------------------------
00001520  48E7 00C0               1125              MOVEM.L A0-A1,-(A7)
00001524                          1126  
00001524  4EB8 1120               1127              JSR     DMMFIRST
00001528  B1FC 00000000           1128  .LOOP       CMP.L   #0,A0
0000152E  6700 0020               1129              BEQ     .END
00001532  0C68 0002 FFFE          1130              CMP.W   #GSSDTYPE,-2(A0)    ;IF MEMORY DOESN'T BELONG TO AGENT
00001538  6710                    1131              BEQ.S   .NEXT               ;SKIP
0000153A  0C68 0001 FFFE          1132              CMP.W   #CLDTYPE,-2(A0)
00001540  6708                    1133              BEQ.S   .NEXT
00001542                          1134              
00001542  2268 0004               1135              MOVE.L  4(A0),A1
00001546  5088                    1136              ADD.L   #8,A0
00001548  4E91                    1137              JSR     (A1)
0000154A  4EB8 1142               1138  .NEXT       JSR     DMMNEXT
0000154E  60D8                    1139              BRA     .LOOP
00001550  4CDF 0300               1140  .END        MOVEM.L (A7)+,A0-A1
00001554                          1141  
00001554  4E75                    1142              RTS
00001556                          1143  
00001556                          1144  ; -----------------------------------------------------------------------------
00001556  =000011AA               1145  AGLKILL     EQU     DMMFREE
00001556                          1146  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001556                          1147  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001556                          1148  ; OUTPUT   - NONE
00001556                          1149  ; MODIFIES - NONE
00001556                          1150  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001556                          1151  ; -----------------------------------------------------------------------------
00001556                          1152  
00001556                          1153  
00001556                          1154  
00001556                          1155  
00001556                          1156  
00001556                          1157  
00001556                          1158  
00001556                          1159  
00001556                          1160  
00001556                          1161  
00001556                          1162  
00001556                          1163  -------------------- end include --------------------
00001556                          1164              INCLUDE "PROPLST.X68"                ; PROPS LIST MANAGEMENT
00001556                          1165  ; =============================================================================
00001556                          1166  ; PROP MANAGEMENT
00001556                          1167  ; EACH PROP HAS A DATA BLOCK FROM DMM AS FOLLOWS:
00001556                          1168  ; +0 - LONG : UPDATE SUBROUTINE POINTER
00001556                          1169  ; +4 - LONG : PLOT SUBROUTINE POINTER
00001556                          1170  ; +8:END    : DATA (PROP SPECIFIC)
00001556                          1171  ; =============================================================================
00001556                          1172  
00001556                          1173  ; -----------------------------------------------------------------------------
00001556                          1174  PRPADD
00001556                          1175  ; CREATES A NEW PROP
00001556                          1176  ; INPUT    - A1 - POINTER TO PROP INIT FUNCTION
00001556                          1177  ;            A2 - POINTER TO PROP UPDATE FUNCTION
00001556                          1178  ;            A3 - POINTER TO PROP PLOT FUNCTION
00001556                          1179  ;            D0 - PROP TYPE (USED AS OWNED BY DMM)
00001556                          1180  ;            D1 - PROP INITIALIZATION PARAMETER 1
00001556                          1181  ;            D2 - PROP INITIALIZATION PARAMETER 2
00001556                          1182  ;            D3 - PROP INITIALIZATION PARAMETER 3
00001556                          1183  ; OUTPUT   - NONE
00001556                          1184  ; MODIFIES - NONE
00001556                          1185  ; -----------------------------------------------------------------------------
00001556  2F08                    1186              MOVE.L  A0,-(A7)
00001558                          1187              
00001558  4EB8 1190               1188              JSR     DMMALLOC
0000155C  B1FC 00000000           1189              CMP.L   #0,A0
00001562  6700 0008               1190              BEQ     .END
00001566  20CA                    1191              MOVE.L  A2,(A0)+
00001568  20CB                    1192              MOVE.L  A3,(A0)+
0000156A  4E91                    1193              JSR     (A1)
0000156C                          1194  
0000156C  205F                    1195  .END        MOVE.L  (A7)+,A0
0000156E  4E75                    1196              RTS
00001570                          1197  
00001570                          1198  ; -----------------------------------------------------------------------------
00001570                          1199  PRPUPD
00001570                          1200  ; UPDATES THE PROP LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001570                          1201  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001570                          1202  ; INPUT    - NONE
00001570                          1203  ; OUTPUT   - NONE
00001570                          1204  ; MODIFIES - NONE
00001570                          1205  ; -----------------------------------------------------------------------------
00001570  48E7 00C0               1206              MOVEM.L A0-A1,-(A7)
00001574                          1207              
00001574  4EB8 1120               1208              JSR     DMMFIRST
00001578  B1FC 00000000           1209  .LOOP       CMP.L   #0,A0
0000157E  6700 0018               1210              BEQ     .END
00001582  0C68 0003 FFFE          1211              CMP.W   #PIPTYPE,-2(A0) ;IF MEMORY DOESN'T BELONG TO PROPS
00001588  6700 0008               1212              BEQ     .NEXT           ;SKIP
0000158C                          1213              
0000158C  2250                    1214              MOVE.L  (A0),A1
0000158E  5088                    1215              ADD.L   #8,A0
00001590  4E91                    1216              JSR     (A1)
00001592                          1217              
00001592  4EB8 1142               1218  .NEXT       JSR     DMMNEXT
00001596  60E0                    1219              BRA     .LOOP
00001598                          1220              
00001598  4CDF 0300               1221  .END        MOVEM.L (A7)+,A0-A1            
0000159C  4E75                    1222              RTS
0000159E                          1223              
0000159E                          1224  ; -----------------------------------------------------------------------------
0000159E                          1225  PRPPLOT
0000159E                          1226  ; PLOTS THE PROP LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
0000159E                          1227  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
0000159E                          1228  ; INPUT    - NONE
0000159E                          1229  ; OUTPUT   - NONE
0000159E                          1230  ; MODIFIES - NONE
0000159E                          1231  ; -----------------------------------------------------------------------------
0000159E  48E7 00C0               1232              MOVEM.L A0-A1,-(A7)
000015A2                          1233  
000015A2  4EB8 1120               1234              JSR     DMMFIRST
000015A6  B1FC 00000000           1235  .LOOP       CMP.L   #0,A0
000015AC  6700 0018               1236              BEQ     .END
000015B0  0C68 0003 FFFE          1237              CMP.W   #PIPTYPE,-2(A0)     ;IF MEMORY DOESN'T BELONG TO PROP
000015B6  6708                    1238              BEQ.S   .NEXT               ;SKIP
000015B8                          1239              
000015B8  2268 0004               1240              MOVE.L  4(A0),A1
000015BC  5088                    1241              ADD.L   #8,A0
000015BE  4E91                    1242              JSR     (A1)
000015C0  4EB8 1142               1243  .NEXT       JSR     DMMNEXT
000015C4  60E0                    1244              BRA     .LOOP
000015C6  4CDF 0300               1245  .END        MOVEM.L (A7)+,A0-A1
000015CA                          1246  
000015CA  4E75                    1247              RTS
000015CC                          1248  
000015CC                          1249  ; -----------------------------------------------------------------------------
000015CC  =000011AA               1250  PRPKILL     EQU     DMMFREE
000015CC                          1251  ; KILLS THE PRP BY RELEASING ITS MEMORY
000015CC                          1252  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
000015CC                          1253  ; OUTPUT   - NONE
000015CC                          1254  ; MODIFIES - NONE
000015CC                          1255  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
000015CC                          1256  ; -----------------------------------------------------------------------------
000015CC                          1257  
000015CC                          1258  
000015CC                          1259  
000015CC                          1260  
000015CC                          1261  
000015CC                          1262  
000015CC                          1263  
000015CC                          1264  
000015CC                          1265  
000015CC                          1266  
000015CC                          1267  
000015CC                          1268  
000015CC                          1269  
000015CC                          1270  
000015CC                          1271  -------------------- end include --------------------
000015CC                          1272              INCLUDE "SPAWNER.X68"                ; SPAWNER
000015CC                          1273  ; =============================================================================
000015CC                          1274  ; SPAWNER MANAGEMENT.
000015CC                          1275  ; =============================================================================
000015CC                          1276  
000015CC                          1277  ; -----------------------------------------------------------------------------
000015CC                          1278  SPWUPD
000015CC                          1279  ; UPDATES THE SPAWNER
000015CC                          1280  ; INPUT    - NONE
000015CC                          1281  ; OUTPUT   - NONE
000015CC                          1282  ; MODIFIES - NONE
000015CC                          1283  ; -----------------------------------------------------------------------------
000015CC  48E7 8070               1284              MOVEM.L  D0/A1-A3,-(A7)
000015D0                          1285  
000015D0  1039 00001C41           1286              MOVE.B  (SCRCYCCT),D0
000015D6  C07C 003F               1287              AND     #$3F,D0                 ; EVERY 64 CYCLES
000015DA  6600 0028               1288              BNE     .END                    ; CREATE A NEW PIPE
000015DE  43F9 00001B04           1289              LEA     PIPINIT,A1
000015E4  45F9 00001B2A           1290              LEA     PIPUPD,A2
000015EA  47F9 00001B6E           1291              LEA     PIPPLOT,A3
000015F0  303C 0003               1292              MOVE.W  #PIPTYPE,D0
000015F4  1239 00001C36           1293              MOVE.B  (PIPCOUNT),D1
000015FA  5239 00001C36           1294              ADDQ.B  #1,(PIPCOUNT)
00001600                          1295              
00001600  4EB8 14D2               1296              JSR     AGLADD
00001604                          1297              
00001604  4CDF 0E01               1298  .END        MOVEM.L (A7)+,D0/A1-A3
00001608  4E75                    1299              RTS
0000160A                          1300  
0000160A                          1301  
0000160A                          1302  
0000160A                          1303  
0000160A                          1304  
0000160A                          1305  
0000160A                          1306  
0000160A                          1307  
0000160A                          1308  
0000160A                          1309  
0000160A                          1310  
0000160A                          1311  
0000160A                          1312  
0000160A                          1313  
0000160A                          1314  
0000160A                          1315  
0000160A                          1316  
0000160A                          1317  
0000160A                          1318  
0000160A                          1319  
0000160A                          1320  
0000160A                          1321  -------------------- end include --------------------
0000160A                          1322              INCLUDE "STATES2.X68"                ; GAME STATES MANAGEMENT
0000160A                          1323  ; =============================================================================
0000160A                          1324  ; GAME STATE MANAGEMENT
0000160A                          1325  ; =============================================================================
0000160A                          1326  
0000160A                          1327  ; -----------------------------------------------------------------------------
0000160A                          1328  STAINIT
0000160A                          1329  ; INITALIZES THE STATE MANAGER
0000160A                          1330  ; INPUT    - NONE
0000160A                          1331  ; OUTPUT   - NONE
0000160A                          1332  ; MODIFIES - NONE
0000160A                          1333  ; -----------------------------------------------------------------------------
0000160A  33FC FFFF 00001C26      1334              MOVE.W  #STANONE,(STACUR)
00001612  33FC 0000 00001C28      1335              MOVE.W  #STAINTR,(STANEXT)
0000161A  4E75                    1336              RTS
0000161C                          1337  
0000161C                          1338  ; -----------------------------------------------------------------------------
0000161C                          1339  STAUPD
0000161C                          1340  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
0000161C                          1341  ; INPUT    - NONE
0000161C                          1342  ; OUTPUT   - NONE
0000161C                          1343  ; MODIFIES - NONE
0000161C                          1344  ; -----------------------------------------------------------------------------
0000161C  48E7 8080               1345              MOVEM.L D0/A0,-(A7)
00001620  4280                    1346              CLR.L   D0
00001622  3039 00001C28           1347              MOVE.W  (STANEXT),D0
00001628  B079 00001C26           1348              CMP.W   (STACUR),D0
0000162E  6700 0012               1349              BEQ     .DOUPD
00001632  33C0 00001C26           1350              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00001638  E588                    1351              LSL.L   #2,D0
0000163A  2040                    1352              MOVE.L  D0,A0
0000163C  2068 165A               1353              MOVE.L  .INITBL(A0),A0
00001640  4E90                    1354              JSR     (A0)
00001642  4280                    1355  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00001644  3039 00001C26           1356              MOVE.W  (STACUR),D0
0000164A  E588                    1357              LSL.L   #2,D0
0000164C  2040                    1358              MOVE.L  D0,A0
0000164E  2068 166A               1359              MOVE.L  .UPDTBL(A0),A0
00001652  4E90                    1360              JSR     (A0)
00001654  4CDF 0101               1361              MOVEM.L (A7)+,D0/A0
00001658  4E75                    1362              RTS
0000165A= 000010FE 000011C0 ...   1363  .INITBL     DC.L    STAINTRI,STAPLAYI,STAEMPTY,STAEMPTY
0000166A= 000016E4 000016A8 ...   1364  .UPDTBL     DC.L    STAINTRU,STAPLAYU,STAPAUU,STAGOVRU
0000167A                          1365  
0000167A                          1366  ; -----------------------------------------------------------------------------
0000167A                          1367  STAPLOT
0000167A                          1368  ; PERFORMS STATE PLOT
0000167A                          1369  ; INPUT    - NONE
0000167A                          1370  ; OUTPUT   - NONE
0000167A                          1371  ; MODIFIES - NONE
0000167A                          1372  ; -----------------------------------------------------------------------------
0000167A  48E7 8080               1373              MOVEM.L D0/A0,-(A7)
0000167E  4280                    1374              CLR.L   D0
00001680  3039 00001C26           1375              MOVE.W  (STACUR),D0
00001686  E588                    1376              LSL.L   #2,D0
00001688  2040                    1377              MOVE.L  D0,A0
0000168A  2068 1696               1378              MOVE.L  .PLTTBL(A0),A0
0000168E  4E90                    1379              JSR     (A0)
00001690  4CDF 0101               1380              MOVEM.L (A7)+,D0/A0
00001694  4E75                    1381              RTS
00001696= 000016FA 000016D2 ...   1382  .PLTTBL     DC.L    STAINTRP,STAPLAYP,STAPAUP,STAGOVRP
000016A6                          1383  
000016A6                          1384  ; -----------------------------------------------------------------------------
000016A6                          1385  STAEMPTY
000016A6                          1386  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
000016A6                          1387  ; INPUT    - NONE
000016A6                          1388  ; OUTPUT   - NONE
000016A6                          1389  ; MODIFIES - NONE
000016A6                          1390  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
000016A6                          1391  ; -----------------------------------------------------------------------------
000016A6  4E75                    1392              RTS
000016A8                          1393  
000016A8                          1394  ; -----------------------------------------------------------------------------
000016A8  =000011C0               1395  STAPLAYI    EQU     PLRINIT
000016A8                          1396  ; PLAY STATE INITIALIZATION.
000016A8                          1397  ; INPUT    - NONE
000016A8                          1398  ; OUTPUT   - NONE
000016A8                          1399  ; MODIFIES - NONE
000016A8                          1400  ; NOTE     - JUST A WRAPPER FOR PLRINIT
000016A8                          1401  ; -----------------------------------------------------------------------------
000016A8                          1402  
000016A8                          1403  ; -----------------------------------------------------------------------------
000016A8                          1404  STAPLAYU
000016A8                          1405  ; PLAY STATE UPDATE
000016A8                          1406  ; INPUT    - NONE
000016A8                          1407  ; OUTPUT   - NONE
000016A8                          1408  ; MODIFIES - NONE
000016A8                          1409  ; -----------------------------------------------------------------------------
000016A8  0839 0007 00001C3F      1410              BTST.B   #KBDBITPS,(KBDEDGE)         ;Si 'P' es presionado, pausa.
000016B0  6616                    1411              BNE.S   .PAUSE
000016B2                          1412              
000016B2  4EB8 11F0               1413              JSR     PLRUPD
000016B6  4EB9 00001A4E           1414              JSR     BGUPD
000016BC  4EB8 1570               1415              JSR     PRPUPD
000016C0  4EB8 15CC               1416              JSR     SPWUPD
000016C4  6000 FE26               1417              BRA     AGLUPD
000016C8                          1418  .PAUSE      
000016C8  33FC 0002 00001C28      1419              MOVE.W  #STAPAU,(STANEXT)
000016D0  4E75                    1420              RTS
000016D2                          1421  ; -----------------------------------------------------------------------------
000016D2                          1422  STAPLAYP
000016D2                          1423  ; PLAY STATE PLOT
000016D2                          1424  ; INPUT    - NONE
000016D2                          1425  ; OUTPUT   - NONE
000016D2                          1426  ; MODIFIES - NONE
000016D2                          1427  ; -----------------------------------------------------------------------------
000016D2  4EB9 00001A9A           1428              JSR     BGPLOT
000016D8  4EB8 159E               1429              JSR     PRPPLOT
000016DC  4EB8 1520               1430              JSR     AGLPLOT
000016E0                          1431              ;BRA     AGLPLOT
000016E0  6000 FBD6               1432              BRA     PLRPLOT
000016E4                          1433  
000016E4                          1434  ; -----------------------------------------------------------------------------
000016E4  =000010FE               1435  STAINTRI    EQU     DMMINIT
000016E4                          1436  ; INTRO STATE INIT
000016E4                          1437  ; INPUT    - NONE
000016E4                          1438  ; OUTPUT   - NONE
000016E4                          1439  ; MODIFIES - NONE
000016E4                          1440  ; NOTE     - JUST A WRAPPER FOR DMMINIT TO RELEASE ALL MEMORY
000016E4                          1441  ; -----------------------------------------------------------------------------
000016E4                          1442  
000016E4                          1443  ; -----------------------------------------------------------------------------
000016E4                          1444  STAINTRU
000016E4                          1445  ; INTRO STATE UPDATE
000016E4                          1446  ; INPUT    - NONE
000016E4                          1447  ; OUTPUT   - NONE
000016E4                          1448  ; MODIFIES - NONE
000016E4                          1449  ; -----------------------------------------------------------------------------
000016E4  0839 0004 00001C3F      1450              BTST.B  #KBDBITF1,(KBDEDGE)
000016EC  6700 000A               1451              BEQ     .END
000016F0  33FC 0001 00001C28      1452              MOVE.W  #STAPLAY,(STANEXT)
000016F8  4E75                    1453  .END        RTS
000016FA                          1454  
000016FA                          1455  ; -----------------------------------------------------------------------------
000016FA                          1456  STAINTRP
000016FA                          1457  ; INTRO STATE PLOT
000016FA                          1458  ; INPUT    - NONE
000016FA                          1459  ; OUTPUT   - NONE
000016FA                          1460  ; MODIFIES - NONE
000016FA                          1461  ; -----------------------------------------------------------------------------
000016FA                          1462              ;Guardar registros en pila
000016FA  48E7 C040               1463              MOVEM.L A1/D0-D1,-(A7)
000016FE                          1464              
000016FE                          1465              ;Seleccionar fuente de texto
000016FE                          1466m             UTLFONT INTTITC,INTTITF
000016FE                          1467m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000016FE                          1468m ; INPUT    - INTTITC COLOR, INTTITF FONT
000016FE                          1469m ; OUTPUT   - NONE
000016FE                          1470m ; MODIFIES - D0,D1,D2
000016FE                          1471m ; -----------------------------------------------------------------------------
0000170E                          1472              ;Seleccionar posicion de texto      
0000170E                          1473m             UTLLOCT INTTITX,INTTITY               
0000170E                          1474m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
0000170E                          1475m ; INPUT    - INTTITX X, INTTITY Y
0000170E                          1476m ; OUTPUT   - NONE
0000170E                          1477m ; MODIFIES - D0,D1
0000170E                          1478m ; -----------------------------------------------------------------------------
00001718                          1479  
00001718  43F9 00001750           1480              LEA     .TITLE,A1
0000171E  103C 000E               1481              MOVE.B  #14,D0
00001722  4E4F                    1482              TRAP    #15
00001724                          1483              
00001724                          1484              ;Seleccionar fuente de texto
00001724                          1485m             UTLFONT INTPRSC,INTPRSF     
00001724                          1486m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001724                          1487m ; INPUT    - INTPRSC COLOR, INTPRSF FONT
00001724                          1488m ; OUTPUT   - NONE
00001724                          1489m ; MODIFIES - D0,D1,D2
00001724                          1490m ; -----------------------------------------------------------------------------
00001734                          1491              ;Seleccionar posicion de texto
00001734                          1492m             UTLLOCT INTPRSX,INTPRSY     
00001734                          1493m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001734                          1494m ; INPUT    - INTPRSX X, INTPRSY Y
00001734                          1495m ; OUTPUT   - NONE
00001734                          1496m ; MODIFIES - D0,D1
00001734                          1497m ; -----------------------------------------------------------------------------
0000173E                          1498  
0000173E  43F9 0000175C           1499              LEA     .START_TEXT,A1
00001744  103C 000E               1500              MOVE.B  #14,D0
00001748  4E4F                    1501              TRAP    #15
0000174A                          1502              
0000174A                          1503              ;Restaurar registros
0000174A  4CDF 0203               1504              MOVEM.L (A7)+,A1/D0-D1
0000174E  4E75                    1505              RTS
00001750                          1506  
00001750= 46 4C 41 50 50 59 ...   1507  .TITLE      DC.B    'FLAPPY BIRD',0 
0000175C= 50 52 45 53 53 20 ...   1508  .START_TEXT DC.B    'PRESS SPACE TO START',0
00001772                          1509              DS.W    0
00001772                          1510  
00001772                          1511  
00001772                          1512  
00001772                          1513  ; -----------------------------------------------------------------------------
00001772                          1514  STAPAUI    
00001772                          1515  ; PAUSE STATE INIT
00001772                          1516  ; INPUT    - NONE
00001772                          1517  ; OUTPUT   - NONE
00001772                          1518  ; MODIFIES - NONE
00001772                          1519  ; -----------------------------------------------------------------------------
00001772                          1520              ;Guardar registros de juego
00001772  48E7 FFFE               1521              MOVEM.L D0-D7/A0-A6,-(A7)
00001776  40E7                    1522              MOVE.W  SR,-(A7)
00001778                          1523              
00001778  4EEF FFC0               1524              JMP     -64(A7)
0000177C                          1525  ; -----------------------------------------------------------------------------
0000177C                          1526  STAPAUU
0000177C                          1527  ; INTRO STATE UPDATE
0000177C                          1528  ; INPUT    - NONE
0000177C                          1529  ; OUTPUT   - NONE
0000177C                          1530  ; MODIFIES - NONE
0000177C                          1531  ; -----------------------------------------------------------------------------
0000177C  0839 0001 00001C3F      1532              BTST.B  #KBDBITUP,(KBDEDGE)     ;Check cambio en estado de UP
00001784  6628                    1533              BNE.S   .UP
00001786  0839 0003 00001C3F      1534              BTST.B  #KBDBITDN,(KBDEDGE)     ;Check cambio en estado de DOWN
0000178E  6630                    1535              BNE.S   .DN
00001790  0839 0004 00001C3F      1536              BTST.B  #KBDBITF1,(KBDEDGE)     ;Check cambio en estado de FIRE1
00001798  6638                    1537              BNE.S   .OK
0000179A  0839 0007 00001C3F      1538              BTST.B  #KBDBITPS,(KBDEDGE)     ;Check cambio en estado de 'P'
000017A2  6708                    1539              BEQ.S   .END
000017A4                          1540              
000017A4  33FC 0001 00001C28      1541              MOVE.W  #STAPLAY,(STANEXT)      ;Si hay cambio en estado de 'P'
000017AC                          1542                                              ;Actualizar siguiente estado
000017AC  4E75                    1543  .END        RTS
000017AE                          1544  
000017AE  0C39 0000 00001C3C      1545  .UP         CMP.B   #CONTNUM,(PMOPTN)       ;Check si es posible cambiar a una
000017B6  6FF4                    1546              BLE.S   .END                    ;opción superior
000017B8  5379 00001C3C           1547              SUBQ    #1,(PMOPTN)
000017BE  60EC                    1548              BRA.S   .END
000017C0                          1549              
000017C0  0C39 0002 00001C3C      1550  .DN         CMP.B   #EXTNUM,(PMOPTN)        ;Check si es posible cambiar a una
000017C8  6CE2                    1551              BGE.S   .END                    ;opción inferior
000017CA  5279 00001C3C           1552              ADDQ    #1,(PMOPTN)
000017D0  60DA                    1553              BRA.S   .END
000017D2                          1554              
000017D2                          1555  .OK         
000017D2  4280                    1556              CLR.L   D0                      ;Preparar registro D0
000017D4  1039 00001C3C           1557              MOVE.B  (PMOPTN),D0
000017DA  C0FC 0006               1558              MULU    #6,D0                   
000017DE                          1559              
000017DE  2040                    1560              MOVEA.L D0,A0                   ;Usar D0 como indice para .JMPLST
000017E0                          1561              
000017E0  4EE8 17E4               1562              JMP     .JMPLST(A0)
000017E4                          1563              
000017E4  4EF9 000017F6           1564  .JMPLST     JMP     .contgame               
000017EA  4EF9 00001800           1565              JMP     .newgame
000017F0  4EF9 0000180A           1566              JMP     .exitgame
000017F6                          1567  .contgame
000017F6                          1568              ;Si última PMOPT == continuar juego, actualizar estado
000017F6  33FC 0001 00001C28      1569              MOVE.W  #STAPLAY,(STANEXT)
000017FE  60AC                    1570              BRA     .END
00001800                          1571  .newgame    
00001800                          1572              ;Si última PMOPT == nuevo juego, actualizar estado
00001800  33FC 0000 00001C28      1573              MOVE.W  #STAINTR,(STANEXT)
00001808  60A2                    1574              BRA     .END
0000180A                          1575              
0000180A                          1576  .exitgame   
0000180A                          1577              ;Si última PMOPT == salir de juego, actualizar estado
0000180A  33FC 0003 00001C28      1578              MOVE.W  #STAGOVR,(STANEXT)
00001812  6098                    1579              BRA     .END
00001814                          1580  
00001814                          1581  ; -----------------------------------------------------------------------------
00001814                          1582  STAPAUP
00001814                          1583  ; INTRO STATE PLOT
00001814                          1584  ; INPUT    - NONE
00001814                          1585  ; OUTPUT   - NONE
00001814                          1586  ; MODIFIES - NONE
00001814                          1587  ; -----------------------------------------------------------------------------
00001814                          1588              ;Guardar registros
00001814  48E7 8040               1589              MOVEM.L D0/A1,-(A7)
00001818                          1590  
00001818                          1591m             UTLSFIL #$00000000
00001818                          1592m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001818                          1593m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001818                          1594m ; OUTPUT   - NONE
00001818                          1595m ; MODIFIES - D0,D1
00001818                          1596m ; -----------------------------------------------------------------------------
00001820                          1597  
00001820                          1598              **********DIBUJAR TÍTULO**********
00001820                          1599              ;Seleccionar fuente de texto
00001820                          1600m             UTLFONT PAUTITC,PAUTITF
00001820                          1601m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001820                          1602m ; INPUT    - PAUTITC COLOR, PAUTITF FONT
00001820                          1603m ; OUTPUT   - NONE
00001820                          1604m ; MODIFIES - D0,D1,D2
00001820                          1605m ; -----------------------------------------------------------------------------
00001830                          1606              ;Seleccionar posicion de texto      
00001830                          1607m             UTLLOCT PAUTITX,PAUTITY               
00001830                          1608m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001830                          1609m ; INPUT    - PAUTITX X, PAUTITY Y
00001830                          1610m ; OUTPUT   - NONE
00001830                          1611m ; MODIFIES - D0,D1
00001830                          1612m ; -----------------------------------------------------------------------------
0000183A                          1613  
0000183A  43F9 00001910           1614              LEA     .TITLE,A1
00001840  700E                    1615              MOVEQ   #14,D0
00001842  4E4F                    1616              TRAP    #15
00001844                          1617              
00001844  1E39 00001C3C           1618              MOVE.B  (PMOPTN),D7
0000184A                          1619              
0000184A                          1620              
0000184A                          1621              **********DIBUJAR OPCION CONTINUAR**********
0000184A                          1622              ;Seleccionar fuente de texto
0000184A  0C39 0000 00001C3C      1623              CMP.B   #CONTNUM,(PMOPTN)
00001852  6712                    1624              BEQ.S   .CNTSEL
00001854                          1625m             UTLFONT PAUOPTC,PAUOPTFU
00001854                          1626m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001854                          1627m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
00001854                          1628m ; OUTPUT   - NONE
00001854                          1629m ; MODIFIES - D0,D1,D2
00001854                          1630m ; -----------------------------------------------------------------------------
00001864  6010                    1631              BRA.S   .SKPCNT
00001866                          1632  
00001866                          1633m .CNTSEL     UTLFONT PAUOPTC,PAUOPTFS
00001866                          1634m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001866                          1635m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
00001866                          1636m ; OUTPUT   - NONE
00001866                          1637m ; MODIFIES - D0,D1,D2
00001866                          1638m ; -----------------------------------------------------------------------------
00001876                          1639  .SKPCNT
00001876                          1640              ;Seleccionar posición de texto
00001876                          1641m             UTLLOCT PAUOPTX,PAUCNTY
00001876                          1642m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001876                          1643m ; INPUT    - PAUOPTX X, PAUCNTY Y
00001876                          1644m ; OUTPUT   - NONE
00001876                          1645m ; MODIFIES - D0,D1
00001876                          1646m ; -----------------------------------------------------------------------------
00001880                          1647              
00001880  43F9 0000191E           1648              LEA     .CONT,A1
00001886  700E                    1649              MOVEQ   #14,D0
00001888  4E4F                    1650              TRAP    #15
0000188A                          1651              
0000188A                          1652              **********DIBUJAR OPCION JUEGO NUEVO**********
0000188A                          1653              ;Seleccionar fuente de texto
0000188A  0C39 0001 00001C3C      1654              CMP.B   #NEWGNUM,(PMOPTN)
00001892  6712                    1655              BEQ.S   .NEWSEL
00001894                          1656m             UTLFONT PAUOPTC,PAUOPTFU
00001894                          1657m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001894                          1658m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
00001894                          1659m ; OUTPUT   - NONE
00001894                          1660m ; MODIFIES - D0,D1,D2
00001894                          1661m ; -----------------------------------------------------------------------------
000018A4  6010                    1662              BRA.S   .SKPNEW
000018A6                          1663  
000018A6                          1664m .NEWSEL     UTLFONT PAUOPTC,PAUOPTFS
000018A6                          1665m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018A6                          1666m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
000018A6                          1667m ; OUTPUT   - NONE
000018A6                          1668m ; MODIFIES - D0,D1,D2
000018A6                          1669m ; -----------------------------------------------------------------------------
000018B6                          1670  .SKPNEW
000018B6                          1671              ;Seleccionar posición de texto
000018B6                          1672m             UTLLOCT PAUOPTX,PAUNEWY
000018B6                          1673m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000018B6                          1674m ; INPUT    - PAUOPTX X, PAUNEWY Y
000018B6                          1675m ; OUTPUT   - NONE
000018B6                          1676m ; MODIFIES - D0,D1
000018B6                          1677m ; -----------------------------------------------------------------------------
000018C0                          1678              
000018C0  43F9 00001928           1679              LEA     .NEWG,A1
000018C6  700E                    1680              MOVEQ   #14,D0
000018C8  4E4F                    1681              TRAP    #15
000018CA                          1682              
000018CA                          1683              **********DIBUJAR OPCION SALIR**********
000018CA                          1684              ;Seleccionar fuente de texto
000018CA  0C39 0002 00001C3C      1685              CMP.B   #EXTNUM,(PMOPTN)
000018D2  6712                    1686              BEQ.S   .EXTSEL
000018D4                          1687m             UTLFONT PAUOPTC,PAUOPTFU
000018D4                          1688m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018D4                          1689m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
000018D4                          1690m ; OUTPUT   - NONE
000018D4                          1691m ; MODIFIES - D0,D1,D2
000018D4                          1692m ; -----------------------------------------------------------------------------
000018E4  6010                    1693              BRA.S   .SKPEXT
000018E6                          1694  
000018E6                          1695m .EXTSEL     UTLFONT PAUOPTC,PAUOPTFS
000018E6                          1696m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018E6                          1697m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
000018E6                          1698m ; OUTPUT   - NONE
000018E6                          1699m ; MODIFIES - D0,D1,D2
000018E6                          1700m ; -----------------------------------------------------------------------------
000018F6                          1701  .SKPEXT
000018F6                          1702              ;Seleccionar posición de texto
000018F6                          1703m             UTLLOCT PAUOPTX,PAUEXTY
000018F6                          1704m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000018F6                          1705m ; INPUT    - PAUOPTX X, PAUEXTY Y
000018F6                          1706m ; OUTPUT   - NONE
000018F6                          1707m ; MODIFIES - D0,D1
000018F6                          1708m ; -----------------------------------------------------------------------------
00001900                          1709              
00001900  43F9 00001934           1710              LEA     .EXIT,A1
00001906  700E                    1711              MOVEQ   #14,D0
00001908  4E4F                    1712              TRAP    #15
0000190A                          1713              
0000190A                          1714              ;Restaurar registros
0000190A  4CDF 0201               1715              MOVEM.L (A7)+,D0/A1
0000190E  4E75                    1716              RTS
00001910                          1717              
00001910                          1718  ; --- LOCAL DATA -----------------
00001910= 4D 45 4E 55 20 44 ...   1719  .TITLE      DC.B    'MENU DE PAUSA',0
0000191E= 43 4F 4E 54 49 4E ...   1720  .CONT       DC.B    'CONTINUAR',0
00001928= 4A 55 45 47 4F 20 ...   1721  .NEWG       DC.B    'JUEGO NUEVO',0
00001934= 53 41 4C 49 52 00       1722  .EXIT       DC.B    'SALIR',0
0000193A                          1723              DS.W    0
0000193A                          1724              
0000193A                          1725  ; -----------------------------------------------------------------------------
0000193A                          1726  STAGOVRU
0000193A                          1727  ; GAME OVER STATE UPDATE
0000193A                          1728  ; INPUT    - NONE
0000193A                          1729  ; OUTPUT   - NONE
0000193A                          1730  ; MODIFIES - NONE
0000193A                          1731  ; -----------------------------------------------------------------------------
0000193A  0839 0004 00001C3F      1732              BTST.B  #KBDBITF1,(KBDEDGE)
00001942  6700 000A               1733              BEQ     .END
00001946  33FC 0000 00001C28      1734              MOVE.W  #STAINTR,(STANEXT)
0000194E  4E75                    1735  .END        RTS
00001950                          1736  
00001950                          1737  ; -----------------------------------------------------------------------------
00001950                          1738  STAGOVRP
00001950                          1739  ; GAME OVER STATE PLOT
00001950                          1740  ; INPUT    - NONE
00001950                          1741  ; OUTPUT   - NONE
00001950                          1742  ; MODIFIES - NONE
00001950                          1743  ; -----------------------------------------------------------------------------
00001950  48E7 C040               1744              MOVEM.L A1/D0-D1,-(A7)
00001954                          1745m             UTLLOCT GOVSTRX,GOVSTRY
00001954                          1746m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001954                          1747m ; INPUT    - GOVSTRX X, GOVSTRY Y
00001954                          1748m ; OUTPUT   - NONE
00001954                          1749m ; MODIFIES - D0,D1
00001954                          1750m ; -----------------------------------------------------------------------------
0000195E                          1751m             UTLSPEN #GOVSTRC
0000195E                          1752m ; WRAPPER FOR SET PEN TRAP 15 TASK.
0000195E                          1753m ; INPUT    - #GOVSTRC COLOR IN FORMAT $00BBGGRR
0000195E                          1754m ; OUTPUT   - NONE
0000195E                          1755m ; MODIFIES - D0,D1
0000195E                          1756m ; -----------------------------------------------------------------------------
0000196A                          1757m             UTLSFIL #$00000000
0000196A                          1758m ; WRAPPER FOR SET FIL TRAP 15 TASK.
0000196A                          1759m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
0000196A                          1760m ; OUTPUT   - NONE
0000196A                          1761m ; MODIFIES - D0,D1
0000196A                          1762m ; -----------------------------------------------------------------------------
00001972  43F9 00001984           1763              LEA     .GOVSTR,A1
00001978  103C 000E               1764              MOVE.B  #14,D0
0000197C  4E4F                    1765              TRAP    #15
0000197E  4CDF 0203               1766              MOVEM.L (A7)+,A1/D0-D1
00001982  4E75                    1767              RTS
00001984                          1768  
00001984= 47 41 4D 45 20 20 ...   1769  .GOVSTR     DC.B    'GAME  OVER',0
00001990                          1770              DS.W    0
00001990                          1771  
00001990                          1772  
00001990                          1773  
00001990                          1774  
00001990                          1775  
00001990                          1776  
00001990                          1777  
00001990                          1778  
00001990                          1779  
00001990                          1780  
00001990                          1781  
00001990                          1782  
00001990                          1783  
00001990                          1784  
00001990                          1785  
00001990                          1786  
00001990                          1787  
00001990                          1788  
00001990                          1789  
00001990                          1790  
00001990                          1791  
00001990                          1792  
00001990                          1793  
00001990                          1794  -------------------- end include --------------------
00001990                          1795              INCLUDE "BACKGROUND/BACKGROUND.X68"  ; BACKGROUND MANAGEMENT
00001990                          1796  ;------------------------------------------------------------------------------
00001990                          1797  ; BACKGROUND
00001990                          1798  ;------------------------------------------------------------------------------
00001990                          1799              INCLUDE "BACKGROUND/CLOUD.X68"     ; BACKGROUND CLOUDS MANAGEMENT 
00001990                          1800  ; =============================================================================
00001990                          1801  ; CLOUD MANAGEMENT. IT IS A PROP.
00001990                          1802  ; LOCAL MEMORY IS:
00001990                          1803  ; +0 WORD X COORDINATE
00001990                          1804  ; +2 WORD Y COORDINATE
00001990                          1805  ; =============================================================================
00001990                          1806  
00001990                          1807  ; -----------------------------------------------------------------------------
00001990                          1808  CLDINIT
00001990                          1809  ; INITALIZES CLOUD
00001990                          1810  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
00001990                          1811  ; OUTPUT   - NONE
00001990                          1812  ; MODIFIES - NONE
00001990                          1813  ; NOTE     - ASSUMES SCRHEIGH IS GREATER THAN 255
00001990                          1814  ; -----------------------------------------------------------------------------
00001990                          1815          ;Guardar registros
00001990  2F00                    1816          MOVE.L      D0,-(A7)
00001992                          1817              
00001992  30BC 0280               1818          MOVE.W      #SCRWIDTH,(A0)
00001996                          1819          
00001996  4EB8 13B4               1820          JSR         UTLRAND
0000199A  3140 0002               1821          MOVE.W      D0,2(A0)
0000199E                          1822          
0000199E                          1823          ;Restaurar registros
0000199E  201F                    1824          MOVE.L      (A7)+,D0
000019A0                          1825          
000019A0  4E75                    1826          RTS
000019A2                          1827  
000019A2                          1828  ; -----------------------------------------------------------------------------
000019A2                          1829  CLDUPD
000019A2                          1830  ; UPDATES THE STATE OF CLOUDS
000019A2                          1831  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
000019A2                          1832  ; OUTPUT   - NONE
000019A2                          1833  ; MODIFIES - NONE
000019A2                          1834  ; -----------------------------------------------------------------------------
000019A2                          1835          ;Actualizar posición
000019A2  2F00                    1836          MOVE.L      D0,-(A7)
000019A4                          1837          
000019A4  3039 00001C3A           1838          MOVE.W      (XSPEED),D0
000019AA  80FC 0002               1839          DIVU.W      #2,D0
000019AE  9150                    1840          SUB.W       D0,(A0)
000019B0  0C50 FF88               1841          CMP.W       #-CLDSIZE*2,(A0)
000019B4  6F04                    1842          BLE.S       .KILL
000019B6                          1843  
000019B6                          1844  .END    
000019B6  201F                    1845          MOVE.L      (A7)+,D0
000019B8  4E75                    1846          RTS
000019BA                          1847          
000019BA  4EB8 11AA               1848  .KILL   JSR PRPKILL
000019BE  60F6                    1849          BRA         .END     
000019C0                          1850  
000019C0                          1851  ; -----------------------------------------------------------------------------
000019C0                          1852  CLDPLOT
000019C0                          1853  ; PLOTS THE CLOUD IN ITS RIGHTFUL POSITION
000019C0                          1854  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
000019C0                          1855  ; OUTPUT   - NONE
000019C0                          1856  ; MODIFIES - NONE
000019C0                          1857  ; -----------------------------------------------------------------------------       
000019C0                          1858          ;Guardar registros
000019C0  48E7 F800               1859          MOVEM.L     D0-D4,-(A7)
000019C4                          1860          
000019C4                          1861m         UTLSPEN     #CLDPCLR
000019C4                          1862m ; WRAPPER FOR SET PEN TRAP 15 TASK.
000019C4                          1863m ; INPUT    - #CLDPCLR COLOR IN FORMAT $00BBGGRR
000019C4                          1864m ; OUTPUT   - NONE
000019C4                          1865m ; MODIFIES - D0,D1
000019C4                          1866m ; -----------------------------------------------------------------------------
000019D0                          1867m         UTLSFIL     #CLDFCLR
000019D0                          1868m ; WRAPPER FOR SET FIL TRAP 15 TASK.
000019D0                          1869m ; INPUT    - #CLDFCLR COLOR IN FORMAT $00BBGGRR
000019D0                          1870m ; OUTPUT   - NONE
000019D0                          1871m ; MODIFIES - D0,D1
000019D0                          1872m ; -----------------------------------------------------------------------------
000019DC                          1873          
000019DC                          1874          ;Preparar parametros
000019DC  3210                    1875          MOVE.W      (A0),D1     ;X0 COORD
000019DE  3428 0002               1876          MOVE.W      2(A0),D2    ;Y0 COORD
000019E2  3601                    1877          MOVE.W      D1,D3       
000019E4  3802                    1878          MOVE.W      D2,D4       
000019E6  0643 0078               1879          ADD.W       #CLDSIZE*2,D3 ;X1 COORD
000019EA  0644 003C               1880          ADD.W       #CLDSIZE,D4 ;Y2 COORD
000019EE                          1881          
000019EE  7058                    1882          MOVEQ       #88,D0      ;TASK NUM
000019F0                          1883          
000019F0  4E4F                    1884          TRAP        #15
000019F2                          1885          
000019F2                          1886          ;Restaurar registros
000019F2  4CDF 001F               1887          MOVEM.L     (A7)+,D0-D4
000019F6  4E75                    1888          RTS
000019F8                          1889  
000019F8                          1890  
000019F8                          1891  
000019F8                          1892  
000019F8                          1893  
000019F8                          1894  
000019F8                          1895  
000019F8                          1896  
000019F8                          1897  
000019F8                          1898  
000019F8                          1899  
000019F8                          1900  
000019F8                          1901  
000019F8                          1902  
000019F8                          1903  
000019F8                          1904  
000019F8                          1905  
000019F8                          1906  
000019F8                          1907  
000019F8                          1908  
000019F8                          1909  
000019F8                          1910  
000019F8                          1911  
000019F8                          1912  
000019F8                          1913  
000019F8                          1914  -------------------- end include --------------------
000019F8                          1915              INCLUDE "BACKGROUND/GSSDETAIL.X68" ; GRASS DETAILS MANAGEMENT
000019F8                          1916  ; =============================================================================
000019F8                          1917  ; GRASS DETAILS MANAGEMENT. IT IS A PROP.
000019F8                          1918  ; LOCAL MEMORY IS:
000019F8                          1919  ; +0 WORD X COORDINATE
000019F8                          1920  ; =============================================================================
000019F8                          1921  
000019F8                          1922  ; -----------------------------------------------------------------------------
000019F8                          1923  GSSDINIT
000019F8                          1924  ; INITIALIZES THE LITTLE DETAILS ON THE GRASS
000019F8                          1925  ; -----------------------------------------------------------------------------
000019F8  2F00                    1926          MOVE.L      D0,-(A7)
000019FA                          1927          
000019FA  30BC 0280               1928          MOVE.W      #SCRWIDTH,(A0)
000019FE                          1929          
000019FE  201F                    1930          MOVE.L      (A7)+,D0
00001A00  4E75                    1931          RTS
00001A02                          1932          
00001A02                          1933          
00001A02                          1934  ; -----------------------------------------------------------------------------
00001A02                          1935  GSSDUPD
00001A02                          1936  ; MODIFIES THE LITTLE DETAILS ON THE GRASS' X COORDINATE
00001A02                          1937  ; -----------------------------------------------------------------------------
00001A02                          1938          ;Guardar registros
00001A02  2F00                    1939          MOVE.L      D0,-(A7)
00001A04                          1940  
00001A04  3039 00001C3A           1941          MOVE.W      (XSPEED),D0
00001A0A  9150                    1942          SUB.W       D0,(A0)         ;UPDATE X COORDINATE
00001A0C  0C50 FFF6               1943          CMP.W       #-GSSDWDTH,(A0)
00001A10  6F04                    1944          BLE.S       .KILL
00001A12                          1945          
00001A12                          1946  .END    ;Restaurar registros
00001A12  201F                    1947          MOVE.L      (A7)+,D0
00001A14  4E75                    1948          RTS
00001A16                          1949  
00001A16  4EB8 11AA               1950  .KILL   JSR         PRPKILL
00001A1A  60F6                    1951          BRA         .END
00001A1C                          1952          
00001A1C                          1953  ; -----------------------------------------------------------------------------
00001A1C                          1954  GSSDPLOT
00001A1C                          1955  ; PLOTS THE LITTLE DETAILS ON THE GRASS' X COORDINATE
00001A1C                          1956  ; -----------------------------------------------------------------------------
00001A1C  48E7 F800               1957          MOVEM.L     D0-D4,-(A7)
00001A20                          1958          
00001A20                          1959m         UTLSPEN     #$00000000
00001A20                          1960m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001A20                          1961m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001A20                          1962m ; OUTPUT   - NONE
00001A20                          1963m ; MODIFIES - D0,D1
00001A20                          1964m ; -----------------------------------------------------------------------------
00001A28                          1965m         UTLSFIL     #GSSDFC
00001A28                          1966m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001A28                          1967m ; INPUT    - #GSSDFC COLOR IN FORMAT $00BBGGRR
00001A28                          1968m ; OUTPUT   - NONE
00001A28                          1969m ; MODIFIES - D0,D1
00001A28                          1970m ; -----------------------------------------------------------------------------
00001A34                          1971          
00001A34  3210                    1972          MOVE.W      (A0),D1
00001A36  343C 0168               1973          MOVE.W      #BGGSSTP,D2
00001A3A  3601                    1974          MOVE.W      D1,D3
00001A3C  0643 000A               1975          ADD.W       #GSSDWDTH,D3
00001A40  383C 0190               1976          MOVE.W      #BGGSSBT,D4
00001A44                          1977          
00001A44  7057                    1978          MOVEQ       #87,D0
00001A46  4E4F                    1979          TRAP        #15
00001A48                          1980          
00001A48  4CDF 001F               1981          MOVEM.L     (A7)+,D0-D4
00001A4C  4E75                    1982          RTS
00001A4E                          1983          
00001A4E                          1984  
00001A4E                          1985  
00001A4E                          1986  
00001A4E                          1987  
00001A4E                          1988  
00001A4E                          1989  
00001A4E                          1990  
00001A4E                          1991  -------------------- end include --------------------
00001A4E                          1992  ; -----------------------------------------------------------------------------
00001A4E                          1993  BGUPD
00001A4E                          1994  ; UPDATES DETAILS OF BACKGROUND
00001A4E                          1995  ; INPUT    - NONE
00001A4E                          1996  ; OUTPUT   - NONE
00001A4E                          1997  ; MODIFIES - MEMORY WHEN NEEDED
00001A4E                          1998  ; -----------------------------------------------------------------------------
00001A4E  48E7 8070               1999              MOVEM.L  D0/A1-A3,-(A7)
00001A52                          2000  
00001A52  1039 00001C41           2001              MOVE.B  (SCRCYCCT),D0
00001A58  C07C 0007               2002              AND     #$07,D0                 ;EVERY 8 CYCLES
00001A5C  6614                    2003              BNE.S   .CLOUD                  ;CREATE A NEW MARK ON GRASS
00001A5E  43F8 19F8               2004              LEA     GSSDINIT,A1
00001A62  45F8 1A02               2005              LEA     GSSDUPD,A2
00001A66  47F8 1A1C               2006              LEA     GSSDPLOT,A3
00001A6A  303C 0002               2007              MOVE.W  #GSSDTYPE,D0
00001A6E                          2008              
00001A6E  4EB8 1556               2009              JSR     PRPADD
00001A72                          2010  
00001A72  1039 00001C41           2011  .CLOUD      MOVE.B  (SCRCYCCT),D0
00001A78  C07C 00FF               2012              AND     #$FF,D0                 ; EVERY 256 CYCLES
00001A7C  6600 0016               2013              BNE     .END                    ; CREATE A NEW CLOUD
00001A80  43F8 1990               2014              LEA     CLDINIT,A1
00001A84  45F8 19A2               2015              LEA     CLDUPD,A2
00001A88  47F8 19C0               2016              LEA     CLDPLOT,A3
00001A8C  303C 0001               2017              MOVE.W  #CLDTYPE,D0
00001A90                          2018              
00001A90  4EB8 1556               2019              JSR     PRPADD
00001A94                          2020              
00001A94  4CDF 0E01               2021  .END        MOVEM.L (A7)+,D0/A1-A3
00001A98  4E75                    2022              RTS
00001A9A                          2023  
00001A9A                          2024  
00001A9A                          2025  ; -----------------------------------------------------------------------------
00001A9A                          2026  BGPLOT
00001A9A                          2027  ; PLOTS BACKGROUND
00001A9A                          2028  ; INPUT    - NONE
00001A9A                          2029  ; OUTPUT   - NONE
00001A9A                          2030  ; MODIFIES - NONE
00001A9A                          2031  ; -----------------------------------------------------------------------------
00001A9A                          2032              
00001A9A  48A7 7800               2033              MOVEM.W D1-D4,-(A7)
00001A9E                          2034              
00001A9E                          2035m             UTLSPEN #BGSKYPC
00001A9E                          2036m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001A9E                          2037m ; INPUT    - #BGSKYPC COLOR IN FORMAT $00BBGGRR
00001A9E                          2038m ; OUTPUT   - NONE
00001A9E                          2039m ; MODIFIES - D0,D1
00001A9E                          2040m ; -----------------------------------------------------------------------------
00001AA6                          2041m             UTLSFIL #BGSKYFC
00001AA6                          2042m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001AA6                          2043m ; INPUT    - #BGSKYFC COLOR IN FORMAT $00BBGGRR
00001AA6                          2044m ; OUTPUT   - NONE
00001AA6                          2045m ; MODIFIES - D0,D1
00001AA6                          2046m ; -----------------------------------------------------------------------------
00001AB2                          2047              
00001AB2  4241                    2048              CLR.W   D1
00001AB4  4242                    2049              CLR.W   D2
00001AB6  363C 0280               2050              MOVE.W  #SCRWIDTH,D3
00001ABA  383C 01E0               2051              MOVE.W  #SCRHEIGH,D4
00001ABE                          2052              
00001ABE  7057                    2053              MOVEQ   #87,D0
00001AC0  4E4F                    2054              TRAP    #15
00001AC2                          2055              
00001AC2                          2056m             UTLSFIL #BGGNDFC
00001AC2                          2057m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001AC2                          2058m ; INPUT    - #BGGNDFC COLOR IN FORMAT $00BBGGRR
00001AC2                          2059m ; OUTPUT   - NONE
00001AC2                          2060m ; MODIFIES - D0,D1
00001AC2                          2061m ; -----------------------------------------------------------------------------
00001ACE                          2062              
00001ACE  4241                    2063              CLR     D1
00001AD0  343C 0190               2064              MOVE.W  #BGGSSBT,D2
00001AD4  363C 0280               2065              MOVE.W  #SCRWIDTH,D3
00001AD8  383C 01E0               2066              MOVE.W  #SCRHEIGH,D4
00001ADC                          2067              
00001ADC  7057                    2068              MOVEQ   #87,D0
00001ADE  4E4F                    2069              TRAP    #15
00001AE0                          2070              
00001AE0                          2071m             UTLSFIL #BGGSSFC
00001AE0                          2072m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001AE0                          2073m ; INPUT    - #BGGSSFC COLOR IN FORMAT $00BBGGRR
00001AE0                          2074m ; OUTPUT   - NONE
00001AE0                          2075m ; MODIFIES - D0,D1
00001AE0                          2076m ; -----------------------------------------------------------------------------
00001AEC                          2077  
00001AEC                          2078  
00001AEC  4241                    2079              CLR     D1
00001AEE  343C 0168               2080              MOVE.W  #BGGSSTP,D2
00001AF2  363C 0280               2081              MOVE.W  #SCRWIDTH,D3
00001AF6  383C 0190               2082              MOVE.W  #BGGSSBT,D4
00001AFA                          2083              
00001AFA  7057                    2084              MOVEQ   #87,D0
00001AFC  4E4F                    2085              TRAP    #15
00001AFE                          2086              
00001AFE  4C9F 001E               2087              MOVEM.W (A7)+,D1-D4
00001B02  4E75                    2088              RTS
00001B04                          2089  
00001B04                          2090  
00001B04                          2091  
00001B04                          2092  
00001B04                          2093  
00001B04                          2094  
00001B04                          2095  
00001B04                          2096  
00001B04                          2097  
00001B04                          2098  
00001B04                          2099  
00001B04                          2100  
00001B04                          2101  
00001B04                          2102  
00001B04                          2103  
00001B04                          2104  
00001B04                          2105  
00001B04                          2106  
00001B04                          2107  -------------------- end include --------------------
00001B04                          2108              INCLUDE "PIPES.X68"                  ; PIPES MANAGEMENT          
00001B04                          2109  ; =============================================================================
00001B04                          2110  ; PIPES MANAGEMENT. IT IS AN AGENT.
00001B04                          2111  ; LOCAL MEMORY IS:
00001B04                          2112  ; +0 WORD X COORDINATE OF THE LEFTMOST EDGE OF THE VERTICALLY ALIGNED PIPES
00001B04                          2113  ; +2 WORD Y COORDINATE OF THE DOWNMOST EDGE OF THE TOP PIPE (FACING DOWN)
00001B04                          2114  ; +4 WORD BOOLEAN THAT TELLS WHETHER THE PIPE SHOULD MOVE OR NOT
00001B04                          2115  ;    (0 == TRUE. ELSE FALSE)
00001B04                          2116  ; =============================================================================
00001B04                          2117  
00001B04                          2118  ; -----------------------------------------------------------------------------
00001B04                          2119  PIPINIT
00001B04                          2120  ; PIPE INITIALIZATION
00001B04                          2121  ; -----------------------------------------------------------------------------
00001B04                          2122              ;Guardar registros
00001B04  48E7 C000               2123              MOVEM.L D0-D1,-(A7)
00001B08                          2124              
00001B08  30BC 0280               2125              MOVE.W  #SCRWIDTH,(A0)      ;X COORDINATE OF STARTING POSITION
00001B0C  4EB8 13B4               2126              JSR     UTLRAND             ;RANDOM Y COORDINATE OF STARTING
00001B10  3140 0002               2127              MOVE.W  D0,2(A0)            *POSITION
00001B14  B23C 0004               2128              CMP.B   #4,D1
00001B18  6606                    2129              BNE.S   .skip
00001B1A                          2130              
00001B1A  4239 00001C36           2131              CLR.B   (PIPCOUNT)
00001B20                          2132  .skip            
00001B20  1141 0004               2133              MOVE.B  D1,4(A0)            ;BOOLEAN: MOVING OR NOT
00001B24                          2134          
00001B24                          2135              ;Restaurar registros
00001B24  4CDF 0003               2136              MOVEM.L (A7)+,D0-D1
00001B28  4E75                    2137              RTS
00001B2A                          2138              
00001B2A                          2139  ; -----------------------------------------------------------------------------
00001B2A                          2140  PIPUPD
00001B2A                          2141  ; PIPE UPDATE
00001B2A                          2142  ; -----------------------------------------------------------------------------
00001B2A                          2143               ;Guardar registros
00001B2A  48E7 FF00               2144              MOVEM.L  D0-D7,-(A7)
00001B2E                          2145              
00001B2E  3039 00001C3A           2146              MOVE.W  (XSPEED),D0     
00001B34  9150                    2147              SUB.W   D0,(A0)         ;UPDATE X COORDINATE
00001B36                          2148              
00001B36  0C50 FFC4               2149              CMP.W   #-PIPTWDT,(A0)
00001B3A  6F2C                    2150              BLE.S   .KILL
00001B3C                          2151              
00001B3C                          2152  
00001B3C                          2153              ;Preparar los registros para llamar a la subrutina que comprueba 
00001B3C                          2154              ;las colisiones con las tuberías. 
00001B3C  3010                    2155              MOVE.W (A0), D0
00001B3E  3228 0002               2156              MOVE.W 2(A0), D1
00001B42  3439 00001C2A           2157              MOVE.W (PLRPOSX), D2
00001B48  3639 00001C2C           2158              MOVE.W (PLRPOSY), D3
00001B4E  383C 0032               2159              MOVE.W #PIPBWDT, D4
00001B52  3A3C 001E               2160              MOVE.W #PLRWIDTH, D5
00001B56  3C3C 0050               2161              MOVE.W #PIPOPEN, D6
00001B5A  3E3C 001E               2162              MOVE.W #PLRHEIGHT, D7
00001B5E  4EB8 1370               2163              JSR UTLCHCOL           
00001B62                          2164              
00001B62                          2165  .END        ;Restaurar registros
00001B62  4CDF 00FF               2166              MOVEM.L  (A7)+,D0-D7
00001B66  4E75                    2167              RTS
00001B68                          2168              
00001B68  4EB8 11AA               2169  .KILL       JSR     AGLKILL
00001B6C  60F4                    2170              BRA.S  .END
00001B6E                          2171              
00001B6E                          2172  ; -----------------------------------------------------------------------------
00001B6E                          2173  PIPPLOT
00001B6E                          2174  ; PIPE PLOT
00001B6E                          2175  ; -----------------------------------------------------------------------------
00001B6E                          2176              ;Guardar registros
00001B6E  48E7 F800               2177              MOVEM.L D0-D4,-(A7)
00001B72                          2178              
00001B72                          2179m             UTLSPEN #PIPPC
00001B72                          2180m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001B72                          2181m ; INPUT    - #PIPPC COLOR IN FORMAT $00BBGGRR
00001B72                          2182m ; OUTPUT   - NONE
00001B72                          2183m ; MODIFIES - D0,D1
00001B72                          2184m ; -----------------------------------------------------------------------------
00001B7A                          2185              
00001B7A  0C28 0000 0004          2186              CMP.B   #0,4(A0)
00001B80  6710                    2187              BEQ.S   .skip
00001B82                          2188              
00001B82                          2189m             UTLSFIL #PIPFC
00001B82                          2190m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001B82                          2191m ; INPUT    - #PIPFC COLOR IN FORMAT $00BBGGRR
00001B82                          2192m ; OUTPUT   - NONE
00001B82                          2193m ; MODIFIES - D0,D1
00001B82                          2194m ; -----------------------------------------------------------------------------
00001B8E  6000 000A               2195              BRA     .skp2
00001B92                          2196  .skip       
00001B92                          2197m             UTLSFIL #$00000000      ;prueba para pipes que se han de mover
00001B92                          2198m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001B92                          2199m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001B92                          2200m ; OUTPUT   - NONE
00001B92                          2201m ; MODIFIES - D0,D1
00001B92                          2202m ; -----------------------------------------------------------------------------
00001B9A                          2203  .skp2
00001B9A                          2204              
00001B9A  3210                    2205              MOVE.W  (A0),D1         ;PAINT THE BASE OF THE TOP PIPE
00001B9C  5A41                    2206              ADDQ    #PIPTBSPC,D1
00001B9E  4242                    2207              CLR     D2
00001BA0  3601                    2208              MOVE.W  D1,D3
00001BA2  0643 0032               2209              ADD.W   #PIPBWDT,D3
00001BA6  3828 0002               2210              MOVE.W  2(A0),D4
00001BAA                          2211              
00001BAA  7057                    2212              MOVEQ   #87,D0
00001BAC  4E4F                    2213              TRAP    #15
00001BAE                          2214              
00001BAE  3210                    2215              MOVE.W  (A0),D1         ;PAINT THE MOUTH OF THE TOP PIPE
00001BB0  3828 0002               2216              MOVE.W  2(A0),D4
00001BB4  3404                    2217              MOVE.W  D4,D2
00001BB6  0442 000A               2218              SUB.W   #PIPTHGT,D2
00001BBA  3601                    2219              MOVE.W  D1,D3
00001BBC  0643 003C               2220              ADD.W   #PIPTWDT,D3
00001BC0                          2221              
00001BC0  7057                    2222              MOVEQ   #87,D0
00001BC2  4E4F                    2223              TRAP    #15
00001BC4                          2224              
00001BC4  3210                    2225              MOVE.W  (A0),D1         ;PAINT THE BASE OF THE BOTTOM PIPE
00001BC6  5A41                    2226              ADD.W   #PIPTBSPC,D1
00001BC8  3428 0002               2227              MOVE.W  2(A0),D2
00001BCC  0642 0050               2228              ADD.W   #PIPOPEN,D2
00001BD0  3601                    2229              MOVE.W  D1,D3
00001BD2  0643 0032               2230              ADD.W   #PIPBWDT,D3
00001BD6  383C 0168               2231              MOVE.W  #BGGSSTP,D4
00001BDA                          2232              
00001BDA  7057                    2233              MOVEQ   #87,D0
00001BDC  4E4F                    2234              TRAP    #15
00001BDE                          2235              
00001BDE  3210                    2236              MOVE.W  (A0),D1         ;PAINT THE MOUTH OF THE BOTTOM PIPE
00001BE0  3428 0002               2237              MOVE.W  2(A0),D2
00001BE4  0642 0050               2238              ADD.W   #PIPOPEN,D2
00001BE8  3601                    2239              MOVE.W  D1,D3
00001BEA  0643 003C               2240              ADD.W   #PIPTWDT,D3
00001BEE  3802                    2241              MOVE.W  D2,D4
00001BF0  0644 000A               2242              ADD.W   #PIPTHGT,D4
00001BF4                          2243              
00001BF4  7057                    2244              MOVEQ   #87,D0
00001BF6  4E4F                    2245              TRAP    #15
00001BF8                          2246  
00001BF8                          2247              ;Restaurar registros
00001BF8  4CDF 001F               2248              MOVEM.L (A7)+,D0-D4
00001BFC  4E75                    2249              RTS
00001BFE                          2250  
00001BFE                          2251  
00001BFE                          2252  
00001BFE                          2253  
00001BFE                          2254  
00001BFE                          2255  
00001BFE                          2256  
00001BFE                          2257  
00001BFE                          2258  
00001BFE                          2259  
00001BFE                          2260  
00001BFE                          2261  
00001BFE                          2262  
00001BFE                          2263  
00001BFE                          2264  -------------------- end include --------------------
00001BFE                          2265  
00001BFE                          2266  
00001BFE                          2267  ; --- INITIALIZE --------------------------------------------------------------
00001BFE                          2268  
00001BFE  4EB8 1000               2269  START       JSR     SYSINIT
00001C02  4EB8 160A               2270              JSR     STAINIT
00001C06                          2271  
00001C06                          2272  ; --- UPDATE ------------------------------------------------------------------
00001C06                          2273   
00001C06  4E40                    2274  .LOOP       TRAP    #KBDTRAP                ; READ KEYBOARD
00001C08  4EB8 161C               2275              JSR     STAUPD
00001C0C                          2276  
00001C0C                          2277  ; --- WAIT SYNCH --------------------------------------------------------------
00001C0C                          2278  
00001C0C  4A39 00001C40           2279  .WINT       TST.B   (SCRINTCT)              ; WAIT FOR INTERRUPT
00001C12  67F8                    2280              BEQ     .WINT
00001C14  4239 00001C40           2281              CLR.B   (SCRINTCT)
00001C1A                          2282  
00001C1A                          2283  ; --- PLOT --------------------------------------------------------------------
00001C1A                          2284  
00001C1A  4EB8 167A               2285              JSR     STAPLOT
00001C1E  4E41                    2286              TRAP    #SCRTRAP                ; SHOW GRAPHICS
00001C20  60E4                    2287              BRA     .LOOP
00001C22  FFFF FFFF               2288              SIMHALT
00001C26                          2289  
00001C26                          2290  ; --- VARIABLES ---------------------------------------------------------------
00001C26                          2291  
00001C26                          2292              INCLUDE "VAR.X68"
00001C26                          2293  ; =============================================================================
00001C26                          2294  ; GAME VARS
00001C26                          2295  ; =============================================================================
00001C26                          2296  
00001C26                          2297  ; --- GAME STATE RELATED VARIABLES --------------------------------------------
00001C26                          2298  
00001C26                          2299  STACUR      DS.W    1                       ; CURRENT GAME STATE
00001C28                          2300  STANEXT     DS.W    1                       ; NEXT GAME STATE
00001C2A                          2301  
00001C2A                          2302  ; --- PLAYER RELATED VARIABLES ------------------------------------------------
00001C2A                          2303  
00001C2A                          2304  PLRPOSX      DS.W    1                       ; PLAYER X POSITION (PIXELS)
00001C2C                          2305  PLRPOSY      DS.W    1                       ; PLAYER Y POSITION (PIXELS)
00001C2E                          2306  MAXPOS       DS.W    1                       ; JUMP MAX POSITION
00001C30                          2307  UPPRESSED    DS.W    1                       ; 1 IF UP PRESSED, 0 IF NO PRESSED
00001C32                          2308  PLRDOWNSPEED DS.W    1                       ; PLAYER DOWN SPEED
00001C34                          2309  PLRDEAD      DS.W    1                       ; PLAYER DEAD
00001C36                          2310               DS.W    0
00001C36                          2311              
00001C36                          2312  ; --- PIPE RELATED VARIABLES --------------------------------------------------
00001C36                          2313  
00001C36= 01                      2314  PIPCOUNT    DC.B    1
00001C38= 0001                    2315  PIPEPOSX    DC.W    1
00001C3A                          2316              DS.W    0
00001C3A                          2317  
00001C3A                          2318  ; --- GAME RELATED VARIABLES --------------------------------------------------
00001C3A                          2319  
00001C3A= 0005                    2320  XSPEED      DC.W    5                       ;HORIZONTAL SPEED OF OBJECTS
00001C3C                          2321  
00001C3C                          2322  ; --- PAUSE MENU RELATED VARIABLES -------------------------------------------
00001C3C                          2323  
00001C3C= 00                      2324  PMOPTN      DC.B    0                       ;OPTION ON THE MENU TO BE CHOSEN
00001C3D                          2325  
00001C3D                          2326  ; --- UTILITY VARIABLES ------------------------------------------------------
00001C3D                          2327  
00001C3D                          2328  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001C3E                          2329              DS.W    0
00001C3E                          2330  
00001C3E                          2331  
00001C3E                          2332  
00001C3E                          2333  
00001C3E                          2334  
00001C3E                          2335  
00001C3E                          2336  
00001C3E                          2337  
00001C3E                          2338  
00001C3E                          2339  
00001C3E                          2340  
00001C3E                          2341  
00001C3E                          2342  
00001C3E                          2343  
00001C3E                          2344  
00001C3E                          2345  
00001C3E                          2346  -------------------- end include --------------------
00001C3E                          2347              INCLUDE "SYSVAR.X68"
00001C3E                          2348  ; =============================================================================
00001C3E                          2349  ; SYSTEM VARS
00001C3E                          2350  ; NOTE THAT ALL THESE VARS ARE USED TO SHARE DATA FROM SYSTEM TO USER. THUS
00001C3E                          2351  ; THEY MUST NOT BE IN PROTECTED MEMORY.
00001C3E                          2352  ; NOTE THAT USING DMMDATA IN SUCH WAY IS A BAD IDEA, AS USER APPLICATIONS CAN
00001C3E                          2353  ; ALSO FREE OR CHANGE OWNERSHIP. NONETHELESS, FOR THE SAKE OF THIS EXAMPLE
00001C3E                          2354  ; THIS IS GOOD ENOUGH.
00001C3E                          2355  ; =============================================================================
00001C3E                          2356  
00001C3E                          2357  ; --- KEYBOARD RELATED VARIABLES ----------------------------------------------
00001C3E                          2358  
00001C3E                          2359  KBDVAL      DS.B    1                       ; KEY PRESSED=1
00001C3F                          2360  KBDEDGE     DS.B    1                       ; KEY CHANGED=1
00001C40                          2361  
00001C40                          2362              DS.W    0
00001C40                          2363  
00001C40                          2364  ; --- SCREEN RELATED VARIABLES ------------------------------------------------
00001C40                          2365  
00001C40                          2366  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER/FLAG
00001C41                          2367  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00001C42                          2368              DS.W    0
00001C42                          2369  
00001C42                          2370  ; --- DYNAMIC MEMORY VARIABLES ------------------------------------------------
00001C42                          2371  
00001C80                          2372              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00001C80                          2373  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00002900                          2374              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00002900                          2375  
00002900                          2376  
00002900                          2377  -------------------- end include --------------------
00002900                          2378  
00002900                          2379              END    START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              14D2
AGLADD:END          14E8
AGLKILL             11AA
AGLPLOT             1520
AGLPLOT:END         1550
AGLPLOT:LOOP        1528
AGLPLOT:NEXT        154A
AGLUPD              14EC
AGLUPD:END          151A
AGLUPD:LOOP         14F4
AGLUPD:NEXT         1514
BGGNDFC             155DD8
BGGNDPC             0
BGGNDTP             190
BGGSSBT             190
BGGSSFC             990A
BGGSSPC             0
BGGSSTP             168
BGPLOT              1A9A
BGSKYFC             EFCE87
BGSKYPC             0
BGUPD               1A4E
BGUPD:CLOUD         1A72
BGUPD:END           1A94
BLACK               0
CLDFCLR             FFFFFF
CLDINIT             1990
CLDPCLR             FFFFFF
CLDPLOT             19C0
CLDSIZE             3C
CLDTYPE             1
CLDUPD              19A2
CLDUPD:END          19B6
CLDUPD:KILL         19BA
CONTNUM             0
DMMALLOC            1190
DMMALLOC:END        11A8
DMMBNUM             32
DMMBSIZE            40
DMMDATA             1C80
DMMFCOM             116A
DMMFFND             1178
DMMFIRST            1120
DMMFLOOP            115E
DMMFRCOM            1132
DMMFREE             11AA
DMMFRFND            1140
DMMFRLOP            1126
DMMFRSTO            1158
DMMINIT             10FE
DMMINIT:LOOP        110C
DMMNEXT             1142
DMMNEXTO            117A
DMMSYSID            0
EXTNUM              2
GOVSTRC             FFFFFF
GOVSTRX             23
GOVSTRY             F
GREEN               8000
GSSDFC              39DB44
GSSDINIT            19F8
GSSDPLOT            1A1C
GSSDTYPE            2
GSSDUPD             1A02
GSSDUPD:END         1A12
GSSDUPD:KILL        1A16
GSSDWDTH            A
INTPRSC             80
INTPRSF             31A0001
INTPRSX             5
INTPRSY             8
INTTITC             FFFF
INTTITF             33D0001
INTTITX             1
INTTITY             1
JUMPSIZE            3C
JUMPSPEED           3
KBDBITDN            3
KBDBITF1            4
KBDBITF2            5
KBDBITF3            6
KBDBITLF            0
KBDBITPS            7
KBDBITRT            2
KBDBITUP            1
KBDCHRDN            28
KBDCHRLF            25
KBDCHRMK            4D
KBDCHRPK            50
KBDCHRRT            27
KBDCHRSH            10
KBDCHRSP            20
KBDCHRUP            26
KBDDOWN             28
KBDEDGE             1C3F
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1090
KBDLEFT             25
KBDMSKDN            8
KBDMSKF1            10
KBDMSKF2            20
KBDMSKF3            40
KBDMSKLF            1
KBDMSKPS            80
KBDMSKRT            4
KBDMSKUP            2
KBDPAUSE            50
KBDREAD             10A6
KBDREAD:KEYSREADY   10E2
KBDREAD:LOOP        10C4
KBDREAD:NEXTKEYS    10C2
KBDREAD:NOTPRESSED  10CE
KBDRIGHT            27
KBDTRAP             0
KBDUP               26
KBDVAL              1C3E
MAXPOS              1C2E
NEWGNUM             1
PAUCNTY             8
PAUEXTY             C
PAUNEWY             A
PAUOPTC             FFFFFF
PAUOPTFS            1130005
PAUOPTFU            1130001
PAUOPTX             F
PAUSELC             FF
PAUTITC             FFFF
PAUTITF             3300001
PAUTITX             2
PAUTITY             1
PIPBWDT             32
PIPCOUNT            1C36
PIPEPOSX            1C38
PIPFC               196600
PIPINIT             1B04
PIPINIT:SKIP        1B20
PIPOPEN             50
PIPPC               0
PIPPLOT             1B6E
PIPPLOT:SKIP        1B92
PIPPLOT:SKP2        1B9A
PIPTBSPC            5
PIPTHGT             A
PIPTWDT             3C
PIPTYPE             3
PIPUPD              1B2A
PIPUPD:END          1B62
PIPUPD:KILL         1B68
PIPYSPD             2
PLRCOLOR            8000
PLRDEAD             1C34
PLRDOWNSPEED        1C32
PLREYECOLOR         FFFFFF
PLRHEIGHT           1E
PLRINIT             11C0
PLRINITPOSX         96
PLRINITPOSY         B4
PLRIRISCOLOR        0
PLRMOUTHCOLOR       FF
PLRPLOT             12B8
PLRPOSX             1C2A
PLRPOSY             1C2C
PLRUPD              11F0
PLRUPD:END          12B2
PLRUPD:GAMEOVER     12A6
PLRUPD:LASTJUMP     129A
PLRUPD:MAKEJUMP     1266
PLRUPD:PRESSED      1242
PLRWIDTH            1E
PMOPTN              1C3C
PRPADD              1556
PRPADD:END          156C
PRPKILL             11AA
PRPPLOT             159E
PRPPLOT:END         15C6
PRPPLOT:LOOP        15A6
PRPPLOT:NEXT        15C0
PRPUPD              1570
PRPUPD:END          1598
PRPUPD:LOOP         1578
PRPUPD:NEXT         1592
RED                 FF
SCRCYCCT            1C41
SCRHEIGH            1E0
SCRINIT             101C
SCRINTCT            1C40
SCRIRQ              1
SCRISR              1074
SCRTIM              14
SCRTRAP             1
SCRUPD              1082
SCRWIDTH            280
SPWUPD              15CC
SPWUPD:END          1604
STACUR              1C26
STAEMPTY            16A6
STAGOVR             3
STAGOVRP            1950
STAGOVRP:GOVSTR     1984
STAGOVRU            193A
STAGOVRU:END        194E
STAINIT             160A
STAINTR             0
STAINTRI            10FE
STAINTRP            16FA
STAINTRP:START_TEXT  175C
STAINTRP:TITLE      1750
STAINTRU            16E4
STAINTRU:END        16F8
STANEXT             1C28
STANONE             FFFFFFFF
STAPAU              2
STAPAUI             1772
STAPAUP             1814
STAPAUP:CNTSEL      1866
STAPAUP:CONT        191E
STAPAUP:EXIT        1934
STAPAUP:EXTSEL      18E6
STAPAUP:NEWG        1928
STAPAUP:NEWSEL      18A6
STAPAUP:SKPCNT      1876
STAPAUP:SKPEXT      18F6
STAPAUP:SKPNEW      18B6
STAPAUP:TITLE       1910
STAPAUU             177C
STAPAUU:CONTGAME    17F6
STAPAUU:DN          17C0
STAPAUU:END         17AC
STAPAUU:EXITGAME    180A
STAPAUU:JMPLST      17E4
STAPAUU:NEWGAME     1800
STAPAUU:OK          17D2
STAPAUU:UP          17AE
STAPLAY             1
STAPLAYI            11C0
STAPLAYP            16D2
STAPLAYU            16A8
STAPLAYU:PAUSE      16C8
STAPLOT             167A
STAPLOT:PLTTBL      1696
START               1BFE
START:LOOP          1C06
START:WINT          1C0C
STAUPD              161C
STAUPD:DOUPD        1642
STAUPD:INITBL       165A
STAUPD:UPDTBL       166A
SYSINIT             1000
UPPRESSED           1C30
UTLCHCOL            1370
UTLCHCOL:COL        139A
UTLCHCOL:END        13AE
UTLCHCOL:NOCOL      13A6
UTLFONT             37C
UTLINIT             1368
UTLLOCT             254
UTLRAND             13B4
UTLRAND:RANDVEC     13D2
UTLRNDIX            1C3D
UTLSFIL             12A
UTLSPEN             0
WHITE               FFFFFF
XSPEED              1C3A
