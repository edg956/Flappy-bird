00001C18 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 04/01/2019 15:19:12

00000000                             1  ; =============================================================================
00000000                             2  ; TITLE    : YET ANOTHER FLAPPY BIRD (YAF)
00000000                             3  ; AUTHORS  : DOÑAQUE, EUGENIO && LLABRÉS, NADAL.
00000000                             4  ; CREATION : DEC 2018
00000000                             5  ; =============================================================================
00000000                             6  
00001000                             7              ORG     $1000
00001000                             8  
00001000                             9  ; --- CODE INCLUDES -----------------------------------------------------------
00001000                            10  
00001000                            11              INCLUDE "SYSCONST.X68"               ; SYSTEM CONSTANTS
00001000                            12  ; =============================================================================
00001000                            13  ; SYSTEM CONSTANTS
00001000                            14  ; =============================================================================
00001000                            15  
00001000                            16  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
00001000                            17  
00001000  =00000000                 18  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
00001000  =00000001                 19  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
00001000                            20  
00001000                            21  ; --- KEY CODES (EASy68K)
00001000                            22  
00001000  =00000020                 23  KBDCHRSP    EQU     $20                     ; SPACE KEY
00001000  =0000004D                 24  KBDCHRMK    EQU     'M'                     ; M KEY
00001000  =00000010                 25  KBDCHRSH    EQU     $10                     ; SHIFT KEY
00001000  =00000050                 26  KBDCHRPK    EQU     'P'                     ; P KEY
00001000  =00000025                 27  KBDCHRLF    EQU     $25                     ; LEFT KEY
00001000  =00000026                 28  KBDCHRUP    EQU     $26                     ; UP KEY
00001000  =00000027                 29  KBDCHRRT    EQU     $27                     ; RIGHT KEY
00001000  =00000028                 30  KBDCHRDN    EQU     $28                     ; DOWN KEY
00001000                            31  
00001000                            32  ; --- KEYBOARD MAPPING --------------------------------------------------------
00001000                            33  
00001000  =00000025                 34  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
00001000  =00000026                 35  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
00001000  =00000027                 36  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
00001000  =00000028                 37  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
00001000  =00000020                 38  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
00001000  =0000004D                 39  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
00001000  =00000010                 40  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
00001000  =00000050                 41  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
00001000                            42  
00001000                            43  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
00001000                            44  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
00001000                            45  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
00001000                            46  ; +---+---+---+---+---+---+---+---+
00001000                            47  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
00001000                            48  ; +---+---+---+---+---+---+---+---+
00001000                            49  ;   |   |   |   |   |   |   |   |
00001000                            50  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
00001000                            51  ;   |   |   |   |   |   |   +-------------- UP BUTTON
00001000                            52  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
00001000                            53  ;   |   |   |   |   +---------------------- DOWN BUTTON
00001000                            54  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
00001000                            55  ;   |   |   +------------------------------ FIRE 2 BUTTON
00001000                            56  ;   |   +---------------------------------- FIRE 3 BUTTON
00001000                            57  ;   +-------------------------------------- PAUSE BUTTON
00001000                            58  
00001000  =00000001                 59  KBDMSKLF    EQU     %00000001
00001000  =00000002                 60  KBDMSKUP    EQU     %00000010
00001000  =00000004                 61  KBDMSKRT    EQU     %00000100
00001000  =00000008                 62  KBDMSKDN    EQU     %00001000
00001000  =00000010                 63  KBDMSKF1    EQU     %00010000
00001000  =00000020                 64  KBDMSKF2    EQU     %00100000
00001000  =00000040                 65  KBDMSKF3    EQU     %01000000
00001000  =00000080                 66  KBDMSKPS    EQU     %10000000
00001000                            67  
00001000                            68  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
00001000                            69  
00001000  =00000000                 70  KBDBITLF    EQU     0
00001000  =00000001                 71  KBDBITUP    EQU     1
00001000  =00000002                 72  KBDBITRT    EQU     2
00001000  =00000003                 73  KBDBITDN    EQU     3
00001000  =00000004                 74  KBDBITF1    EQU     4
00001000  =00000005                 75  KBDBITF2    EQU     5
00001000  =00000006                 76  KBDBITF3    EQU     6
00001000  =00000007                 77  KBDBITPS    EQU     7
00001000                            78  
00001000                            79  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
00001000                            80  
00001000  =00000280                 81  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
00001000  =000001E0                 82  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
00001000  =00000001                 83  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
00001000  =00000014                 84  SCRTIM      EQU     20                      ; SCREEN TIMER (MS)
00001000                            85  
00001000                            86  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
00001000                            87  
00001000  =00000040                 88  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001000  =00000032                 89  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001000  =00000000                 90  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001000                            91  
00001000                            92  
00001000                            93  
00001000                            94  
00001000                            95  -------------------- end include --------------------
00001000                            96              INCLUDE "SYSTEM.X68"                 ; SYSTEM CODE
00001000                            97  ; =============================================================================
00001000                            98  ; SYSTEM MANAGEMENT (SYSTEM CODE)
00001000                            99  ; =============================================================================
00001000                           100  
00001000                           101  ; -----------------------------------------------------------------------------
00001000                           102  SYSINIT
00001000                           103  ; INITIALIZES THE SYSTEM
00001000                           104  ; INPUT    - NONE
00001000                           105  ; OUTPUT   - NONE
00001000                           106  ; MODIFIES - NONE
00001000                           107  ; -----------------------------------------------------------------------------
00001000  205F                     108              MOVE.L  (A7)+,A0                ; GET RETURN ADDRESS
00001002  4EB9 00001090            109              JSR     KBDINIT                 ; INIT KEYBOARD
00001008  4EB9 0000101C            110              JSR     SCRINIT                 ; INIT SCREEN
0000100E  4EB9 000010FE            111              JSR     DMMINIT                 ; INIT DYNAMIC MEMORY
00001014  027C DFFF                112              ANDI.W  #$DFFF,SR               ; SWITCH TO USER
00001018  2F08                     113              MOVE.L  A0,-(A7)                ; PUT RETURN ADDRESS
0000101A  4E75                     114              RTS
0000101C                           115  
0000101C                           116  ; =============================================================================
0000101C                           117  ; SCREEN MANAGEMENT (SYSTEM CODE)
0000101C                           118  ; =============================================================================
0000101C                           119  
0000101C                           120  ; -----------------------------------------------------------------------------
0000101C                           121  SCRINIT
0000101C                           122  ; INITIALIZES THE SCREEN, SCREEN-RELATED INTERRUPT AND VARS.
0000101C                           123  ; INPUT    - NONE
0000101C                           124  ; OUTPUT   - NONE
0000101C                           125  ; MODIFIES - D0,D1,D2,D3
0000101C                           126  ; -----------------------------------------------------------------------------
0000101C                           127              ; TO DO:
0000101C                           128              ; - DISABLE INTS (SET INT BITS IN SR TO 111)
0000101C                           129              
0000101C  007C 0700                130              ORI.W #(7<<8)&$700,SR
00001020                           131              
00001020                           132              ; - INSTALL SCRUPD INTO TRAP SCRTRAP
00001020                           133              
00001020  21FC 00001082 0084       134              MOVE.L  #SCRUPD,($80+4*SCRTRAP)
00001028                           135              
00001028                           136              ; - SET RESOLUTION TO SCRWIDTH X SCRHEIGHT
00001028                           137              
00001028  7021                     138              MOVE.L  #33,D0
0000102A  223C 028001E0            139              MOVE.L  #SCRWIDTH*$10000+SCRHEIGH,D1
00001030  4E4F                     140              TRAP    #15
00001032                           141              
00001032                           142              ; - SET WINDOWED MODE
00001032                           143              
00001032  7201                     144              MOVEQ   #1, D1 
00001034  4E4F                     145              TRAP    #15
00001036                           146              
00001036                           147              ; - CLEAR VISIBLE BUFFER
00001036                           148              
00001036  700B                     149              MOVEQ   #11, D0
00001038  323C FF00                150              MOVE.W  #$FF00,D1
0000103C  4E4F                     151              TRAP    #15
0000103E                           152              
0000103E                           153              ; - ENABLE DOUBLE BUFFER
0000103E                           154              
0000103E  705C                     155              MOVEQ   #92, D0
00001040  7211                     156              MOVEQ   #17, D1     
00001042  4E4F                     157              TRAP    #15
00001044                           158              
00001044                           159              ; - CLEAR HIDDEN BUFFER
00001044                           160              
00001044  700B                     161              MOVEQ   #11, D0
00001046  323C FF00                162              MOVE.W  #$FF00,D1
0000104A  4E4F                     163              TRAP    #15
0000104C                           164              
0000104C                           165              ; - INSTALL SCRISR FOR IRQ SCRIRQ (IRQ INTERRUPT VECTOR BEGINS
0000104C                           166              ;   AT $60. INSTALLATION IS SIMILAR TO TRAP INSTALLATION)
0000104C                           167              
0000104C  21FC 00001074 0064       168              MOVE.L  #SCRISR,($60+4*SCRIRQ)
00001054                           169              
00001054                           170              ; - ENABLE AUTO-IRQ EVERY SCRTIM MS FOR IRQ SCRIRQ (SEE TRAP #15
00001054                           171              ;   TASK 32)
00001054                           172              
00001054  7020                     173              MOVEQ   #32,D0
00001056  7206                     174              MOVEQ   #6,D1
00001058  243C 00000081            175              MOVE.L  #$80+SCRIRQ,D2
0000105E  7614                     176              MOVE.L  #SCRTIM, D3
00001060  4E4F                     177              TRAP    #15
00001062                           178              
00001062                           179              ; - CLEAR SCRINTCT AND SCRCYCCT
00001062                           180              
00001062  4239 00001C66            181              CLR.B   (SCRINTCT)
00001068  4239 00001C67            182              CLR.B   (SCRCYCCT)
0000106E                           183              
0000106E                           184              ; - ENABLE INTS (SET INT BITS IN SR TO 000)
0000106E                           185              
0000106E  027C F8FF                186              ANDI.W #$F8FF,SR
00001072                           187              
00001072  4E75                     188              RTS
00001074                           189  
00001074                           190  ; -----------------------------------------------------------------------------
00001074                           191  SCRISR
00001074                           192  ; SCREEN TIMER ISR. INCREASES THE INTERRUPT COUNTER AND UPDATES DOUBLE BUFFER.
00001074                           193  ; INPUT    - NONE
00001074                           194  ; OUTPUT   - NONE
00001074                           195  ; MODIFIES - NONE
00001074                           196  ; -----------------------------------------------------------------------------
00001074  5239 00001C66            197              ADDQ.B  #1,(SCRINTCT)           ; UPDATE INT FLAG/COUNTER
0000107A  5239 00001C67            198              ADDQ.B  #1,(SCRCYCCT)           ; UPDATE CYCLE COUNTER
00001080  4E73                     199              RTE
00001082                           200  
00001082                           201  ; -----------------------------------------------------------------------------
00001082                           202  SCRUPD
00001082                           203  ; TRAP SERVICE ROUTINE IN CHARGE OF VISUALIZING CURRENT FRAME AND CLEARING
00001082                           204  ; BUFFER FOR THE NEXT ONE.
00001082                           205  ; INPUT    - NONE
00001082                           206  ; OUTPUT   - NONE
00001082                           207  ; MODIFIES - NONE
00001082                           208  ; -----------------------------------------------------------------------------
00001082                           209              ; TO DO: UPDATE DOUBLE BUFFER AND CLEAR HIDDEN BUFFER
00001082                           210              ; - UPDATE DOUBLE BUFFER
00001082                           211              
00001082  705E                     212              MOVEQ   #94,D0
00001084  4E4F                     213              TRAP    #15
00001086                           214              
00001086                           215              ; - CLEAR HIDDEN BUFFER
00001086                           216                                 
00001086  700B                     217              MOVEQ   #11, D0
00001088  323C FF00                218              MOVE.W  #$FF00,D1
0000108C  4E4F                     219              TRAP    #15
0000108E                           220              
0000108E  4E73                     221              RTE
00001090                           222  
00001090                           223  ; =============================================================================
00001090                           224  ; KEYBOARD MANAGEMENT (SYSTEM CODE)
00001090                           225  ; =============================================================================
00001090                           226  
00001090                           227  ; -----------------------------------------------------------------------------
00001090                           228  KBDINIT
00001090                           229  ; INITIALIZES THE SYSTEM VARIABLES KBDSYS AND KBDVAL
00001090                           230  ; INPUT    - NONE
00001090                           231  ; OUTPUT   - NONE
00001090                           232  ; MODIFIES - NONE
00001090                           233  ; -----------------------------------------------------------------------------
00001090  4239 00001C64            234              CLR.B   (KBDVAL)                ; INIT VARS
00001096  4239 00001C65            235              CLR.B   (KBDEDGE)
0000109C  21FC 000010A6 0080       236              MOVE.L  #KBDREAD,($80+KBDTRAP*4) ; INSTALL
000010A4  4E75                     237              RTS
000010A6                           238  
000010A6                           239  ; -----------------------------------------------------------------------------
000010A6                           240  KBDREAD
000010A6                           241  ; TRAP SERVICE ROUTINE.
000010A6                           242  ; UPDATES THE SYSTEM VARIABLES KBDEDGE AND KBDVAL ACCORDING TO THE BITFIELD
000010A6                           243  ; DESCRIBED IN SYSCONST. KBDVAL HOLDS THE CURRENT VALUES AND KBDEFGE HOLDS
000010A6                           244  ; RISING EDGES FROM PREVIOUS CALL TO THE CURRENT ONE.
000010A6                           245  ; INPUT    - NONE
000010A6                           246  ; OUTPUT   - (KBDVAL) AND (KBDEDGE)
000010A6                           247  ; MODIFIES - NONE
000010A6                           248  ; -----------------------------------------------------------------------------
000010A6                           249              ; TO DO: UPDATE KBDVAL AND KBDEDGE
000010A6                           250              ;Guardar registros en pila
000010A6  48E7 F800                251              MOVEM.L D0-D4,-(A7)
000010AA                           252  
000010AA                           253              ;Obtener estado de teclas
000010AA  7013                     254              MOVEQ   #19,D0
000010AC                           255              
000010AC                           256              ;Obtener estado de teclas PAUSE - FIRE3 - FIRE2 - FIRE1
000010AC  223C 50104D20            257              MOVE.L  #KBDCHRPK<<24+KBDCHRSH<<16+KBDCHRMK<<8+KBDCHRSP,D1
000010B2                           258              
000010B2  4E4F                     259              TRAP    #15
000010B4                           260              
000010B4                           261              ;GUARDAR ESTADO DE TECLAS
000010B4  2401                     262              MOVE.L  D1,D2                   
000010B6                           263              
000010B6                           264              ;Obtener estado de teclas DOWN - RIGHT - UP - LEFT
000010B6  223C 28272625            265              MOVE.L  #KBDCHRDN<<24+KBDCHRRT<<16+KBDCHRUP<<8+KBDCHRLF,D1
000010BC                           266  
000010BC  4E4F                     267              TRAP    #15
000010BE                           268            
000010BE                           269              ;Actualizar valores de KBDVAL
000010BE  4243                     270              CLR     D3        ;Registro que contendrá KBDVAL.
000010C0  4244                     271              CLR     D4        ;Registro con índice de bit a modificar de D3.
000010C2                           272              
000010C2                           273              
000010C2                           274              ;Bucle que recorre D1 para obtener estado de teclas.
000010C2  7003                     275  .NEXTKEYS   MOVEQ   #3, D0    ;Número de iteraciones del bucle (.LOOP).
000010C4                           276  
000010C4                           277  .LOOP                   
000010C4  0801 0000                278              BTST    #0, D1
000010C8  6700 0004                279              BEQ     .NOTPRESSED
000010CC                           280              ;If pressed, set corresponding bit
000010CC  09C3                     281              BSET    D4, D3                  
000010CE                           282                        
000010CE                           283  .NOTPRESSED              
000010CE                           284              *En cualquier caso, obtener siguiente byte de D1*
000010CE                           285              
000010CE                           286              ;Se desplaza el registro D1 8 bits a la derecha. 
000010CE  E089                     287              LSR.L   #8, D1
000010D0                           288              
000010D0                           289              ;Se incrementa el índice de D3.
000010D0  5244                     290              ADDQ    #1, D4
000010D2  51C8 FFF0                291              DBRA    D0, .LOOP
000010D6                           292              
000010D6                           293              ;Comprobar si hay que analizar el segundo conjunto de teclas. 
000010D6  B83C 0004                294              CMP.B   #4, D4
000010DA  6600 0006                295              BNE     .KEYSREADY            
000010DE                           296             
000010DE                           297              ;Se mueve el segundo conjunto de teclas al registro D1 y se
000010DE                           298              ;repite el bucle .LOOP.
000010DE  2202                     299              MOVE.L  D2, D1
000010E0  60E0                     300              BRA     .NEXTKEYS
000010E2                           301  
000010E2                           302  .KEYSREADY  
000010E2                           303              ;Recuperamos el anterior KBDVAL en D4.
000010E2  1839 00001C64            304              MOVE.B  (KBDVAL), D4
000010E8                           305              ;Se mueve el byte obtenido a KBDVAL.         
000010E8  13C3 00001C64            306              MOVE.B  D3, KBDVAL 
000010EE                           307  
000010EE  4604                     308              NOT.B   D4
000010F0  C604                     309              AND.B   D4, D3
000010F2  13C3 00001C65            310              MOVE.B  D3, (KBDEDGE)             
000010F8                           311              
000010F8                           312              ;Restaurar registros a su estado original. 
000010F8  4CDF 001F                313              MOVEM.L (A7)+,D0-D4
000010FC                           314  
000010FC  4E73                     315              RTE
000010FE                           316  
000010FE                           317  ; =============================================================================
000010FE                           318  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
000010FE                           319  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
000010FE                           320  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
000010FE                           321  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
000010FE                           322  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
000010FE                           323  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
000010FE                           324  ; =============================================================================
000010FE                           325  
000010FE                           326  ; -----------------------------------------------------------------------------
000010FE                           327  DMMINIT
000010FE                           328  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
000010FE                           329  ; INPUT    - NONE
000010FE                           330  ; OUTPUT   - NONE
000010FE                           331  ; MODIFIES - NONE
000010FE                           332  ; -----------------------------------------------------------------------------
000010FE  48E7 8080                333              MOVEM.L D0/A0,-(A7)
00001102  41F9 00001C80            334              LEA     DMMDATA,A0
00001108  303C 0031                335              MOVE.W  #DMMBNUM-1,D0
0000110C  30BC 0000                336  .LOOP       MOVE.W  #DMMSYSID,(A0)
00001110  D1FC 00000040            337              ADD.L   #DMMBSIZE,A0
00001116  51C8 FFF4                338              DBRA.W  D0,.LOOP
0000111A  4CDF 0101                339              MOVEM.L (A7)+,D0/A0
0000111E  4E75                     340              RTS
00001120                           341  
00001120                           342  ; -----------------------------------------------------------------------------
00001120                           343  DMMFIRST
00001120                           344  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001120                           345  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001120                           346  ; INPUT    - NONE
00001120                           347  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001120                           348  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001120                           349  ; -----------------------------------------------------------------------------
00001120  41F9 00001C80            350              LEA     DMMDATA,A0
00001126  4A58                     351  DMMFRLOP    TST.W   (A0)+
00001128  6600 0016                352              BNE     DMMFRFND
0000112C  D1FC 0000003E            353              ADD.L   #DMMBSIZE-2,A0
00001132  B1FC 000028FF            354  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001138  6DEC                     355              BLT     DMMFRLOP
0000113A  207C 00000000            356              MOVE.L  #0,A0
00001140  4E75                     357  DMMFRFND    RTS
00001142                           358  
00001142                           359  ; -----------------------------------------------------------------------------
00001142                           360  DMMNEXT
00001142                           361  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001142                           362  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001142                           363  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
00001142                           364  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001142                           365  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001142                           366  ; -----------------------------------------------------------------------------
00001142  2F00                     367              MOVE.L  D0,-(A7)
00001144  2008                     368              MOVE.L  A0,D0
00001146  C0BC FFFFFFC0            369              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
0000114C  0680 00000040            370              ADD.L   #DMMBSIZE,D0
00001152  2040                     371              MOVE.L  D0,A0
00001154  201F                     372              MOVE.L  (A7)+,D0
00001156  60DA                     373              BRA     DMMFRCOM
00001158                           374  
00001158                           375  ; -----------------------------------------------------------------------------
00001158                           376  DMMFRSTO
00001158                           377  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
00001158                           378  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001158                           379  ; INPUT    - D0.W : ID TO SEARCH
00001158                           380  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001158                           381  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001158                           382  ; -----------------------------------------------------------------------------
00001158  41F9 00001C80            383              LEA     DMMDATA,A0
0000115E  B058                     384  DMMFLOOP    CMP.W   (A0)+,D0
00001160  6700 0016                385              BEQ     DMMFFND
00001164  D1FC 0000003E            386              ADD.L   #DMMBSIZE-2,A0
0000116A  B1FC 000028FF            387  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001170  6DEC                     388              BLT     DMMFLOOP
00001172  207C 00000000            389              MOVE.L  #0,A0
00001178  4E75                     390  DMMFFND     RTS
0000117A                           391  
0000117A                           392  ; -----------------------------------------------------------------------------
0000117A                           393  DMMNEXTO
0000117A                           394  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000117A                           395  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000117A                           396  ; INPUT    - D0.W : ID TO SEARCH
0000117A                           397  ;            A0   : POINTER WITHIN THE CURRENT SLOT
0000117A                           398  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000117A                           399  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000117A                           400  ; -----------------------------------------------------------------------------
0000117A  2F00                     401              MOVE.L  D0,-(A7)
0000117C  2008                     402              MOVE.L  A0,D0
0000117E  C0BC FFFFFFC0            403              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001184  0680 00000040            404              ADD.L   #DMMBSIZE,D0
0000118A  2040                     405              MOVE.L  D0,A0
0000118C  201F                     406              MOVE.L  (A7)+,D0
0000118E  60DA                     407              BRA     DMMFCOM
00001190                           408  
00001190                           409  ; -----------------------------------------------------------------------------
00001190                           410  DMMALLOC
00001190                           411  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
00001190                           412  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
00001190                           413  ; INPUT    - D0.W : ID TO ASSIGN
00001190                           414  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
00001190                           415  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001190                           416  ; -----------------------------------------------------------------------------
00001190  3F00                     417              MOVE.W  D0,-(A7)
00001192  4240                     418              CLR.W   D0
00001194  4EB8 1158                419              JSR     DMMFRSTO
00001198  301F                     420              MOVE.W  (A7)+,D0
0000119A  B1FC 00000000            421              CMP.L   #0,A0
000011A0  6700 0006                422              BEQ     .END
000011A4  3140 FFFE                423              MOVE.W  D0,-2(A0)
000011A8  4E75                     424  .END        RTS
000011AA                           425  
000011AA                           426  ; -----------------------------------------------------------------------------
000011AA                           427  DMMFREE
000011AA                           428  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000011AA                           429  ; SYSTEM (0)
000011AA                           430  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000011AA                           431  ; OUTPUT   - NONE
000011AA                           432  ; MODIFIES - NONE
000011AA                           433  ; -----------------------------------------------------------------------------
000011AA  48E7 8080                434              MOVEM.L D0/A0,-(A7)
000011AE  2008                     435              MOVE.L  A0,D0
000011B0  C0BC FFFFFFC0            436              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000011B6  2040                     437              MOVE.L  D0,A0
000011B8  4250                     438              CLR.W   (A0)
000011BA  4CDF 0101                439              MOVEM.L (A7)+,D0/A0
000011BE  4E75                     440              RTS
000011C0                           441  
000011C0                           442  
000011C0                           443  
000011C0                           444  
000011C0                           445  -------------------- end include --------------------
000011C0                           446              INCLUDE "SYSCONST.X68"               ; SYSTEM CONSTANTS
000011C0                           447  ; =============================================================================
000011C0                           448  ; SYSTEM CONSTANTS
000011C0                           449  ; =============================================================================
000011C0                           450  
000011C0                           451  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
000011C0                           452  
000011C0  =00000000                453  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
000011C0  =00000001                454  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
000011C0                           455  
000011C0                           456  ; --- KEY CODES (EASy68K)
000011C0                           457  
000011C0  =00000020                458  KBDCHRSP    EQU     $20                     ; SPACE KEY
000011C0  =0000004D                459  KBDCHRMK    EQU     'M'                     ; M KEY
000011C0  =00000010                460  KBDCHRSH    EQU     $10                     ; SHIFT KEY
000011C0  =00000050                461  KBDCHRPK    EQU     'P'                     ; P KEY
000011C0  =00000025                462  KBDCHRLF    EQU     $25                     ; LEFT KEY
000011C0  =00000026                463  KBDCHRUP    EQU     $26                     ; UP KEY
000011C0  =00000027                464  KBDCHRRT    EQU     $27                     ; RIGHT KEY
000011C0  =00000028                465  KBDCHRDN    EQU     $28                     ; DOWN KEY
000011C0                           466  
000011C0                           467  ; --- KEYBOARD MAPPING --------------------------------------------------------
000011C0                           468  
000011C0  =00000025                469  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
000011C0  =00000026                470  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
000011C0  =00000027                471  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
000011C0  =00000028                472  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
000011C0  =00000020                473  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
000011C0  =0000004D                474  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
000011C0  =00000010                475  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
000011C0  =00000050                476  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
000011C0                           477  
000011C0                           478  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
000011C0                           479  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
000011C0                           480  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
000011C0                           481  ; +---+---+---+---+---+---+---+---+
000011C0                           482  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
000011C0                           483  ; +---+---+---+---+---+---+---+---+
000011C0                           484  ;   |   |   |   |   |   |   |   |
000011C0                           485  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
000011C0                           486  ;   |   |   |   |   |   |   +-------------- UP BUTTON
000011C0                           487  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
000011C0                           488  ;   |   |   |   |   +---------------------- DOWN BUTTON
000011C0                           489  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
000011C0                           490  ;   |   |   +------------------------------ FIRE 2 BUTTON
000011C0                           491  ;   |   +---------------------------------- FIRE 3 BUTTON
000011C0                           492  ;   +-------------------------------------- PAUSE BUTTON
000011C0                           493  
000011C0  =00000001                494  KBDMSKLF    EQU     %00000001
000011C0  =00000002                495  KBDMSKUP    EQU     %00000010
000011C0  =00000004                496  KBDMSKRT    EQU     %00000100
000011C0  =00000008                497  KBDMSKDN    EQU     %00001000
000011C0  =00000010                498  KBDMSKF1    EQU     %00010000
000011C0  =00000020                499  KBDMSKF2    EQU     %00100000
000011C0  =00000040                500  KBDMSKF3    EQU     %01000000
000011C0  =00000080                501  KBDMSKPS    EQU     %10000000
000011C0                           502  
000011C0                           503  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
000011C0                           504  
000011C0  =00000000                505  KBDBITLF    EQU     0
000011C0  =00000001                506  KBDBITUP    EQU     1
000011C0  =00000002                507  KBDBITRT    EQU     2
000011C0  =00000003                508  KBDBITDN    EQU     3
000011C0  =00000004                509  KBDBITF1    EQU     4
000011C0  =00000005                510  KBDBITF2    EQU     5
000011C0  =00000006                511  KBDBITF3    EQU     6
000011C0  =00000007                512  KBDBITPS    EQU     7
000011C0                           513  
000011C0                           514  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
000011C0                           515  
000011C0  =00000280                516  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
000011C0  =000001E0                517  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
000011C0  =00000001                518  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
000011C0  =00000014                519  SCRTIM      EQU     20                      ; SCREEN TIMER (MS)
000011C0                           520  
000011C0                           521  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
000011C0                           522  
000011C0  =00000040                523  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
000011C0  =00000032                524  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
000011C0  =00000000                525  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
000011C0                           526  
000011C0                           527  
000011C0                           528  
000011C0                           529  
000011C0                           530  -------------------- end include --------------------
000011C0                           531              INCLUDE "CONST.X68"                  ; USER CONSTANTS
000011C0                           532  ; =============================================================================
000011C0                           533  ; SYSTEM CONSTANTS
000011C0                           534  ; =============================================================================
000011C0                           535  
000011C0                           536  ; --- GAME STATES -------------------------------------------------------------
000011C0                           537  
000011C0  =FFFFFFFF                538  STANONE     EQU     -1                      ; PLACEHOLDER TO FORCE CHANGE
000011C0  =00000000                539  STAINTR     EQU     0                       ; INTRO/PRESS FIRE STATE
000011C0  =00000001                540  STAPLAY     EQU     1                       ; NORMAL GAME STATE
000011C0  =00000002                541  STAPAU      EQU     2                       ; PAUSE GAME STATE
000011C0  =00000003                542  STAGOVR     EQU     3                       ; GAME OVER STATE
000011C0                           543  
000011C0                           544  ; --- AGENT & PROP TYPES -------------------------------------------------------------
000011C0                           545  
000011C0  =00000001                546  CLDTYPE     EQU     1                       ; NUMBER FOR CLOUD TYPES
000011C0  =00000002                547  GSSDTYPE    EQU     2                       ; NUMBER FOR GRASS DETAIL TYPES
000011C0  =00000003                548  PIPTYPE     EQU     3                       ; NUMBER FOR PIPE TYPES
000011C0                           549  
000011C0                           550  
000011C0                           551  ; --- INTRO STATE RELATED CONSTANTS -------------------------------------------
000011C0                           552  
000011C0  =00000001                553  INTTITX     EQU     1                       ; TITLE X COORDINATE
000011C0  =00000001                554  INTTITY     EQU     1                       ; TITLE Y COORDINATE
000011C0  =0000FFFF                555  INTTITC     EQU     $0000FFFF               ; TITLE COLOR
000011C0  =033D0001                556  INTTITF     EQU     $033D0001               ; TITLE FONT
000011C0  =00000005                557  INTPRSX     EQU     5                       ; PRESS FIRE X COORDINATE
000011C0  =00000008                558  INTPRSY     EQU     8                       ; PRESS FIRE Y COORDINATE
000011C0  =00000080                559  INTPRSC     EQU     $00000080               ; PRESS FIRE COLOR
000011C0  =031A0001                560  INTPRSF     EQU     $031A0001               ; PRESS FIRE FONT
000011C0                           561  
000011C0                           562  ; --- BACKGROUND RELATED CONSTANTS --------------------------------------------
000011C0                           563  
000011C0  =00000000                564  BGSKYPC     EQU     $00000000               ; BACKGROUND SKY PEN COLOUR
000011C0  =00EFCE87                565  BGSKYFC     EQU     $00EFCE87               ; BACKGROUND SKY FILL COLOUR
000011C0  =00000000                566  BGGSSPC     EQU     $00000000               ; BACKGROUND GRASS PEN COLOUR
000011C0  =0000990A                567  BGGSSFC     EQU     $0000990A               ; BACKGROUND GRASS FILL COLOUR
000011C0  =00000168                568  BGGSSTP     EQU     SCRHEIGH*3/4            ; GRASS TOP EDGE (Y) COORDINATE
000011C0  =00000190                569  BGGSSBT     EQU     BGGSSTP+40              ; GRASS BOTTOM EDGE (Y) COORDINATE
000011C0  =0000000A                570  GSSDWDTH    EQU     10                      ; GRASS DETAIL WIDTH
000011C0  =0039DB44                571  GSSDFC      EQU     $0039DB44               ; BACKGROUND GRASS DETAIL F.COLOUR
000011C0  =00000000                572  BGGNDPC     EQU     $00000000               ; BACKGROUND GROUND PEN COLOUR
000011C0  =00155DD8                573  BGGNDFC     EQU     $00155DD8               ; BACKGROUND GROUND FILL COLOUR
000011C0  =00000190                574  BGGNDTP     EQU     BGGSSBT                 ; GROUND TOP EDGE (Y) COORDINATE
000011C0                           575  
000011C0                           576  ; --- PLAYER RELATED CONSTANTS ------------------------------------------------
000011C0                           577  
000011C0                           578        ;Player colours
000011C0                           579  
000011C0  =00008000                580  GREEN EQU $00008000                         ;GREEN COLOR
000011C0  =000000FF                581  RED   EQU $000000FF                         ;RED COLOR
000011C0  =00FFFFFF                582  WHITE EQU $00FFFFFF                         ;WHITE COLOR
000011C0  =00000000                583  BLACK EQU $00000000                         ;BLACK COLOR
000011C0                           584  
000011C0                           585        ;Constants
000011C0                           586        
000011C0  =00008000                587  PLRCOLOR        EQU GREEN                   ;PLAYER COLOR
000011C0  =00FFFFFF                588  PLREYECOLOR     EQU WHITE                   ;PLAYER EYE COLOR
000011C0  =00000000                589  PLRIRISCOLOR    EQU BLACK                   ;PLAYER IRIS COLOR
000011C0  =000000FF                590  PLRMOUTHCOLOR   EQU RED                     ;PLAYER MOUTH COLOR
000011C0  =00000019                591  PLRWIDTH        EQU 25                      ;PLAYER WIDTH
000011C0  =00000019                592  PLRHEIGHT       EQU 25                      ;PLAYER HEIGHT
000011C0  =00000096                593  PLRINITPOSX     EQU 150                     ;INITIAL POSITION OF THE PLAYER (X)
000011C0  =000000B4                594  PLRINITPOSY     EQU 180                     ;INITIAL POSITION OF THE PLAYER (Y)
000011C0  =0000003C                595  JUMPSIZE        EQU 60                      ;JUMP SIZE
000011C0  =00000003                596  JUMPSPEED       EQU 3                       ;JUMP SPEED (BIG VALUE = SLOW SPEED).
000011C0                           597  
000011C0                           598  ; --- PIPE RELATED CONSTANTS --------------------------------------------------
000011C0                           599  
000011C0  =00000000                600  PIPPC       EQU     $00000000               ; PIPE PEN COLOUR
000011C0  =00196600                601  PIPFC       EQU     $00196600               ; PIPE FILL COLOUR
000011C0  =00000032                602  PIPBWDT     EQU     50                      ; PIPE BASE WIDTH
000011C0  =0000003C                603  PIPTWDT     EQU     60                      ; PIPE MOUTH WIDTH
000011C0  =0000000A                604  PIPTHGT     EQU     10                      ; PIPE MOUTH HEIGHT
000011C0  =00000005                605  PIPTBSPC    EQU     ((PIPTWDT-PIPBWDT)/2)   ; DIF.BETW. OUTER RAD. & IN. RAD
000011C0  =00000064                606  PIPOPEN     EQU     100                      ; SPACE BETW. TOP AND BOTTOM PIPES
000011C0  =00000002                607  PIPYSPD     EQU     2                       ; SPEED @ WHICH PIPES GO UP&DOWN
000011C0                           608  
000011C0                           609  ; --- CLOUD RELATED CONSTANTS -------------------------------------------------
000011C0                           610  
000011C0  =0000003C                611  CLDSIZE     EQU     60                      ; CLOUD DIAMETER
000011C0  =00FFFFFF                612  CLDPCLR     EQU     $00FFFFFF               ; CLOUD PEN COLOR
000011C0  =00FFFFFF                613  CLDFCLR     EQU     $00FFFFFF               ; CLOUD FIL COLOR
000011C0                           614  
000011C0                           615  ; --- PAUSE STATE RELATED CONSTANTS ---------------------------------------
000011C0                           616  
000011C0  =00000000                617  CONTNUM     EQU     0                       ; CONTINUE GAME NUMBER
000011C0  =00000001                618  NEWGNUM     EQU     1                       ; NEW GAME NUMBER
000011C0  =00000002                619  EXTNUM      EQU     2                       ; EXIT GAME NUMBER
000011C0  =0000FFFF                620  PAUTITC     EQU     $0000FFFF               ; TITLE COLOUR
000011C0  =03300001                621  PAUTITF     EQU     $03300001               ; TITLE FONT
000011C0  =01130001                622  PAUOPTFU    EQU     $01130001               ; OPTION FONT (unselected)
000011C0  =01130005                623  PAUOPTFS    EQU     $01130005               ; OPTION FONT (selected)
000011C0  =00FFFFFF                624  PAUOPTC     EQU     $00FFFFFF               ; OPTION COLOUR
000011C0  =00000002                625  PAUTITX     EQU     2                       ; TITLE COORD. X
000011C0  =00000001                626  PAUTITY     EQU     1                       ; TITLE COORD. Y
000011C0  =0000000F                627  PAUOPTX     EQU     15                      ; OPTIONS COORD. X
000011C0  =00000008                628  PAUCNTY     EQU     8                       ; CONTINUE OPTION COORD. Y
000011C0  =0000000A                629  PAUNEWY     EQU     10                      ; NEW GAME OPTION COORD. Y
000011C0  =0000000C                630  PAUEXTY     EQU     12                      ; EXIT OPTION COORD. Y
000011C0  =000000FF                631  PAUSELC     EQU     $000000FF               ; SELECTED OPTION COLOUR
000011C0                           632  
000011C0                           633  ; --- GAME OVER STATE RELATED CONSTANTS ---------------------------------------
000011C0                           634  
000011C0  =00000023                635  GOVSTRX     EQU     35                      ; TITLE X COORDINATE
000011C0  =0000000F                636  GOVSTRY     EQU     15                      ; TITLE Y COORDINATE
000011C0  =00FFFFFF                637  GOVSTRC     EQU     $00FFFFFF               ; TITLE COLOR
000011C0                           638  
000011C0                           639  
000011C0                           640  
000011C0                           641  
000011C0                           642  
000011C0                           643  
000011C0                           644  
000011C0                           645  
000011C0                           646  
000011C0                           647  
000011C0                           648  
000011C0                           649  
000011C0                           650  
000011C0                           651  
000011C0                           652  
000011C0                           653  
000011C0                           654  
000011C0                           655  
000011C0                           656  
000011C0                           657  
000011C0                           658  
000011C0                           659  
000011C0                           660  
000011C0                           661  
000011C0                           662  
000011C0                           663  
000011C0                           664  
000011C0                           665  
000011C0                           666  
000011C0                           667  
000011C0                           668  
000011C0                           669  
000011C0                           670  
000011C0                           671  -------------------- end include --------------------
000011C0                           672              INCLUDE "PLAYER.X68"
000011C0                           673  ; =============================================================================
000011C0                           674  ; PLAYER MANAGEMENT
000011C0                           675  ; =============================================================================
000011C0                           676  
000011C0                           677  ; -----------------------------------------------------------------------------
000011C0                           678  PLRINIT
000011C0                           679  ; INITIALIZES THE PLAYER
000011C0                           680  ; INPUT    - NONE
000011C0                           681  ; OUTPUT   - NONE
000011C0                           682  ; MODIFIES - NONE
000011C0                           683  ; -----------------------------------------------------------------------------
000011C0                           684  
000011C0  33FC 0096 00001C44       685          MOVE.W #PLRINITPOSX,(PLRPOSX)
000011C8  33FC 00B4 00001C46       686          MOVE.W #PLRINITPOSY,(PLRPOSY)
000011D0  33FC 00B4 00001C48       687          MOVE.W #PLRINITPOSY,(MAXPOS)
000011D8  33FC 0000 00001C4A       688          MOVE.W #0, (UPPRESSED)
000011E0  33FC 0001 00001C4C       689          MOVE.W #1, (PLRDOWNSPEED)
000011E8  23FC 00000000 00001C50   690          MOVE.L #0, (PLRSCORE)
000011F2  23FC 00000000 00001C4E   691          MOVE.L #0, (PLRDEAD)               ;Poner a 0 PLRDEAD (Jugador vivo).
000011FC                           692  
000011FC  4E75                     693          RTS
000011FE                           694  ; -----------------------------------------------------------------------------
000011FE                           695  PLRUPD
000011FE                           696  ; UPDATES THE PLAYER MOTION
000011FE                           697  ; INPUT    - NONE (ACCESSES KBDEDGE)
000011FE                           698  ; OUTPUT   - NONE (MODIFIES PLAYER DATA)
000011FE                           699  ; MODIFIES - NONE
000011FE                           700  ; -----------------------------------------------------------------------------
000011FE  48E7 F000                701            MOVEM.L D0/D1/D2/D3,-(A7)
00001202  0839 0001 00001C65       702            BTST.B #KBDBITUP, (KBDEDGE)    
0000120A  6600 0044                703            BNE.L  .PRESSED
0000120E                           704          
0000120E                           705           ;Comprobar colisión con tubería. 
0000120E  0C79 0001 00001C4E       706            CMP #1, (PLRDEAD)
00001216  6700 009C                707            BEQ .GAMEOVER 
0000121A                           708          
0000121A                           709            ;TECLA NO PRESIONADA
0000121A  0C79 0001 00001C4A       710            CMP #1, (UPPRESSED)
00001222  6700 0050                711            BEQ .MAKEJUMP
00001226                           712            ;No se ha apretado la tecla UP. Hay que bajar el pájaro. 
00001226  3039 00001C46            713            MOVE.W (PLRPOSY), D0
0000122C  D079 00001C4C            714            ADD.W (PLRDOWNSPEED), D0
00001232                           715            ;Se incrementa la velocidad de bajada. 
00001232  5279 00001C4C            716            ADDQ #1, (PLRDOWNSPEED)
00001238  33C0 00001C46            717            MOVE.W D0, (PLRPOSY)
0000123E                           718           
0000123E                           719            ;Comprobar si ha salido por la parte inferior
0000123E  323C 0168                720            MOVE.W #BGGSSTP, D1
00001242  0640 0019                721            ADD.W #PLRHEIGHT, D0
00001246  B240                     722            CMP D0, D1
00001248  6B00 006A                723            BMI .GAMEOVER         
0000124C                           724         
0000124C  6000 0072                725            BRA .END         
00001250                           726  .PRESSED
00001250                           727            ;TECLA UP PRESIONADA
00001250                           728            ;Se reinicia la velocidad de bajada. 
00001250  33FC 0001 00001C4C       729            MOVE.W #1, (PLRDOWNSPEED)
00001258                           730  
00001258                           731            ;Se establece el límite hasta donde subirá
00001258  3039 00001C46            732            MOVE.W (PLRPOSY), D0
0000125E  0440 003C                733            SUB.W #JUMPSIZE, D0
00001262  33C0 00001C48            734            MOVE.W D0, (MAXPOS)
00001268                           735            ;Se indica que se ha presionado la tecla de salto
00001268  33FC 0001 00001C4A       736            MOVE.W #1, (UPPRESSED)
00001270                           737            
00001270  6000 004E                738            BRA .END   
00001274                           739        
00001274                           740  .MAKEJUMP
00001274                           741            ;Se ha apretado la tecla UP anteriormente (eso indica que el salto no
00001274                           742            ; ha finalizado). 
00001274                           743            
00001274  3039 00001C46            744            MOVE.W (PLRPOSY), D0
0000127A  3239 00001C48            745            MOVE.W (MAXPOS), D1
00001280  9041                     746            SUB.W  D1, D0             ;FÓRMULA: (PLRPOSY-MAXPOS)/JUMPSPEED = VALOR QUE SE TIENE QUE RESTAR A LA POSICIÓN ACTUAL PARA OBTENER LA NUEVA POSICIÓN
00001282  80FC 0003                747            DIVU.W #JUMPSPEED, D0
00001286  9179 00001C46            748            SUB.W D0, (PLRPOSY)       ;NEWPOS
0000128C                           749  
0000128C                           750            ;Ver si ha salido por la parte superior. 
0000128C  0C79 0000 00001C46       751            CMP #0, (PLRPOSY)
00001294  6B00 001E                752            BMI .GAMEOVER
00001298  B07C 0001                753            CMP #1, D0
0000129C  6B00 000A                754            BMI .LASTJUMP
000012A0  6700 0006                755            BEQ .LASTJUMP
000012A4                           756            ;El salto no ha finalizado (No ha llegado a MAXPOS)
000012A4                           757                                
000012A4  6000 001A                758            BRA .END
000012A8                           759            
000012A8                           760  .LASTJUMP
000012A8                           761            ;El salto ha llegado a MAXPOS
000012A8                           762            ;Se desactiva la tecla UP indicando que lo siguiente será realizar la bajada. 
000012A8  33FC 0000 00001C4A       763            MOVE.W #0, (UPPRESSED)         
000012B0  6000 000E                764            BRA .END    
000012B4                           765            
000012B4                           766  .GAMEOVER
000012B4                           767  
000012B4  33FC 0003 00001C42       768            MOVE.W #STAGOVR, (STANEXT)        
000012BC  6000 0002                769            BRA .END         
000012C0                           770                   
000012C0                           771  .END
000012C0  4CDF 000F                772            MOVEM.L (A7)+,D0/D1/D2/D3
000012C4  4E75                     773            RTS
000012C6                           774            
000012C6                           775  ; -----------------------------------------------------------------------------
000012C6                           776  PLRPLOT
000012C6                           777  ; PLOTS THE PLAYER
000012C6                           778  ; INPUT    - NONE
000012C6                           779  ; OUTPUT   - NONE
000012C6                           780  ; MODIFIES - NONE
000012C6                           781  ; -----------------------------------------------------------------------------
000012C6                           782  
000012C6  48E7 FC00                783              MOVEM.L D0-D5,-(A7)
000012CA                           784              
000012CA                           785              ;-------SCORE----------------
000012CA  7000                     786              MOVE.L #0, D0
000012CC  303C 0011                787              MOVE #17, D0
000012D0  43F9 00001C52            788              LEA PLRSCORETEXT, A1
000012D6  2239 00001C50            789              MOVE.L (PLRSCORE), D1
000012DC  4E4F                     790              TRAP #15
000012DE                           791                      
000012DE                           792              ;-------PLAYER (BODY)--------
000012DE                           793  
000012DE                           794              ;SET PLAYER COLOR 
000012DE  223C 00008000            795              MOVE.L  #PLRCOLOR,D1
000012E4  103C 0050                796              MOVE.B  #80,D0
000012E8  4E4F                     797              TRAP    #15
000012EA  5200                     798              ADDQ.B  #1,D0
000012EC  4E4F                     799              TRAP    #15
000012EE                           800              
000012EE                           801              ;SET PLAYER POSITION
000012EE  3239 00001C44            802              MOVE.W  (PLRPOSX),D1            
000012F4  3439 00001C46            803              MOVE.W  (PLRPOSY),D2
000012FA  3601                     804              MOVE.W  D1,D3
000012FC  3802                     805              MOVE.W  D2,D4
000012FE                           806              
000012FE                           807              ;SET PLAYER WIDTH AND HEIGHT
000012FE  0643 0019                808              ADD.W   #PLRWIDTH,D3
00001302  0644 0019                809              ADD.W   #PLRHEIGHT,D4
00001306  103C 0058                810              MOVE.B  #88,D0
0000130A  4E4F                     811              TRAP    #15
0000130C                           812              
0000130C  0443 000C                813              SUB.W   #PLRWIDTH/2,D3
00001310  103C 0057                814              MOVE.B  #87,D0
00001314  4E4F                     815              TRAP    #15
00001316                           816              
00001316                           817              ;---------EYE (IRIS)---------
00001316                           818                               
00001316                           819              ;SET EYE COLOR
00001316  7051                     820              MOVE.L  #81, D0
00001318  7200                     821              MOVE.L  #PLRIRISCOLOR, D1
0000131A  4E4F                     822              TRAP    #15
0000131C                           823              
0000131C  3239 00001C44            824              MOVE.W  PLRPOSX,D1   
00001322                           825              
00001322                           826              ;X0        
00001322  5041                     827              ADD.W   #PLRWIDTH/3,D1
00001324  3639 00001C44            828              MOVE.W  (PLRPOSX),D3
0000132A                           829              
0000132A                           830              ;X2
0000132A  0643 000C                831              ADD.W   #PLRWIDTH/2,D3
0000132E  3439 00001C46            832              MOVE.W (PLRPOSY),D2
00001334                           833              
00001334                           834              ;X1
00001334  5C42                     835              ADD.W   #PLRHEIGHT/4,D2
00001336  3839 00001C46            836              MOVE.W  (PLRPOSY),D4
0000133C                           837              
0000133C                           838              
0000133C                           839              ;X3
0000133C  5244                     840              ADD.W   #PLRHEIGHT/20,D4
0000133E  103C 0058                841              MOVE.B  #88,D0
00001342  4E4F                     842              TRAP    #15
00001344                           843              
00001344                           844             ;---------MOUTH------
00001344                           845                                 
00001344                           846              ;SET MOUTH COLOR
00001344  7051                     847              MOVE.L  #81, D0
00001346  223C 000000FF            848              MOVE.L  #RED, D1
0000134C  4E4F                     849              TRAP    #15           
0000134E                           850                 
0000134E  3239 00001C44            851              MOVE.W  (PLRPOSX),D1   
00001354                           852              
00001354                           853              ;X0        
00001354  0641 0014                854              ADD.W   #PLRWIDTH-5,D1
00001358  3639 00001C44            855              MOVE.W  (PLRPOSX),D3
0000135E                           856             
0000135E                           857              
0000135E                           858              ;X2
0000135E  0643 000C                859              ADD.W   #PLRWIDTH/2,D3
00001362  3439 00001C46            860              MOVE.W  (PLRPOSY),D2
00001368                           861              
00001368                           862    
00001368                           863              ;X1
00001368  0642 000C                864              ADD.W   #PLRHEIGHT/2,D2
0000136C  3839 00001C46            865              MOVE.W  (PLRPOSY),D4   
00001372                           866              
00001372                           867              ;X3 
00001372  0644 0019                868              ADD.W   #PLRHEIGHT,D4
00001376                           869             
00001376  103C 0058                870              MOVE.B  #88,D0
0000137A  4E4F                     871              TRAP    #15
0000137C                           872              
0000137C  4CDF 003F                873              MOVEM.L (A7)+,D0-D5
00001380                           874              
00001380  4E75                     875              RTS
00001382                           876  
00001382                           877  
00001382                           878  -------------------- end include --------------------
00001382                           879              INCLUDE "UTIL.X68"                   ; UTILITY MACRO AND SUBROUTINES
00001382                           880  ; =============================================================================
00001382                           881  ; UTILITY MACROS
00001382                           882  ; =============================================================================
00001382                           883  
00001382                           884  ; -----------------------------------------------------------------------------
00001382                           885  UTLSPEN     MACRO
00001382                           886  ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001382                           887  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
00001382                           888  ; OUTPUT   - NONE
00001382                           889  ; MODIFIES - D0,D1
00001382                           890  ; -----------------------------------------------------------------------------
00001382                           891              MOVE.B  #80,D0
00001382                           892              MOVE.L  \1,D1
00001382                           893              TRAP    #15
00001382                           894              ENDM
00001382                           895  
00001382                           896  ; -----------------------------------------------------------------------------
00001382                           897  UTLSFIL     MACRO
00001382                           898  ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001382                           899  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
00001382                           900  ; OUTPUT   - NONE
00001382                           901  ; MODIFIES - D0,D1
00001382                           902  ; -----------------------------------------------------------------------------
00001382                           903              MOVE.B  #81,D0
00001382                           904              MOVE.L  \1,D1
00001382                           905              TRAP    #15
00001382                           906              ENDM
00001382                           907  
00001382                           908  ; -----------------------------------------------------------------------------
00001382                           909  UTLLOCT     MACRO
00001382                           910  ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001382                           911  ; INPUT    - \1 X, \2 Y
00001382                           912  ; OUTPUT   - NONE
00001382                           913  ; MODIFIES - D0,D1
00001382                           914  ; -----------------------------------------------------------------------------
00001382                           915              MOVE.W  #\1<<8|\2, D1
00001382                           916              MOVE.B  #11,D0
00001382                           917              TRAP    #15
00001382                           918              ENDM
00001382                           919  
00001382                           920  ; -----------------------------------------------------------------------------
00001382                           921  UTLFONT     MACRO
00001382                           922  ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001382                           923  ; INPUT    - \1 COLOR, \2 FONT
00001382                           924  ; OUTPUT   - NONE
00001382                           925  ; MODIFIES - D0,D1,D2
00001382                           926  ; -----------------------------------------------------------------------------
00001382                           927              MOVE.L  #\1,D1
00001382                           928              MOVE.L  #\2,D2
00001382                           929              MOVEQ   #21,D0
00001382                           930              TRAP    #15
00001382                           931              ENDM
00001382                           932  
00001382                           933  ; =============================================================================
00001382                           934  ; UTILITY SUBROUTINES
00001382                           935  ; =============================================================================
00001382                           936  
00001382                           937  ; -----------------------------------------------------------------------------
00001382                           938  UTLINIT
00001382                           939  ; INITIALIZES UTILITY CODE
00001382                           940  ; INPUT    - NONE
00001382                           941  ; OUTPUT   - NONE
00001382                           942  ; MODIFIES - NONE
00001382                           943  ; -----------------------------------------------------------------------------
00001382  4239 00001C63            944              CLR.B   (UTLRNDIX)
00001388  4E75                     945              RTS
0000138A                           946  ; -----------------------------------------------------------------------------
0000138A                           947  UTLCHCOL
0000138A                           948  ; CHECKS COLLISION
0000138A                           949  ; INPUT    - D0.W X0 COORDINATE
0000138A                           950  ;            D1.W Y0 COORDINATE
0000138A                           951  ;            D2.W X1 COORDINATE
0000138A                           952  ;            D3.W Y1 COORDINATE
0000138A                           953  ;            D4.W WIDTH 0
0000138A                           954  ;            D5.W WIDTH 1
0000138A                           955  ;            D6.W HEIGHT 0
0000138A                           956  ;            D7.W HEIGHT 1
0000138A                           957  ; OUTPUT   - D0.B=FF - COLLISION, =0 - NO COLLISION
0000138A                           958  ; MODIFIES - NONE
0000138A                           959  ; -----------------------------------------------------------------------------
0000138A  48A7 2B00                960               MOVEM.W D2/D4/D6/D7,-(A7)
0000138E                           961  
0000138E                           962              ;Verificar si la tubería esta delante o detrás del pájaro. 
0000138E                           963              
0000138E  D840                     964              ADD.W D0, D4 ;Pared derecha de la tubería.
00001390  B842                     965              CMP D2, D4
00001392  6500 0022                966              BCS .NOCOL
00001396                           967              
00001396                           968              ;Comprobar si el pájaro ha alcanzado la tubería.
00001396                           969              
00001396  D445                     970              ADD.W D5, D2 ;Parte delantera del pájaro.
00001398  B440                     971              CMP D0, D2
0000139A  6500 001A                972              BCS .NOCOL
0000139E                           973              
0000139E                           974              ;Comprobar parte inferior del pájaro con la parte superior de la 
0000139E                           975              ;tubería inferior.
0000139E                           976                          
0000139E  B641                     977              CMP D1, D3
000013A0  6F00 000C                978              BLE .COL 
000013A4                           979              
000013A4  DC41                     980              ADD.W D1, D6 ;Parte superior de la tubería inferior.
000013A6  DE43                     981              ADD.W D3, D7 ;Parte inferior del pájaro. 
000013A8  BE46                     982              CMP D6, D7
000013AA  6500 000A                983              BCS .NOCOL
000013AE                           984       
000013AE                           985             ;Si no se realiza ninguno de los saltos anteriores, hay colisión. 
000013AE                           986  .COL
000013AE  303C 00FF                987              MOVE.W  #$FF, D0
000013B2  6000 0006                988              BRA .END                                
000013B6                           989  
000013B6                           990  .NOCOL                    
000013B6  303C 0000                991              MOVE.W #0, D0
000013BA                           992  
000013BA                           993  .END          
000013BA  4C9F 00D4                994              MOVEM.W (A7)+,D2/D4/D6/D7
000013BE  4E75                     995              RTS
000013C0                           996  ; -----------------------------------------------------------------------------
000013C0                           997  UTLRAND
000013C0                           998  ; PROVIDES A PSEUDO-RANDOM BYTE
000013C0                           999  ; INPUT    - NONE
000013C0                          1000  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
000013C0                          1001  ; MODIFIES - NONE (ASIDE OF OUTPUT)
000013C0                          1002  ; -----------------------------------------------------------------------------
000013C0  2F08                    1003              MOVE.L  A0,-(A7)
000013C2  41F9 000013DE           1004              LEA     .RANDVEC,A0
000013C8  4280                    1005              CLR.L   D0
000013CA  1039 00001C63           1006              MOVE.B  (UTLRNDIX),D0
000013D0  1030 0800               1007              MOVE.B  (A0,D0.L),D0
000013D4  5239 00001C63           1008              ADDQ.B  #1,(UTLRNDIX)
000013DA  205F                    1009              MOVE.L  (A7)+,A0
000013DC  4E75                    1010              RTS
000013DE                          1011  
000013DE                          1012  
000013DE= A2 EE 9A 0C F5 24 ...   1013  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
000013E6= 2A A3 51 26 E0 AC ...   1014              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
000013EE= 75 51 CA FD 33 EB ...   1015              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
000013F6= 60 CC E7 B8 9A EB ...   1016              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
000013FE= 1D 76 B5 95 B0 89 ...   1017              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
00001406= 39 15 48 C9 6E CA ...   1018              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
0000140E= 43 E7 E2 7C 37 25 ...   1019              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
00001416= E9 94 CE E9 E4 52 ...   1020              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
0000141E= 37 6D 9A 84 A2 28 ...   1021              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
00001426= 19 E2 C6 77 80 D4 ...   1022              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
0000142E= 0A 5A 32 67 33 C2 ...   1023              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
00001436= 59 80 DC 0E 57 FC ...   1024              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
0000143E= 8A AB BC F7 07 4D ...   1025              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
00001446= EF D5 77 6E 1E BB ...   1026              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
0000144E= D6 E0 2A 8F BD 28 ...   1027              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
00001456= 13 4F 66 EC 0A 64 ...   1028              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
0000145E= 56 52 9A 16 9B 90 ...   1029              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001466= 06 8A A4 F7 01 DA ...   1030              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
0000146E= F2 E7 77 28 B1 76 ...   1031              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001476= A4 42 E3 81 B1 67 ...   1032              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
0000147E= BF CE FA 16 BF 38 ...   1033              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001486= D1 8B 50 0C 5F 49 ...   1034              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
0000148E= DE 4C 14 A2 40 DC ...   1035              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001496= B6 9B 0A 38 5D AB ...   1036              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
0000149E= E2 1B DD 75 15 82 ...   1037              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
000014A6= 8A 26 51 30 9F 47 ...   1038              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
000014AE= 1E 8A BB 71 C6 6E ...   1039              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
000014B6= 9F 47 E5 34 94 27 ...   1040              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
000014BE= 7D 06 D6 BA 30 0F ...   1041              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
000014C6= EC 7F 7E 03 CF 2D ...   1042              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
000014CE= 94 5B 23 F2 8B CD ...   1043              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
000014D6= 74 33 EC B9 0F D5 ...   1044              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
000014DE                          1045  
000014DE                          1046  
000014DE                          1047  
000014DE                          1048  
000014DE                          1049  
000014DE                          1050  
000014DE                          1051  
000014DE                          1052  
000014DE                          1053  
000014DE                          1054  
000014DE                          1055  
000014DE                          1056  
000014DE                          1057  -------------------- end include --------------------
000014DE                          1058              INCLUDE "AGENTLST.X68"               ; AGENT LIST MANAGEMENT
000014DE                          1059  ; =============================================================================
000014DE                          1060  ; AGENT MANAGEMENT
000014DE                          1061  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
000014DE                          1062  ; +0 - LONG : UPDATE SUBROUTINE POINTER
000014DE                          1063  ; +4 - LONG : PLOT SUBROUTINE POINTER
000014DE                          1064  ; +8:END    : DATA (AGENT SPECIFIC)
000014DE                          1065  ; =============================================================================
000014DE                          1066  
000014DE                          1067  ; -----------------------------------------------------------------------------
000014DE                          1068  AGLADD
000014DE                          1069  ; CREATES A NEW AGENT
000014DE                          1070  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
000014DE                          1071  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
000014DE                          1072  ;            A3 - POINTER TO AGENT PLOT FUNCTION
000014DE                          1073  ;            D0 - AGENT TYPE (USED AS OWNED BY DMM)
000014DE                          1074  ;            D1 - AGENT INITIALIZATION PARAMETER 1
000014DE                          1075  ;            D2 - AGENT INITIALIZATION PARAMETER 2
000014DE                          1076  ;            D3 - AGENT INITIALIZATION PARAMETER 3
000014DE                          1077  ; OUTPUT   - NONE
000014DE                          1078  ; MODIFIES - NONE
000014DE                          1079  ; -----------------------------------------------------------------------------
000014DE  2F08                    1080              MOVE.L  A0,-(A7)
000014E0                          1081              
000014E0  4EB8 1190               1082              JSR     DMMALLOC
000014E4  B1FC 00000000           1083              CMP.L   #0,A0
000014EA  6700 0008               1084              BEQ     .END
000014EE  20CA                    1085              MOVE.L  A2,(A0)+
000014F0  20CB                    1086              MOVE.L  A3,(A0)+
000014F2  4E91                    1087              JSR     (A1)
000014F4                          1088  
000014F4  205F                    1089  .END        MOVE.L  (A7)+,A0
000014F6  4E75                    1090              RTS
000014F8                          1091  
000014F8                          1092  ; -----------------------------------------------------------------------------
000014F8                          1093  AGLUPD
000014F8                          1094  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000014F8                          1095  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000014F8                          1096  ; INPUT    - NONE
000014F8                          1097  ; OUTPUT   - NONE
000014F8                          1098  ; MODIFIES - NONE
000014F8                          1099  ; -----------------------------------------------------------------------------
000014F8  48E7 00C0               1100              MOVEM.L A0-A1,-(A7)
000014FC                          1101              
000014FC  4EB8 1120               1102              JSR     DMMFIRST
00001500  B1FC 00000000           1103  .LOOP       CMP.L   #0,A0
00001506  6700 001E               1104              BEQ     .END
0000150A  0C68 0002 FFFE          1105              CMP.W   #GSSDTYPE,-2(A0)    ;IF MEMORY DOESN'T BELONG TO AGENT
00001510  670E                    1106              BEQ.S   .NEXT               ;SKIP
00001512  0C68 0001 FFFE          1107              CMP.W   #CLDTYPE,-2(A0)
00001518  6706                    1108              BEQ.S   .NEXT
0000151A                          1109              
0000151A  2250                    1110              MOVE.L  (A0),A1
0000151C  5088                    1111              ADD.L   #8,A0
0000151E  4E91                    1112              JSR     (A1)
00001520  4EB8 1142               1113  .NEXT       JSR     DMMNEXT
00001524  60DA                    1114              BRA     .LOOP
00001526                          1115              
00001526  4CDF 0300               1116  .END        MOVEM.L (A7)+,A0-A1            
0000152A  4E75                    1117              RTS
0000152C                          1118  
0000152C                          1119  ; -----------------------------------------------------------------------------
0000152C                          1120  AGLPLOT
0000152C                          1121  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
0000152C                          1122  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
0000152C                          1123  ; INPUT    - NONE
0000152C                          1124  ; OUTPUT   - NONE
0000152C                          1125  ; MODIFIES - NONE
0000152C                          1126  ; -----------------------------------------------------------------------------
0000152C  48E7 00C0               1127              MOVEM.L A0-A1,-(A7)
00001530                          1128  
00001530  4EB8 1120               1129              JSR     DMMFIRST
00001534  B1FC 00000000           1130  .LOOP       CMP.L   #0,A0
0000153A  6700 0020               1131              BEQ     .END
0000153E  0C68 0002 FFFE          1132              CMP.W   #GSSDTYPE,-2(A0)    ;IF MEMORY DOESN'T BELONG TO AGENT
00001544  6710                    1133              BEQ.S   .NEXT               ;SKIP
00001546  0C68 0001 FFFE          1134              CMP.W   #CLDTYPE,-2(A0)
0000154C  6708                    1135              BEQ.S   .NEXT
0000154E                          1136              
0000154E  2268 0004               1137              MOVE.L  4(A0),A1
00001552  5088                    1138              ADD.L   #8,A0
00001554  4E91                    1139              JSR     (A1)
00001556  4EB8 1142               1140  .NEXT       JSR     DMMNEXT
0000155A  60D8                    1141              BRA     .LOOP
0000155C  4CDF 0300               1142  .END        MOVEM.L (A7)+,A0-A1
00001560                          1143  
00001560  4E75                    1144              RTS
00001562                          1145  
00001562                          1146  ; -----------------------------------------------------------------------------
00001562  =000011AA               1147  AGLKILL     EQU     DMMFREE
00001562                          1148  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001562                          1149  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001562                          1150  ; OUTPUT   - NONE
00001562                          1151  ; MODIFIES - NONE
00001562                          1152  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001562                          1153  ; -----------------------------------------------------------------------------
00001562                          1154  
00001562                          1155  
00001562                          1156  
00001562                          1157  
00001562                          1158  
00001562                          1159  
00001562                          1160  
00001562                          1161  
00001562                          1162  
00001562                          1163  
00001562                          1164  
00001562                          1165  -------------------- end include --------------------
00001562                          1166              INCLUDE "PROPLST.X68"                ; PROPS LIST MANAGEMENT
00001562                          1167  ; =============================================================================
00001562                          1168  ; PROP MANAGEMENT
00001562                          1169  ; EACH PROP HAS A DATA BLOCK FROM DMM AS FOLLOWS:
00001562                          1170  ; +0 - LONG : UPDATE SUBROUTINE POINTER
00001562                          1171  ; +4 - LONG : PLOT SUBROUTINE POINTER
00001562                          1172  ; +8:END    : DATA (PROP SPECIFIC)
00001562                          1173  ; =============================================================================
00001562                          1174  
00001562                          1175  ; -----------------------------------------------------------------------------
00001562                          1176  PRPADD
00001562                          1177  ; CREATES A NEW PROP
00001562                          1178  ; INPUT    - A1 - POINTER TO PROP INIT FUNCTION
00001562                          1179  ;            A2 - POINTER TO PROP UPDATE FUNCTION
00001562                          1180  ;            A3 - POINTER TO PROP PLOT FUNCTION
00001562                          1181  ;            D0 - PROP TYPE (USED AS OWNED BY DMM)
00001562                          1182  ;            D1 - PROP INITIALIZATION PARAMETER 1
00001562                          1183  ;            D2 - PROP INITIALIZATION PARAMETER 2
00001562                          1184  ;            D3 - PROP INITIALIZATION PARAMETER 3
00001562                          1185  ; OUTPUT   - NONE
00001562                          1186  ; MODIFIES - NONE
00001562                          1187  ; -----------------------------------------------------------------------------
00001562  2F08                    1188              MOVE.L  A0,-(A7)
00001564                          1189              
00001564  4EB8 1190               1190              JSR     DMMALLOC
00001568  B1FC 00000000           1191              CMP.L   #0,A0
0000156E  6700 0008               1192              BEQ     .END
00001572  20CA                    1193              MOVE.L  A2,(A0)+
00001574  20CB                    1194              MOVE.L  A3,(A0)+
00001576  4E91                    1195              JSR     (A1)
00001578                          1196  
00001578  205F                    1197  .END        MOVE.L  (A7)+,A0
0000157A  4E75                    1198              RTS
0000157C                          1199  
0000157C                          1200  ; -----------------------------------------------------------------------------
0000157C                          1201  PRPUPD
0000157C                          1202  ; UPDATES THE PROP LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
0000157C                          1203  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
0000157C                          1204  ; INPUT    - NONE
0000157C                          1205  ; OUTPUT   - NONE
0000157C                          1206  ; MODIFIES - NONE
0000157C                          1207  ; -----------------------------------------------------------------------------
0000157C  48E7 00C0               1208              MOVEM.L A0-A1,-(A7)
00001580                          1209              
00001580  4EB8 1120               1210              JSR     DMMFIRST
00001584  B1FC 00000000           1211  .LOOP       CMP.L   #0,A0
0000158A  6700 0018               1212              BEQ     .END
0000158E  0C68 0003 FFFE          1213              CMP.W   #PIPTYPE,-2(A0) ;IF MEMORY DOESN'T BELONG TO PROPS
00001594  6700 0008               1214              BEQ     .NEXT           ;SKIP
00001598                          1215              
00001598  2250                    1216              MOVE.L  (A0),A1
0000159A  5088                    1217              ADD.L   #8,A0
0000159C  4E91                    1218              JSR     (A1)
0000159E                          1219              
0000159E  4EB8 1142               1220  .NEXT       JSR     DMMNEXT
000015A2  60E0                    1221              BRA     .LOOP
000015A4                          1222              
000015A4  4CDF 0300               1223  .END        MOVEM.L (A7)+,A0-A1            
000015A8  4E75                    1224              RTS
000015AA                          1225              
000015AA                          1226  ; -----------------------------------------------------------------------------
000015AA                          1227  PRPPLOT
000015AA                          1228  ; PLOTS THE PROP LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000015AA                          1229  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000015AA                          1230  ; INPUT    - NONE
000015AA                          1231  ; OUTPUT   - NONE
000015AA                          1232  ; MODIFIES - NONE
000015AA                          1233  ; -----------------------------------------------------------------------------
000015AA  48E7 00C0               1234              MOVEM.L A0-A1,-(A7)
000015AE                          1235  
000015AE  4EB8 1120               1236              JSR     DMMFIRST
000015B2  B1FC 00000000           1237  .LOOP       CMP.L   #0,A0
000015B8  6700 0018               1238              BEQ     .END
000015BC  0C68 0003 FFFE          1239              CMP.W   #PIPTYPE,-2(A0)     ;IF MEMORY DOESN'T BELONG TO PROP
000015C2  6708                    1240              BEQ.S   .NEXT               ;SKIP
000015C4                          1241              
000015C4  2268 0004               1242              MOVE.L  4(A0),A1
000015C8  5088                    1243              ADD.L   #8,A0
000015CA  4E91                    1244              JSR     (A1)
000015CC  4EB8 1142               1245  .NEXT       JSR     DMMNEXT
000015D0  60E0                    1246              BRA     .LOOP
000015D2  4CDF 0300               1247  .END        MOVEM.L (A7)+,A0-A1
000015D6                          1248  
000015D6  4E75                    1249              RTS
000015D8                          1250  
000015D8                          1251  ; -----------------------------------------------------------------------------
000015D8  =000011AA               1252  PRPKILL     EQU     DMMFREE
000015D8                          1253  ; KILLS THE PRP BY RELEASING ITS MEMORY
000015D8                          1254  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
000015D8                          1255  ; OUTPUT   - NONE
000015D8                          1256  ; MODIFIES - NONE
000015D8                          1257  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
000015D8                          1258  ; -----------------------------------------------------------------------------
000015D8                          1259  
000015D8                          1260  
000015D8                          1261  
000015D8                          1262  
000015D8                          1263  
000015D8                          1264  
000015D8                          1265  
000015D8                          1266  
000015D8                          1267  
000015D8                          1268  
000015D8                          1269  
000015D8                          1270  
000015D8                          1271  
000015D8                          1272  
000015D8                          1273  -------------------- end include --------------------
000015D8                          1274              INCLUDE "SPAWNER.X68"                ; SPAWNER
000015D8                          1275  ; =============================================================================
000015D8                          1276  ; SPAWNER MANAGEMENT.
000015D8                          1277  ; =============================================================================
000015D8                          1278  
000015D8                          1279  ; -----------------------------------------------------------------------------
000015D8                          1280  SPWUPD
000015D8                          1281  ; UPDATES THE SPAWNER
000015D8                          1282  ; INPUT    - NONE
000015D8                          1283  ; OUTPUT   - NONE
000015D8                          1284  ; MODIFIES - NONE
000015D8                          1285  ; -----------------------------------------------------------------------------
000015D8  48E7 8070               1286              MOVEM.L  D0/A1-A3,-(A7)
000015DC                          1287  
000015DC  1039 00001C67           1288              MOVE.B  (SCRCYCCT),D0
000015E2  C07C 003F               1289              AND     #$3F,D0                 ; EVERY 64 CYCLES
000015E6  6600 0028               1290              BNE     .END                    ; CREATE A NEW PIPE
000015EA  43F9 00001B10           1291              LEA     PIPINIT,A1
000015F0  45F9 00001B36           1292              LEA     PIPUPD,A2
000015F6  47F9 00001B88           1293              LEA     PIPPLOT,A3
000015FC  303C 0003               1294              MOVE.W  #PIPTYPE,D0
00001600  1239 00001C5C           1295              MOVE.B  (PIPCOUNT),D1
00001606  5239 00001C5C           1296              ADDQ.B  #1,(PIPCOUNT)
0000160C                          1297              
0000160C  4EB8 14DE               1298              JSR     AGLADD
00001610                          1299              
00001610  4CDF 0E01               1300  .END        MOVEM.L (A7)+,D0/A1-A3
00001614  4E75                    1301              RTS
00001616                          1302  
00001616                          1303  
00001616                          1304  
00001616                          1305  
00001616                          1306  
00001616                          1307  
00001616                          1308  
00001616                          1309  
00001616                          1310  
00001616                          1311  
00001616                          1312  
00001616                          1313  
00001616                          1314  
00001616                          1315  
00001616                          1316  
00001616                          1317  
00001616                          1318  
00001616                          1319  
00001616                          1320  
00001616                          1321  
00001616                          1322  
00001616                          1323  -------------------- end include --------------------
00001616                          1324              INCLUDE "STATES2.X68"                ; GAME STATES MANAGEMENT
00001616                          1325  ; =============================================================================
00001616                          1326  ; GAME STATE MANAGEMENT
00001616                          1327  ; =============================================================================
00001616                          1328  
00001616                          1329  ; -----------------------------------------------------------------------------
00001616                          1330  STAINIT
00001616                          1331  ; INITALIZES THE STATE MANAGER
00001616                          1332  ; INPUT    - NONE
00001616                          1333  ; OUTPUT   - NONE
00001616                          1334  ; MODIFIES - NONE
00001616                          1335  ; -----------------------------------------------------------------------------
00001616  33FC FFFF 00001C40      1336              MOVE.W  #STANONE,(STACUR)
0000161E  33FC 0000 00001C42      1337              MOVE.W  #STAINTR,(STANEXT)
00001626  4E75                    1338              RTS
00001628                          1339  
00001628                          1340  ; -----------------------------------------------------------------------------
00001628                          1341  STAUPD
00001628                          1342  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
00001628                          1343  ; INPUT    - NONE
00001628                          1344  ; OUTPUT   - NONE
00001628                          1345  ; MODIFIES - NONE
00001628                          1346  ; -----------------------------------------------------------------------------
00001628  48E7 8080               1347              MOVEM.L D0/A0,-(A7)
0000162C  4280                    1348              CLR.L   D0
0000162E  3039 00001C42           1349              MOVE.W  (STANEXT),D0
00001634  B079 00001C40           1350              CMP.W   (STACUR),D0
0000163A  6700 0012               1351              BEQ     .DOUPD
0000163E  33C0 00001C40           1352              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
00001644  E588                    1353              LSL.L   #2,D0
00001646  2040                    1354              MOVE.L  D0,A0
00001648  2068 1666               1355              MOVE.L  .INITBL(A0),A0
0000164C  4E90                    1356              JSR     (A0)
0000164E  4280                    1357  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
00001650  3039 00001C40           1358              MOVE.W  (STACUR),D0
00001656  E588                    1359              LSL.L   #2,D0
00001658  2040                    1360              MOVE.L  D0,A0
0000165A  2068 1676               1361              MOVE.L  .UPDTBL(A0),A0
0000165E  4E90                    1362              JSR     (A0)
00001660  4CDF 0101               1363              MOVEM.L (A7)+,D0/A0
00001664  4E75                    1364              RTS
00001666= 000010FE 000011C0 ...   1365  .INITBL     DC.L    STAINTRI,STAPLAYI,STAEMPTY,STAEMPTY
00001676= 000016F0 000016B4 ...   1366  .UPDTBL     DC.L    STAINTRU,STAPLAYU,STAPAUU,STAGOVRU
00001686                          1367  
00001686                          1368  ; -----------------------------------------------------------------------------
00001686                          1369  STAPLOT
00001686                          1370  ; PERFORMS STATE PLOT
00001686                          1371  ; INPUT    - NONE
00001686                          1372  ; OUTPUT   - NONE
00001686                          1373  ; MODIFIES - NONE
00001686                          1374  ; -----------------------------------------------------------------------------
00001686  48E7 8080               1375              MOVEM.L D0/A0,-(A7)
0000168A  4280                    1376              CLR.L   D0
0000168C  3039 00001C40           1377              MOVE.W  (STACUR),D0
00001692  E588                    1378              LSL.L   #2,D0
00001694  2040                    1379              MOVE.L  D0,A0
00001696  2068 16A2               1380              MOVE.L  .PLTTBL(A0),A0
0000169A  4E90                    1381              JSR     (A0)
0000169C  4CDF 0101               1382              MOVEM.L (A7)+,D0/A0
000016A0  4E75                    1383              RTS
000016A2= 00001706 000016DE ...   1384  .PLTTBL     DC.L    STAINTRP,STAPLAYP,STAPAUP,STAGOVRP
000016B2                          1385  
000016B2                          1386  ; -----------------------------------------------------------------------------
000016B2                          1387  STAEMPTY
000016B2                          1388  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
000016B2                          1389  ; INPUT    - NONE
000016B2                          1390  ; OUTPUT   - NONE
000016B2                          1391  ; MODIFIES - NONE
000016B2                          1392  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
000016B2                          1393  ; -----------------------------------------------------------------------------
000016B2  4E75                    1394              RTS
000016B4                          1395  
000016B4                          1396  ; -----------------------------------------------------------------------------
000016B4  =000011C0               1397  STAPLAYI    EQU     PLRINIT
000016B4                          1398  ; PLAY STATE INITIALIZATION.
000016B4                          1399  ; INPUT    - NONE
000016B4                          1400  ; OUTPUT   - NONE
000016B4                          1401  ; MODIFIES - NONE
000016B4                          1402  ; NOTE     - JUST A WRAPPER FOR PLRINIT
000016B4                          1403  ; -----------------------------------------------------------------------------
000016B4                          1404  
000016B4                          1405  ; -----------------------------------------------------------------------------
000016B4                          1406  STAPLAYU
000016B4                          1407  ; PLAY STATE UPDATE
000016B4                          1408  ; INPUT    - NONE
000016B4                          1409  ; OUTPUT   - NONE
000016B4                          1410  ; MODIFIES - NONE
000016B4                          1411  ; -----------------------------------------------------------------------------
000016B4  0839 0007 00001C65      1412              BTST.B   #KBDBITPS,(KBDEDGE)         ;Si 'P' es presionado, pausa.
000016BC  6616                    1413              BNE.S   .PAUSE
000016BE                          1414              
000016BE  4EB8 11FE               1415              JSR     PLRUPD
000016C2  4EB9 00001A5A           1416              JSR     BGUPD
000016C8  4EB8 157C               1417              JSR     PRPUPD
000016CC  4EB8 15D8               1418              JSR     SPWUPD
000016D0  6000 FE26               1419              BRA     AGLUPD
000016D4                          1420  .PAUSE      
000016D4  33FC 0002 00001C42      1421              MOVE.W  #STAPAU,(STANEXT)
000016DC  4E75                    1422              RTS
000016DE                          1423  ; -----------------------------------------------------------------------------
000016DE                          1424  STAPLAYP
000016DE                          1425  ; PLAY STATE PLOT
000016DE                          1426  ; INPUT    - NONE
000016DE                          1427  ; OUTPUT   - NONE
000016DE                          1428  ; MODIFIES - NONE
000016DE                          1429  ; -----------------------------------------------------------------------------
000016DE  4EB9 00001AA6           1430              JSR     BGPLOT
000016E4  4EB8 15AA               1431              JSR     PRPPLOT
000016E8  4EB8 152C               1432              JSR     AGLPLOT
000016EC                          1433              ;BRA     AGLPLOT
000016EC  6000 FBD8               1434              BRA     PLRPLOT
000016F0                          1435  
000016F0                          1436  ; -----------------------------------------------------------------------------
000016F0  =000010FE               1437  STAINTRI    EQU     DMMINIT
000016F0                          1438  ; INTRO STATE INIT
000016F0                          1439  ; INPUT    - NONE
000016F0                          1440  ; OUTPUT   - NONE
000016F0                          1441  ; MODIFIES - NONE
000016F0                          1442  ; NOTE     - JUST A WRAPPER FOR DMMINIT TO RELEASE ALL MEMORY
000016F0                          1443  ; -----------------------------------------------------------------------------
000016F0                          1444  
000016F0                          1445  ; -----------------------------------------------------------------------------
000016F0                          1446  STAINTRU
000016F0                          1447  ; INTRO STATE UPDATE
000016F0                          1448  ; INPUT    - NONE
000016F0                          1449  ; OUTPUT   - NONE
000016F0                          1450  ; MODIFIES - NONE
000016F0                          1451  ; -----------------------------------------------------------------------------
000016F0  0839 0004 00001C65      1452              BTST.B  #KBDBITF1,(KBDEDGE)
000016F8  6700 000A               1453              BEQ     .END
000016FC  33FC 0001 00001C42      1454              MOVE.W  #STAPLAY,(STANEXT)
00001704  4E75                    1455  .END        RTS
00001706                          1456  
00001706                          1457  ; -----------------------------------------------------------------------------
00001706                          1458  STAINTRP
00001706                          1459  ; INTRO STATE PLOT
00001706                          1460  ; INPUT    - NONE
00001706                          1461  ; OUTPUT   - NONE
00001706                          1462  ; MODIFIES - NONE
00001706                          1463  ; -----------------------------------------------------------------------------
00001706                          1464              ;Guardar registros en pila
00001706  48E7 C040               1465              MOVEM.L A1/D0-D1,-(A7)
0000170A                          1466              
0000170A                          1467              ;Seleccionar fuente de texto
0000170A                          1468m             UTLFONT INTTITC,INTTITF
0000170A                          1469m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
0000170A                          1470m ; INPUT    - INTTITC COLOR, INTTITF FONT
0000170A                          1471m ; OUTPUT   - NONE
0000170A                          1472m ; MODIFIES - D0,D1,D2
0000170A                          1473m ; -----------------------------------------------------------------------------
0000171A                          1474              ;Seleccionar posicion de texto      
0000171A                          1475m             UTLLOCT INTTITX,INTTITY               
0000171A                          1476m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
0000171A                          1477m ; INPUT    - INTTITX X, INTTITY Y
0000171A                          1478m ; OUTPUT   - NONE
0000171A                          1479m ; MODIFIES - D0,D1
0000171A                          1480m ; -----------------------------------------------------------------------------
00001724                          1481  
00001724  43F9 0000175C           1482              LEA     .TITLE,A1
0000172A  103C 000E               1483              MOVE.B  #14,D0
0000172E  4E4F                    1484              TRAP    #15
00001730                          1485              
00001730                          1486              ;Seleccionar fuente de texto
00001730                          1487m             UTLFONT INTPRSC,INTPRSF     
00001730                          1488m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001730                          1489m ; INPUT    - INTPRSC COLOR, INTPRSF FONT
00001730                          1490m ; OUTPUT   - NONE
00001730                          1491m ; MODIFIES - D0,D1,D2
00001730                          1492m ; -----------------------------------------------------------------------------
00001740                          1493              ;Seleccionar posicion de texto
00001740                          1494m             UTLLOCT INTPRSX,INTPRSY     
00001740                          1495m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001740                          1496m ; INPUT    - INTPRSX X, INTPRSY Y
00001740                          1497m ; OUTPUT   - NONE
00001740                          1498m ; MODIFIES - D0,D1
00001740                          1499m ; -----------------------------------------------------------------------------
0000174A                          1500  
0000174A  43F9 00001768           1501              LEA     .START_TEXT,A1
00001750  103C 000E               1502              MOVE.B  #14,D0
00001754  4E4F                    1503              TRAP    #15
00001756                          1504              
00001756                          1505              ;Restaurar registros
00001756  4CDF 0203               1506              MOVEM.L (A7)+,A1/D0-D1
0000175A  4E75                    1507              RTS
0000175C                          1508  
0000175C= 46 4C 41 50 50 59 ...   1509  .TITLE      DC.B    'FLAPPY BIRD',0 
00001768= 50 52 45 53 53 20 ...   1510  .START_TEXT DC.B    'PRESS SPACE TO START',0
0000177E                          1511              DS.W    0
0000177E                          1512  
0000177E                          1513  
0000177E                          1514  
0000177E                          1515  ; -----------------------------------------------------------------------------
0000177E                          1516  STAPAUI    
0000177E                          1517  ; PAUSE STATE INIT
0000177E                          1518  ; INPUT    - NONE
0000177E                          1519  ; OUTPUT   - NONE
0000177E                          1520  ; MODIFIES - NONE
0000177E                          1521  ; -----------------------------------------------------------------------------
0000177E                          1522              ;Guardar registros de juego
0000177E  48E7 FFFE               1523              MOVEM.L D0-D7/A0-A6,-(A7)
00001782  40E7                    1524              MOVE.W  SR,-(A7)
00001784                          1525              
00001784  4EEF FFC0               1526              JMP     -64(A7)
00001788                          1527  ; -----------------------------------------------------------------------------
00001788                          1528  STAPAUU
00001788                          1529  ; INTRO STATE UPDATE
00001788                          1530  ; INPUT    - NONE
00001788                          1531  ; OUTPUT   - NONE
00001788                          1532  ; MODIFIES - NONE
00001788                          1533  ; -----------------------------------------------------------------------------
00001788  0839 0001 00001C65      1534              BTST.B  #KBDBITUP,(KBDEDGE)     ;Check cambio en estado de UP
00001790  6628                    1535              BNE.S   .UP
00001792  0839 0003 00001C65      1536              BTST.B  #KBDBITDN,(KBDEDGE)     ;Check cambio en estado de DOWN
0000179A  6630                    1537              BNE.S   .DN
0000179C  0839 0004 00001C65      1538              BTST.B  #KBDBITF1,(KBDEDGE)     ;Check cambio en estado de FIRE1
000017A4  6638                    1539              BNE.S   .OK
000017A6  0839 0007 00001C65      1540              BTST.B  #KBDBITPS,(KBDEDGE)     ;Check cambio en estado de 'P'
000017AE  6708                    1541              BEQ.S   .END
000017B0                          1542              
000017B0  33FC 0001 00001C42      1543              MOVE.W  #STAPLAY,(STANEXT)      ;Si hay cambio en estado de 'P'
000017B8                          1544                                              ;Actualizar siguiente estado
000017B8  4E75                    1545  .END        RTS
000017BA                          1546  
000017BA  0C39 0000 00001C62      1547  .UP         CMP.B   #CONTNUM,(PMOPTN)       ;Check si es posible cambiar a una
000017C2  6FF4                    1548              BLE.S   .END                    ;opción superior
000017C4  5379 00001C62           1549              SUBQ    #1,(PMOPTN)
000017CA  60EC                    1550              BRA.S   .END
000017CC                          1551              
000017CC  0C39 0002 00001C62      1552  .DN         CMP.B   #EXTNUM,(PMOPTN)        ;Check si es posible cambiar a una
000017D4  6CE2                    1553              BGE.S   .END                    ;opción inferior
000017D6  5279 00001C62           1554              ADDQ    #1,(PMOPTN)
000017DC  60DA                    1555              BRA.S   .END
000017DE                          1556              
000017DE                          1557  .OK         
000017DE  4280                    1558              CLR.L   D0                      ;Preparar registro D0
000017E0  1039 00001C62           1559              MOVE.B  (PMOPTN),D0
000017E6  C0FC 0006               1560              MULU    #6,D0                   
000017EA                          1561              
000017EA  2040                    1562              MOVEA.L D0,A0                   ;Usar D0 como indice para .JMPLST
000017EC                          1563              
000017EC  4EE8 17F0               1564              JMP     .JMPLST(A0)
000017F0                          1565              
000017F0  4EF9 00001802           1566  .JMPLST     JMP     .contgame               
000017F6  4EF9 0000180C           1567              JMP     .newgame
000017FC  4EF9 00001816           1568              JMP     .exitgame
00001802                          1569  .contgame
00001802                          1570              ;Si última PMOPT == continuar juego, actualizar estado
00001802  33FC 0001 00001C42      1571              MOVE.W  #STAPLAY,(STANEXT)
0000180A  60AC                    1572              BRA     .END
0000180C                          1573  .newgame    
0000180C                          1574              ;Si última PMOPT == nuevo juego, actualizar estado
0000180C  33FC 0000 00001C42      1575              MOVE.W  #STAINTR,(STANEXT)
00001814  60A2                    1576              BRA     .END
00001816                          1577              
00001816                          1578  .exitgame   
00001816                          1579              ;Si última PMOPT == salir de juego, actualizar estado
00001816  33FC 0003 00001C42      1580              MOVE.W  #STAGOVR,(STANEXT)
0000181E  6098                    1581              BRA     .END
00001820                          1582  
00001820                          1583  ; -----------------------------------------------------------------------------
00001820                          1584  STAPAUP
00001820                          1585  ; INTRO STATE PLOT
00001820                          1586  ; INPUT    - NONE
00001820                          1587  ; OUTPUT   - NONE
00001820                          1588  ; MODIFIES - NONE
00001820                          1589  ; -----------------------------------------------------------------------------
00001820                          1590              ;Guardar registros
00001820  48E7 8040               1591              MOVEM.L D0/A1,-(A7)
00001824                          1592  
00001824                          1593m             UTLSFIL #$00000000
00001824                          1594m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001824                          1595m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001824                          1596m ; OUTPUT   - NONE
00001824                          1597m ; MODIFIES - D0,D1
00001824                          1598m ; -----------------------------------------------------------------------------
0000182C                          1599  
0000182C                          1600              **********DIBUJAR TÍTULO**********
0000182C                          1601              ;Seleccionar fuente de texto
0000182C                          1602m             UTLFONT PAUTITC,PAUTITF
0000182C                          1603m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
0000182C                          1604m ; INPUT    - PAUTITC COLOR, PAUTITF FONT
0000182C                          1605m ; OUTPUT   - NONE
0000182C                          1606m ; MODIFIES - D0,D1,D2
0000182C                          1607m ; -----------------------------------------------------------------------------
0000183C                          1608              ;Seleccionar posicion de texto      
0000183C                          1609m             UTLLOCT PAUTITX,PAUTITY               
0000183C                          1610m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
0000183C                          1611m ; INPUT    - PAUTITX X, PAUTITY Y
0000183C                          1612m ; OUTPUT   - NONE
0000183C                          1613m ; MODIFIES - D0,D1
0000183C                          1614m ; -----------------------------------------------------------------------------
00001846                          1615  
00001846  43F9 0000191C           1616              LEA     .TITLE,A1
0000184C  700E                    1617              MOVEQ   #14,D0
0000184E  4E4F                    1618              TRAP    #15
00001850                          1619              
00001850  1E39 00001C62           1620              MOVE.B  (PMOPTN),D7
00001856                          1621              
00001856                          1622              
00001856                          1623              **********DIBUJAR OPCION CONTINUAR**********
00001856                          1624              ;Seleccionar fuente de texto
00001856  0C39 0000 00001C62      1625              CMP.B   #CONTNUM,(PMOPTN)
0000185E  6712                    1626              BEQ.S   .CNTSEL
00001860                          1627m             UTLFONT PAUOPTC,PAUOPTFU
00001860                          1628m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001860                          1629m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
00001860                          1630m ; OUTPUT   - NONE
00001860                          1631m ; MODIFIES - D0,D1,D2
00001860                          1632m ; -----------------------------------------------------------------------------
00001870  6010                    1633              BRA.S   .SKPCNT
00001872                          1634  
00001872                          1635m .CNTSEL     UTLFONT PAUOPTC,PAUOPTFS
00001872                          1636m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001872                          1637m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
00001872                          1638m ; OUTPUT   - NONE
00001872                          1639m ; MODIFIES - D0,D1,D2
00001872                          1640m ; -----------------------------------------------------------------------------
00001882                          1641  .SKPCNT
00001882                          1642              ;Seleccionar posición de texto
00001882                          1643m             UTLLOCT PAUOPTX,PAUCNTY
00001882                          1644m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001882                          1645m ; INPUT    - PAUOPTX X, PAUCNTY Y
00001882                          1646m ; OUTPUT   - NONE
00001882                          1647m ; MODIFIES - D0,D1
00001882                          1648m ; -----------------------------------------------------------------------------
0000188C                          1649              
0000188C  43F9 0000192A           1650              LEA     .CONT,A1
00001892  700E                    1651              MOVEQ   #14,D0
00001894  4E4F                    1652              TRAP    #15
00001896                          1653              
00001896                          1654              **********DIBUJAR OPCION JUEGO NUEVO**********
00001896                          1655              ;Seleccionar fuente de texto
00001896  0C39 0001 00001C62      1656              CMP.B   #NEWGNUM,(PMOPTN)
0000189E  6712                    1657              BEQ.S   .NEWSEL
000018A0                          1658m             UTLFONT PAUOPTC,PAUOPTFU
000018A0                          1659m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018A0                          1660m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
000018A0                          1661m ; OUTPUT   - NONE
000018A0                          1662m ; MODIFIES - D0,D1,D2
000018A0                          1663m ; -----------------------------------------------------------------------------
000018B0  6010                    1664              BRA.S   .SKPNEW
000018B2                          1665  
000018B2                          1666m .NEWSEL     UTLFONT PAUOPTC,PAUOPTFS
000018B2                          1667m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018B2                          1668m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
000018B2                          1669m ; OUTPUT   - NONE
000018B2                          1670m ; MODIFIES - D0,D1,D2
000018B2                          1671m ; -----------------------------------------------------------------------------
000018C2                          1672  .SKPNEW
000018C2                          1673              ;Seleccionar posición de texto
000018C2                          1674m             UTLLOCT PAUOPTX,PAUNEWY
000018C2                          1675m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000018C2                          1676m ; INPUT    - PAUOPTX X, PAUNEWY Y
000018C2                          1677m ; OUTPUT   - NONE
000018C2                          1678m ; MODIFIES - D0,D1
000018C2                          1679m ; -----------------------------------------------------------------------------
000018CC                          1680              
000018CC  43F9 00001934           1681              LEA     .NEWG,A1
000018D2  700E                    1682              MOVEQ   #14,D0
000018D4  4E4F                    1683              TRAP    #15
000018D6                          1684              
000018D6                          1685              **********DIBUJAR OPCION SALIR**********
000018D6                          1686              ;Seleccionar fuente de texto
000018D6  0C39 0002 00001C62      1687              CMP.B   #EXTNUM,(PMOPTN)
000018DE  6712                    1688              BEQ.S   .EXTSEL
000018E0                          1689m             UTLFONT PAUOPTC,PAUOPTFU
000018E0                          1690m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018E0                          1691m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
000018E0                          1692m ; OUTPUT   - NONE
000018E0                          1693m ; MODIFIES - D0,D1,D2
000018E0                          1694m ; -----------------------------------------------------------------------------
000018F0  6010                    1695              BRA.S   .SKPEXT
000018F2                          1696  
000018F2                          1697m .EXTSEL     UTLFONT PAUOPTC,PAUOPTFS
000018F2                          1698m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000018F2                          1699m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
000018F2                          1700m ; OUTPUT   - NONE
000018F2                          1701m ; MODIFIES - D0,D1,D2
000018F2                          1702m ; -----------------------------------------------------------------------------
00001902                          1703  .SKPEXT
00001902                          1704              ;Seleccionar posición de texto
00001902                          1705m             UTLLOCT PAUOPTX,PAUEXTY
00001902                          1706m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001902                          1707m ; INPUT    - PAUOPTX X, PAUEXTY Y
00001902                          1708m ; OUTPUT   - NONE
00001902                          1709m ; MODIFIES - D0,D1
00001902                          1710m ; -----------------------------------------------------------------------------
0000190C                          1711              
0000190C  43F9 00001940           1712              LEA     .EXIT,A1
00001912  700E                    1713              MOVEQ   #14,D0
00001914  4E4F                    1714              TRAP    #15
00001916                          1715              
00001916                          1716              ;Restaurar registros
00001916  4CDF 0201               1717              MOVEM.L (A7)+,D0/A1
0000191A  4E75                    1718              RTS
0000191C                          1719              
0000191C                          1720  ; --- LOCAL DATA -----------------
0000191C= 4D 45 4E 55 20 44 ...   1721  .TITLE      DC.B    'MENU DE PAUSA',0
0000192A= 43 4F 4E 54 49 4E ...   1722  .CONT       DC.B    'CONTINUAR',0
00001934= 4A 55 45 47 4F 20 ...   1723  .NEWG       DC.B    'JUEGO NUEVO',0
00001940= 53 41 4C 49 52 00       1724  .EXIT       DC.B    'SALIR',0
00001946                          1725              DS.W    0
00001946                          1726              
00001946                          1727  ; -----------------------------------------------------------------------------
00001946                          1728  STAGOVRU
00001946                          1729  ; GAME OVER STATE UPDATE
00001946                          1730  ; INPUT    - NONE
00001946                          1731  ; OUTPUT   - NONE
00001946                          1732  ; MODIFIES - NONE
00001946                          1733  ; -----------------------------------------------------------------------------
00001946  0839 0004 00001C65      1734              BTST.B  #KBDBITF1,(KBDEDGE)
0000194E  6700 000A               1735              BEQ     .END
00001952  33FC 0000 00001C42      1736              MOVE.W  #STAINTR,(STANEXT)
0000195A  4E75                    1737  .END        RTS
0000195C                          1738  
0000195C                          1739  ; -----------------------------------------------------------------------------
0000195C                          1740  STAGOVRP
0000195C                          1741  ; GAME OVER STATE PLOT
0000195C                          1742  ; INPUT    - NONE
0000195C                          1743  ; OUTPUT   - NONE
0000195C                          1744  ; MODIFIES - NONE
0000195C                          1745  ; -----------------------------------------------------------------------------
0000195C  48E7 C040               1746              MOVEM.L A1/D0-D1,-(A7)
00001960                          1747m             UTLLOCT GOVSTRX,GOVSTRY
00001960                          1748m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001960                          1749m ; INPUT    - GOVSTRX X, GOVSTRY Y
00001960                          1750m ; OUTPUT   - NONE
00001960                          1751m ; MODIFIES - D0,D1
00001960                          1752m ; -----------------------------------------------------------------------------
0000196A                          1753m             UTLSPEN #GOVSTRC
0000196A                          1754m ; WRAPPER FOR SET PEN TRAP 15 TASK.
0000196A                          1755m ; INPUT    - #GOVSTRC COLOR IN FORMAT $00BBGGRR
0000196A                          1756m ; OUTPUT   - NONE
0000196A                          1757m ; MODIFIES - D0,D1
0000196A                          1758m ; -----------------------------------------------------------------------------
00001976                          1759m             UTLSFIL #$00000000
00001976                          1760m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001976                          1761m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001976                          1762m ; OUTPUT   - NONE
00001976                          1763m ; MODIFIES - D0,D1
00001976                          1764m ; -----------------------------------------------------------------------------
0000197E  43F9 00001990           1765              LEA     .GOVSTR,A1
00001984  103C 000E               1766              MOVE.B  #14,D0
00001988  4E4F                    1767              TRAP    #15
0000198A  4CDF 0203               1768              MOVEM.L (A7)+,A1/D0-D1
0000198E  4E75                    1769              RTS
00001990                          1770  
00001990= 47 41 4D 45 20 20 ...   1771  .GOVSTR     DC.B    'GAME  OVER',0
0000199C                          1772              DS.W    0
0000199C                          1773  
0000199C                          1774  
0000199C                          1775  
0000199C                          1776  
0000199C                          1777  
0000199C                          1778  
0000199C                          1779  
0000199C                          1780  
0000199C                          1781  
0000199C                          1782  
0000199C                          1783  
0000199C                          1784  
0000199C                          1785  
0000199C                          1786  
0000199C                          1787  
0000199C                          1788  
0000199C                          1789  
0000199C                          1790  
0000199C                          1791  
0000199C                          1792  
0000199C                          1793  
0000199C                          1794  
0000199C                          1795  
0000199C                          1796  -------------------- end include --------------------
0000199C                          1797              INCLUDE "BACKGROUND/BACKGROUND.X68"  ; BACKGROUND MANAGEMENT
0000199C                          1798  ;------------------------------------------------------------------------------
0000199C                          1799  ; BACKGROUND
0000199C                          1800  ;------------------------------------------------------------------------------
0000199C                          1801              INCLUDE "BACKGROUND/CLOUD.X68"     ; BACKGROUND CLOUDS MANAGEMENT 
0000199C                          1802  ; =============================================================================
0000199C                          1803  ; CLOUD MANAGEMENT. IT IS A PROP.
0000199C                          1804  ; LOCAL MEMORY IS:
0000199C                          1805  ; +0 WORD X COORDINATE
0000199C                          1806  ; +2 WORD Y COORDINATE
0000199C                          1807  ; =============================================================================
0000199C                          1808  
0000199C                          1809  ; -----------------------------------------------------------------------------
0000199C                          1810  CLDINIT
0000199C                          1811  ; INITALIZES CLOUD
0000199C                          1812  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
0000199C                          1813  ; OUTPUT   - NONE
0000199C                          1814  ; MODIFIES - NONE
0000199C                          1815  ; NOTE     - ASSUMES SCRHEIGH IS GREATER THAN 255
0000199C                          1816  ; -----------------------------------------------------------------------------
0000199C                          1817          ;Guardar registros
0000199C  2F00                    1818          MOVE.L      D0,-(A7)
0000199E                          1819              
0000199E  30BC 0280               1820          MOVE.W      #SCRWIDTH,(A0)
000019A2                          1821          
000019A2  4EB8 13C0               1822          JSR         UTLRAND
000019A6  3140 0002               1823          MOVE.W      D0,2(A0)
000019AA                          1824          
000019AA                          1825          ;Restaurar registros
000019AA  201F                    1826          MOVE.L      (A7)+,D0
000019AC                          1827          
000019AC  4E75                    1828          RTS
000019AE                          1829  
000019AE                          1830  ; -----------------------------------------------------------------------------
000019AE                          1831  CLDUPD
000019AE                          1832  ; UPDATES THE STATE OF CLOUDS
000019AE                          1833  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
000019AE                          1834  ; OUTPUT   - NONE
000019AE                          1835  ; MODIFIES - NONE
000019AE                          1836  ; -----------------------------------------------------------------------------
000019AE                          1837          ;Actualizar posición
000019AE  2F00                    1838          MOVE.L      D0,-(A7)
000019B0                          1839          
000019B0  3039 00001C60           1840          MOVE.W      (XSPEED),D0
000019B6  80FC 0002               1841          DIVU.W      #2,D0
000019BA  9150                    1842          SUB.W       D0,(A0)
000019BC  0C50 FF88               1843          CMP.W       #-CLDSIZE*2,(A0)
000019C0  6F04                    1844          BLE.S       .KILL
000019C2                          1845  
000019C2                          1846  .END    
000019C2  201F                    1847          MOVE.L      (A7)+,D0
000019C4  4E75                    1848          RTS
000019C6                          1849          
000019C6  4EB8 11AA               1850  .KILL   JSR PRPKILL
000019CA  60F6                    1851          BRA         .END     
000019CC                          1852  
000019CC                          1853  ; -----------------------------------------------------------------------------
000019CC                          1854  CLDPLOT
000019CC                          1855  ; PLOTS THE CLOUD IN ITS RIGHTFUL POSITION
000019CC                          1856  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
000019CC                          1857  ; OUTPUT   - NONE
000019CC                          1858  ; MODIFIES - NONE
000019CC                          1859  ; -----------------------------------------------------------------------------       
000019CC                          1860          ;Guardar registros
000019CC  48E7 F800               1861          MOVEM.L     D0-D4,-(A7)
000019D0                          1862          
000019D0                          1863m         UTLSPEN     #CLDPCLR
000019D0                          1864m ; WRAPPER FOR SET PEN TRAP 15 TASK.
000019D0                          1865m ; INPUT    - #CLDPCLR COLOR IN FORMAT $00BBGGRR
000019D0                          1866m ; OUTPUT   - NONE
000019D0                          1867m ; MODIFIES - D0,D1
000019D0                          1868m ; -----------------------------------------------------------------------------
000019DC                          1869m         UTLSFIL     #CLDFCLR
000019DC                          1870m ; WRAPPER FOR SET FIL TRAP 15 TASK.
000019DC                          1871m ; INPUT    - #CLDFCLR COLOR IN FORMAT $00BBGGRR
000019DC                          1872m ; OUTPUT   - NONE
000019DC                          1873m ; MODIFIES - D0,D1
000019DC                          1874m ; -----------------------------------------------------------------------------
000019E8                          1875          
000019E8                          1876          ;Preparar parametros
000019E8  3210                    1877          MOVE.W      (A0),D1     ;X0 COORD
000019EA  3428 0002               1878          MOVE.W      2(A0),D2    ;Y0 COORD
000019EE  3601                    1879          MOVE.W      D1,D3       
000019F0  3802                    1880          MOVE.W      D2,D4       
000019F2  0643 0078               1881          ADD.W       #CLDSIZE*2,D3 ;X1 COORD
000019F6  0644 003C               1882          ADD.W       #CLDSIZE,D4 ;Y2 COORD
000019FA                          1883          
000019FA  7058                    1884          MOVEQ       #88,D0      ;TASK NUM
000019FC                          1885          
000019FC  4E4F                    1886          TRAP        #15
000019FE                          1887          
000019FE                          1888          ;Restaurar registros
000019FE  4CDF 001F               1889          MOVEM.L     (A7)+,D0-D4
00001A02  4E75                    1890          RTS
00001A04                          1891  
00001A04                          1892  
00001A04                          1893  
00001A04                          1894  
00001A04                          1895  
00001A04                          1896  
00001A04                          1897  
00001A04                          1898  
00001A04                          1899  
00001A04                          1900  
00001A04                          1901  
00001A04                          1902  
00001A04                          1903  
00001A04                          1904  
00001A04                          1905  
00001A04                          1906  
00001A04                          1907  
00001A04                          1908  
00001A04                          1909  
00001A04                          1910  
00001A04                          1911  
00001A04                          1912  
00001A04                          1913  
00001A04                          1914  
00001A04                          1915  
00001A04                          1916  -------------------- end include --------------------
00001A04                          1917              INCLUDE "BACKGROUND/GSSDETAIL.X68" ; GRASS DETAILS MANAGEMENT
00001A04                          1918  ; =============================================================================
00001A04                          1919  ; GRASS DETAILS MANAGEMENT. IT IS A PROP.
00001A04                          1920  ; LOCAL MEMORY IS:
00001A04                          1921  ; +0 WORD X COORDINATE
00001A04                          1922  ; =============================================================================
00001A04                          1923  
00001A04                          1924  ; -----------------------------------------------------------------------------
00001A04                          1925  GSSDINIT
00001A04                          1926  ; INITIALIZES THE LITTLE DETAILS ON THE GRASS
00001A04                          1927  ; -----------------------------------------------------------------------------
00001A04  2F00                    1928          MOVE.L      D0,-(A7)
00001A06                          1929          
00001A06  30BC 0280               1930          MOVE.W      #SCRWIDTH,(A0)
00001A0A                          1931          
00001A0A  201F                    1932          MOVE.L      (A7)+,D0
00001A0C  4E75                    1933          RTS
00001A0E                          1934          
00001A0E                          1935          
00001A0E                          1936  ; -----------------------------------------------------------------------------
00001A0E                          1937  GSSDUPD
00001A0E                          1938  ; MODIFIES THE LITTLE DETAILS ON THE GRASS' X COORDINATE
00001A0E                          1939  ; -----------------------------------------------------------------------------
00001A0E                          1940          ;Guardar registros
00001A0E  2F00                    1941          MOVE.L      D0,-(A7)
00001A10                          1942  
00001A10  3039 00001C60           1943          MOVE.W      (XSPEED),D0
00001A16  9150                    1944          SUB.W       D0,(A0)         ;UPDATE X COORDINATE
00001A18  0C50 FFF6               1945          CMP.W       #-GSSDWDTH,(A0)
00001A1C  6F04                    1946          BLE.S       .KILL
00001A1E                          1947          
00001A1E                          1948  .END    ;Restaurar registros
00001A1E  201F                    1949          MOVE.L      (A7)+,D0
00001A20  4E75                    1950          RTS
00001A22                          1951  
00001A22  4EB8 11AA               1952  .KILL   JSR         PRPKILL
00001A26  60F6                    1953          BRA         .END
00001A28                          1954          
00001A28                          1955  ; -----------------------------------------------------------------------------
00001A28                          1956  GSSDPLOT
00001A28                          1957  ; PLOTS THE LITTLE DETAILS ON THE GRASS' X COORDINATE
00001A28                          1958  ; -----------------------------------------------------------------------------
00001A28  48E7 F800               1959          MOVEM.L     D0-D4,-(A7)
00001A2C                          1960          
00001A2C                          1961m         UTLSPEN     #$00000000
00001A2C                          1962m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001A2C                          1963m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001A2C                          1964m ; OUTPUT   - NONE
00001A2C                          1965m ; MODIFIES - D0,D1
00001A2C                          1966m ; -----------------------------------------------------------------------------
00001A34                          1967m         UTLSFIL     #GSSDFC
00001A34                          1968m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001A34                          1969m ; INPUT    - #GSSDFC COLOR IN FORMAT $00BBGGRR
00001A34                          1970m ; OUTPUT   - NONE
00001A34                          1971m ; MODIFIES - D0,D1
00001A34                          1972m ; -----------------------------------------------------------------------------
00001A40                          1973          
00001A40  3210                    1974          MOVE.W      (A0),D1
00001A42  343C 0168               1975          MOVE.W      #BGGSSTP,D2
00001A46  3601                    1976          MOVE.W      D1,D3
00001A48  0643 000A               1977          ADD.W       #GSSDWDTH,D3
00001A4C  383C 0190               1978          MOVE.W      #BGGSSBT,D4
00001A50                          1979          
00001A50  7057                    1980          MOVEQ       #87,D0
00001A52  4E4F                    1981          TRAP        #15
00001A54                          1982          
00001A54  4CDF 001F               1983          MOVEM.L     (A7)+,D0-D4
00001A58  4E75                    1984          RTS
00001A5A                          1985          
00001A5A                          1986  
00001A5A                          1987  
00001A5A                          1988  
00001A5A                          1989  
00001A5A                          1990  
00001A5A                          1991  
00001A5A                          1992  
00001A5A                          1993  -------------------- end include --------------------
00001A5A                          1994  ; -----------------------------------------------------------------------------
00001A5A                          1995  BGUPD
00001A5A                          1996  ; UPDATES DETAILS OF BACKGROUND
00001A5A                          1997  ; INPUT    - NONE
00001A5A                          1998  ; OUTPUT   - NONE
00001A5A                          1999  ; MODIFIES - MEMORY WHEN NEEDED
00001A5A                          2000  ; -----------------------------------------------------------------------------
00001A5A  48E7 8070               2001              MOVEM.L  D0/A1-A3,-(A7)
00001A5E                          2002  
00001A5E  1039 00001C67           2003              MOVE.B  (SCRCYCCT),D0
00001A64  C07C 0007               2004              AND     #$07,D0                 ;EVERY 8 CYCLES
00001A68  6614                    2005              BNE.S   .CLOUD                  ;CREATE A NEW MARK ON GRASS
00001A6A  43F8 1A04               2006              LEA     GSSDINIT,A1
00001A6E  45F8 1A0E               2007              LEA     GSSDUPD,A2
00001A72  47F8 1A28               2008              LEA     GSSDPLOT,A3
00001A76  303C 0002               2009              MOVE.W  #GSSDTYPE,D0
00001A7A                          2010              
00001A7A  4EB8 1562               2011              JSR     PRPADD
00001A7E                          2012  
00001A7E  1039 00001C67           2013  .CLOUD      MOVE.B  (SCRCYCCT),D0
00001A84  C07C 00FF               2014              AND     #$FF,D0                 ; EVERY 256 CYCLES
00001A88  6600 0016               2015              BNE     .END                    ; CREATE A NEW CLOUD
00001A8C  43F8 199C               2016              LEA     CLDINIT,A1
00001A90  45F8 19AE               2017              LEA     CLDUPD,A2
00001A94  47F8 19CC               2018              LEA     CLDPLOT,A3
00001A98  303C 0001               2019              MOVE.W  #CLDTYPE,D0
00001A9C                          2020              
00001A9C  4EB8 1562               2021              JSR     PRPADD
00001AA0                          2022              
00001AA0  4CDF 0E01               2023  .END        MOVEM.L (A7)+,D0/A1-A3
00001AA4  4E75                    2024              RTS
00001AA6                          2025  
00001AA6                          2026  
00001AA6                          2027  ; -----------------------------------------------------------------------------
00001AA6                          2028  BGPLOT
00001AA6                          2029  ; PLOTS BACKGROUND
00001AA6                          2030  ; INPUT    - NONE
00001AA6                          2031  ; OUTPUT   - NONE
00001AA6                          2032  ; MODIFIES - NONE
00001AA6                          2033  ; -----------------------------------------------------------------------------
00001AA6                          2034              
00001AA6  48A7 7800               2035              MOVEM.W D1-D4,-(A7)
00001AAA                          2036              
00001AAA                          2037m             UTLSPEN #BGSKYPC
00001AAA                          2038m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001AAA                          2039m ; INPUT    - #BGSKYPC COLOR IN FORMAT $00BBGGRR
00001AAA                          2040m ; OUTPUT   - NONE
00001AAA                          2041m ; MODIFIES - D0,D1
00001AAA                          2042m ; -----------------------------------------------------------------------------
00001AB2                          2043m             UTLSFIL #BGSKYFC
00001AB2                          2044m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001AB2                          2045m ; INPUT    - #BGSKYFC COLOR IN FORMAT $00BBGGRR
00001AB2                          2046m ; OUTPUT   - NONE
00001AB2                          2047m ; MODIFIES - D0,D1
00001AB2                          2048m ; -----------------------------------------------------------------------------
00001ABE                          2049              
00001ABE  4241                    2050              CLR.W   D1
00001AC0  4242                    2051              CLR.W   D2
00001AC2  363C 0280               2052              MOVE.W  #SCRWIDTH,D3
00001AC6  383C 01E0               2053              MOVE.W  #SCRHEIGH,D4
00001ACA                          2054              
00001ACA  7057                    2055              MOVEQ   #87,D0
00001ACC  4E4F                    2056              TRAP    #15
00001ACE                          2057              
00001ACE                          2058m             UTLSFIL #BGGNDFC
00001ACE                          2059m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001ACE                          2060m ; INPUT    - #BGGNDFC COLOR IN FORMAT $00BBGGRR
00001ACE                          2061m ; OUTPUT   - NONE
00001ACE                          2062m ; MODIFIES - D0,D1
00001ACE                          2063m ; -----------------------------------------------------------------------------
00001ADA                          2064              
00001ADA  4241                    2065              CLR     D1
00001ADC  343C 0190               2066              MOVE.W  #BGGSSBT,D2
00001AE0  363C 0280               2067              MOVE.W  #SCRWIDTH,D3
00001AE4  383C 01E0               2068              MOVE.W  #SCRHEIGH,D4
00001AE8                          2069              
00001AE8  7057                    2070              MOVEQ   #87,D0
00001AEA  4E4F                    2071              TRAP    #15
00001AEC                          2072              
00001AEC                          2073m             UTLSFIL #BGGSSFC
00001AEC                          2074m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001AEC                          2075m ; INPUT    - #BGGSSFC COLOR IN FORMAT $00BBGGRR
00001AEC                          2076m ; OUTPUT   - NONE
00001AEC                          2077m ; MODIFIES - D0,D1
00001AEC                          2078m ; -----------------------------------------------------------------------------
00001AF8                          2079  
00001AF8                          2080  
00001AF8  4241                    2081              CLR     D1
00001AFA  343C 0168               2082              MOVE.W  #BGGSSTP,D2
00001AFE  363C 0280               2083              MOVE.W  #SCRWIDTH,D3
00001B02  383C 0190               2084              MOVE.W  #BGGSSBT,D4
00001B06                          2085              
00001B06  7057                    2086              MOVEQ   #87,D0
00001B08  4E4F                    2087              TRAP    #15
00001B0A                          2088              
00001B0A  4C9F 001E               2089              MOVEM.W (A7)+,D1-D4
00001B0E  4E75                    2090              RTS
00001B10                          2091  
00001B10                          2092  
00001B10                          2093  
00001B10                          2094  
00001B10                          2095  
00001B10                          2096  
00001B10                          2097  
00001B10                          2098  
00001B10                          2099  
00001B10                          2100  
00001B10                          2101  
00001B10                          2102  
00001B10                          2103  
00001B10                          2104  
00001B10                          2105  
00001B10                          2106  
00001B10                          2107  
00001B10                          2108  
00001B10                          2109  -------------------- end include --------------------
00001B10                          2110              INCLUDE "PIPES.X68"                  ; PIPES MANAGEMENT          
00001B10                          2111  ; =============================================================================
00001B10                          2112  ; PIPES MANAGEMENT. IT IS AN AGENT.
00001B10                          2113  ; LOCAL MEMORY IS:
00001B10                          2114  ; +0 WORD X COORDINATE OF THE LEFTMOST EDGE OF THE VERTICALLY ALIGNED PIPES
00001B10                          2115  ; +2 WORD Y COORDINATE OF THE DOWNMOST EDGE OF THE TOP PIPE (FACING DOWN)
00001B10                          2116  ; +4 WORD BOOLEAN THAT TELLS WHETHER THE PIPE SHOULD MOVE OR NOT
00001B10                          2117  ;    (0 == TRUE. ELSE FALSE)
00001B10                          2118  ; =============================================================================
00001B10                          2119  
00001B10                          2120  ; -----------------------------------------------------------------------------
00001B10                          2121  PIPINIT
00001B10                          2122  ; PIPE INITIALIZATION
00001B10                          2123  ; -----------------------------------------------------------------------------
00001B10                          2124              ;Guardar registros
00001B10  48E7 C000               2125              MOVEM.L D0-D1,-(A7)
00001B14                          2126              
00001B14  30BC 0280               2127              MOVE.W  #SCRWIDTH,(A0)      ;X COORDINATE OF STARTING POSITION
00001B18  4EB8 13C0               2128              JSR     UTLRAND             ;RANDOM Y COORDINATE OF STARTING
00001B1C  3140 0002               2129              MOVE.W  D0,2(A0)            *POSITION
00001B20  B23C 0004               2130              CMP.B   #4,D1
00001B24  6606                    2131              BNE.S   .skip
00001B26                          2132              
00001B26  4239 00001C5C           2133              CLR.B   (PIPCOUNT)
00001B2C                          2134  .skip            
00001B2C  1141 0004               2135              MOVE.B  D1,4(A0)            ;BOOLEAN: MOVING OR NOT
00001B30                          2136          
00001B30                          2137              ;Restaurar registros
00001B30  4CDF 0003               2138              MOVEM.L (A7)+,D0-D1
00001B34  4E75                    2139              RTS
00001B36                          2140              
00001B36                          2141  ; -----------------------------------------------------------------------------
00001B36                          2142  PIPUPD
00001B36                          2143  ; PIPE UPDATE
00001B36                          2144  ; -----------------------------------------------------------------------------
00001B36                          2145               ;Guardar registros
00001B36  48E7 FF00               2146              MOVEM.L  D0-D7,-(A7)
00001B3A                          2147              
00001B3A  3039 00001C60           2148              MOVE.W  (XSPEED),D0     
00001B40  9150                    2149              SUB.W   D0,(A0)         ;UPDATE X COORDINATE
00001B42                          2150              
00001B42  0C50 FFC4               2151              CMP.W   #-PIPTWDT,(A0)
00001B46  6F3A                    2152              BLE.S   .KILL
00001B48                          2153              
00001B48                          2154  
00001B48                          2155              ;Preparar los registros para llamar a la subrutina que comprueba 
00001B48                          2156              ;las colisiones con las tuberías. 
00001B48  3010                    2157              MOVE.W (A0), D0
00001B4A  3228 0002               2158              MOVE.W 2(A0), D1
00001B4E  3439 00001C44           2159              MOVE.W (PLRPOSX), D2
00001B54  3639 00001C46           2160              MOVE.W (PLRPOSY), D3
00001B5A  383C 0032               2161              MOVE.W #PIPBWDT, D4
00001B5E  3A3C 0019               2162              MOVE.W #PLRWIDTH, D5
00001B62  3C3C 0064               2163              MOVE.W #PIPOPEN, D6
00001B66  3E3C 0019               2164              MOVE.W #PLRHEIGHT, D7
00001B6A  4EB8 138A               2165              JSR UTLCHCOL           
00001B6E                          2166              
00001B6E  4A00                    2167              TST.B D0
00001B70  6700 000A               2168              BEQ .END
00001B74  33FC 0001 00001C4E      2169              MOVE.W #1, (PLRDEAD)
00001B7C                          2170              
00001B7C                          2171  .END        ;Restaurar registros
00001B7C  4CDF 00FF               2172              MOVEM.L  (A7)+,D0-D7
00001B80  4E75                    2173              RTS
00001B82                          2174              
00001B82  4EB8 11AA               2175  .KILL       JSR     AGLKILL
00001B86  60F4                    2176              BRA.S  .END
00001B88                          2177  
00001B88                          2178  ; -----------------------------------------------------------------------------
00001B88                          2179  PIPPLOT
00001B88                          2180  ; PIPE PLOT
00001B88                          2181  ; -----------------------------------------------------------------------------
00001B88                          2182              ;Guardar registros
00001B88  48E7 F800               2183              MOVEM.L D0-D4,-(A7)
00001B8C                          2184              
00001B8C                          2185m             UTLSPEN #PIPPC
00001B8C                          2186m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001B8C                          2187m ; INPUT    - #PIPPC COLOR IN FORMAT $00BBGGRR
00001B8C                          2188m ; OUTPUT   - NONE
00001B8C                          2189m ; MODIFIES - D0,D1
00001B8C                          2190m ; -----------------------------------------------------------------------------
00001B94                          2191              
00001B94  0C28 0000 0004          2192              CMP.B   #0,4(A0)
00001B9A  6710                    2193              BEQ.S   .skip
00001B9C                          2194              
00001B9C                          2195m             UTLSFIL #PIPFC
00001B9C                          2196m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001B9C                          2197m ; INPUT    - #PIPFC COLOR IN FORMAT $00BBGGRR
00001B9C                          2198m ; OUTPUT   - NONE
00001B9C                          2199m ; MODIFIES - D0,D1
00001B9C                          2200m ; -----------------------------------------------------------------------------
00001BA8  6000 000A               2201              BRA     .skp2
00001BAC                          2202  .skip       
00001BAC                          2203m             UTLSFIL #$00000000      ;prueba para pipes que se han de mover
00001BAC                          2204m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001BAC                          2205m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001BAC                          2206m ; OUTPUT   - NONE
00001BAC                          2207m ; MODIFIES - D0,D1
00001BAC                          2208m ; -----------------------------------------------------------------------------
00001BB4                          2209  .skp2
00001BB4                          2210              
00001BB4  3210                    2211              MOVE.W  (A0),D1         ;PAINT THE BASE OF THE TOP PIPE
00001BB6  5A41                    2212              ADDQ    #PIPTBSPC,D1
00001BB8  4242                    2213              CLR     D2
00001BBA  3601                    2214              MOVE.W  D1,D3
00001BBC  0643 0032               2215              ADD.W   #PIPBWDT,D3
00001BC0  3828 0002               2216              MOVE.W  2(A0),D4
00001BC4                          2217              
00001BC4  7057                    2218              MOVEQ   #87,D0
00001BC6  4E4F                    2219              TRAP    #15
00001BC8                          2220              
00001BC8  3210                    2221              MOVE.W  (A0),D1         ;PAINT THE MOUTH OF THE TOP PIPE
00001BCA  3828 0002               2222              MOVE.W  2(A0),D4
00001BCE  3404                    2223              MOVE.W  D4,D2
00001BD0  0442 000A               2224              SUB.W   #PIPTHGT,D2
00001BD4  3601                    2225              MOVE.W  D1,D3
00001BD6  0643 003C               2226              ADD.W   #PIPTWDT,D3
00001BDA                          2227              
00001BDA  7057                    2228              MOVEQ   #87,D0
00001BDC  4E4F                    2229              TRAP    #15
00001BDE                          2230              
00001BDE  3210                    2231              MOVE.W  (A0),D1         ;PAINT THE BASE OF THE BOTTOM PIPE
00001BE0  5A41                    2232              ADD.W   #PIPTBSPC,D1
00001BE2  3428 0002               2233              MOVE.W  2(A0),D2
00001BE6  0642 0064               2234              ADD.W   #PIPOPEN,D2
00001BEA  3601                    2235              MOVE.W  D1,D3
00001BEC  0643 0032               2236              ADD.W   #PIPBWDT,D3
00001BF0  383C 0168               2237              MOVE.W  #BGGSSTP,D4
00001BF4                          2238              
00001BF4  7057                    2239              MOVEQ   #87,D0
00001BF6  4E4F                    2240              TRAP    #15
00001BF8                          2241              
00001BF8  3210                    2242              MOVE.W  (A0),D1         ;PAINT THE MOUTH OF THE BOTTOM PIPE
00001BFA  3428 0002               2243              MOVE.W  2(A0),D2
00001BFE  0642 0064               2244              ADD.W   #PIPOPEN,D2
00001C02  3601                    2245              MOVE.W  D1,D3
00001C04  0643 003C               2246              ADD.W   #PIPTWDT,D3
00001C08  3802                    2247              MOVE.W  D2,D4
00001C0A  0644 000A               2248              ADD.W   #PIPTHGT,D4
00001C0E                          2249              
00001C0E  7057                    2250              MOVEQ   #87,D0
00001C10  4E4F                    2251              TRAP    #15
00001C12                          2252  
00001C12                          2253              ;Restaurar registros
00001C12  4CDF 001F               2254              MOVEM.L (A7)+,D0-D4
00001C16  4E75                    2255              RTS
00001C18                          2256  
00001C18                          2257  
00001C18                          2258  
00001C18                          2259  
00001C18                          2260  
00001C18                          2261  
00001C18                          2262  
00001C18                          2263  
00001C18                          2264  
00001C18                          2265  
00001C18                          2266  
00001C18                          2267  
00001C18                          2268  
00001C18                          2269  
00001C18                          2270  
00001C18                          2271  
00001C18                          2272  
00001C18                          2273  -------------------- end include --------------------
00001C18                          2274  
00001C18                          2275  
00001C18                          2276  ; --- INITIALIZE --------------------------------------------------------------
00001C18                          2277  
00001C18  4EB8 1000               2278  START       JSR     SYSINIT
00001C1C  4EB8 1616               2279              JSR     STAINIT
00001C20                          2280  
00001C20                          2281  ; --- UPDATE ------------------------------------------------------------------
00001C20                          2282   
00001C20  4E40                    2283  .LOOP       TRAP    #KBDTRAP                ; READ KEYBOARD
00001C22  4EB8 1628               2284              JSR     STAUPD
00001C26                          2285  
00001C26                          2286  ; --- WAIT SYNCH --------------------------------------------------------------
00001C26                          2287  
00001C26  4A39 00001C66           2288  .WINT       TST.B   (SCRINTCT)              ; WAIT FOR INTERRUPT
00001C2C  67F8                    2289              BEQ     .WINT
00001C2E  4239 00001C66           2290              CLR.B   (SCRINTCT)
00001C34                          2291  
00001C34                          2292  ; --- PLOT --------------------------------------------------------------------
00001C34                          2293  
00001C34  4EB8 1686               2294              JSR     STAPLOT
00001C38  4E41                    2295              TRAP    #SCRTRAP                ; SHOW GRAPHICS
00001C3A  60E4                    2296              BRA     .LOOP
00001C3C  FFFF FFFF               2297              SIMHALT
00001C40                          2298  
00001C40                          2299  ; --- VARIABLES ---------------------------------------------------------------
00001C40                          2300  
00001C40                          2301              INCLUDE "VAR.X68"
00001C40                          2302  ; =============================================================================
00001C40                          2303  ; GAME VARS
00001C40                          2304  ; =============================================================================
00001C40                          2305  
00001C40                          2306  ; --- GAME STATE RELATED VARIABLES --------------------------------------------
00001C40                          2307  
00001C40                          2308  STACUR      DS.W    1                       ; CURRENT GAME STATE
00001C42                          2309  STANEXT     DS.W    1                       ; NEXT GAME STATE
00001C44                          2310  
00001C44                          2311  ; --- PLAYER RELATED VARIABLES ------------------------------------------------
00001C44                          2312  
00001C44                          2313  PLRPOSX      DS.W    1                       ; PLAYER X POSITION (PIXELS)
00001C46                          2314  PLRPOSY      DS.W    1                       ; PLAYER Y POSITION (PIXELS)
00001C48                          2315  MAXPOS       DS.W    1                       ; JUMP MAX POSITION
00001C4A                          2316  UPPRESSED    DS.W    1                       ; 1 IF UP PRESSED, 0 IF NO PRESSED
00001C4C                          2317  PLRDOWNSPEED DS.W    1                       ; PLAYER DOWN SPEED
00001C4E                          2318  PLRDEAD      DS.W    1                       ; PLAYER DEAD
00001C50                          2319  PLRSCORE     DS.W    1                       ; PLAYER SCORE
00001C52= 5343 4F52 453A 2...     2320  PLRSCORETEXT DC.W    'SCORE: ',0             ; SCORE TEXT
00001C5C                          2321               DS.W    0
00001C5C                          2322              
00001C5C                          2323  ; --- PIPE RELATED VARIABLES --------------------------------------------------
00001C5C                          2324  
00001C5C= 01                      2325  PIPCOUNT    DC.B    1
00001C5E= 0001                    2326  PIPEPOSX    DC.W    1
00001C60                          2327              DS.W    0
00001C60                          2328  
00001C60                          2329  ; --- GAME RELATED VARIABLES --------------------------------------------------
00001C60                          2330  
00001C60= 0005                    2331  XSPEED      DC.W    5                       ;HORIZONTAL SPEED OF OBJECTS
00001C62                          2332  
00001C62                          2333  ; --- PAUSE MENU RELATED VARIABLES -------------------------------------------
00001C62                          2334  
00001C62= 00                      2335  PMOPTN      DC.B    0                       ;OPTION ON THE MENU TO BE CHOSEN
00001C63                          2336  
00001C63                          2337  ; --- UTILITY VARIABLES ------------------------------------------------------
00001C63                          2338  
00001C63                          2339  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001C64                          2340              DS.W    0
00001C64                          2341  
00001C64                          2342  
00001C64                          2343  
00001C64                          2344  
00001C64                          2345  
00001C64                          2346  
00001C64                          2347  
00001C64                          2348  
00001C64                          2349  
00001C64                          2350  
00001C64                          2351  
00001C64                          2352  
00001C64                          2353  
00001C64                          2354  
00001C64                          2355  
00001C64                          2356  
00001C64                          2357  
00001C64                          2358  
00001C64                          2359  
00001C64                          2360  -------------------- end include --------------------
00001C64                          2361              INCLUDE "SYSVAR.X68"
00001C64                          2362  ; =============================================================================
00001C64                          2363  ; SYSTEM VARS
00001C64                          2364  ; NOTE THAT ALL THESE VARS ARE USED TO SHARE DATA FROM SYSTEM TO USER. THUS
00001C64                          2365  ; THEY MUST NOT BE IN PROTECTED MEMORY.
00001C64                          2366  ; NOTE THAT USING DMMDATA IN SUCH WAY IS A BAD IDEA, AS USER APPLICATIONS CAN
00001C64                          2367  ; ALSO FREE OR CHANGE OWNERSHIP. NONETHELESS, FOR THE SAKE OF THIS EXAMPLE
00001C64                          2368  ; THIS IS GOOD ENOUGH.
00001C64                          2369  ; =============================================================================
00001C64                          2370  
00001C64                          2371  ; --- KEYBOARD RELATED VARIABLES ----------------------------------------------
00001C64                          2372  
00001C64                          2373  KBDVAL      DS.B    1                       ; KEY PRESSED=1
00001C65                          2374  KBDEDGE     DS.B    1                       ; KEY CHANGED=1
00001C66                          2375  
00001C66                          2376              DS.W    0
00001C66                          2377  
00001C66                          2378  ; --- SCREEN RELATED VARIABLES ------------------------------------------------
00001C66                          2379  
00001C66                          2380  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER/FLAG
00001C67                          2381  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00001C68                          2382              DS.W    0
00001C68                          2383  
00001C68                          2384  ; --- DYNAMIC MEMORY VARIABLES ------------------------------------------------
00001C68                          2385  
00001C80                          2386              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00001C80                          2387  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00002900                          2388              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00002900                          2389  
00002900                          2390  
00002900                          2391  -------------------- end include --------------------
00002900                          2392  
00002900                          2393              END    START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              14DE
AGLADD:END          14F4
AGLKILL             11AA
AGLPLOT             152C
AGLPLOT:END         155C
AGLPLOT:LOOP        1534
AGLPLOT:NEXT        1556
AGLUPD              14F8
AGLUPD:END          1526
AGLUPD:LOOP         1500
AGLUPD:NEXT         1520
BGGNDFC             155DD8
BGGNDPC             0
BGGNDTP             190
BGGSSBT             190
BGGSSFC             990A
BGGSSPC             0
BGGSSTP             168
BGPLOT              1AA6
BGSKYFC             EFCE87
BGSKYPC             0
BGUPD               1A5A
BGUPD:CLOUD         1A7E
BGUPD:END           1AA0
BLACK               0
CLDFCLR             FFFFFF
CLDINIT             199C
CLDPCLR             FFFFFF
CLDPLOT             19CC
CLDSIZE             3C
CLDTYPE             1
CLDUPD              19AE
CLDUPD:END          19C2
CLDUPD:KILL         19C6
CONTNUM             0
DMMALLOC            1190
DMMALLOC:END        11A8
DMMBNUM             32
DMMBSIZE            40
DMMDATA             1C80
DMMFCOM             116A
DMMFFND             1178
DMMFIRST            1120
DMMFLOOP            115E
DMMFRCOM            1132
DMMFREE             11AA
DMMFRFND            1140
DMMFRLOP            1126
DMMFRSTO            1158
DMMINIT             10FE
DMMINIT:LOOP        110C
DMMNEXT             1142
DMMNEXTO            117A
DMMSYSID            0
EXTNUM              2
GOVSTRC             FFFFFF
GOVSTRX             23
GOVSTRY             F
GREEN               8000
GSSDFC              39DB44
GSSDINIT            1A04
GSSDPLOT            1A28
GSSDTYPE            2
GSSDUPD             1A0E
GSSDUPD:END         1A1E
GSSDUPD:KILL        1A22
GSSDWDTH            A
INTPRSC             80
INTPRSF             31A0001
INTPRSX             5
INTPRSY             8
INTTITC             FFFF
INTTITF             33D0001
INTTITX             1
INTTITY             1
JUMPSIZE            3C
JUMPSPEED           3
KBDBITDN            3
KBDBITF1            4
KBDBITF2            5
KBDBITF3            6
KBDBITLF            0
KBDBITPS            7
KBDBITRT            2
KBDBITUP            1
KBDCHRDN            28
KBDCHRLF            25
KBDCHRMK            4D
KBDCHRPK            50
KBDCHRRT            27
KBDCHRSH            10
KBDCHRSP            20
KBDCHRUP            26
KBDDOWN             28
KBDEDGE             1C65
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1090
KBDLEFT             25
KBDMSKDN            8
KBDMSKF1            10
KBDMSKF2            20
KBDMSKF3            40
KBDMSKLF            1
KBDMSKPS            80
KBDMSKRT            4
KBDMSKUP            2
KBDPAUSE            50
KBDREAD             10A6
KBDREAD:KEYSREADY   10E2
KBDREAD:LOOP        10C4
KBDREAD:NEXTKEYS    10C2
KBDREAD:NOTPRESSED  10CE
KBDRIGHT            27
KBDTRAP             0
KBDUP               26
KBDVAL              1C64
MAXPOS              1C48
NEWGNUM             1
PAUCNTY             8
PAUEXTY             C
PAUNEWY             A
PAUOPTC             FFFFFF
PAUOPTFS            1130005
PAUOPTFU            1130001
PAUOPTX             F
PAUSELC             FF
PAUTITC             FFFF
PAUTITF             3300001
PAUTITX             2
PAUTITY             1
PIPBWDT             32
PIPCOUNT            1C5C
PIPEPOSX            1C5E
PIPFC               196600
PIPINIT             1B10
PIPINIT:SKIP        1B2C
PIPOPEN             64
PIPPC               0
PIPPLOT             1B88
PIPPLOT:SKIP        1BAC
PIPPLOT:SKP2        1BB4
PIPTBSPC            5
PIPTHGT             A
PIPTWDT             3C
PIPTYPE             3
PIPUPD              1B36
PIPUPD:END          1B7C
PIPUPD:KILL         1B82
PIPYSPD             2
PLRCOLOR            8000
PLRDEAD             1C4E
PLRDOWNSPEED        1C4C
PLREYECOLOR         FFFFFF
PLRHEIGHT           19
PLRINIT             11C0
PLRINITPOSX         96
PLRINITPOSY         B4
PLRIRISCOLOR        0
PLRMOUTHCOLOR       FF
PLRPLOT             12C6
PLRPOSX             1C44
PLRPOSY             1C46
PLRSCORE            1C50
PLRSCORETEXT        1C52
PLRUPD              11FE
PLRUPD:END          12C0
PLRUPD:GAMEOVER     12B4
PLRUPD:LASTJUMP     12A8
PLRUPD:MAKEJUMP     1274
PLRUPD:PRESSED      1250
PLRWIDTH            19
PMOPTN              1C62
PRPADD              1562
PRPADD:END          1578
PRPKILL             11AA
PRPPLOT             15AA
PRPPLOT:END         15D2
PRPPLOT:LOOP        15B2
PRPPLOT:NEXT        15CC
PRPUPD              157C
PRPUPD:END          15A4
PRPUPD:LOOP         1584
PRPUPD:NEXT         159E
RED                 FF
SCRCYCCT            1C67
SCRHEIGH            1E0
SCRINIT             101C
SCRINTCT            1C66
SCRIRQ              1
SCRISR              1074
SCRTIM              14
SCRTRAP             1
SCRUPD              1082
SCRWIDTH            280
SPWUPD              15D8
SPWUPD:END          1610
STACUR              1C40
STAEMPTY            16B2
STAGOVR             3
STAGOVRP            195C
STAGOVRP:GOVSTR     1990
STAGOVRU            1946
STAGOVRU:END        195A
STAINIT             1616
STAINTR             0
STAINTRI            10FE
STAINTRP            1706
STAINTRP:START_TEXT  1768
STAINTRP:TITLE      175C
STAINTRU            16F0
STAINTRU:END        1704
STANEXT             1C42
STANONE             FFFFFFFF
STAPAU              2
STAPAUI             177E
STAPAUP             1820
STAPAUP:CNTSEL      1872
STAPAUP:CONT        192A
STAPAUP:EXIT        1940
STAPAUP:EXTSEL      18F2
STAPAUP:NEWG        1934
STAPAUP:NEWSEL      18B2
STAPAUP:SKPCNT      1882
STAPAUP:SKPEXT      1902
STAPAUP:SKPNEW      18C2
STAPAUP:TITLE       191C
STAPAUU             1788
STAPAUU:CONTGAME    1802
STAPAUU:DN          17CC
STAPAUU:END         17B8
STAPAUU:EXITGAME    1816
STAPAUU:JMPLST      17F0
STAPAUU:NEWGAME     180C
STAPAUU:OK          17DE
STAPAUU:UP          17BA
STAPLAY             1
STAPLAYI            11C0
STAPLAYP            16DE
STAPLAYU            16B4
STAPLAYU:PAUSE      16D4
STAPLOT             1686
STAPLOT:PLTTBL      16A2
START               1C18
START:LOOP          1C20
START:WINT          1C26
STAUPD              1628
STAUPD:DOUPD        164E
STAUPD:INITBL       1666
STAUPD:UPDTBL       1676
SYSINIT             1000
UPPRESSED           1C4A
UTLCHCOL            138A
UTLCHCOL:COL        13AE
UTLCHCOL:END        13BA
UTLCHCOL:NOCOL      13B6
UTLFONT             37C
UTLINIT             1382
UTLLOCT             254
UTLRAND             13C0
UTLRAND:RANDVEC     13DE
UTLRNDIX            1C63
UTLSFIL             12A
UTLSPEN             0
WHITE               FFFFFF
XSPEED              1C60
