00001B80 Starting Address
Assembler used: EASy68K Editor/Assembler v5.16.01
Created On: 29/12/2018 12:25:37

00000000                             1  ; =============================================================================
00000000                             2  ; TITLE    : YET ANOTHER FLAPPY BIRD (YAF)
00000000                             3  ; AUTHORS  : DOÑAQUE, EUGENIO && LLABRÉS, NADAL.
00000000                             4  ; CREATION : DEC 2018
00000000                             5  ; =============================================================================
00000000                             6  
00001000                             7              ORG     $1000
00001000                             8  
00001000                             9  ; --- CODE INCLUDES -----------------------------------------------------------
00001000                            10  
00001000                            11              INCLUDE "SYSCONST.X68"               ; SYSTEM CONSTANTS
00001000                            12  ; =============================================================================
00001000                            13  ; SYSTEM CONSTANTS
00001000                            14  ; =============================================================================
00001000                            15  
00001000                            16  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
00001000                            17  
00001000  =00000000                 18  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
00001000  =00000001                 19  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
00001000                            20  
00001000                            21  ; --- KEY CODES (EASy68K)
00001000                            22  
00001000  =00000020                 23  KBDCHRSP    EQU     $20                     ; SPACE KEY
00001000  =0000004D                 24  KBDCHRMK    EQU     'M'                     ; M KEY
00001000  =00000010                 25  KBDCHRSH    EQU     $10                     ; SHIFT KEY
00001000  =00000050                 26  KBDCHRPK    EQU     'P'                     ; P KEY
00001000  =00000025                 27  KBDCHRLF    EQU     $25                     ; LEFT KEY
00001000  =00000026                 28  KBDCHRUP    EQU     $26                     ; UP KEY
00001000  =00000027                 29  KBDCHRRT    EQU     $27                     ; RIGHT KEY
00001000  =00000028                 30  KBDCHRDN    EQU     $28                     ; DOWN KEY
00001000                            31  
00001000                            32  ; --- KEYBOARD MAPPING --------------------------------------------------------
00001000                            33  
00001000  =00000025                 34  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
00001000  =00000026                 35  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
00001000  =00000027                 36  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
00001000  =00000028                 37  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
00001000  =00000020                 38  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
00001000  =0000004D                 39  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
00001000  =00000010                 40  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
00001000  =00000050                 41  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
00001000                            42  
00001000                            43  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
00001000                            44  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
00001000                            45  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
00001000                            46  ; +---+---+---+---+---+---+---+---+
00001000                            47  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
00001000                            48  ; +---+---+---+---+---+---+---+---+
00001000                            49  ;   |   |   |   |   |   |   |   |
00001000                            50  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
00001000                            51  ;   |   |   |   |   |   |   +-------------- UP BUTTON
00001000                            52  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
00001000                            53  ;   |   |   |   |   +---------------------- DOWN BUTTON
00001000                            54  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
00001000                            55  ;   |   |   +------------------------------ FIRE 2 BUTTON
00001000                            56  ;   |   +---------------------------------- FIRE 3 BUTTON
00001000                            57  ;   +-------------------------------------- PAUSE BUTTON
00001000                            58  
00001000  =00000001                 59  KBDMSKLF    EQU     %00000001
00001000  =00000002                 60  KBDMSKUP    EQU     %00000010
00001000  =00000004                 61  KBDMSKRT    EQU     %00000100
00001000  =00000008                 62  KBDMSKDN    EQU     %00001000
00001000  =00000010                 63  KBDMSKF1    EQU     %00010000
00001000  =00000020                 64  KBDMSKF2    EQU     %00100000
00001000  =00000040                 65  KBDMSKF3    EQU     %01000000
00001000  =00000080                 66  KBDMSKPS    EQU     %10000000
00001000                            67  
00001000                            68  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
00001000                            69  
00001000  =00000000                 70  KBDBITLF    EQU     0
00001000  =00000001                 71  KBDBITUP    EQU     1
00001000  =00000002                 72  KBDBITRT    EQU     2
00001000  =00000003                 73  KBDBITDN    EQU     3
00001000  =00000004                 74  KBDBITF1    EQU     4
00001000  =00000005                 75  KBDBITF2    EQU     5
00001000  =00000006                 76  KBDBITF3    EQU     6
00001000  =00000007                 77  KBDBITPS    EQU     7
00001000                            78  
00001000                            79  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
00001000                            80  
00001000  =00000280                 81  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
00001000  =000001E0                 82  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
00001000  =00000001                 83  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
00001000  =00000014                 84  SCRTIM      EQU     20                      ; SCREEN TIMER (MS)
00001000                            85  
00001000                            86  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
00001000                            87  
00001000  =00000040                 88  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
00001000  =00000032                 89  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
00001000  =00000000                 90  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
00001000                            91  
00001000                            92  
00001000                            93  
00001000                            94  
00001000                            95  -------------------- end include --------------------
00001000                            96              INCLUDE "SYSTEM.X68"                 ; SYSTEM CODE
00001000                            97  ; =============================================================================
00001000                            98  ; SYSTEM MANAGEMENT (SYSTEM CODE)
00001000                            99  ; =============================================================================
00001000                           100  
00001000                           101  ; -----------------------------------------------------------------------------
00001000                           102  SYSINIT
00001000                           103  ; INITIALIZES THE SYSTEM
00001000                           104  ; INPUT    - NONE
00001000                           105  ; OUTPUT   - NONE
00001000                           106  ; MODIFIES - NONE
00001000                           107  ; -----------------------------------------------------------------------------
00001000  205F                     108              MOVE.L  (A7)+,A0                ; GET RETURN ADDRESS
00001002  4EB9 00001090            109              JSR     KBDINIT                 ; INIT KEYBOARD
00001008  4EB9 0000101C            110              JSR     SCRINIT                 ; INIT SCREEN
0000100E  4EB9 000010FE            111              JSR     DMMINIT                 ; INIT DYNAMIC MEMORY
00001014  027C DFFF                112              ANDI.W  #$DFFF,SR               ; SWITCH TO USER
00001018  2F08                     113              MOVE.L  A0,-(A7)                ; PUT RETURN ADDRESS
0000101A  4E75                     114              RTS
0000101C                           115  
0000101C                           116  ; =============================================================================
0000101C                           117  ; SCREEN MANAGEMENT (SYSTEM CODE)
0000101C                           118  ; =============================================================================
0000101C                           119  
0000101C                           120  ; -----------------------------------------------------------------------------
0000101C                           121  SCRINIT
0000101C                           122  ; INITIALIZES THE SCREEN, SCREEN-RELATED INTERRUPT AND VARS.
0000101C                           123  ; INPUT    - NONE
0000101C                           124  ; OUTPUT   - NONE
0000101C                           125  ; MODIFIES - D0,D1,D2,D3
0000101C                           126  ; -----------------------------------------------------------------------------
0000101C                           127              ; TO DO:
0000101C                           128              ; - DISABLE INTS (SET INT BITS IN SR TO 111)
0000101C                           129              
0000101C  007C 0700                130              ORI.W #(7<<8)&$700,SR
00001020                           131              
00001020                           132              ; - INSTALL SCRUPD INTO TRAP SCRTRAP
00001020                           133              
00001020  21FC 00001082 0084       134              MOVE.L  #SCRUPD,($80+4*SCRTRAP)
00001028                           135              
00001028                           136              ; - SET RESOLUTION TO SCRWIDTH X SCRHEIGHT
00001028                           137              
00001028  7021                     138              MOVE.L  #33,D0
0000102A  223C 028001E0            139              MOVE.L  #SCRWIDTH*$10000+SCRHEIGH,D1
00001030  4E4F                     140              TRAP    #15
00001032                           141              
00001032                           142              ; - SET WINDOWED MODE
00001032                           143              
00001032  7201                     144              MOVEQ   #1, D1 
00001034  4E4F                     145              TRAP    #15
00001036                           146              
00001036                           147              ; - CLEAR VISIBLE BUFFER
00001036                           148              
00001036  700B                     149              MOVEQ   #11, D0
00001038  323C FF00                150              MOVE.W  #$FF00,D1
0000103C  4E4F                     151              TRAP    #15
0000103E                           152              
0000103E                           153              ; - ENABLE DOUBLE BUFFER
0000103E                           154              
0000103E  705C                     155              MOVEQ   #92, D0
00001040  7211                     156              MOVEQ   #17, D1     
00001042  4E4F                     157              TRAP    #15
00001044                           158              
00001044                           159              ; - CLEAR HIDDEN BUFFER
00001044                           160              
00001044  700B                     161              MOVEQ   #11, D0
00001046  323C FF00                162              MOVE.W  #$FF00,D1
0000104A  4E4F                     163              TRAP    #15
0000104C                           164              
0000104C                           165              ; - INSTALL SCRISR FOR IRQ SCRIRQ (IRQ INTERRUPT VECTOR BEGINS
0000104C                           166              ;   AT $60. INSTALLATION IS SIMILAR TO TRAP INSTALLATION)
0000104C                           167              
0000104C  21FC 00001074 0064       168              MOVE.L  #SCRISR,($60+4*SCRIRQ)
00001054                           169              
00001054                           170              ; - ENABLE AUTO-IRQ EVERY SCRTIM MS FOR IRQ SCRIRQ (SEE TRAP #15
00001054                           171              ;   TASK 32)
00001054                           172              
00001054  7020                     173              MOVEQ   #32,D0
00001056  7206                     174              MOVEQ   #6,D1
00001058  243C 00000081            175              MOVE.L  #$80+SCRIRQ,D2
0000105E  7614                     176              MOVE.L  #SCRTIM, D3
00001060  4E4F                     177              TRAP    #15
00001062                           178              
00001062                           179              ; - CLEAR SCRINTCT AND SCRCYCCT
00001062                           180              
00001062  4239 00001BBE            181              CLR.B   (SCRINTCT)
00001068  4239 00001BBF            182              CLR.B   (SCRCYCCT)
0000106E                           183              
0000106E                           184              ; - ENABLE INTS (SET INT BITS IN SR TO 000)
0000106E                           185              
0000106E  027C F8FF                186              ANDI.W #$F8FF,SR
00001072                           187              
00001072  4E75                     188              RTS
00001074                           189  
00001074                           190  ; -----------------------------------------------------------------------------
00001074                           191  SCRISR
00001074                           192  ; SCREEN TIMER ISR. INCREASES THE INTERRUPT COUNTER AND UPDATES DOUBLE BUFFER.
00001074                           193  ; INPUT    - NONE
00001074                           194  ; OUTPUT   - NONE
00001074                           195  ; MODIFIES - NONE
00001074                           196  ; -----------------------------------------------------------------------------
00001074  5239 00001BBE            197              ADDQ.B  #1,(SCRINTCT)           ; UPDATE INT FLAG/COUNTER
0000107A  5239 00001BBF            198              ADDQ.B  #1,(SCRCYCCT)           ; UPDATE CYCLE COUNTER
00001080  4E73                     199              RTE
00001082                           200  
00001082                           201  ; -----------------------------------------------------------------------------
00001082                           202  SCRUPD
00001082                           203  ; TRAP SERVICE ROUTINE IN CHARGE OF VISUALIZING CURRENT FRAME AND CLEARING
00001082                           204  ; BUFFER FOR THE NEXT ONE.
00001082                           205  ; INPUT    - NONE
00001082                           206  ; OUTPUT   - NONE
00001082                           207  ; MODIFIES - NONE
00001082                           208  ; -----------------------------------------------------------------------------
00001082                           209              ; TO DO: UPDATE DOUBLE BUFFER AND CLEAR HIDDEN BUFFER
00001082                           210              ; - UPDATE DOUBLE BUFFER
00001082                           211              
00001082  705E                     212              MOVEQ   #94,D0
00001084  4E4F                     213              TRAP    #15
00001086                           214              
00001086                           215              ; - CLEAR HIDDEN BUFFER
00001086                           216                                 
00001086  700B                     217              MOVEQ   #11, D0
00001088  323C FF00                218              MOVE.W  #$FF00,D1
0000108C  4E4F                     219              TRAP    #15
0000108E                           220              
0000108E  4E73                     221              RTE
00001090                           222  
00001090                           223  ; =============================================================================
00001090                           224  ; KEYBOARD MANAGEMENT (SYSTEM CODE)
00001090                           225  ; =============================================================================
00001090                           226  
00001090                           227  ; -----------------------------------------------------------------------------
00001090                           228  KBDINIT
00001090                           229  ; INITIALIZES THE SYSTEM VARIABLES KBDSYS AND KBDVAL
00001090                           230  ; INPUT    - NONE
00001090                           231  ; OUTPUT   - NONE
00001090                           232  ; MODIFIES - NONE
00001090                           233  ; -----------------------------------------------------------------------------
00001090  4239 00001BBC            234              CLR.B   (KBDVAL)                ; INIT VARS
00001096  4239 00001BBD            235              CLR.B   (KBDEDGE)
0000109C  21FC 000010A6 0080       236              MOVE.L  #KBDREAD,($80+KBDTRAP*4) ; INSTALL
000010A4  4E75                     237              RTS
000010A6                           238  
000010A6                           239  ; -----------------------------------------------------------------------------
000010A6                           240  KBDREAD
000010A6                           241  ; TRAP SERVICE ROUTINE.
000010A6                           242  ; UPDATES THE SYSTEM VARIABLES KBDEDGE AND KBDVAL ACCORDING TO THE BITFIELD
000010A6                           243  ; DESCRIBED IN SYSCONST. KBDVAL HOLDS THE CURRENT VALUES AND KBDEFGE HOLDS
000010A6                           244  ; RISING EDGES FROM PREVIOUS CALL TO THE CURRENT ONE.
000010A6                           245  ; INPUT    - NONE
000010A6                           246  ; OUTPUT   - (KBDVAL) AND (KBDEDGE)
000010A6                           247  ; MODIFIES - NONE
000010A6                           248  ; -----------------------------------------------------------------------------
000010A6                           249              ; TO DO: UPDATE KBDVAL AND KBDEDGE
000010A6                           250              ;Guardar registros en pila
000010A6  48E7 F800                251              MOVEM.L D0-D4,-(A7)
000010AA                           252  
000010AA                           253              ;Obtener estado de teclas
000010AA  7013                     254              MOVEQ   #19,D0
000010AC                           255              
000010AC                           256              ;Obtener estado de teclas PAUSE - FIRE3 - FIRE2 - FIRE1
000010AC  223C 50104D20            257              MOVE.L  #KBDCHRPK<<24+KBDCHRSH<<16+KBDCHRMK<<8+KBDCHRSP,D1
000010B2                           258              
000010B2  4E4F                     259              TRAP    #15
000010B4                           260              
000010B4                           261              ;GUARDAR ESTADO DE TECLAS
000010B4  2401                     262              MOVE.L  D1,D2                   
000010B6                           263              
000010B6                           264              ;Obtener estado de teclas DOWN - RIGHT - UP - LEFT
000010B6  223C 28272625            265              MOVE.L  #KBDCHRDN<<24+KBDCHRRT<<16+KBDCHRUP<<8+KBDCHRLF,D1
000010BC                           266  
000010BC  4E4F                     267              TRAP    #15
000010BE                           268            
000010BE                           269              ;Actualizar valores de KBDVAL
000010BE  4243                     270              CLR     D3        ;Registro que contendrá KBDVAL.
000010C0  4244                     271              CLR     D4        ;Registro con índice de bit a modificar de D3.
000010C2                           272              
000010C2                           273              
000010C2                           274              ;Bucle que recorre D1 para obtener estado de teclas.
000010C2  7003                     275  .NEXTKEYS   MOVEQ   #3, D0    ;Número de iteraciones del bucle (.LOOP).
000010C4                           276  
000010C4                           277  .LOOP                   
000010C4  0801 0000                278              BTST    #0, D1
000010C8  6700 0004                279              BEQ     .NOTPRESSED
000010CC                           280              ;If pressed, set corresponding bit
000010CC  09C3                     281              BSET    D4, D3                  
000010CE                           282                        
000010CE                           283  .NOTPRESSED              
000010CE                           284              *En cualquier caso, obtener siguiente byte de D1*
000010CE                           285              
000010CE                           286              ;Se desplaza el registro D1 8 bits a la derecha. 
000010CE  E089                     287              LSR.L   #8, D1
000010D0                           288              
000010D0                           289              ;Se incrementa el índice de D3.
000010D0  5244                     290              ADDQ    #1, D4
000010D2  51C8 FFF0                291              DBRA    D0, .LOOP
000010D6                           292              
000010D6                           293              ;Comprobar si hay que analizar el segundo conjunto de teclas. 
000010D6  B83C 0004                294              CMP.B   #4, D4
000010DA  6600 0006                295              BNE     .KEYSREADY            
000010DE                           296             
000010DE                           297              ;Se mueve el segundo conjunto de teclas al registro D1 y se
000010DE                           298              ;repite el bucle .LOOP.
000010DE  2202                     299              MOVE.L  D2, D1
000010E0  60E0                     300              BRA     .NEXTKEYS
000010E2                           301  
000010E2                           302  .KEYSREADY  
000010E2                           303              ;Recuperamos el anterior KBDVAL en D4.
000010E2  1839 00001BBC            304              MOVE.B  (KBDVAL), D4
000010E8                           305              ;Se mueve el byte obtenido a KBDVAL.         
000010E8  13C3 00001BBC            306              MOVE.B  D3, KBDVAL 
000010EE                           307  
000010EE  4604                     308              NOT.B   D4
000010F0  C604                     309              AND.B   D4, D3
000010F2  13C3 00001BBD            310              MOVE.B  D3, (KBDEDGE)             
000010F8                           311              
000010F8                           312              ;Restaurar registros a su estado original. 
000010F8  4CDF 001F                313              MOVEM.L (A7)+,D0-D4
000010FC                           314  
000010FC  4E73                     315              RTE
000010FE                           316  
000010FE                           317  ; =============================================================================
000010FE                           318  ; DYNAMIC MEMORY MANAGEMENT (SYSTEM CODE)
000010FE                           319  ; DYNAMIC MEMORY IS A SET OF DMMBNUM SLOTS OF DMMBSIZE BYTES EACH ONE.
000010FE                           320  ; DMMBSIZE MUST BE POWER OF TWO. A SLOT HAS:
000010FE                           321  ; - HEADER - 1 WORD. SPECIFIES THE OWNER (0 MEANS OWNED BY SYSTEM)
000010FE                           322  ; - DATA   - DMMBSIZE - 2 BYTES. MAY CONTAIN VARS AND ANY KIND OF DATA RELATED
000010FE                           323  ;            THE THE OWNER. IF OWNER==0, DATA IS MEANINGLESS.
000010FE                           324  ; =============================================================================
000010FE                           325  
000010FE                           326  ; -----------------------------------------------------------------------------
000010FE                           327  DMMINIT
000010FE                           328  ; INITIALIZES THE DYNAMIC MEMORY TO ALL OWNED BY SYSTEM.
000010FE                           329  ; INPUT    - NONE
000010FE                           330  ; OUTPUT   - NONE
000010FE                           331  ; MODIFIES - NONE
000010FE                           332  ; -----------------------------------------------------------------------------
000010FE  48E7 8080                333              MOVEM.L D0/A0,-(A7)
00001102  41F9 00001BC0            334              LEA     DMMDATA,A0
00001108  303C 0031                335              MOVE.W  #DMMBNUM-1,D0
0000110C  30BC 0000                336  .LOOP       MOVE.W  #DMMSYSID,(A0)
00001110  D1FC 00000040            337              ADD.L   #DMMBSIZE,A0
00001116  51C8 FFF4                338              DBRA.W  D0,.LOOP
0000111A  4CDF 0101                339              MOVEM.L (A7)+,D0/A0
0000111E  4E75                     340              RTS
00001120                           341  
00001120                           342  ; -----------------------------------------------------------------------------
00001120                           343  DMMFIRST
00001120                           344  ; SEARCHES THE FIRST MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001120                           345  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001120                           346  ; INPUT    - NONE
00001120                           347  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001120                           348  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001120                           349  ; -----------------------------------------------------------------------------
00001120  41F9 00001BC0            350              LEA     DMMDATA,A0
00001126  4A58                     351  DMMFRLOP    TST.W   (A0)+
00001128  6600 0016                352              BNE     DMMFRFND
0000112C  D1FC 0000003E            353              ADD.L   #DMMBSIZE-2,A0
00001132  B1FC 0000283F            354  DMMFRCOM    CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001138  6DEC                     355              BLT     DMMFRLOP
0000113A  207C 00000000            356              MOVE.L  #0,A0
00001140  4E75                     357  DMMFRFND    RTS
00001142                           358  
00001142                           359  ; -----------------------------------------------------------------------------
00001142                           360  DMMNEXT
00001142                           361  ; SEARCHES THE NEXT MEMORY SLOT NOT OWNED BY SYSTEM AND OUTPUTS A POINTER
00001142                           362  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001142                           363  ; INPUT    - A0   : POINTER WITHIN THE CURRENT SLOT
00001142                           364  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001142                           365  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001142                           366  ; -----------------------------------------------------------------------------
00001142  2F00                     367              MOVE.L  D0,-(A7)
00001144  2008                     368              MOVE.L  A0,D0
00001146  C0BC FFFFFFC0            369              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
0000114C  0680 00000040            370              ADD.L   #DMMBSIZE,D0
00001152  2040                     371              MOVE.L  D0,A0
00001154  201F                     372              MOVE.L  (A7)+,D0
00001156  60DA                     373              BRA     DMMFRCOM
00001158                           374  
00001158                           375  ; -----------------------------------------------------------------------------
00001158                           376  DMMFRSTO
00001158                           377  ; SEARCHES THE FIRST MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
00001158                           378  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
00001158                           379  ; INPUT    - D0.W : ID TO SEARCH
00001158                           380  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
00001158                           381  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001158                           382  ; -----------------------------------------------------------------------------
00001158  41F9 00001BC0            383              LEA     DMMDATA,A0
0000115E  B058                     384  DMMFLOOP    CMP.W   (A0)+,D0
00001160  6700 0016                385              BEQ     DMMFFND
00001164  D1FC 0000003E            386              ADD.L   #DMMBSIZE-2,A0
0000116A  B1FC 0000283F            387  DMMFCOM     CMP.L   #DMMDATA+DMMBSIZE*DMMBNUM-1,A0
00001170  6DEC                     388              BLT     DMMFLOOP
00001172  207C 00000000            389              MOVE.L  #0,A0
00001178  4E75                     390  DMMFFND     RTS
0000117A                           391  
0000117A                           392  ; -----------------------------------------------------------------------------
0000117A                           393  DMMNEXTO
0000117A                           394  ; SEARCHES THE NEXT MEMORY SLOT WITH THE SPECIFIED ID AND OUTPUTS A POINTER
0000117A                           395  ; TO THE CORRESPONDING DATA (SLOT ADDRESS+2)
0000117A                           396  ; INPUT    - D0.W : ID TO SEARCH
0000117A                           397  ;            A0   : POINTER WITHIN THE CURRENT SLOT
0000117A                           398  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FOUND
0000117A                           399  ; MODIFIES - NONE (ASIDE OF OUTPUT)
0000117A                           400  ; -----------------------------------------------------------------------------
0000117A  2F00                     401              MOVE.L  D0,-(A7)
0000117C  2008                     402              MOVE.L  A0,D0
0000117E  C0BC FFFFFFC0            403              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
00001184  0680 00000040            404              ADD.L   #DMMBSIZE,D0
0000118A  2040                     405              MOVE.L  D0,A0
0000118C  201F                     406              MOVE.L  (A7)+,D0
0000118E  60DA                     407              BRA     DMMFCOM
00001190                           408  
00001190                           409  ; -----------------------------------------------------------------------------
00001190                           410  DMMALLOC
00001190                           411  ; SEARCHES THE FIRST FREE (SYS OWNED) SLOT, ASSIGNS TO THE SPECIFIED OWNER
00001190                           412  ; AND RETURNS A POINTER TO THE CORRESPONDING DATA (SLOT ADDRESS + 2)
00001190                           413  ; INPUT    - D0.W : ID TO ASSIGN
00001190                           414  ; OUTPUT   - A0   : POINTER TO THE DATA OR 0 IF NOT FREE SPACE
00001190                           415  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001190                           416  ; -----------------------------------------------------------------------------
00001190  3F00                     417              MOVE.W  D0,-(A7)
00001192  4240                     418              CLR.W   D0
00001194  4EB8 1158                419              JSR     DMMFRSTO
00001198  301F                     420              MOVE.W  (A7)+,D0
0000119A  B1FC 00000000            421              CMP.L   #0,A0
000011A0  6700 0006                422              BEQ     .END
000011A4  3140 FFFE                423              MOVE.W  D0,-2(A0)
000011A8  4E75                     424  .END        RTS
000011AA                           425  
000011AA                           426  ; -----------------------------------------------------------------------------
000011AA                           427  DMMFREE
000011AA                           428  ; FREES THE SLOT TO WHICH THE PROVIDED POINTER BELONGS BY SETTING ITS OWNED TO
000011AA                           429  ; SYSTEM (0)
000011AA                           430  ; INPUT    - A0   : POINTER BELONGING TO THE SLOT TO FREE
000011AA                           431  ; OUTPUT   - NONE
000011AA                           432  ; MODIFIES - NONE
000011AA                           433  ; -----------------------------------------------------------------------------
000011AA  48E7 8080                434              MOVEM.L D0/A0,-(A7)
000011AE  2008                     435              MOVE.L  A0,D0
000011B0  C0BC FFFFFFC0            436              AND.L   #-DMMBSIZE,D0           ; TAKE ADVANTAGE OF ALIGNMENT
000011B6  2040                     437              MOVE.L  D0,A0
000011B8  4250                     438              CLR.W   (A0)
000011BA  4CDF 0101                439              MOVEM.L (A7)+,D0/A0
000011BE  4E75                     440              RTS
000011C0                           441  
000011C0                           442  
000011C0                           443  
000011C0                           444  
000011C0                           445  -------------------- end include --------------------
000011C0                           446              INCLUDE "SYSCONST.X68"               ; SYSTEM CONSTANTS
000011C0                           447  ; =============================================================================
000011C0                           448  ; SYSTEM CONSTANTS
000011C0                           449  ; =============================================================================
000011C0                           450  
000011C0                           451  ; --- TRAP RELATED CONSTANTS --------------------------------------------------
000011C0                           452  
000011C0  =00000000                453  KBDTRAP     EQU     0                       ; KEYBOARD UPDATE TRAP
000011C0  =00000001                454  SCRTRAP     EQU     1                       ; SCREEN REFRESH TRAP
000011C0                           455  
000011C0                           456  ; --- KEY CODES (EASy68K)
000011C0                           457  
000011C0  =00000020                458  KBDCHRSP    EQU     $20                     ; SPACE KEY
000011C0  =0000004D                459  KBDCHRMK    EQU     'M'                     ; M KEY
000011C0  =00000010                460  KBDCHRSH    EQU     $10                     ; SHIFT KEY
000011C0  =00000050                461  KBDCHRPK    EQU     'P'                     ; P KEY
000011C0  =00000025                462  KBDCHRLF    EQU     $25                     ; LEFT KEY
000011C0  =00000026                463  KBDCHRUP    EQU     $26                     ; UP KEY
000011C0  =00000027                464  KBDCHRRT    EQU     $27                     ; RIGHT KEY
000011C0  =00000028                465  KBDCHRDN    EQU     $28                     ; DOWN KEY
000011C0                           466  
000011C0                           467  ; --- KEYBOARD MAPPING --------------------------------------------------------
000011C0                           468  
000011C0  =00000025                469  KBDLEFT     EQU     KBDCHRLF                ; LEFT BUTTON
000011C0  =00000026                470  KBDUP       EQU     KBDCHRUP                ; UP BUTTON
000011C0  =00000027                471  KBDRIGHT    EQU     KBDCHRRT                ; RIGHT BUTTON
000011C0  =00000028                472  KBDDOWN     EQU     KBDCHRDN                ; DOWN BUTTON
000011C0  =00000020                473  KBDFIRE1    EQU     KBDCHRSP                ; FIRE 1 BUTTON
000011C0  =0000004D                474  KBDFIRE2    EQU     KBDCHRMK                ; FIRE 2 BUTTON
000011C0  =00000010                475  KBDFIRE3    EQU     KBDCHRSH                ; FIRE 3 BUTTON
000011C0  =00000050                476  KBDPAUSE    EQU     KBDCHRPK                ; PAUSE BUTTON
000011C0                           477  
000011C0                           478  ; --- KEYBOARD BITFIELD MASKS -------------------------------------------------
000011C0                           479  ; CONVENIENCE CONSTANTS TO ACCESS THE FOLLOWING BIT-FIELD.
000011C0                           480  ; THIS BIT-FIELD IS USED BY SYSTEM VARS (KBDVAL) AND (KBDEDGE).
000011C0                           481  ; +---+---+---+---+---+---+---+---+
000011C0                           482  ; | 7 | 6 | 5 | 4 | 3 | 2 | 1 | 0 |
000011C0                           483  ; +---+---+---+---+---+---+---+---+
000011C0                           484  ;   |   |   |   |   |   |   |   |
000011C0                           485  ;   |   |   |   |   |   |   |   +---------- LEFT BUTTON
000011C0                           486  ;   |   |   |   |   |   |   +-------------- UP BUTTON
000011C0                           487  ;   |   |   |   |   |   +------------------ RIGHT BUTTON
000011C0                           488  ;   |   |   |   |   +---------------------- DOWN BUTTON
000011C0                           489  ;   |   |   |   +-------------------------- FIRE 1 BUTTON
000011C0                           490  ;   |   |   +------------------------------ FIRE 2 BUTTON
000011C0                           491  ;   |   +---------------------------------- FIRE 3 BUTTON
000011C0                           492  ;   +-------------------------------------- PAUSE BUTTON
000011C0                           493  
000011C0  =00000001                494  KBDMSKLF    EQU     %00000001
000011C0  =00000002                495  KBDMSKUP    EQU     %00000010
000011C0  =00000004                496  KBDMSKRT    EQU     %00000100
000011C0  =00000008                497  KBDMSKDN    EQU     %00001000
000011C0  =00000010                498  KBDMSKF1    EQU     %00010000
000011C0  =00000020                499  KBDMSKF2    EQU     %00100000
000011C0  =00000040                500  KBDMSKF3    EQU     %01000000
000011C0  =00000080                501  KBDMSKPS    EQU     %10000000
000011C0                           502  
000011C0                           503  ; --- KEYBOARD BITFIELD POSITIONS ---------------------------------------------
000011C0                           504  
000011C0  =00000000                505  KBDBITLF    EQU     0
000011C0  =00000001                506  KBDBITUP    EQU     1
000011C0  =00000002                507  KBDBITRT    EQU     2
000011C0  =00000003                508  KBDBITDN    EQU     3
000011C0  =00000004                509  KBDBITF1    EQU     4
000011C0  =00000005                510  KBDBITF2    EQU     5
000011C0  =00000006                511  KBDBITF3    EQU     6
000011C0  =00000007                512  KBDBITPS    EQU     7
000011C0                           513  
000011C0                           514  ; --- SCREEN RELATED CONSTANTS ------------------------------------------------
000011C0                           515  
000011C0  =00000280                516  SCRWIDTH    EQU     640                     ; SCREEN WIDTH (PIXELS)
000011C0  =000001E0                517  SCRHEIGH    EQU     480                     ; SCREEN HEIGHT (PIXELS)
000011C0  =00000001                518  SCRIRQ      EQU     1                       ; SCREEN INTERRUPT NUMBER
000011C0  =00000014                519  SCRTIM      EQU     20                      ; SCREEN TIMER (MS)
000011C0                           520  
000011C0                           521  ; --- DYNAMIC MEMORY CONSTANTS ------------------------------------------------
000011C0                           522  
000011C0  =00000040                523  DMMBSIZE    EQU     64                      ; BLOCK SIZE (BYTES). POWER OF TWO
000011C0  =00000032                524  DMMBNUM     EQU     50                      ; NUMBER OF BLOCKS
000011C0  =00000000                525  DMMSYSID    EQU     0                       ; SYSTEM OWNER ID (MUST BE 0)
000011C0                           526  
000011C0                           527  
000011C0                           528  
000011C0                           529  
000011C0                           530  -------------------- end include --------------------
000011C0                           531              INCLUDE "CONST.X68"                  ; USER CONSTANTS
000011C0                           532  ; =============================================================================
000011C0                           533  ; SYSTEM CONSTANTS
000011C0                           534  ; =============================================================================
000011C0                           535  
000011C0                           536  ; --- GAME STATES -------------------------------------------------------------
000011C0                           537  
000011C0  =FFFFFFFF                538  STANONE     EQU     -1                      ; PLACEHOLDER TO FORCE CHANGE
000011C0  =00000000                539  STAINTR     EQU     0                       ; INTRO/PRESS FIRE STATE
000011C0  =00000001                540  STAPLAY     EQU     1                       ; NORMAL GAME STATE
000011C0  =00000002                541  STAPAU      EQU     2                       ; PAUSE GAME STATE
000011C0  =00000003                542  STAGOVR     EQU     3                       ; GAME OVER STATE
000011C0                           543  
000011C0                           544  ; --- AGENT & PROP TYPES -------------------------------------------------------------
000011C0                           545  
000011C0  =00000001                546  CLDTYPE     EQU     1                       ; NUMBER FOR CLOUD TYPES
000011C0  =00000002                547  GSSDTYPE    EQU     2                       ; NUMBER FOR GRASS DETAIL TYPES
000011C0  =00000003                548  PIPTYPE     EQU     3                       ; NUMBER FOR PIPE TYPES
000011C0                           549  
000011C0                           550  
000011C0                           551  ; --- INTRO STATE RELATED CONSTANTS -------------------------------------------
000011C0                           552  
000011C0  =00000001                553  INTTITX     EQU     1                       ; TITLE X COORDINATE
000011C0  =00000001                554  INTTITY     EQU     1                       ; TITLE Y COORDINATE
000011C0  =0000FFFF                555  INTTITC     EQU     $0000FFFF               ; TITLE COLOR
000011C0  =033D0001                556  INTTITF     EQU     $033D0001               ; TITLE FONT
000011C0  =00000005                557  INTPRSX     EQU     5                       ; PRESS FIRE X COORDINATE
000011C0  =00000008                558  INTPRSY     EQU     8                       ; PRESS FIRE Y COORDINATE
000011C0  =00000080                559  INTPRSC     EQU     $00000080               ; PRESS FIRE COLOR
000011C0  =031A0001                560  INTPRSF     EQU     $031A0001               ; PRESS FIRE FONT
000011C0                           561  
000011C0                           562  ; --- BACKGROUND RELATED CONSTANTS --------------------------------------------
000011C0                           563  
000011C0  =00000000                564  BGSKYPC     EQU     $00000000               ; BACKGROUND SKY PEN COLOUR
000011C0  =00EFCE87                565  BGSKYFC     EQU     $00EFCE87               ; BACKGROUND SKY FILL COLOUR
000011C0  =00000000                566  BGGSSPC     EQU     $00000000               ; BACKGROUND GRASS PEN COLOUR
000011C0  =0000990A                567  BGGSSFC     EQU     $0000990A               ; BACKGROUND GRASS FILL COLOUR
000011C0  =00000168                568  BGGSSTP     EQU     SCRHEIGH*3/4            ; GRASS TOP EDGE (Y) COORDINATE
000011C0  =00000190                569  BGGSSBT     EQU     BGGSSTP+40              ; GRASS BOTTOM EDGE (Y) COORDINATE
000011C0  =0000000A                570  GSSDWDTH    EQU     10                      ; GRASS DETAIL WIDTH
000011C0  =0039DB44                571  GSSDFC      EQU     $0039DB44               ; BACKGROUND GRASS DETAIL F.COLOUR
000011C0  =00000000                572  BGGNDPC     EQU     $00000000               ; BACKGROUND GROUND PEN COLOUR
000011C0  =00155DD8                573  BGGNDFC     EQU     $00155DD8               ; BACKGROUND GROUND FILL COLOUR
000011C0  =00000190                574  BGGNDTP     EQU     BGGSSBT                 ; GROUND TOP EDGE (Y) COORDINATE
000011C0                           575  
000011C0                           576  ; --- PLAYER RELATED CONSTANTS ------------------------------------------------
000011C0                           577  
000011C0                           578        ;Player colours
000011C0                           579  
000011C0  =00008000                580  GREEN EQU $00008000 
000011C0  =000000FF                581  RED   EQU $000000FF 
000011C0  =00FFFFFF                582  WHITE EQU $00FFFFFF 
000011C0  =00000000                583  BLACK EQU $00000000
000011C0                           584  
000011C0                           585        ;Constants
000011C0                           586        
000011C0  =00008000                587  PLRCOLOR        EQU GREEN
000011C0  =00FFFFFF                588  PLREYECOLOR     EQU WHITE
000011C0  =00000000                589  PLRIRISCOLOR    EQU BLACK
000011C0  =000000FF                590  PLRMOUTHCOLOR   EQU RED
000011C0  =0000001E                591  PLRWIDTH        EQU 30
000011C0  =0000001E                592  PLRHEIGHT       EQU 30
000011C0  =00000096                593  PLRINITPOSX     EQU 150
000011C0  =000000B4                594  PLRINITPOSY     EQU 180
000011C0  =0000000A                595  JUMPSIZE        EQU 10
000011C0                           596  
000011C0                           597  ; --- PIPE RELATED CONSTANTS --------------------------------------------------
000011C0                           598  
000011C0  =00000000                599  PIPPC       EQU     $00000000               ; PIPE PEN COLOUR
000011C0  =00196600                600  PIPFC       EQU     $00196600               ; PIPE FILL COLOUR
000011C0  =00000032                601  PIPBWDT     EQU     50                      ; PIPE BASE WIDTH
000011C0  =0000003C                602  PIPTWDT     EQU     60                      ; PIPE MOUTH WIDTH
000011C0  =0000000A                603  PIPTHGT     EQU     10                      ; PIPE MOUTH HEIGHT
000011C0  =00000005                604  PIPTBSPC    EQU     ((PIPTWDT-PIPBWDT)/2)   ; DIF.BETW. OUTER RAD. & IN. RAD
000011C0  =00000050                605  PIPOPEN     EQU     80                      ; SPACE BETW. TOP AND BOTTOM PIPES
000011C0  =00000002                606  PIPYSPD     EQU     2                       ; SPEED @ WHICH PIPES GO UP&DOWN
000011C0                           607  
000011C0                           608  ; --- CLOUD RELATED CONSTANTS -------------------------------------------------
000011C0                           609  
000011C0  =0000003C                610  CLDSIZE     EQU     60                      ; CLOUD DIAMETER
000011C0  =00FFFFFF                611  CLDPCLR     EQU     $00FFFFFF               ; CLOUD PEN COLOR
000011C0  =00FFFFFF                612  CLDFCLR     EQU     $00FFFFFF               ; CLOUD FIL COLOR
000011C0                           613  
000011C0                           614  ; --- PAUSE STATE RELATED CONSTANTS ---------------------------------------
000011C0                           615  
000011C0  =00000000                616  CONTNUM     EQU     0                       ; CONTINUE GAME NUMBER
000011C0  =00000001                617  NEWGNUM     EQU     1                       ; NEW GAME NUMBER
000011C0  =00000002                618  EXTNUM      EQU     2                       ; EXIT GAME NUMBER
000011C0  =0000FFFF                619  PAUTITC     EQU     $0000FFFF               ; TITLE COLOUR
000011C0  =03300001                620  PAUTITF     EQU     $03300001               ; TITLE FONT
000011C0  =01130001                621  PAUOPTFU    EQU     $01130001               ; OPTION FONT (unselected)
000011C0  =01130005                622  PAUOPTFS    EQU     $01130005               ; OPTION FONT (selected)
000011C0  =00FFFFFF                623  PAUOPTC     EQU     $00FFFFFF               ; OPTION COLOUR
000011C0  =00000002                624  PAUTITX     EQU     2                       ; TITLE COORD. X
000011C0  =00000001                625  PAUTITY     EQU     1                       ; TITLE COORD. Y
000011C0  =0000000F                626  PAUOPTX     EQU     15                      ; OPTIONS COORD. X
000011C0  =00000008                627  PAUCNTY     EQU     8                       ; CONTINUE OPTION COORD. Y
000011C0  =0000000A                628  PAUNEWY     EQU     10                      ; NEW GAME OPTION COORD. Y
000011C0  =0000000C                629  PAUEXTY     EQU     12                      ; EXIT OPTION COORD. Y
000011C0  =000000FF                630  PAUSELC     EQU     $000000FF               ; SELECTED OPTION COLOUR
000011C0                           631  
000011C0                           632  ; --- GAME OVER STATE RELATED CONSTANTS ---------------------------------------
000011C0                           633  
000011C0  =00000023                634  GOVSTRX     EQU     35                      ; TITLE X COORDINATE
000011C0  =0000000F                635  GOVSTRY     EQU     15                      ; TITLE Y COORDINATE
000011C0  =00FFFFFF                636  GOVSTRC     EQU     $00FFFFFF               ; TITLE COLOR
000011C0                           637  
000011C0                           638  
000011C0                           639  
000011C0                           640  
000011C0                           641  
000011C0                           642  
000011C0                           643  
000011C0                           644  
000011C0                           645  
000011C0                           646  
000011C0                           647  
000011C0                           648  
000011C0                           649  
000011C0                           650  
000011C0                           651  
000011C0                           652  
000011C0                           653  
000011C0                           654  
000011C0                           655  
000011C0                           656  
000011C0                           657  
000011C0                           658  
000011C0                           659  
000011C0                           660  
000011C0                           661  
000011C0                           662  
000011C0                           663  
000011C0                           664  -------------------- end include --------------------
000011C0                           665              INCLUDE "PLAYER.X68"
000011C0                           666  ; =============================================================================
000011C0                           667  ; PLAYER MANAGEMENT
000011C0                           668  ; =============================================================================
000011C0                           669  
000011C0                           670  ; -----------------------------------------------------------------------------
000011C0                           671  PLRINIT
000011C0                           672  ; INITIALIZES THE PLAYER
000011C0                           673  ; INPUT    - NONE
000011C0                           674  ; OUTPUT   - NONE
000011C0                           675  ; MODIFIES - NONE
000011C0                           676  ; -----------------------------------------------------------------------------
000011C0                           677  
000011C0  33FC 0096 00001BAC       678          MOVE.W #PLRINITPOSX,(PLRPOSX)
000011C8  33FC 00B4 00001BAE       679          MOVE.W #PLRINITPOSY,(PLRPOSY)
000011D0  33FC 00B4 00001BB0       680          MOVE.W #PLRINITPOSY,(MAXPOS)
000011D8  33FC 0000 00001BB2       681          MOVE.W #0, (UPPRESSED)
000011E0  33FC 0001 00001BB4       682          MOVE.W #1, (PLRSPEED)
000011E8  4E75                     683          RTS
000011EA                           684  ; -----------------------------------------------------------------------------
000011EA                           685  PLRUPD
000011EA                           686  ; UPDATES THE PLAYER MOTION
000011EA                           687  ; INPUT    - NONE (ACCESSES KBDVAL AND KBDEDGE)
000011EA                           688  ; OUTPUT   - NONE (MODIFIES PLAYER DATA)
000011EA                           689  ; MODIFIES - NONE
000011EA                           690  ; -----------------------------------------------------------------------------
000011EA  48E7 E000                691            MOVEM.L D0/D1/D2,-(A7)
000011EE  0839 0001 00001BBD       692            BTST.B #KBDBITUP, (KBDEDGE)    
000011F6  6600 0020                693            BNE.L  .PRESSED
000011FA                           694          
000011FA                           695            ;TECLA NO PRESIONADA
000011FA  0C79 0001 00001BB2       696            CMP #1, (UPPRESSED)
00001202  6700 0030                697            BEQ .MAKEJUMP
00001206                           698            ;No se ha apretado la tecla UP. Hay que bajar el pájaro. 
00001206  3039 00001BAE            699            MOVE.W (PLRPOSY), D0
0000120C  5E40                     700            ADD.W #7, D0
0000120E  33C0 00001BAE            701            MOVE.W D0, (PLRPOSY)       
00001214                           702         
00001214  6000 004C                703            BRA .END         
00001218                           704  .PRESSED
00001218                           705            ;TECLA UP PRESIONADA
00001218                           706            ;Se establece el límite hasta donde subirá
00001218  3039 00001BAE            707            MOVE.W (PLRPOSY), D0
0000121E  0440 000A                708            SUB.W #JUMPSIZE, D0
00001222  33C0 00001BB0            709            MOVE.W D0, (MAXPOS)
00001228                           710            ;Se indica que se ha presionado la tecla de salto
00001228  33FC 0001 00001BB2       711            MOVE.W #1, (UPPRESSED)
00001230                           712            
00001230  6000 0030                713            BRA .END   
00001234                           714        
00001234                           715  .MAKEJUMP
00001234                           716            ;Se ha apretado la tecla UP anteriormente (eso indica que el salto no
00001234                           717            ; ha finalizado). 
00001234                           718            
00001234  3039 00001BAE            719            MOVE.W (PLRPOSY), D0
0000123A  3239 00001BB0            720            MOVE.W (MAXPOS), D1
00001240  9041                     721            SUB.W  D1, D0             ;FÓRMULA: (PLRPOSY-MAXPOS)/2 = VALOR QUE SE TIENE QUE RESTAR A LA POSICIÓN ACTUAL PARA OBTENER LA NUEVA POSICIÓN
00001242  80FC 0004                722            DIVU.W #4, D0
00001246  33C0 00001BB0            723            MOVE.W D0, (MAXPOS)
0000124C  9179 00001BAE            724            SUB.W D0, (PLRPOSY)       ;NEWPOS
00001252  B07C 0001                725            CMP #1, D0
00001256  6700 0006                726            BEQ .LASTJUMP
0000125A                           727            ;El salto no ha finalizado (No ha llegado a MAXPOS)
0000125A                           728  
0000125A                           729                      
0000125A                           730            
0000125A  6000 0006                731            BRA .END
0000125E                           732            
0000125E                           733  .LASTJUMP
0000125E                           734            ;El salto ha llegado a MAXPOS
0000125E                           735            ;Se desactiva la tecla UP indicando que lo siguiente será realizar la bajada. 
0000125E                           736          ;  MOVE.W #0, (UPPRESSED)         
0000125E  6000 0002                737            BRA .END    
00001262                           738                   
00001262                           739  .END
00001262                           740            
00001262  4CDF 0007                741            MOVEM.L (A7)+,D0/D1/D2
00001266  4E75                     742            RTS
00001268                           743            
00001268                           744            
00001268                           745            
00001268                           746            
00001268                           747            
00001268                           748  
00001268                           749  ; -----------------------------------------------------------------------------
00001268                           750  PLRPLOT
00001268                           751  ; PLOTS THE PLAYER
00001268                           752  ; INPUT    - NONE
00001268                           753  ; OUTPUT   - NONE
00001268                           754  ; MODIFIES - NONE
00001268                           755  ; -----------------------------------------------------------------------------
00001268                           756  
00001268  48E7 F800                757              MOVEM.L D0-D4,-(A7)
0000126C                           758  
0000126C                           759  
0000126C                           760              ;SET PLAYER COLOR 
0000126C  223C 00008000            761              MOVE.L  #PLRCOLOR,D1
00001272  103C 0050                762              MOVE.B  #80,D0
00001276  4E4F                     763              TRAP    #15
00001278  5200                     764              ADDQ.B  #1,D0
0000127A  4E4F                     765              TRAP    #15
0000127C                           766              
0000127C                           767              ;SET PLAYER POSITION
0000127C  3239 00001BAC            768              MOVE.W  (PLRPOSX),D1            
00001282  3439 00001BAE            769              MOVE.W  (PLRPOSY),D2
00001288  3601                     770              MOVE.W  D1,D3
0000128A  3802                     771              MOVE.W  D2,D4
0000128C                           772              
0000128C                           773              ;SET PLAYER WIDTH AND HEIGHT
0000128C  0643 001E                774              ADD.W   #PLRWIDTH,D3
00001290  0644 001E                775              ADD.W   #PLRHEIGHT,D4
00001294  103C 0058                776              MOVE.B  #88,D0
00001298  4E4F                     777              TRAP    #15
0000129A  0443 000F                778              SUB.W   #PLRWIDTH/2,D3
0000129E  103C 0057                779              MOVE.B  #87,D0
000012A2  4E4F                     780              TRAP    #15
000012A4                           781              
000012A4                           782              ;---------EYE---------
000012A4                           783                               
000012A4                           784              ;SET EYE COLOR
000012A4  7051                     785              MOVE.L  #81, D0
000012A6  223C 00FFFFFF            786              MOVE.L  #PLREYECOLOR, D1
000012AC  4E4F                     787              TRAP    #15
000012AE                           788              
000012AE  3239 00001BAC            789              MOVE.W  PLRPOSX,D1   
000012B4                           790              
000012B4                           791              ;EYE WIDTH         
000012B4  5A41                     792              ADD.W   #PLRWIDTH-25,D1
000012B6  3639 00001BAC            793              MOVE.W  (PLRPOSX),D3
000012BC                           794              
000012BC                           795              ;EYE POSX
000012BC  0643 0014                796              ADD.W   #PLRWIDTH-10,D3
000012C0  3439 00001BAE            797              MOVE.W (PLRPOSY),D2
000012C6                           798              
000012C6                           799              ;EYE POSY
000012C6  0642 000A                800              ADD.W   #PLRHEIGHT/2-5,D2
000012CA  3839 00001BAE            801              MOVE.W  (PLRPOSY),D4
000012D0                           802             
000012D0                           803              ;EYE HEIGHT 
000012D0  0644 FFF6                804              ADD.W   #PLRHEIGHT/2-25,D4
000012D4  103C 0058                805              MOVE.B  #88,D0
000012D8  4E4F                     806              TRAP    #15
000012DA                           807              
000012DA                           808              
000012DA                           809             ;---------MOUTH------
000012DA                           810              
000012DA                           811              ;PLOT EYE OF CHARACTER
000012DA  4241                     812              CLR     D1
000012DC  103C 0050                813              MOVE.B  #80,D0
000012E0  4E4F                     814              TRAP    #15
000012E2  5200                     815              ADDQ.B  #1,D0
000012E4  4E4F                     816              TRAP    #15
000012E6                           817                     
000012E6                           818              ;SET EYE COLOR
000012E6  7051                     819              MOVE.L  #81, D0
000012E8  223C 000000FF            820              MOVE.L  #RED, D1
000012EE  4E4F                     821              TRAP    #15
000012F0                           822  
000012F0                           823              
000012F0  3239 00001BAC            824              MOVE.W  (PLRPOSX),D1   
000012F6                           825              
000012F6                           826              ;EYE WIDTH         
000012F6  0641 001D                827              ADD.W   #PLRWIDTH-1,D1
000012FA  3639 00001BAC            828              MOVE.W  (PLRPOSX),D3
00001300                           829              
00001300                           830              ;EYE POSX
00001300  0643 000A                831              ADD.W   #PLRWIDTH-20,D3
00001304  3439 00001BAE            832              MOVE.W  (PLRPOSY),D2
0000130A                           833              
0000130A                           834              ;EYE POSY
0000130A  0642 0019                835              ADD.W   #PLRHEIGHT-5,D2
0000130E  3839 00001BAE            836              MOVE.W  (PLRPOSY),D4
00001314                           837             
00001314                           838              ;EYE HEIGHT 
00001314  0644 000F                839              ADD.W   #PLRHEIGHT-15,D4
00001318  103C 0058                840              MOVE.B  #88,D0
0000131C  4E4F                     841              TRAP    #15
0000131E                           842              
0000131E  4CDF 001F                843              MOVEM.L (A7)+,D0-D4
00001322                           844              
00001322  4E75                     845              RTS
00001324                           846  
00001324                           847  
00001324                           848  
00001324                           849  
00001324                           850  -------------------- end include --------------------
00001324                           851              INCLUDE "UTIL.X68"                   ; UTILITY MACRO AND SUBROUTINES
00001324                           852  ; =============================================================================
00001324                           853  ; UTILITY MACROS
00001324                           854  ; =============================================================================
00001324                           855  
00001324                           856  ; -----------------------------------------------------------------------------
00001324                           857  UTLSPEN     MACRO
00001324                           858  ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001324                           859  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
00001324                           860  ; OUTPUT   - NONE
00001324                           861  ; MODIFIES - D0,D1
00001324                           862  ; -----------------------------------------------------------------------------
00001324                           863              MOVE.B  #80,D0
00001324                           864              MOVE.L  \1,D1
00001324                           865              TRAP    #15
00001324                           866              ENDM
00001324                           867  
00001324                           868  ; -----------------------------------------------------------------------------
00001324                           869  UTLSFIL     MACRO
00001324                           870  ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001324                           871  ; INPUT    - \1 COLOR IN FORMAT $00BBGGRR
00001324                           872  ; OUTPUT   - NONE
00001324                           873  ; MODIFIES - D0,D1
00001324                           874  ; -----------------------------------------------------------------------------
00001324                           875              MOVE.B  #81,D0
00001324                           876              MOVE.L  \1,D1
00001324                           877              TRAP    #15
00001324                           878              ENDM
00001324                           879  
00001324                           880  ; -----------------------------------------------------------------------------
00001324                           881  UTLLOCT     MACRO
00001324                           882  ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001324                           883  ; INPUT    - \1 X, \2 Y
00001324                           884  ; OUTPUT   - NONE
00001324                           885  ; MODIFIES - D0,D1
00001324                           886  ; -----------------------------------------------------------------------------
00001324                           887              MOVE.W  #\1<<8|\2, D1
00001324                           888              MOVE.B  #11,D0
00001324                           889              TRAP    #15
00001324                           890              ENDM
00001324                           891  
00001324                           892  ; -----------------------------------------------------------------------------
00001324                           893  UTLFONT     MACRO
00001324                           894  ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001324                           895  ; INPUT    - \1 COLOR, \2 FONT
00001324                           896  ; OUTPUT   - NONE
00001324                           897  ; MODIFIES - D0,D1,D2
00001324                           898  ; -----------------------------------------------------------------------------
00001324                           899              MOVE.L  #\1,D1
00001324                           900              MOVE.L  #\2,D2
00001324                           901              MOVEQ   #21,D0
00001324                           902              TRAP    #15
00001324                           903              ENDM
00001324                           904  
00001324                           905  ; =============================================================================
00001324                           906  ; UTILITY SUBROUTINES
00001324                           907  ; =============================================================================
00001324                           908  
00001324                           909  ; -----------------------------------------------------------------------------
00001324                           910  UTLINIT
00001324                           911  ; INITIALIZES UTILITY CODE
00001324                           912  ; INPUT    - NONE
00001324                           913  ; OUTPUT   - NONE
00001324                           914  ; MODIFIES - NONE
00001324                           915  ; -----------------------------------------------------------------------------
00001324  4239 00001BBB            916              CLR.B   (UTLRNDIX)
0000132A  4E75                     917              RTS
0000132C                           918  ; -----------------------------------------------------------------------------
0000132C                           919  UTLCHCOL
0000132C                           920  ; CHECKS COLLISION
0000132C                           921  ; INPUT    - D0.W X0 COORDINATE
0000132C                           922  ;            D1.W Y0 COORDINATE
0000132C                           923  ;            D2.W X1 COORDINATE
0000132C                           924  ;            D3.W Y1 COORDINATE
0000132C                           925  ;            D4.W WIDTH 0
0000132C                           926  ;            D5.W WIDTH 1
0000132C                           927  ;            D6.W HEIGHT 0
0000132C                           928  ;            D7.W HEIGHT 1
0000132C                           929  ; OUTPUT   - D0.B=FF - COLLISION, =0 - NO COLLISION
0000132C                           930  ; MODIFIES - NONE
0000132C                           931  ; -----------------------------------------------------------------------------
0000132C  48A7 0F00                932              MOVEM.W D4-D7,-(A7)
00001330  D840                     933              ADD.W   D0,D4
00001332  B842                     934              CMP.W   D2,D4
00001334  6F00 0022                935              BLE     .NOCOL
00001338  DA42                     936              ADD.W   D2,D5
0000133A  BA40                     937              CMP.W   D0,D5
0000133C  6F00 001A                938              BLE     .NOCOL
00001340  DC41                     939              ADD.W   D1,D6
00001342  BC43                     940              CMP.W   D3,D6
00001344  6F00 0012                941              BLE     .NOCOL
00001348  DE43                     942              ADD.W   D3,D7
0000134A  BE41                     943              CMP.W   D1,D7
0000134C  6F00 000A                944              BLE     .NOCOL
00001350  103C 00FF                945              MOVE.B  #$FF,D0
00001354  6000 0004                946              BRA     .END
00001358  4200                     947  .NOCOL      CLR.B   D0
0000135A  4C9F 00F0                948  .END        MOVEM.W (A7)+,D4-D7
0000135E  4E75                     949              RTS
00001360                           950  
00001360                           951  ; -----------------------------------------------------------------------------
00001360                           952  UTLRAND
00001360                           953  ; PROVIDES A PSEUDO-RANDOM BYTE
00001360                           954  ; INPUT    - NONE
00001360                           955  ; OUTPUT   - D0.L RANDOM VALUE (ONLY BYTE)
00001360                           956  ; MODIFIES - NONE (ASIDE OF OUTPUT)
00001360                           957  ; -----------------------------------------------------------------------------
00001360  2F08                     958              MOVE.L  A0,-(A7)
00001362  41F9 0000137E            959              LEA     .RANDVEC,A0
00001368  4280                     960              CLR.L   D0
0000136A  1039 00001BBB            961              MOVE.B  (UTLRNDIX),D0
00001370  1030 0800                962              MOVE.B  (A0,D0.L),D0
00001374  5239 00001BBB            963              ADDQ.B  #1,(UTLRNDIX)
0000137A  205F                     964              MOVE.L  (A7)+,A0
0000137C  4E75                     965              RTS
0000137E                           966  
0000137E                           967  
0000137E= A2 EE 9A 0C F5 24 ...    968  .RANDVEC    DC.B    162, 238, 154, 12 , 245, 36 , 32 , 103
00001386= 2A A3 51 26 E0 AC ...    969              DC.B    42 , 163, 81 , 38 , 224, 172, 19 , 69
0000138E= 75 51 CA FD 33 EB ...    970              DC.B    117, 81 , 202, 253, 51 , 235, 108, 154
00001396= 60 CC E7 B8 9A EB ...    971              DC.B    96 , 204, 231, 184, 154, 235, 34 , 203
0000139E= 1D 76 B5 95 B0 89 ...    972              DC.B    29 , 118, 181, 149, 176, 137, 62 , 108
000013A6= 39 15 48 C9 6E CA ...    973              DC.B    57 , 21 , 72 , 201, 110, 202, 159, 41
000013AE= 43 E7 E2 7C 37 25 ...    974              DC.B    67 , 231, 226, 124, 55 , 37 , 84 , 62
000013B6= E9 94 CE E9 E4 52 ...    975              DC.B    233, 148, 206, 233, 228, 82 , 243, 78
000013BE= 37 6D 9A 84 A2 28 ...    976              DC.B    55 , 109, 154, 132, 162, 40 , 30 , 39
000013C6= 19 E2 C6 77 80 D4 ...    977              DC.B    25 , 226, 198, 119, 128, 212, 232, 225
000013CE= 0A 5A 32 67 33 C2 ...    978              DC.B    10 , 90 , 50 , 103, 51 , 194, 222, 40
000013D6= 59 80 DC 0E 57 FC ...    979              DC.B    89 , 128, 220, 14 , 87 , 252, 243, 252
000013DE= 8A AB BC F7 07 4D ...    980              DC.B    138, 171, 188, 247, 7  , 77 , 29 , 234
000013E6= EF D5 77 6E 1E BB ...    981              DC.B    239, 213, 119, 110, 30 , 187, 131, 23
000013EE= D6 E0 2A 8F BD 28 ...    982              DC.B    214, 224, 42 , 143, 189, 40 , 212, 130
000013F6= 13 4F 66 EC 0A 64 ...    983              DC.B    19 , 79 , 102, 236, 10 , 100, 122, 188
000013FE= 56 52 9A 16 9B 90 ...    984              DC.B    86 , 82 , 154, 22 , 155, 144, 7  , 199
00001406= 06 8A A4 F7 01 DA ...    985              DC.B    6  , 138, 164, 247, 1  , 218, 166, 82
0000140E= F2 E7 77 28 B1 76 ...    986              DC.B    242, 231, 119, 40 , 177, 118, 220, 102
00001416= A4 42 E3 81 B1 67 ...    987              DC.B    164, 66 , 227, 129, 177, 103, 165, 108
0000141E= BF CE FA 16 BF 38 ...    988              DC.B    191, 206, 250, 22 , 191, 56 , 30 , 161
00001426= D1 8B 50 0C 5F 49 ...    989              DC.B    209, 139, 80 , 12 , 95 , 73 , 168, 56
0000142E= DE 4C 14 A2 40 DC ...    990              DC.B    222, 76 , 20 , 162, 64 , 220, 93 , 12
00001436= B6 9B 0A 38 5D AB ...    991              DC.B    182, 155, 10 , 56 , 93 , 171, 89 , 6
0000143E= E2 1B DD 75 15 82 ...    992              DC.B    226, 27 , 221, 117, 21 , 130, 101, 18
00001446= 8A 26 51 30 9F 47 ...    993              DC.B    138, 38 , 81 , 48 , 159, 71 , 57 , 21
0000144E= 1E 8A BB 71 C6 6E ...    994              DC.B    30 , 138, 187, 113, 198, 110, 185, 152
00001456= 9F 47 E5 34 94 27 ...    995              DC.B    159, 71 , 229, 52 , 148, 39 , 77 , 6
0000145E= 7D 06 D6 BA 30 0F ...    996              DC.B    125, 6  , 214, 186, 48 , 15 , 212, 22
00001466= EC 7F 7E 03 CF 2D ...    997              DC.B    236, 127, 126, 3  , 207, 45 , 193, 2
0000146E= 94 5B 23 F2 8B CD ...    998              DC.B    148, 91 , 35 , 242, 139, 205, 248, 237
00001476= 74 33 EC B9 0F D5 ...    999              DC.B    116, 51 , 236, 185, 15 , 213, 221, 6
0000147E                          1000  
0000147E                          1001  
0000147E                          1002  -------------------- end include --------------------
0000147E                          1003              INCLUDE "AGENTLST.X68"               ; AGENT LIST MANAGEMENT
0000147E                          1004  ; =============================================================================
0000147E                          1005  ; AGENT MANAGEMENT
0000147E                          1006  ; EACH AGENT HAS A DATA BLOCK FROM DMM AS FOLLOWS:
0000147E                          1007  ; +0 - LONG : UPDATE SUBROUTINE POINTER
0000147E                          1008  ; +4 - LONG : PLOT SUBROUTINE POINTER
0000147E                          1009  ; +8:END    : DATA (AGENT SPECIFIC)
0000147E                          1010  ; =============================================================================
0000147E                          1011  
0000147E                          1012  ; -----------------------------------------------------------------------------
0000147E                          1013  AGLADD
0000147E                          1014  ; CREATES A NEW AGENT
0000147E                          1015  ; INPUT    - A1 - POINTER TO AGENT INIT FUNCTION
0000147E                          1016  ;            A2 - POINTER TO AGENT UPDATE FUNCTION
0000147E                          1017  ;            A3 - POINTER TO AGENT PLOT FUNCTION
0000147E                          1018  ;            D0 - AGENT TYPE (USED AS OWNED BY DMM)
0000147E                          1019  ;            D1 - AGENT INITIALIZATION PARAMETER 1
0000147E                          1020  ;            D2 - AGENT INITIALIZATION PARAMETER 2
0000147E                          1021  ;            D3 - AGENT INITIALIZATION PARAMETER 3
0000147E                          1022  ; OUTPUT   - NONE
0000147E                          1023  ; MODIFIES - NONE
0000147E                          1024  ; -----------------------------------------------------------------------------
0000147E  2F08                    1025              MOVE.L  A0,-(A7)
00001480                          1026              
00001480  4EB8 1190               1027              JSR     DMMALLOC
00001484  B1FC 00000000           1028              CMP.L   #0,A0
0000148A  6700 0008               1029              BEQ     .END
0000148E  20CA                    1030              MOVE.L  A2,(A0)+
00001490  20CB                    1031              MOVE.L  A3,(A0)+
00001492  4E91                    1032              JSR     (A1)
00001494                          1033  
00001494  205F                    1034  .END        MOVE.L  (A7)+,A0
00001496  4E75                    1035              RTS
00001498                          1036  
00001498                          1037  ; -----------------------------------------------------------------------------
00001498                          1038  AGLUPD
00001498                          1039  ; UPDATES THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
00001498                          1040  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
00001498                          1041  ; INPUT    - NONE
00001498                          1042  ; OUTPUT   - NONE
00001498                          1043  ; MODIFIES - NONE
00001498                          1044  ; -----------------------------------------------------------------------------
00001498  48E7 00C0               1045              MOVEM.L A0-A1,-(A7)
0000149C                          1046              
0000149C  4EB8 1120               1047              JSR     DMMFIRST
000014A0  B1FC 00000000           1048  .LOOP       CMP.L   #0,A0
000014A6  6700 001E               1049              BEQ     .END
000014AA  0C68 0002 FFFE          1050              CMP.W   #GSSDTYPE,-2(A0)    ;IF MEMORY DOESN'T BELONG TO AGENT
000014B0  670E                    1051              BEQ.S   .NEXT               ;SKIP
000014B2  0C68 0001 FFFE          1052              CMP.W   #CLDTYPE,-2(A0)
000014B8  6706                    1053              BEQ.S   .NEXT
000014BA                          1054              
000014BA  2250                    1055              MOVE.L  (A0),A1
000014BC  5088                    1056              ADD.L   #8,A0
000014BE  4E91                    1057              JSR     (A1)
000014C0  4EB8 1142               1058  .NEXT       JSR     DMMNEXT
000014C4  60DA                    1059              BRA     .LOOP
000014C6                          1060              
000014C6  4CDF 0300               1061  .END        MOVEM.L (A7)+,A0-A1            
000014CA  4E75                    1062              RTS
000014CC                          1063  
000014CC                          1064  ; -----------------------------------------------------------------------------
000014CC                          1065  AGLPLOT
000014CC                          1066  ; PLOTS THE AGENT LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
000014CC                          1067  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
000014CC                          1068  ; INPUT    - NONE
000014CC                          1069  ; OUTPUT   - NONE
000014CC                          1070  ; MODIFIES - NONE
000014CC                          1071  ; -----------------------------------------------------------------------------
000014CC  48E7 00C0               1072              MOVEM.L A0-A1,-(A7)
000014D0                          1073  
000014D0  4EB8 1120               1074              JSR     DMMFIRST
000014D4  B1FC 00000000           1075  .LOOP       CMP.L   #0,A0
000014DA  6700 0020               1076              BEQ     .END
000014DE  0C68 0002 FFFE          1077              CMP.W   #GSSDTYPE,-2(A0)    ;IF MEMORY DOESN'T BELONG TO AGENT
000014E4  6710                    1078              BEQ.S   .NEXT               ;SKIP
000014E6  0C68 0001 FFFE          1079              CMP.W   #CLDTYPE,-2(A0)
000014EC  6708                    1080              BEQ.S   .NEXT
000014EE                          1081              
000014EE  2268 0004               1082              MOVE.L  4(A0),A1
000014F2  5088                    1083              ADD.L   #8,A0
000014F4  4E91                    1084              JSR     (A1)
000014F6  4EB8 1142               1085  .NEXT       JSR     DMMNEXT
000014FA  60D8                    1086              BRA     .LOOP
000014FC  4CDF 0300               1087  .END        MOVEM.L (A7)+,A0-A1
00001500                          1088  
00001500  4E75                    1089              RTS
00001502                          1090  
00001502                          1091  ; -----------------------------------------------------------------------------
00001502  =000011AA               1092  AGLKILL     EQU     DMMFREE
00001502                          1093  ; KILLS THE AGENT BY RELEASING ITS MEMORY
00001502                          1094  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001502                          1095  ; OUTPUT   - NONE
00001502                          1096  ; MODIFIES - NONE
00001502                          1097  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001502                          1098  ; -----------------------------------------------------------------------------
00001502                          1099  
00001502                          1100  
00001502                          1101  
00001502                          1102  
00001502                          1103  
00001502                          1104  
00001502                          1105  
00001502                          1106  
00001502                          1107  
00001502                          1108  
00001502                          1109  
00001502                          1110  -------------------- end include --------------------
00001502                          1111              INCLUDE "PROPLST.X68"                ; PROPS LIST MANAGEMENT
00001502                          1112  ; =============================================================================
00001502                          1113  ; PROP MANAGEMENT
00001502                          1114  ; EACH PROP HAS A DATA BLOCK FROM DMM AS FOLLOWS:
00001502                          1115  ; +0 - LONG : UPDATE SUBROUTINE POINTER
00001502                          1116  ; +4 - LONG : PLOT SUBROUTINE POINTER
00001502                          1117  ; +8:END    : DATA (PROP SPECIFIC)
00001502                          1118  ; =============================================================================
00001502                          1119  
00001502                          1120  ; -----------------------------------------------------------------------------
00001502                          1121  PRPADD
00001502                          1122  ; CREATES A NEW PROP
00001502                          1123  ; INPUT    - A1 - POINTER TO PROP INIT FUNCTION
00001502                          1124  ;            A2 - POINTER TO PROP UPDATE FUNCTION
00001502                          1125  ;            A3 - POINTER TO PROP PLOT FUNCTION
00001502                          1126  ;            D0 - PROP TYPE (USED AS OWNED BY DMM)
00001502                          1127  ;            D1 - PROP INITIALIZATION PARAMETER 1
00001502                          1128  ;            D2 - PROP INITIALIZATION PARAMETER 2
00001502                          1129  ;            D3 - PROP INITIALIZATION PARAMETER 3
00001502                          1130  ; OUTPUT   - NONE
00001502                          1131  ; MODIFIES - NONE
00001502                          1132  ; -----------------------------------------------------------------------------
00001502  2F08                    1133              MOVE.L  A0,-(A7)
00001504                          1134              
00001504  4EB8 1190               1135              JSR     DMMALLOC
00001508  B1FC 00000000           1136              CMP.L   #0,A0
0000150E  6700 0008               1137              BEQ     .END
00001512  20CA                    1138              MOVE.L  A2,(A0)+
00001514  20CB                    1139              MOVE.L  A3,(A0)+
00001516  4E91                    1140              JSR     (A1)
00001518                          1141  
00001518  205F                    1142  .END        MOVE.L  (A7)+,A0
0000151A  4E75                    1143              RTS
0000151C                          1144  
0000151C                          1145  ; -----------------------------------------------------------------------------
0000151C                          1146  PRPUPD
0000151C                          1147  ; UPDATES THE PROP LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
0000151C                          1148  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
0000151C                          1149  ; INPUT    - NONE
0000151C                          1150  ; OUTPUT   - NONE
0000151C                          1151  ; MODIFIES - NONE
0000151C                          1152  ; -----------------------------------------------------------------------------
0000151C  48E7 00C0               1153              MOVEM.L A0-A1,-(A7)
00001520                          1154              
00001520  4EB8 1120               1155              JSR     DMMFIRST
00001524  B1FC 00000000           1156  .LOOP       CMP.L   #0,A0
0000152A  6700 0018               1157              BEQ     .END
0000152E  0C68 0003 FFFE          1158              CMP.W   #PIPTYPE,-2(A0) ;IF MEMORY DOESN'T BELONG TO PROPS
00001534  6700 0008               1159              BEQ     .NEXT           ;SKIP
00001538                          1160              
00001538  2250                    1161              MOVE.L  (A0),A1
0000153A  5088                    1162              ADD.L   #8,A0
0000153C  4E91                    1163              JSR     (A1)
0000153E                          1164              
0000153E  4EB8 1142               1165  .NEXT       JSR     DMMNEXT
00001542  60E0                    1166              BRA     .LOOP
00001544                          1167              
00001544  4CDF 0300               1168  .END        MOVEM.L (A7)+,A0-A1            
00001548  4E75                    1169              RTS
0000154A                          1170              
0000154A                          1171  ; -----------------------------------------------------------------------------
0000154A                          1172  PRPPLOT
0000154A                          1173  ; PLOTS THE PROP LIST. PRIOR TO CALLING THE UPDATE FUNCTIONS, A0 IS SET
0000154A                          1174  ; TO THE DATA BLOCK OF THE CORRESPONDING SLOT.
0000154A                          1175  ; INPUT    - NONE
0000154A                          1176  ; OUTPUT   - NONE
0000154A                          1177  ; MODIFIES - NONE
0000154A                          1178  ; -----------------------------------------------------------------------------
0000154A  48E7 00C0               1179              MOVEM.L A0-A1,-(A7)
0000154E                          1180  
0000154E  4EB8 1120               1181              JSR     DMMFIRST
00001552  B1FC 00000000           1182  .LOOP       CMP.L   #0,A0
00001558  6700 0018               1183              BEQ     .END
0000155C  0C68 0003 FFFE          1184              CMP.W   #PIPTYPE,-2(A0)     ;IF MEMORY DOESN'T BELONG TO PROP
00001562  6708                    1185              BEQ.S   .NEXT               ;SKIP
00001564                          1186              
00001564  2268 0004               1187              MOVE.L  4(A0),A1
00001568  5088                    1188              ADD.L   #8,A0
0000156A  4E91                    1189              JSR     (A1)
0000156C  4EB8 1142               1190  .NEXT       JSR     DMMNEXT
00001570  60E0                    1191              BRA     .LOOP
00001572  4CDF 0300               1192  .END        MOVEM.L (A7)+,A0-A1
00001576                          1193  
00001576  4E75                    1194              RTS
00001578                          1195  
00001578                          1196  ; -----------------------------------------------------------------------------
00001578  =000011AA               1197  PRPKILL     EQU     DMMFREE
00001578                          1198  ; KILLS THE PRP BY RELEASING ITS MEMORY
00001578                          1199  ; INPUT    - A0 POINTER WITHIN THE AGENT MEMORY
00001578                          1200  ; OUTPUT   - NONE
00001578                          1201  ; MODIFIES - NONE
00001578                          1202  ; NOTE     - IT IS JUST A WRAPPER FOR DMMFREE
00001578                          1203  ; -----------------------------------------------------------------------------
00001578                          1204  
00001578                          1205  
00001578                          1206  
00001578                          1207  
00001578                          1208  
00001578                          1209  
00001578                          1210  
00001578                          1211  
00001578                          1212  
00001578                          1213  
00001578                          1214  
00001578                          1215  
00001578                          1216  
00001578                          1217  
00001578                          1218  -------------------- end include --------------------
00001578                          1219              INCLUDE "SPAWNER.X68"                ; SPAWNER
00001578                          1220  ; =============================================================================
00001578                          1221  ; SPAWNER MANAGEMENT.
00001578                          1222  ; =============================================================================
00001578                          1223  
00001578                          1224  ; -----------------------------------------------------------------------------
00001578                          1225  SPWUPD
00001578                          1226  ; UPDATES THE SPAWNER
00001578                          1227  ; INPUT    - NONE
00001578                          1228  ; OUTPUT   - NONE
00001578                          1229  ; MODIFIES - NONE
00001578                          1230  ; -----------------------------------------------------------------------------
00001578  48E7 8070               1231              MOVEM.L  D0/A1-A3,-(A7)
0000157C                          1232  
0000157C  1039 00001BBF           1233              MOVE.B  (SCRCYCCT),D0
00001582  C07C 003F               1234              AND     #$3F,D0                 ; EVERY 64 CYCLES
00001586  6600 0028               1235              BNE     .END                    ; CREATE A NEW PIPE
0000158A  43F9 00001AB0           1236              LEA     PIPINIT,A1
00001590  45F9 00001AD6           1237              LEA     PIPUPD,A2
00001596  47F9 00001AF0           1238              LEA     PIPPLOT,A3
0000159C  303C 0003               1239              MOVE.W  #PIPTYPE,D0
000015A0  1239 00001BB6           1240              MOVE.B  (PIPCOUNT),D1
000015A6  5239 00001BB6           1241              ADDQ.B  #1,(PIPCOUNT)
000015AC                          1242              
000015AC  4EB8 147E               1243              JSR     AGLADD
000015B0                          1244              
000015B0  4CDF 0E01               1245  .END        MOVEM.L (A7)+,D0/A1-A3
000015B4  4E75                    1246              RTS
000015B6                          1247  
000015B6                          1248  
000015B6                          1249  
000015B6                          1250  
000015B6                          1251  
000015B6                          1252  
000015B6                          1253  
000015B6                          1254  
000015B6                          1255  
000015B6                          1256  
000015B6                          1257  
000015B6                          1258  
000015B6                          1259  
000015B6                          1260  
000015B6                          1261  
000015B6                          1262  
000015B6                          1263  
000015B6                          1264  
000015B6                          1265  
000015B6                          1266  
000015B6                          1267  
000015B6                          1268  -------------------- end include --------------------
000015B6                          1269              INCLUDE "STATES2.X68"                ; GAME STATES MANAGEMENT
000015B6                          1270  ; =============================================================================
000015B6                          1271  ; GAME STATE MANAGEMENT
000015B6                          1272  ; =============================================================================
000015B6                          1273  
000015B6                          1274  ; -----------------------------------------------------------------------------
000015B6                          1275  STAINIT
000015B6                          1276  ; INITALIZES THE STATE MANAGER
000015B6                          1277  ; INPUT    - NONE
000015B6                          1278  ; OUTPUT   - NONE
000015B6                          1279  ; MODIFIES - NONE
000015B6                          1280  ; -----------------------------------------------------------------------------
000015B6  33FC FFFF 00001BA8      1281              MOVE.W  #STANONE,(STACUR)
000015BE  33FC 0000 00001BAA      1282              MOVE.W  #STAINTR,(STANEXT)
000015C6  4E75                    1283              RTS
000015C8                          1284  
000015C8                          1285  ; -----------------------------------------------------------------------------
000015C8                          1286  STAUPD
000015C8                          1287  ; PERFORMS STATE UPDATE AND INIT IF NECESSARY
000015C8                          1288  ; INPUT    - NONE
000015C8                          1289  ; OUTPUT   - NONE
000015C8                          1290  ; MODIFIES - NONE
000015C8                          1291  ; -----------------------------------------------------------------------------
000015C8  48E7 8080               1292              MOVEM.L D0/A0,-(A7)
000015CC  4280                    1293              CLR.L   D0
000015CE  3039 00001BAA           1294              MOVE.W  (STANEXT),D0
000015D4  B079 00001BA8           1295              CMP.W   (STACUR),D0
000015DA  6700 0012               1296              BEQ     .DOUPD
000015DE  33C0 00001BA8           1297              MOVE.W  D0,(STACUR)             ; IF STATE CHANGED, DO INIT
000015E4  E588                    1298              LSL.L   #2,D0
000015E6  2040                    1299              MOVE.L  D0,A0
000015E8  2068 1606               1300              MOVE.L  .INITBL(A0),A0
000015EC  4E90                    1301              JSR     (A0)
000015EE  4280                    1302  .DOUPD      CLR.L   D0                      ; IN ANY CASE, DO UPDATE
000015F0  3039 00001BA8           1303              MOVE.W  (STACUR),D0
000015F6  E588                    1304              LSL.L   #2,D0
000015F8  2040                    1305              MOVE.L  D0,A0
000015FA  2068 1616               1306              MOVE.L  .UPDTBL(A0),A0
000015FE  4E90                    1307              JSR     (A0)
00001600  4CDF 0101               1308              MOVEM.L (A7)+,D0/A0
00001604  4E75                    1309              RTS
00001606= 000010FE 000011C0 ...   1310  .INITBL     DC.L    STAINTRI,STAPLAYI,STAEMPTY,STAEMPTY
00001616= 00001690 00001654 ...   1311  .UPDTBL     DC.L    STAINTRU,STAPLAYU,STAPAUU,STAGOVRU
00001626                          1312  
00001626                          1313  ; -----------------------------------------------------------------------------
00001626                          1314  STAPLOT
00001626                          1315  ; PERFORMS STATE PLOT
00001626                          1316  ; INPUT    - NONE
00001626                          1317  ; OUTPUT   - NONE
00001626                          1318  ; MODIFIES - NONE
00001626                          1319  ; -----------------------------------------------------------------------------
00001626  48E7 8080               1320              MOVEM.L D0/A0,-(A7)
0000162A  4280                    1321              CLR.L   D0
0000162C  3039 00001BA8           1322              MOVE.W  (STACUR),D0
00001632  E588                    1323              LSL.L   #2,D0
00001634  2040                    1324              MOVE.L  D0,A0
00001636  2068 1642               1325              MOVE.L  .PLTTBL(A0),A0
0000163A  4E90                    1326              JSR     (A0)
0000163C  4CDF 0101               1327              MOVEM.L (A7)+,D0/A0
00001640  4E75                    1328              RTS
00001642= 000016A6 0000167E ...   1329  .PLTTBL     DC.L    STAINTRP,STAPLAYP,STAPAUP,STAGOVRP
00001652                          1330  
00001652                          1331  ; -----------------------------------------------------------------------------
00001652                          1332  STAEMPTY
00001652                          1333  ; EMPTY SUBROUTINE FOR CASES WITH NOTHING TO DO
00001652                          1334  ; INPUT    - NONE
00001652                          1335  ; OUTPUT   - NONE
00001652                          1336  ; MODIFIES - NONE
00001652                          1337  ; NOTE     - JUST A PLACEHOLDER. NOTHING TO DO.
00001652                          1338  ; -----------------------------------------------------------------------------
00001652  4E75                    1339              RTS
00001654                          1340  
00001654                          1341  ; -----------------------------------------------------------------------------
00001654  =000011C0               1342  STAPLAYI    EQU     PLRINIT
00001654                          1343  ; PLAY STATE INITIALIZATION.
00001654                          1344  ; INPUT    - NONE
00001654                          1345  ; OUTPUT   - NONE
00001654                          1346  ; MODIFIES - NONE
00001654                          1347  ; NOTE     - JUST A WRAPPER FOR PLRINIT
00001654                          1348  ; -----------------------------------------------------------------------------
00001654                          1349  
00001654                          1350  ; -----------------------------------------------------------------------------
00001654                          1351  STAPLAYU
00001654                          1352  ; PLAY STATE UPDATE
00001654                          1353  ; INPUT    - NONE
00001654                          1354  ; OUTPUT   - NONE
00001654                          1355  ; MODIFIES - NONE
00001654                          1356  ; -----------------------------------------------------------------------------
00001654  0839 0007 00001BBD      1357              BTST.B   #KBDBITPS,(KBDEDGE)         ;Si 'P' es presionado, pausa.
0000165C  6616                    1358              BNE.S   .PAUSE
0000165E                          1359              
0000165E  4EB8 11EA               1360              JSR     PLRUPD
00001662  4EB9 000019FA           1361              JSR     BGUPD
00001668  4EB8 151C               1362              JSR     PRPUPD
0000166C  4EB8 1578               1363              JSR     SPWUPD
00001670  6000 FE26               1364              BRA     AGLUPD
00001674                          1365  .PAUSE      
00001674  33FC 0002 00001BAA      1366              MOVE.W  #STAPAU,(STANEXT)
0000167C  4E75                    1367              RTS
0000167E                          1368  ; -----------------------------------------------------------------------------
0000167E                          1369  STAPLAYP
0000167E                          1370  ; PLAY STATE PLOT
0000167E                          1371  ; INPUT    - NONE
0000167E                          1372  ; OUTPUT   - NONE
0000167E                          1373  ; MODIFIES - NONE
0000167E                          1374  ; -----------------------------------------------------------------------------
0000167E  4EB9 00001A46           1375              JSR     BGPLOT
00001684  4EB8 154A               1376              JSR     PRPPLOT
00001688  4EB8 14CC               1377              JSR     AGLPLOT
0000168C                          1378              ;BRA     AGLPLOT
0000168C  6000 FBDA               1379              BRA     PLRPLOT
00001690                          1380  
00001690                          1381  ; -----------------------------------------------------------------------------
00001690  =000010FE               1382  STAINTRI    EQU     DMMINIT
00001690                          1383  ; INTRO STATE INIT
00001690                          1384  ; INPUT    - NONE
00001690                          1385  ; OUTPUT   - NONE
00001690                          1386  ; MODIFIES - NONE
00001690                          1387  ; NOTE     - JUST A WRAPPER FOR DMMINIT TO RELEASE ALL MEMORY
00001690                          1388  ; -----------------------------------------------------------------------------
00001690                          1389  
00001690                          1390  ; -----------------------------------------------------------------------------
00001690                          1391  STAINTRU
00001690                          1392  ; INTRO STATE UPDATE
00001690                          1393  ; INPUT    - NONE
00001690                          1394  ; OUTPUT   - NONE
00001690                          1395  ; MODIFIES - NONE
00001690                          1396  ; -----------------------------------------------------------------------------
00001690  0839 0004 00001BBD      1397              BTST.B  #KBDBITF1,(KBDEDGE)
00001698  6700 000A               1398              BEQ     .END
0000169C  33FC 0001 00001BAA      1399              MOVE.W  #STAPLAY,(STANEXT)
000016A4  4E75                    1400  .END        RTS
000016A6                          1401  
000016A6                          1402  ; -----------------------------------------------------------------------------
000016A6                          1403  STAINTRP
000016A6                          1404  ; INTRO STATE PLOT
000016A6                          1405  ; INPUT    - NONE
000016A6                          1406  ; OUTPUT   - NONE
000016A6                          1407  ; MODIFIES - NONE
000016A6                          1408  ; -----------------------------------------------------------------------------
000016A6                          1409              ;Guardar registros en pila
000016A6  48E7 C040               1410              MOVEM.L A1/D0-D1,-(A7)
000016AA                          1411              
000016AA                          1412              ;Seleccionar fuente de texto
000016AA                          1413m             UTLFONT INTTITC,INTTITF
000016AA                          1414m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000016AA                          1415m ; INPUT    - INTTITC COLOR, INTTITF FONT
000016AA                          1416m ; OUTPUT   - NONE
000016AA                          1417m ; MODIFIES - D0,D1,D2
000016AA                          1418m ; -----------------------------------------------------------------------------
000016BA                          1419              ;Seleccionar posicion de texto      
000016BA                          1420m             UTLLOCT INTTITX,INTTITY               
000016BA                          1421m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000016BA                          1422m ; INPUT    - INTTITX X, INTTITY Y
000016BA                          1423m ; OUTPUT   - NONE
000016BA                          1424m ; MODIFIES - D0,D1
000016BA                          1425m ; -----------------------------------------------------------------------------
000016C4                          1426  
000016C4  43F9 000016FC           1427              LEA     .TITLE,A1
000016CA  103C 000E               1428              MOVE.B  #14,D0
000016CE  4E4F                    1429              TRAP    #15
000016D0                          1430              
000016D0                          1431              ;Seleccionar fuente de texto
000016D0                          1432m             UTLFONT INTPRSC,INTPRSF     
000016D0                          1433m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000016D0                          1434m ; INPUT    - INTPRSC COLOR, INTPRSF FONT
000016D0                          1435m ; OUTPUT   - NONE
000016D0                          1436m ; MODIFIES - D0,D1,D2
000016D0                          1437m ; -----------------------------------------------------------------------------
000016E0                          1438              ;Seleccionar posicion de texto
000016E0                          1439m             UTLLOCT INTPRSX,INTPRSY     
000016E0                          1440m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000016E0                          1441m ; INPUT    - INTPRSX X, INTPRSY Y
000016E0                          1442m ; OUTPUT   - NONE
000016E0                          1443m ; MODIFIES - D0,D1
000016E0                          1444m ; -----------------------------------------------------------------------------
000016EA                          1445  
000016EA  43F9 00001708           1446              LEA     .START_TEXT,A1
000016F0  103C 000E               1447              MOVE.B  #14,D0
000016F4  4E4F                    1448              TRAP    #15
000016F6                          1449              
000016F6                          1450              ;Restaurar registros
000016F6  4CDF 0203               1451              MOVEM.L (A7)+,A1/D0-D1
000016FA  4E75                    1452              RTS
000016FC                          1453  
000016FC= 46 4C 41 50 50 59 ...   1454  .TITLE      DC.B    'FLAPPY BIRD',0 
00001708= 50 52 45 53 53 20 ...   1455  .START_TEXT DC.B    'PRESS SPACE TO START',0
0000171E                          1456              DS.W    0
0000171E                          1457  
0000171E                          1458  
0000171E                          1459  
0000171E                          1460  ; -----------------------------------------------------------------------------
0000171E                          1461  STAPAUI    
0000171E                          1462  ; PAUSE STATE INIT
0000171E                          1463  ; INPUT    - NONE
0000171E                          1464  ; OUTPUT   - NONE
0000171E                          1465  ; MODIFIES - NONE
0000171E                          1466  ; -----------------------------------------------------------------------------
0000171E                          1467              ;Guardar registros de juego
0000171E  48E7 FFFE               1468              MOVEM.L D0-D7/A0-A6,-(A7)
00001722  40E7                    1469              MOVE.W  SR,-(A7)
00001724                          1470              
00001724  4EEF FFC0               1471              JMP     -64(A7)
00001728                          1472  ; -----------------------------------------------------------------------------
00001728                          1473  STAPAUU
00001728                          1474  ; INTRO STATE UPDATE
00001728                          1475  ; INPUT    - NONE
00001728                          1476  ; OUTPUT   - NONE
00001728                          1477  ; MODIFIES - NONE
00001728                          1478  ; -----------------------------------------------------------------------------
00001728  0839 0001 00001BBD      1479              BTST.B  #KBDBITUP,(KBDEDGE)     ;Check cambio en estado de UP
00001730  6628                    1480              BNE.S   .UP
00001732  0839 0003 00001BBD      1481              BTST.B  #KBDBITDN,(KBDEDGE)     ;Check cambio en estado de DOWN
0000173A  6630                    1482              BNE.S   .DN
0000173C  0839 0004 00001BBD      1483              BTST.B  #KBDBITF1,(KBDEDGE)     ;Check cambio en estado de FIRE1
00001744  6638                    1484              BNE.S   .OK
00001746  0839 0007 00001BBD      1485              BTST.B  #KBDBITPS,(KBDEDGE)     ;Check cambio en estado de 'P'
0000174E  6708                    1486              BEQ.S   .END
00001750                          1487              
00001750  33FC 0001 00001BAA      1488              MOVE.W  #STAPLAY,(STANEXT)      ;Si hay cambio en estado de 'P'
00001758                          1489                                              ;Actualizar siguiente estado
00001758  4E75                    1490  .END        RTS
0000175A                          1491  
0000175A  0C39 0000 00001BBA      1492  .UP         CMP.B   #CONTNUM,(PMOPTN)       ;Check si es posible cambiar a una
00001762  6FF4                    1493              BLE.S   .END                    ;opción superior
00001764  5379 00001BBA           1494              SUBQ    #1,(PMOPTN)
0000176A  60EC                    1495              BRA.S   .END
0000176C                          1496              
0000176C  0C39 0002 00001BBA      1497  .DN         CMP.B   #EXTNUM,(PMOPTN)        ;Check si es posible cambiar a una
00001774  6CE2                    1498              BGE.S   .END                    ;opción inferior
00001776  5279 00001BBA           1499              ADDQ    #1,(PMOPTN)
0000177C  60DA                    1500              BRA.S   .END
0000177E                          1501              
0000177E                          1502  .OK         
0000177E  4280                    1503              CLR.L   D0                      ;Preparar registro D0
00001780  1039 00001BBA           1504              MOVE.B  (PMOPTN),D0
00001786  C0FC 0006               1505              MULU    #6,D0                   
0000178A                          1506              
0000178A  2040                    1507              MOVEA.L D0,A0                   ;Usar D0 como indice para .JMPLST
0000178C                          1508              
0000178C  4EE8 1790               1509              JMP     .JMPLST(A0)
00001790                          1510              
00001790  4EF9 000017A2           1511  .JMPLST     JMP     .contgame               
00001796  4EF9 000017AC           1512              JMP     .newgame
0000179C  4EF9 000017B6           1513              JMP     .exitgame
000017A2                          1514  .contgame
000017A2                          1515              ;Si última PMOPT == continuar juego, actualizar estado
000017A2  33FC 0001 00001BAA      1516              MOVE.W  #STAPLAY,(STANEXT)
000017AA  60AC                    1517              BRA     .END
000017AC                          1518  .newgame    
000017AC                          1519              ;Si última PMOPT == nuevo juego, actualizar estado
000017AC  33FC 0000 00001BAA      1520              MOVE.W  #STAINTR,(STANEXT)
000017B4  60A2                    1521              BRA     .END
000017B6                          1522              
000017B6                          1523  .exitgame   
000017B6                          1524              ;Si última PMOPT == salir de juego, actualizar estado
000017B6  33FC 0003 00001BAA      1525              MOVE.W  #STAGOVR,(STANEXT)
000017BE  6098                    1526              BRA     .END
000017C0                          1527  
000017C0                          1528  ; -----------------------------------------------------------------------------
000017C0                          1529  STAPAUP
000017C0                          1530  ; INTRO STATE PLOT
000017C0                          1531  ; INPUT    - NONE
000017C0                          1532  ; OUTPUT   - NONE
000017C0                          1533  ; MODIFIES - NONE
000017C0                          1534  ; -----------------------------------------------------------------------------
000017C0                          1535              ;Guardar registros
000017C0  48E7 8040               1536              MOVEM.L D0/A1,-(A7)
000017C4                          1537  
000017C4                          1538m             UTLSFIL #$00000000
000017C4                          1539m ; WRAPPER FOR SET FIL TRAP 15 TASK.
000017C4                          1540m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
000017C4                          1541m ; OUTPUT   - NONE
000017C4                          1542m ; MODIFIES - D0,D1
000017C4                          1543m ; -----------------------------------------------------------------------------
000017CC                          1544  
000017CC                          1545              **********DIBUJAR TÍTULO**********
000017CC                          1546              ;Seleccionar fuente de texto
000017CC                          1547m             UTLFONT PAUTITC,PAUTITF
000017CC                          1548m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
000017CC                          1549m ; INPUT    - PAUTITC COLOR, PAUTITF FONT
000017CC                          1550m ; OUTPUT   - NONE
000017CC                          1551m ; MODIFIES - D0,D1,D2
000017CC                          1552m ; -----------------------------------------------------------------------------
000017DC                          1553              ;Seleccionar posicion de texto      
000017DC                          1554m             UTLLOCT PAUTITX,PAUTITY               
000017DC                          1555m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000017DC                          1556m ; INPUT    - PAUTITX X, PAUTITY Y
000017DC                          1557m ; OUTPUT   - NONE
000017DC                          1558m ; MODIFIES - D0,D1
000017DC                          1559m ; -----------------------------------------------------------------------------
000017E6                          1560  
000017E6  43F9 000018BC           1561              LEA     .TITLE,A1
000017EC  700E                    1562              MOVEQ   #14,D0
000017EE  4E4F                    1563              TRAP    #15
000017F0                          1564              
000017F0  1E39 00001BBA           1565              MOVE.B  (PMOPTN),D7
000017F6                          1566              
000017F6                          1567              
000017F6                          1568              **********DIBUJAR OPCION CONTINUAR**********
000017F6                          1569              ;Seleccionar fuente de texto
000017F6  0C39 0000 00001BBA      1570              CMP.B   #CONTNUM,(PMOPTN)
000017FE  6712                    1571              BEQ.S   .CNTSEL
00001800                          1572m             UTLFONT PAUOPTC,PAUOPTFU
00001800                          1573m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001800                          1574m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
00001800                          1575m ; OUTPUT   - NONE
00001800                          1576m ; MODIFIES - D0,D1,D2
00001800                          1577m ; -----------------------------------------------------------------------------
00001810  6010                    1578              BRA.S   .SKPCNT
00001812                          1579  
00001812                          1580m .CNTSEL     UTLFONT PAUOPTC,PAUOPTFS
00001812                          1581m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001812                          1582m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
00001812                          1583m ; OUTPUT   - NONE
00001812                          1584m ; MODIFIES - D0,D1,D2
00001812                          1585m ; -----------------------------------------------------------------------------
00001822                          1586  .SKPCNT
00001822                          1587              ;Seleccionar posición de texto
00001822                          1588m             UTLLOCT PAUOPTX,PAUCNTY
00001822                          1589m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001822                          1590m ; INPUT    - PAUOPTX X, PAUCNTY Y
00001822                          1591m ; OUTPUT   - NONE
00001822                          1592m ; MODIFIES - D0,D1
00001822                          1593m ; -----------------------------------------------------------------------------
0000182C                          1594              
0000182C  43F9 000018CA           1595              LEA     .CONT,A1
00001832  700E                    1596              MOVEQ   #14,D0
00001834  4E4F                    1597              TRAP    #15
00001836                          1598              
00001836                          1599              **********DIBUJAR OPCION JUEGO NUEVO**********
00001836                          1600              ;Seleccionar fuente de texto
00001836  0C39 0001 00001BBA      1601              CMP.B   #NEWGNUM,(PMOPTN)
0000183E  6712                    1602              BEQ.S   .NEWSEL
00001840                          1603m             UTLFONT PAUOPTC,PAUOPTFU
00001840                          1604m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001840                          1605m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
00001840                          1606m ; OUTPUT   - NONE
00001840                          1607m ; MODIFIES - D0,D1,D2
00001840                          1608m ; -----------------------------------------------------------------------------
00001850  6010                    1609              BRA.S   .SKPNEW
00001852                          1610  
00001852                          1611m .NEWSEL     UTLFONT PAUOPTC,PAUOPTFS
00001852                          1612m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001852                          1613m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
00001852                          1614m ; OUTPUT   - NONE
00001852                          1615m ; MODIFIES - D0,D1,D2
00001852                          1616m ; -----------------------------------------------------------------------------
00001862                          1617  .SKPNEW
00001862                          1618              ;Seleccionar posición de texto
00001862                          1619m             UTLLOCT PAUOPTX,PAUNEWY
00001862                          1620m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001862                          1621m ; INPUT    - PAUOPTX X, PAUNEWY Y
00001862                          1622m ; OUTPUT   - NONE
00001862                          1623m ; MODIFIES - D0,D1
00001862                          1624m ; -----------------------------------------------------------------------------
0000186C                          1625              
0000186C  43F9 000018D4           1626              LEA     .NEWG,A1
00001872  700E                    1627              MOVEQ   #14,D0
00001874  4E4F                    1628              TRAP    #15
00001876                          1629              
00001876                          1630              **********DIBUJAR OPCION SALIR**********
00001876                          1631              ;Seleccionar fuente de texto
00001876  0C39 0002 00001BBA      1632              CMP.B   #EXTNUM,(PMOPTN)
0000187E  6712                    1633              BEQ.S   .EXTSEL
00001880                          1634m             UTLFONT PAUOPTC,PAUOPTFU
00001880                          1635m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001880                          1636m ; INPUT    - PAUOPTC COLOR, PAUOPTFU FONT
00001880                          1637m ; OUTPUT   - NONE
00001880                          1638m ; MODIFIES - D0,D1,D2
00001880                          1639m ; -----------------------------------------------------------------------------
00001890  6010                    1640              BRA.S   .SKPEXT
00001892                          1641  
00001892                          1642m .EXTSEL     UTLFONT PAUOPTC,PAUOPTFS
00001892                          1643m ; WRAPPER TO FONT FORMATTING FROM TRAP 15
00001892                          1644m ; INPUT    - PAUOPTC COLOR, PAUOPTFS FONT
00001892                          1645m ; OUTPUT   - NONE
00001892                          1646m ; MODIFIES - D0,D1,D2
00001892                          1647m ; -----------------------------------------------------------------------------
000018A2                          1648  .SKPEXT
000018A2                          1649              ;Seleccionar posición de texto
000018A2                          1650m             UTLLOCT PAUOPTX,PAUEXTY
000018A2                          1651m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
000018A2                          1652m ; INPUT    - PAUOPTX X, PAUEXTY Y
000018A2                          1653m ; OUTPUT   - NONE
000018A2                          1654m ; MODIFIES - D0,D1
000018A2                          1655m ; -----------------------------------------------------------------------------
000018AC                          1656              
000018AC  43F9 000018E0           1657              LEA     .EXIT,A1
000018B2  700E                    1658              MOVEQ   #14,D0
000018B4  4E4F                    1659              TRAP    #15
000018B6                          1660              
000018B6                          1661              ;Restaurar registros
000018B6  4CDF 0201               1662              MOVEM.L (A7)+,D0/A1
000018BA  4E75                    1663              RTS
000018BC                          1664              
000018BC                          1665  ; --- LOCAL DATA -----------------
000018BC= 4D 45 4E 55 20 44 ...   1666  .TITLE      DC.B    'MENU DE PAUSA',0
000018CA= 43 4F 4E 54 49 4E ...   1667  .CONT       DC.B    'CONTINUAR',0
000018D4= 4A 55 45 47 4F 20 ...   1668  .NEWG       DC.B    'JUEGO NUEVO',0
000018E0= 53 41 4C 49 52 00       1669  .EXIT       DC.B    'SALIR',0
000018E6                          1670              DS.W    0
000018E6                          1671              
000018E6                          1672  ; -----------------------------------------------------------------------------
000018E6                          1673  STAGOVRU
000018E6                          1674  ; GAME OVER STATE UPDATE
000018E6                          1675  ; INPUT    - NONE
000018E6                          1676  ; OUTPUT   - NONE
000018E6                          1677  ; MODIFIES - NONE
000018E6                          1678  ; -----------------------------------------------------------------------------
000018E6  0839 0004 00001BBD      1679              BTST.B  #KBDBITF1,(KBDEDGE)
000018EE  6700 000A               1680              BEQ     .END
000018F2  33FC 0000 00001BAA      1681              MOVE.W  #STAINTR,(STANEXT)
000018FA  4E75                    1682  .END        RTS
000018FC                          1683  
000018FC                          1684  ; -----------------------------------------------------------------------------
000018FC                          1685  STAGOVRP
000018FC                          1686  ; GAME OVER STATE PLOT
000018FC                          1687  ; INPUT    - NONE
000018FC                          1688  ; OUTPUT   - NONE
000018FC                          1689  ; MODIFIES - NONE
000018FC                          1690  ; -----------------------------------------------------------------------------
000018FC  48E7 C040               1691              MOVEM.L A1/D0-D1,-(A7)
00001900                          1692m             UTLLOCT GOVSTRX,GOVSTRY
00001900                          1693m ; WRAPPER TO TEXT POSITIONNING FROM TRAP 15
00001900                          1694m ; INPUT    - GOVSTRX X, GOVSTRY Y
00001900                          1695m ; OUTPUT   - NONE
00001900                          1696m ; MODIFIES - D0,D1
00001900                          1697m ; -----------------------------------------------------------------------------
0000190A                          1698m             UTLSPEN #GOVSTRC
0000190A                          1699m ; WRAPPER FOR SET PEN TRAP 15 TASK.
0000190A                          1700m ; INPUT    - #GOVSTRC COLOR IN FORMAT $00BBGGRR
0000190A                          1701m ; OUTPUT   - NONE
0000190A                          1702m ; MODIFIES - D0,D1
0000190A                          1703m ; -----------------------------------------------------------------------------
00001916                          1704m             UTLSFIL #$00000000
00001916                          1705m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001916                          1706m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001916                          1707m ; OUTPUT   - NONE
00001916                          1708m ; MODIFIES - D0,D1
00001916                          1709m ; -----------------------------------------------------------------------------
0000191E  43F9 00001930           1710              LEA     .GOVSTR,A1
00001924  103C 000E               1711              MOVE.B  #14,D0
00001928  4E4F                    1712              TRAP    #15
0000192A  4CDF 0203               1713              MOVEM.L (A7)+,A1/D0-D1
0000192E  4E75                    1714              RTS
00001930                          1715  
00001930= 47 41 4D 45 20 20 ...   1716  .GOVSTR     DC.B    'GAME  OVER',0
0000193C                          1717              DS.W    0
0000193C                          1718  
0000193C                          1719  
0000193C                          1720  
0000193C                          1721  
0000193C                          1722  
0000193C                          1723  
0000193C                          1724  
0000193C                          1725  
0000193C                          1726  
0000193C                          1727  
0000193C                          1728  
0000193C                          1729  
0000193C                          1730  
0000193C                          1731  
0000193C                          1732  
0000193C                          1733  
0000193C                          1734  
0000193C                          1735  
0000193C                          1736  
0000193C                          1737  
0000193C                          1738  
0000193C                          1739  
0000193C                          1740  
0000193C                          1741  -------------------- end include --------------------
0000193C                          1742              INCLUDE "BACKGROUND/BACKGROUND.X68"  ; BACKGROUND MANAGEMENT
0000193C                          1743  ;------------------------------------------------------------------------------
0000193C                          1744  ; BACKGROUND
0000193C                          1745  ;------------------------------------------------------------------------------
0000193C                          1746              INCLUDE "BACKGROUND/CLOUD.X68"     ; BACKGROUND CLOUDS MANAGEMENT 
0000193C                          1747  ; =============================================================================
0000193C                          1748  ; CLOUD MANAGEMENT. IT IS A PROP.
0000193C                          1749  ; LOCAL MEMORY IS:
0000193C                          1750  ; +0 WORD X COORDINATE
0000193C                          1751  ; +2 WORD Y COORDINATE
0000193C                          1752  ; =============================================================================
0000193C                          1753  
0000193C                          1754  ; -----------------------------------------------------------------------------
0000193C                          1755  CLDINIT
0000193C                          1756  ; INITALIZES CLOUD
0000193C                          1757  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
0000193C                          1758  ; OUTPUT   - NONE
0000193C                          1759  ; MODIFIES - NONE
0000193C                          1760  ; NOTE     - ASSUMES SCRHEIGH IS GREATER THAN 255
0000193C                          1761  ; -----------------------------------------------------------------------------
0000193C                          1762          ;Guardar registros
0000193C  2F00                    1763          MOVE.L      D0,-(A7)
0000193E                          1764              
0000193E  30BC 0280               1765          MOVE.W      #SCRWIDTH,(A0)
00001942                          1766          
00001942  4EB8 1360               1767          JSR         UTLRAND
00001946  3140 0002               1768          MOVE.W      D0,2(A0)
0000194A                          1769          
0000194A                          1770          ;Restaurar registros
0000194A  201F                    1771          MOVE.L      (A7)+,D0
0000194C                          1772          
0000194C  4E75                    1773          RTS
0000194E                          1774  
0000194E                          1775  ; -----------------------------------------------------------------------------
0000194E                          1776  CLDUPD
0000194E                          1777  ; UPDATES THE STATE OF CLOUDS
0000194E                          1778  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
0000194E                          1779  ; OUTPUT   - NONE
0000194E                          1780  ; MODIFIES - NONE
0000194E                          1781  ; -----------------------------------------------------------------------------
0000194E                          1782          ;Actualizar posición
0000194E  2F00                    1783          MOVE.L      D0,-(A7)
00001950                          1784          
00001950  3039 00001BB8           1785          MOVE.W      (XSPEED),D0
00001956  80FC 0002               1786          DIVU.W      #2,D0
0000195A  9150                    1787          SUB.W       D0,(A0)
0000195C  0C50 FF88               1788          CMP.W       #-CLDSIZE*2,(A0)
00001960  6F04                    1789          BLE.S       .KILL
00001962                          1790  
00001962                          1791  .END    
00001962  201F                    1792          MOVE.L      (A7)+,D0
00001964  4E75                    1793          RTS
00001966                          1794          
00001966  4EB8 11AA               1795  .KILL   JSR PRPKILL
0000196A  60F6                    1796          BRA         .END     
0000196C                          1797  
0000196C                          1798  ; -----------------------------------------------------------------------------
0000196C                          1799  CLDPLOT
0000196C                          1800  ; PLOTS THE CLOUD IN ITS RIGHTFUL POSITION
0000196C                          1801  ; INPUT    - A0 POINTER TO THE LOCAL MEMORY
0000196C                          1802  ; OUTPUT   - NONE
0000196C                          1803  ; MODIFIES - NONE
0000196C                          1804  ; -----------------------------------------------------------------------------       
0000196C                          1805          ;Guardar registros
0000196C  48E7 F800               1806          MOVEM.L     D0-D4,-(A7)
00001970                          1807          
00001970                          1808m         UTLSPEN     #CLDPCLR
00001970                          1809m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001970                          1810m ; INPUT    - #CLDPCLR COLOR IN FORMAT $00BBGGRR
00001970                          1811m ; OUTPUT   - NONE
00001970                          1812m ; MODIFIES - D0,D1
00001970                          1813m ; -----------------------------------------------------------------------------
0000197C                          1814m         UTLSFIL     #CLDFCLR
0000197C                          1815m ; WRAPPER FOR SET FIL TRAP 15 TASK.
0000197C                          1816m ; INPUT    - #CLDFCLR COLOR IN FORMAT $00BBGGRR
0000197C                          1817m ; OUTPUT   - NONE
0000197C                          1818m ; MODIFIES - D0,D1
0000197C                          1819m ; -----------------------------------------------------------------------------
00001988                          1820          
00001988                          1821          ;Preparar parametros
00001988  3210                    1822          MOVE.W      (A0),D1     ;X0 COORD
0000198A  3428 0002               1823          MOVE.W      2(A0),D2    ;Y0 COORD
0000198E  3601                    1824          MOVE.W      D1,D3       
00001990  3802                    1825          MOVE.W      D2,D4       
00001992  0643 0078               1826          ADD.W       #CLDSIZE*2,D3 ;X1 COORD
00001996  0644 003C               1827          ADD.W       #CLDSIZE,D4 ;Y2 COORD
0000199A                          1828          
0000199A  7058                    1829          MOVEQ       #88,D0      ;TASK NUM
0000199C                          1830          
0000199C  4E4F                    1831          TRAP        #15
0000199E                          1832          
0000199E                          1833          ;Restaurar registros
0000199E  4CDF 001F               1834          MOVEM.L     (A7)+,D0-D4
000019A2  4E75                    1835          RTS
000019A4                          1836  
000019A4                          1837  
000019A4                          1838  
000019A4                          1839  
000019A4                          1840  
000019A4                          1841  
000019A4                          1842  
000019A4                          1843  
000019A4                          1844  
000019A4                          1845  
000019A4                          1846  
000019A4                          1847  
000019A4                          1848  
000019A4                          1849  
000019A4                          1850  
000019A4                          1851  
000019A4                          1852  
000019A4                          1853  
000019A4                          1854  
000019A4                          1855  
000019A4                          1856  
000019A4                          1857  
000019A4                          1858  
000019A4                          1859  
000019A4                          1860  
000019A4                          1861  -------------------- end include --------------------
000019A4                          1862              INCLUDE "BACKGROUND/GSSDETAIL.X68" ; GRASS DETAILS MANAGEMENT
000019A4                          1863  ; =============================================================================
000019A4                          1864  ; GRASS DETAILS MANAGEMENT. IT IS A PROP.
000019A4                          1865  ; LOCAL MEMORY IS:
000019A4                          1866  ; +0 WORD X COORDINATE
000019A4                          1867  ; =============================================================================
000019A4                          1868  
000019A4                          1869  ; -----------------------------------------------------------------------------
000019A4                          1870  GSSDINIT
000019A4                          1871  ; INITIALIZES THE LITTLE DETAILS ON THE GRASS
000019A4                          1872  ; -----------------------------------------------------------------------------
000019A4  2F00                    1873          MOVE.L      D0,-(A7)
000019A6                          1874          
000019A6  30BC 0280               1875          MOVE.W      #SCRWIDTH,(A0)
000019AA                          1876          
000019AA  201F                    1877          MOVE.L      (A7)+,D0
000019AC  4E75                    1878          RTS
000019AE                          1879          
000019AE                          1880          
000019AE                          1881  ; -----------------------------------------------------------------------------
000019AE                          1882  GSSDUPD
000019AE                          1883  ; MODIFIES THE LITTLE DETAILS ON THE GRASS' X COORDINATE
000019AE                          1884  ; -----------------------------------------------------------------------------
000019AE                          1885          ;Guardar registros
000019AE  2F00                    1886          MOVE.L      D0,-(A7)
000019B0                          1887  
000019B0  3039 00001BB8           1888          MOVE.W      (XSPEED),D0
000019B6  9150                    1889          SUB.W       D0,(A0)         ;UPDATE X COORDINATE
000019B8  0C50 FFF6               1890          CMP.W       #-GSSDWDTH,(A0)
000019BC  6F04                    1891          BLE.S       .KILL
000019BE                          1892          
000019BE                          1893  .END    ;Restaurar registros
000019BE  201F                    1894          MOVE.L      (A7)+,D0
000019C0  4E75                    1895          RTS
000019C2                          1896  
000019C2  4EB8 11AA               1897  .KILL   JSR         PRPKILL
000019C6  60F6                    1898          BRA         .END
000019C8                          1899          
000019C8                          1900  ; -----------------------------------------------------------------------------
000019C8                          1901  GSSDPLOT
000019C8                          1902  ; PLOTS THE LITTLE DETAILS ON THE GRASS' X COORDINATE
000019C8                          1903  ; -----------------------------------------------------------------------------
000019C8  48E7 F800               1904          MOVEM.L     D0-D4,-(A7)
000019CC                          1905          
000019CC                          1906m         UTLSPEN     #$00000000
000019CC                          1907m ; WRAPPER FOR SET PEN TRAP 15 TASK.
000019CC                          1908m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
000019CC                          1909m ; OUTPUT   - NONE
000019CC                          1910m ; MODIFIES - D0,D1
000019CC                          1911m ; -----------------------------------------------------------------------------
000019D4                          1912m         UTLSFIL     #GSSDFC
000019D4                          1913m ; WRAPPER FOR SET FIL TRAP 15 TASK.
000019D4                          1914m ; INPUT    - #GSSDFC COLOR IN FORMAT $00BBGGRR
000019D4                          1915m ; OUTPUT   - NONE
000019D4                          1916m ; MODIFIES - D0,D1
000019D4                          1917m ; -----------------------------------------------------------------------------
000019E0                          1918          
000019E0  3210                    1919          MOVE.W      (A0),D1
000019E2  343C 0168               1920          MOVE.W      #BGGSSTP,D2
000019E6  3601                    1921          MOVE.W      D1,D3
000019E8  0643 000A               1922          ADD.W       #GSSDWDTH,D3
000019EC  383C 0190               1923          MOVE.W      #BGGSSBT,D4
000019F0                          1924          
000019F0  7057                    1925          MOVEQ       #87,D0
000019F2  4E4F                    1926          TRAP        #15
000019F4                          1927          
000019F4  4CDF 001F               1928          MOVEM.L     (A7)+,D0-D4
000019F8  4E75                    1929          RTS
000019FA                          1930          
000019FA                          1931  
000019FA                          1932  
000019FA                          1933  
000019FA                          1934  
000019FA                          1935  
000019FA                          1936  
000019FA                          1937  
000019FA                          1938  -------------------- end include --------------------
000019FA                          1939  ; -----------------------------------------------------------------------------
000019FA                          1940  BGUPD
000019FA                          1941  ; UPDATES DETAILS OF BACKGROUND
000019FA                          1942  ; INPUT    - NONE
000019FA                          1943  ; OUTPUT   - NONE
000019FA                          1944  ; MODIFIES - MEMORY WHEN NEEDED
000019FA                          1945  ; -----------------------------------------------------------------------------
000019FA  48E7 8070               1946              MOVEM.L  D0/A1-A3,-(A7)
000019FE                          1947  
000019FE  1039 00001BBF           1948              MOVE.B  (SCRCYCCT),D0
00001A04  C07C 0007               1949              AND     #$07,D0                 ;EVERY 8 CYCLES
00001A08  6614                    1950              BNE.S   .CLOUD                  ;CREATE A NEW MARK ON GRASS
00001A0A  43F8 19A4               1951              LEA     GSSDINIT,A1
00001A0E  45F8 19AE               1952              LEA     GSSDUPD,A2
00001A12  47F8 19C8               1953              LEA     GSSDPLOT,A3
00001A16  303C 0002               1954              MOVE.W  #GSSDTYPE,D0
00001A1A                          1955              
00001A1A  4EB8 1502               1956              JSR     PRPADD
00001A1E                          1957  
00001A1E  1039 00001BBF           1958  .CLOUD      MOVE.B  (SCRCYCCT),D0
00001A24  C07C 00FF               1959              AND     #$FF,D0                 ; EVERY 256 CYCLES
00001A28  6600 0016               1960              BNE     .END                    ; CREATE A NEW CLOUD
00001A2C  43F8 193C               1961              LEA     CLDINIT,A1
00001A30  45F8 194E               1962              LEA     CLDUPD,A2
00001A34  47F8 196C               1963              LEA     CLDPLOT,A3
00001A38  303C 0001               1964              MOVE.W  #CLDTYPE,D0
00001A3C                          1965              
00001A3C  4EB8 1502               1966              JSR     PRPADD
00001A40                          1967              
00001A40  4CDF 0E01               1968  .END        MOVEM.L (A7)+,D0/A1-A3
00001A44  4E75                    1969              RTS
00001A46                          1970  
00001A46                          1971  
00001A46                          1972  ; -----------------------------------------------------------------------------
00001A46                          1973  BGPLOT
00001A46                          1974  ; PLOTS BACKGROUND
00001A46                          1975  ; INPUT    - NONE
00001A46                          1976  ; OUTPUT   - NONE
00001A46                          1977  ; MODIFIES - NONE
00001A46                          1978  ; -----------------------------------------------------------------------------
00001A46                          1979              
00001A46  48A7 7800               1980              MOVEM.W D1-D4,-(A7)
00001A4A                          1981              
00001A4A                          1982m             UTLSPEN #BGSKYPC
00001A4A                          1983m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001A4A                          1984m ; INPUT    - #BGSKYPC COLOR IN FORMAT $00BBGGRR
00001A4A                          1985m ; OUTPUT   - NONE
00001A4A                          1986m ; MODIFIES - D0,D1
00001A4A                          1987m ; -----------------------------------------------------------------------------
00001A52                          1988m             UTLSFIL #BGSKYFC
00001A52                          1989m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001A52                          1990m ; INPUT    - #BGSKYFC COLOR IN FORMAT $00BBGGRR
00001A52                          1991m ; OUTPUT   - NONE
00001A52                          1992m ; MODIFIES - D0,D1
00001A52                          1993m ; -----------------------------------------------------------------------------
00001A5E                          1994              
00001A5E  4241                    1995              CLR.W   D1
00001A60  4242                    1996              CLR.W   D2
00001A62  363C 0280               1997              MOVE.W  #SCRWIDTH,D3
00001A66  383C 01E0               1998              MOVE.W  #SCRHEIGH,D4
00001A6A                          1999              
00001A6A  7057                    2000              MOVEQ   #87,D0
00001A6C  4E4F                    2001              TRAP    #15
00001A6E                          2002              
00001A6E                          2003m             UTLSFIL #BGGNDFC
00001A6E                          2004m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001A6E                          2005m ; INPUT    - #BGGNDFC COLOR IN FORMAT $00BBGGRR
00001A6E                          2006m ; OUTPUT   - NONE
00001A6E                          2007m ; MODIFIES - D0,D1
00001A6E                          2008m ; -----------------------------------------------------------------------------
00001A7A                          2009              
00001A7A  4241                    2010              CLR     D1
00001A7C  343C 0190               2011              MOVE.W  #BGGSSBT,D2
00001A80  363C 0280               2012              MOVE.W  #SCRWIDTH,D3
00001A84  383C 01E0               2013              MOVE.W  #SCRHEIGH,D4
00001A88                          2014              
00001A88  7057                    2015              MOVEQ   #87,D0
00001A8A  4E4F                    2016              TRAP    #15
00001A8C                          2017              
00001A8C                          2018m             UTLSFIL #BGGSSFC
00001A8C                          2019m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001A8C                          2020m ; INPUT    - #BGGSSFC COLOR IN FORMAT $00BBGGRR
00001A8C                          2021m ; OUTPUT   - NONE
00001A8C                          2022m ; MODIFIES - D0,D1
00001A8C                          2023m ; -----------------------------------------------------------------------------
00001A98                          2024  
00001A98                          2025  
00001A98  4241                    2026              CLR     D1
00001A9A  343C 0168               2027              MOVE.W  #BGGSSTP,D2
00001A9E  363C 0280               2028              MOVE.W  #SCRWIDTH,D3
00001AA2  383C 0190               2029              MOVE.W  #BGGSSBT,D4
00001AA6                          2030              
00001AA6  7057                    2031              MOVEQ   #87,D0
00001AA8  4E4F                    2032              TRAP    #15
00001AAA                          2033              
00001AAA  4C9F 001E               2034              MOVEM.W (A7)+,D1-D4
00001AAE  4E75                    2035              RTS
00001AB0                          2036  
00001AB0                          2037  
00001AB0                          2038  
00001AB0                          2039  
00001AB0                          2040  
00001AB0                          2041  
00001AB0                          2042  
00001AB0                          2043  
00001AB0                          2044  
00001AB0                          2045  
00001AB0                          2046  
00001AB0                          2047  
00001AB0                          2048  
00001AB0                          2049  
00001AB0                          2050  
00001AB0                          2051  
00001AB0                          2052  
00001AB0                          2053  
00001AB0                          2054  -------------------- end include --------------------
00001AB0                          2055              INCLUDE "PIPES.X68"                  ; PIPES MANAGEMENT          
00001AB0                          2056  ; =============================================================================
00001AB0                          2057  ; PIPES MANAGEMENT. IT IS AN AGENT.
00001AB0                          2058  ; LOCAL MEMORY IS:
00001AB0                          2059  ; +0 WORD X COORDINATE OF THE LEFTMOST EDGE OF THE VERTICALLY ALIGNED PIPES
00001AB0                          2060  ; +2 WORD Y COORDINATE OF THE DOWNMOST EDGE OF THE TOP PIPE (FACING DOWN)
00001AB0                          2061  ; +4 WORD BOOLEAN THAT TELLS WHETHER THE PIPE SHOULD MOVE OR NOT
00001AB0                          2062  ;    (0 == TRUE. ELSE FALSE)
00001AB0                          2063  ; =============================================================================
00001AB0                          2064  
00001AB0                          2065  ; -----------------------------------------------------------------------------
00001AB0                          2066  PIPINIT
00001AB0                          2067  ; PIPE INITIALIZATION
00001AB0                          2068  ; -----------------------------------------------------------------------------
00001AB0                          2069              ;Guardar registros
00001AB0  48E7 C000               2070              MOVEM.L D0-D1,-(A7)
00001AB4                          2071          
00001AB4  30BC 0280               2072              MOVE.W  #SCRWIDTH,(A0)      ;X COORDINATE OF STARTING POSITION
00001AB8  4EB8 1360               2073              JSR     UTLRAND             ;RANDOM Y COORDINATE OF STARTING
00001ABC  3140 0002               2074              MOVE.W  D0,2(A0)            *POSITION
00001AC0  B23C 0004               2075              CMP.B   #4,D1
00001AC4  6606                    2076              BNE.S   .skip
00001AC6                          2077              
00001AC6  4239 00001BB6           2078              CLR.B   (PIPCOUNT)
00001ACC                          2079  .skip            
00001ACC  1141 0004               2080              MOVE.B  D1,4(A0)            ;BOOLEAN: MOVING OR NOT
00001AD0                          2081          
00001AD0                          2082              ;Restaurar registros
00001AD0  4CDF 0003               2083              MOVEM.L (A7)+,D0-D1
00001AD4  4E75                    2084              RTS
00001AD6                          2085              
00001AD6                          2086  ; -----------------------------------------------------------------------------
00001AD6                          2087  PIPUPD
00001AD6                          2088  ; PIPE UPDATE
00001AD6                          2089  ; -----------------------------------------------------------------------------
00001AD6                          2090              ;Guardar registros
00001AD6  2F00                    2091              MOVE.L  D0,-(A7)
00001AD8                          2092              
00001AD8  3039 00001BB8           2093              MOVE.W  (XSPEED),D0     
00001ADE  9150                    2094              SUB.W   D0,(A0)         ;UPDATE X COORDINATE
00001AE0                          2095              
00001AE0  0C50 FFC4               2096              CMP.W   #-PIPTWDT,(A0)
00001AE4  6F04                    2097              BLE.S   .KILL
00001AE6                          2098              
00001AE6                          2099              
00001AE6                          2100              
00001AE6                          2101  .END        ;Restaurar registros
00001AE6  201F                    2102              MOVE.L  (A7)+,D0
00001AE8  4E75                    2103              RTS
00001AEA                          2104              
00001AEA  4EB8 11AA               2105  .KILL       JSR     AGLKILL
00001AEE  60F6                    2106              BRA.S  .END
00001AF0                          2107              
00001AF0                          2108  ; -----------------------------------------------------------------------------
00001AF0                          2109  PIPPLOT
00001AF0                          2110  ; PIPE PLOT
00001AF0                          2111  ; -----------------------------------------------------------------------------
00001AF0                          2112              ;Guardar registros
00001AF0  48E7 F800               2113              MOVEM.L D0-D4,-(A7)
00001AF4                          2114              
00001AF4                          2115m             UTLSPEN #PIPPC
00001AF4                          2116m ; WRAPPER FOR SET PEN TRAP 15 TASK.
00001AF4                          2117m ; INPUT    - #PIPPC COLOR IN FORMAT $00BBGGRR
00001AF4                          2118m ; OUTPUT   - NONE
00001AF4                          2119m ; MODIFIES - D0,D1
00001AF4                          2120m ; -----------------------------------------------------------------------------
00001AFC                          2121              
00001AFC  0C28 0000 0004          2122              CMP.B   #0,4(A0)
00001B02  6710                    2123              BEQ.S   .skip
00001B04                          2124              
00001B04                          2125m             UTLSFIL #PIPFC
00001B04                          2126m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001B04                          2127m ; INPUT    - #PIPFC COLOR IN FORMAT $00BBGGRR
00001B04                          2128m ; OUTPUT   - NONE
00001B04                          2129m ; MODIFIES - D0,D1
00001B04                          2130m ; -----------------------------------------------------------------------------
00001B10  6000 000A               2131              BRA     .skp2
00001B14                          2132  .skip       
00001B14                          2133m             UTLSFIL #$00000000      ;prueba para pipes que se han de mover
00001B14                          2134m ; WRAPPER FOR SET FIL TRAP 15 TASK.
00001B14                          2135m ; INPUT    - #$00000000 COLOR IN FORMAT $00BBGGRR
00001B14                          2136m ; OUTPUT   - NONE
00001B14                          2137m ; MODIFIES - D0,D1
00001B14                          2138m ; -----------------------------------------------------------------------------
00001B1C                          2139  .skp2
00001B1C                          2140              
00001B1C  3210                    2141              MOVE.W  (A0),D1         ;PAINT THE BASE OF THE TOP PIPE
00001B1E  5A41                    2142              ADDQ    #PIPTBSPC,D1
00001B20  4242                    2143              CLR     D2
00001B22  3601                    2144              MOVE.W  D1,D3
00001B24  0643 0032               2145              ADD.W   #PIPBWDT,D3
00001B28  3828 0002               2146              MOVE.W  2(A0),D4
00001B2C                          2147              
00001B2C  7057                    2148              MOVEQ   #87,D0
00001B2E  4E4F                    2149              TRAP    #15
00001B30                          2150              
00001B30  3210                    2151              MOVE.W  (A0),D1         ;PAINT THE MOUTH OF THE TOP PIPE
00001B32  3828 0002               2152              MOVE.W  2(A0),D4
00001B36  3404                    2153              MOVE.W  D4,D2
00001B38  0442 000A               2154              SUB.W   #PIPTHGT,D2
00001B3C  3601                    2155              MOVE.W  D1,D3
00001B3E  0643 003C               2156              ADD.W   #PIPTWDT,D3
00001B42                          2157              
00001B42  7057                    2158              MOVEQ   #87,D0
00001B44  4E4F                    2159              TRAP    #15
00001B46                          2160              
00001B46  3210                    2161              MOVE.W  (A0),D1         ;PAINT THE BASE OF THE BOTTOM PIPE
00001B48  5A41                    2162              ADD.W   #PIPTBSPC,D1
00001B4A  3428 0002               2163              MOVE.W  2(A0),D2
00001B4E  0642 0050               2164              ADD.W   #PIPOPEN,D2
00001B52  3601                    2165              MOVE.W  D1,D3
00001B54  0643 0032               2166              ADD.W   #PIPBWDT,D3
00001B58  383C 0168               2167              MOVE.W  #BGGSSTP,D4
00001B5C                          2168              
00001B5C  7057                    2169              MOVEQ   #87,D0
00001B5E  4E4F                    2170              TRAP    #15
00001B60                          2171              
00001B60  3210                    2172              MOVE.W  (A0),D1         ;PAINT THE MOUTH OF THE BOTTOM PIPE
00001B62  3428 0002               2173              MOVE.W  2(A0),D2
00001B66  0642 0050               2174              ADD.W   #PIPOPEN,D2
00001B6A  3601                    2175              MOVE.W  D1,D3
00001B6C  0643 003C               2176              ADD.W   #PIPTWDT,D3
00001B70  3802                    2177              MOVE.W  D2,D4
00001B72  0644 000A               2178              ADD.W   #PIPTHGT,D4
00001B76                          2179              
00001B76  7057                    2180              MOVEQ   #87,D0
00001B78  4E4F                    2181              TRAP    #15
00001B7A                          2182  
00001B7A                          2183              ;Restaurar registros
00001B7A  4CDF 001F               2184              MOVEM.L (A7)+,D0-D4
00001B7E  4E75                    2185              RTS
00001B80                          2186  
00001B80                          2187  
00001B80                          2188  
00001B80                          2189  
00001B80                          2190  
00001B80                          2191  
00001B80                          2192  
00001B80                          2193  -------------------- end include --------------------
00001B80                          2194  
00001B80                          2195  
00001B80                          2196  ; --- INITIALIZE --------------------------------------------------------------
00001B80                          2197  
00001B80  4EB8 1000               2198  START       JSR     SYSINIT
00001B84  4EB8 15B6               2199              JSR     STAINIT
00001B88                          2200  
00001B88                          2201  ; --- UPDATE ------------------------------------------------------------------
00001B88                          2202   
00001B88  4E40                    2203  .LOOP       TRAP    #KBDTRAP                ; READ KEYBOARD
00001B8A  4EB8 15C8               2204              JSR     STAUPD
00001B8E                          2205  
00001B8E                          2206  ; --- WAIT SYNCH --------------------------------------------------------------
00001B8E                          2207  
00001B8E  4A39 00001BBE           2208  .WINT       TST.B   (SCRINTCT)              ; WAIT FOR INTERRUPT
00001B94  67F8                    2209              BEQ     .WINT
00001B96  4239 00001BBE           2210              CLR.B   (SCRINTCT)
00001B9C                          2211  
00001B9C                          2212  ; --- PLOT --------------------------------------------------------------------
00001B9C                          2213  
00001B9C  4EB8 1626               2214              JSR     STAPLOT
00001BA0  4E41                    2215              TRAP    #SCRTRAP                ; SHOW GRAPHICS
00001BA2  60E4                    2216              BRA     .LOOP
00001BA4  FFFF FFFF               2217              SIMHALT
00001BA8                          2218  
00001BA8                          2219  ; --- VARIABLES ---------------------------------------------------------------
00001BA8                          2220  
00001BA8                          2221              INCLUDE "VAR.X68"
00001BA8                          2222  ; =============================================================================
00001BA8                          2223  ; GAME VARS
00001BA8                          2224  ; =============================================================================
00001BA8                          2225  
00001BA8                          2226  ; --- GAME STATE RELATED VARIABLES --------------------------------------------
00001BA8                          2227  
00001BA8                          2228  STACUR      DS.W    1                       ; CURRENT GAME STATE
00001BAA                          2229  STANEXT     DS.W    1                       ; NEXT GAME STATE
00001BAC                          2230  
00001BAC                          2231  ; --- PLAYER RELATED VARIABLES ------------------------------------------------
00001BAC                          2232  
00001BAC                          2233  PLRPOSX     DS.W    1                       ; PLAYER X POSITION (PIXELS)
00001BAE                          2234  PLRPOSY     DS.W    1                       ; PLAYER Y POSITION (PIXELS)
00001BB0                          2235  MAXPOS      DS.W    1
00001BB2                          2236  UPPRESSED   DS.W    1
00001BB4                          2237  PLRSPEED    DS.W    1
00001BB6                          2238              DS.W    0
00001BB6                          2239              
00001BB6                          2240  ; --- PIPE RELATED VARIABLES --------------------------------------------------
00001BB6                          2241  
00001BB6= 01                      2242  PIPCOUNT    DC.B    1
00001BB8                          2243              DS.W    0
00001BB8                          2244  
00001BB8                          2245  ; --- GAME RELATED VARIABLES --------------------------------------------------
00001BB8                          2246  
00001BB8= 0005                    2247  XSPEED      DC.W    5                       ;HORIZONTAL SPEED OF OBJECTS
00001BBA                          2248  
00001BBA                          2249  ; --- PAUSE MENU RELATED VARIABLES -------------------------------------------
00001BBA                          2250  
00001BBA= 00                      2251  PMOPTN      DC.B    0                       ;OPTION ON THE MENU TO BE CHOSEN
00001BBB                          2252  
00001BBB                          2253  ; --- UTILITY VARIABLES ------------------------------------------------------
00001BBB                          2254  
00001BBB                          2255  UTLRNDIX    DS.B    1                       ; NEXT INDEX TO RANDOM NUMBER
00001BBC                          2256              DS.W    0
00001BBC                          2257  
00001BBC                          2258  
00001BBC                          2259  
00001BBC                          2260  
00001BBC                          2261  
00001BBC                          2262  
00001BBC                          2263  
00001BBC                          2264  
00001BBC                          2265  
00001BBC                          2266  
00001BBC                          2267  
00001BBC                          2268  
00001BBC                          2269  
00001BBC                          2270  -------------------- end include --------------------
00001BBC                          2271              INCLUDE "SYSVAR.X68"
00001BBC                          2272  ; =============================================================================
00001BBC                          2273  ; SYSTEM VARS
00001BBC                          2274  ; NOTE THAT ALL THESE VARS ARE USED TO SHARE DATA FROM SYSTEM TO USER. THUS
00001BBC                          2275  ; THEY MUST NOT BE IN PROTECTED MEMORY.
00001BBC                          2276  ; NOTE THAT USING DMMDATA IN SUCH WAY IS A BAD IDEA, AS USER APPLICATIONS CAN
00001BBC                          2277  ; ALSO FREE OR CHANGE OWNERSHIP. NONETHELESS, FOR THE SAKE OF THIS EXAMPLE
00001BBC                          2278  ; THIS IS GOOD ENOUGH.
00001BBC                          2279  ; =============================================================================
00001BBC                          2280  
00001BBC                          2281  ; --- KEYBOARD RELATED VARIABLES ----------------------------------------------
00001BBC                          2282  
00001BBC                          2283  KBDVAL      DS.B    1                       ; KEY PRESSED=1
00001BBD                          2284  KBDEDGE     DS.B    1                       ; KEY CHANGED=1
00001BBE                          2285  
00001BBE                          2286              DS.W    0
00001BBE                          2287  
00001BBE                          2288  ; --- SCREEN RELATED VARIABLES ------------------------------------------------
00001BBE                          2289  
00001BBE                          2290  SCRINTCT    DS.B    1                       ; INTERRUPT COUNTER/FLAG
00001BBF                          2291  SCRCYCCT    DS.B    1                       ; CYCLE COUNTER
00001BC0                          2292              DS.W    0
00001BC0                          2293  
00001BC0                          2294  ; --- DYNAMIC MEMORY VARIABLES ------------------------------------------------
00001BC0                          2295  
00001BC0                          2296              ORG     (*+DMMBSIZE-1)&-DMMBSIZE ; ALIGN TO DMMBSIZE
00001BC0                          2297  DMMDATA     DS.B    DMMBSIZE*DMMBNUM        ; DYNAMIC MEMORY ALLOCATION SPACE
00002840                          2298              DS.W    0                       ; JUST IN CASE (SIZE IS POW OF TWO)
00002840                          2299  
00002840                          2300  
00002840                          2301  -------------------- end include --------------------
00002840                          2302  
00002840                          2303              END    START

No errors detected
No warnings generated


SYMBOL TABLE INFORMATION
Symbol-name         Value
-------------------------
AGLADD              147E
AGLADD:END          1494
AGLKILL             11AA
AGLPLOT             14CC
AGLPLOT:END         14FC
AGLPLOT:LOOP        14D4
AGLPLOT:NEXT        14F6
AGLUPD              1498
AGLUPD:END          14C6
AGLUPD:LOOP         14A0
AGLUPD:NEXT         14C0
BGGNDFC             155DD8
BGGNDPC             0
BGGNDTP             190
BGGSSBT             190
BGGSSFC             990A
BGGSSPC             0
BGGSSTP             168
BGPLOT              1A46
BGSKYFC             EFCE87
BGSKYPC             0
BGUPD               19FA
BGUPD:CLOUD         1A1E
BGUPD:END           1A40
BLACK               0
CLDFCLR             FFFFFF
CLDINIT             193C
CLDPCLR             FFFFFF
CLDPLOT             196C
CLDSIZE             3C
CLDTYPE             1
CLDUPD              194E
CLDUPD:END          1962
CLDUPD:KILL         1966
CONTNUM             0
DMMALLOC            1190
DMMALLOC:END        11A8
DMMBNUM             32
DMMBSIZE            40
DMMDATA             1BC0
DMMFCOM             116A
DMMFFND             1178
DMMFIRST            1120
DMMFLOOP            115E
DMMFRCOM            1132
DMMFREE             11AA
DMMFRFND            1140
DMMFRLOP            1126
DMMFRSTO            1158
DMMINIT             10FE
DMMINIT:LOOP        110C
DMMNEXT             1142
DMMNEXTO            117A
DMMSYSID            0
EXTNUM              2
GOVSTRC             FFFFFF
GOVSTRX             23
GOVSTRY             F
GREEN               8000
GSSDFC              39DB44
GSSDINIT            19A4
GSSDPLOT            19C8
GSSDTYPE            2
GSSDUPD             19AE
GSSDUPD:END         19BE
GSSDUPD:KILL        19C2
GSSDWDTH            A
INTPRSC             80
INTPRSF             31A0001
INTPRSX             5
INTPRSY             8
INTTITC             FFFF
INTTITF             33D0001
INTTITX             1
INTTITY             1
JUMPSIZE            A
KBDBITDN            3
KBDBITF1            4
KBDBITF2            5
KBDBITF3            6
KBDBITLF            0
KBDBITPS            7
KBDBITRT            2
KBDBITUP            1
KBDCHRDN            28
KBDCHRLF            25
KBDCHRMK            4D
KBDCHRPK            50
KBDCHRRT            27
KBDCHRSH            10
KBDCHRSP            20
KBDCHRUP            26
KBDDOWN             28
KBDEDGE             1BBD
KBDFIRE1            20
KBDFIRE2            4D
KBDFIRE3            10
KBDINIT             1090
KBDLEFT             25
KBDMSKDN            8
KBDMSKF1            10
KBDMSKF2            20
KBDMSKF3            40
KBDMSKLF            1
KBDMSKPS            80
KBDMSKRT            4
KBDMSKUP            2
KBDPAUSE            50
KBDREAD             10A6
KBDREAD:KEYSREADY   10E2
KBDREAD:LOOP        10C4
KBDREAD:NEXTKEYS    10C2
KBDREAD:NOTPRESSED  10CE
KBDRIGHT            27
KBDTRAP             0
KBDUP               26
KBDVAL              1BBC
MAXPOS              1BB0
NEWGNUM             1
PAUCNTY             8
PAUEXTY             C
PAUNEWY             A
PAUOPTC             FFFFFF
PAUOPTFS            1130005
PAUOPTFU            1130001
PAUOPTX             F
PAUSELC             FF
PAUTITC             FFFF
PAUTITF             3300001
PAUTITX             2
PAUTITY             1
PIPBWDT             32
PIPCOUNT            1BB6
PIPFC               196600
PIPINIT             1AB0
PIPINIT:SKIP        1ACC
PIPOPEN             50
PIPPC               0
PIPPLOT             1AF0
PIPPLOT:SKIP        1B14
PIPPLOT:SKP2        1B1C
PIPTBSPC            5
PIPTHGT             A
PIPTWDT             3C
PIPTYPE             3
PIPUPD              1AD6
PIPUPD:END          1AE6
PIPUPD:KILL         1AEA
PIPYSPD             2
PLRCOLOR            8000
PLREYECOLOR         FFFFFF
PLRHEIGHT           1E
PLRINIT             11C0
PLRINITPOSX         96
PLRINITPOSY         B4
PLRIRISCOLOR        0
PLRMOUTHCOLOR       FF
PLRPLOT             1268
PLRPOSX             1BAC
PLRPOSY             1BAE
PLRSPEED            1BB4
PLRUPD              11EA
PLRUPD:END          1262
PLRUPD:LASTJUMP     125E
PLRUPD:MAKEJUMP     1234
PLRUPD:PRESSED      1218
PLRWIDTH            1E
PMOPTN              1BBA
PRPADD              1502
PRPADD:END          1518
PRPKILL             11AA
PRPPLOT             154A
PRPPLOT:END         1572
PRPPLOT:LOOP        1552
PRPPLOT:NEXT        156C
PRPUPD              151C
PRPUPD:END          1544
PRPUPD:LOOP         1524
PRPUPD:NEXT         153E
RED                 FF
SCRCYCCT            1BBF
SCRHEIGH            1E0
SCRINIT             101C
SCRINTCT            1BBE
SCRIRQ              1
SCRISR              1074
SCRTIM              14
SCRTRAP             1
SCRUPD              1082
SCRWIDTH            280
SPWUPD              1578
SPWUPD:END          15B0
STACUR              1BA8
STAEMPTY            1652
STAGOVR             3
STAGOVRP            18FC
STAGOVRP:GOVSTR     1930
STAGOVRU            18E6
STAGOVRU:END        18FA
STAINIT             15B6
STAINTR             0
STAINTRI            10FE
STAINTRP            16A6
STAINTRP:START_TEXT  1708
STAINTRP:TITLE      16FC
STAINTRU            1690
STAINTRU:END        16A4
STANEXT             1BAA
STANONE             FFFFFFFF
STAPAU              2
STAPAUI             171E
STAPAUP             17C0
STAPAUP:CNTSEL      1812
STAPAUP:CONT        18CA
STAPAUP:EXIT        18E0
STAPAUP:EXTSEL      1892
STAPAUP:NEWG        18D4
STAPAUP:NEWSEL      1852
STAPAUP:SKPCNT      1822
STAPAUP:SKPEXT      18A2
STAPAUP:SKPNEW      1862
STAPAUP:TITLE       18BC
STAPAUU             1728
STAPAUU:CONTGAME    17A2
STAPAUU:DN          176C
STAPAUU:END         1758
STAPAUU:EXITGAME    17B6
STAPAUU:JMPLST      1790
STAPAUU:NEWGAME     17AC
STAPAUU:OK          177E
STAPAUU:UP          175A
STAPLAY             1
STAPLAYI            11C0
STAPLAYP            167E
STAPLAYU            1654
STAPLAYU:PAUSE      1674
STAPLOT             1626
STAPLOT:PLTTBL      1642
START               1B80
START:LOOP          1B88
START:WINT          1B8E
STAUPD              15C8
STAUPD:DOUPD        15EE
STAUPD:INITBL       1606
STAUPD:UPDTBL       1616
SYSINIT             1000
UPPRESSED           1BB2
UTLCHCOL            132C
UTLCHCOL:END        135A
UTLCHCOL:NOCOL      1358
UTLFONT             37C
UTLINIT             1324
UTLLOCT             254
UTLRAND             1360
UTLRAND:RANDVEC     137E
UTLRNDIX            1BBB
UTLSFIL             12A
UTLSPEN             0
WHITE               FFFFFF
XSPEED              1BB8
